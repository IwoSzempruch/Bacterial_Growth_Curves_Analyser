(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var yw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ed(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Sx={exports:{}},Au={},Ex={exports:{}},tr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Do=Symbol.for("react.element"),ww=Symbol.for("react.portal"),kw=Symbol.for("react.fragment"),_w=Symbol.for("react.strict_mode"),Sw=Symbol.for("react.profiler"),Ew=Symbol.for("react.provider"),bw=Symbol.for("react.context"),Cw=Symbol.for("react.forward_ref"),Tw=Symbol.for("react.suspense"),Nw=Symbol.for("react.memo"),Aw=Symbol.for("react.lazy"),Bh=Symbol.iterator;function jw(e){return e===null||typeof e!="object"?null:(e=Bh&&e[Bh]||e["@@iterator"],typeof e=="function"?e:null)}var bx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Cx=Object.assign,Tx={};function wl(e,t,r){this.props=e,this.context=t,this.refs=Tx,this.updater=r||bx}wl.prototype.isReactComponent={};wl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};wl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Nx(){}Nx.prototype=wl.prototype;function td(e,t,r){this.props=e,this.context=t,this.refs=Tx,this.updater=r||bx}var rd=td.prototype=new Nx;rd.constructor=td;Cx(rd,wl.prototype);rd.isPureReactComponent=!0;var Uh=Array.isArray,Ax=Object.prototype.hasOwnProperty,nd={current:null},jx={key:!0,ref:!0,__self:!0,__source:!0};function Fx(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)Ax.call(t,n)&&!jx.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var o=Array(l),u=0;u<l;u++)o[u]=arguments[u+2];a.children=o}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:Do,type:e,key:s,ref:i,props:a,_owner:nd.current}}function Fw(e,t){return{$$typeof:Do,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ad(e){return typeof e=="object"&&e!==null&&e.$$typeof===Do}function Mw(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var $h=/\/+/g;function qu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Mw(""+e.key):t.toString(36)}function Mc(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Do:case ww:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+qu(i,0):n,Uh(a)?(r="",e!=null&&(r=e.replace($h,"$&/")+"/"),Mc(a,t,r,"",function(u){return u})):a!=null&&(ad(a)&&(a=Fw(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace($h,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",Uh(e))for(var l=0;l<e.length;l++){s=e[l];var o=n+qu(s,l);i+=Mc(s,t,r,o,a)}else if(o=jw(e),typeof o=="function")for(e=o.call(e),l=0;!(s=e.next()).done;)s=s.value,o=n+qu(s,l++),i+=Mc(s,t,r,o,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function ec(e,t,r){if(e==null)return e;var n=[],a=0;return Mc(e,n,"","",function(s){return t.call(r,s,a++)}),n}function Rw(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Un={current:null},Rc={transition:null},Iw={ReactCurrentDispatcher:Un,ReactCurrentBatchConfig:Rc,ReactCurrentOwner:nd};function Mx(){throw Error("act(...) is not supported in production builds of React.")}tr.Children={map:ec,forEach:function(e,t,r){ec(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return ec(e,function(){t++}),t},toArray:function(e){return ec(e,function(t){return t})||[]},only:function(e){if(!ad(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};tr.Component=wl;tr.Fragment=kw;tr.Profiler=Sw;tr.PureComponent=td;tr.StrictMode=_w;tr.Suspense=Tw;tr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Iw;tr.act=Mx;tr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Cx({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=nd.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(o in t)Ax.call(t,o)&&!jx.hasOwnProperty(o)&&(n[o]=t[o]===void 0&&l!==void 0?l[o]:t[o])}var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){l=Array(o);for(var u=0;u<o;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:Do,type:e.type,key:a,ref:s,props:n,_owner:i}};tr.createContext=function(e){return e={$$typeof:bw,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Ew,_context:e},e.Consumer=e};tr.createElement=Fx;tr.createFactory=function(e){var t=Fx.bind(null,e);return t.type=e,t};tr.createRef=function(){return{current:null}};tr.forwardRef=function(e){return{$$typeof:Cw,render:e}};tr.isValidElement=ad;tr.lazy=function(e){return{$$typeof:Aw,_payload:{_status:-1,_result:e},_init:Rw}};tr.memo=function(e,t){return{$$typeof:Nw,type:e,compare:t===void 0?null:t}};tr.startTransition=function(e){var t=Rc.transition;Rc.transition={};try{e()}finally{Rc.transition=t}};tr.unstable_act=Mx;tr.useCallback=function(e,t){return Un.current.useCallback(e,t)};tr.useContext=function(e){return Un.current.useContext(e)};tr.useDebugValue=function(){};tr.useDeferredValue=function(e){return Un.current.useDeferredValue(e)};tr.useEffect=function(e,t){return Un.current.useEffect(e,t)};tr.useId=function(){return Un.current.useId()};tr.useImperativeHandle=function(e,t,r){return Un.current.useImperativeHandle(e,t,r)};tr.useInsertionEffect=function(e,t){return Un.current.useInsertionEffect(e,t)};tr.useLayoutEffect=function(e,t){return Un.current.useLayoutEffect(e,t)};tr.useMemo=function(e,t){return Un.current.useMemo(e,t)};tr.useReducer=function(e,t,r){return Un.current.useReducer(e,t,r)};tr.useRef=function(e){return Un.current.useRef(e)};tr.useState=function(e){return Un.current.useState(e)};tr.useSyncExternalStore=function(e,t,r){return Un.current.useSyncExternalStore(e,t,r)};tr.useTransition=function(){return Un.current.useTransition()};tr.version="18.3.1";Ex.exports=tr;var k=Ex.exports;const Rx=ed(k);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zw=k,Lw=Symbol.for("react.element"),Ow=Symbol.for("react.fragment"),Pw=Object.prototype.hasOwnProperty,Dw=zw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Bw={key:!0,ref:!0,__self:!0,__source:!0};function Ix(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)Pw.call(t,n)&&!Bw.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Lw,type:e,key:s,ref:i,props:a,_owner:Dw.current}}Au.Fragment=Ow;Au.jsx=Ix;Au.jsxs=Ix;Sx.exports=Au;var c=Sx.exports,zx={exports:{}},ua={},Lx={exports:{}},Ox={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ee,F){var le=ee.length;ee.push(F);e:for(;0<le;){var re=le-1>>>1,j=ee[re];if(0<a(j,F))ee[re]=F,ee[le]=j,le=re;else break e}}function r(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var F=ee[0],le=ee.pop();if(le!==F){ee[0]=le;e:for(var re=0,j=ee.length,R=j>>>1;re<R;){var B=2*(re+1)-1,V=ee[B],te=B+1,ke=ee[te];if(0>a(V,le))te<j&&0>a(ke,V)?(ee[re]=ke,ee[te]=le,re=te):(ee[re]=V,ee[B]=le,re=B);else if(te<j&&0>a(ke,le))ee[re]=ke,ee[te]=le,re=te;else break e}}return F}function a(ee,F){var le=ee.sortIndex-F.sortIndex;return le!==0?le:ee.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var o=[],u=[],f=1,d=null,p=3,h=!1,m=!1,x=!1,v=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(ee){for(var F=r(u);F!==null;){if(F.callback===null)n(u);else if(F.startTime<=ee)n(u),F.sortIndex=F.expirationTime,t(o,F);else break;F=r(u)}}function E(ee){if(x=!1,g(ee),!m)if(r(o)!==null)m=!0,Q(A);else{var F=r(u);F!==null&&X(E,F.startTime-ee)}}function A(ee,F){m=!1,x&&(x=!1,y(S),S=-1),h=!0;var le=p;try{for(g(F),d=r(o);d!==null&&(!(d.expirationTime>F)||ee&&!D());){var re=d.callback;if(typeof re=="function"){d.callback=null,p=d.priorityLevel;var j=re(d.expirationTime<=F);F=e.unstable_now(),typeof j=="function"?d.callback=j:d===r(o)&&n(o),g(F)}else n(o);d=r(o)}if(d!==null)var R=!0;else{var B=r(u);B!==null&&X(E,B.startTime-F),R=!1}return R}finally{d=null,p=le,h=!1}}var z=!1,b=null,S=-1,_=5,T=-1;function D(){return!(e.unstable_now()-T<_)}function M(){if(b!==null){var ee=e.unstable_now();T=ee;var F=!0;try{F=b(!0,ee)}finally{F?G():(z=!1,b=null)}}else z=!1}var G;if(typeof w=="function")G=function(){w(M)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,J=Y.port2;Y.port1.onmessage=M,G=function(){J.postMessage(null)}}else G=function(){v(M,0)};function Q(ee){b=ee,z||(z=!0,G())}function X(ee,F){S=v(function(){ee(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_continueExecution=function(){m||h||(m=!0,Q(A))},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(o)},e.unstable_next=function(ee){switch(p){case 1:case 2:case 3:var F=3;break;default:F=p}var le=p;p=F;try{return ee()}finally{p=le}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ee,F){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var le=p;p=ee;try{return F()}finally{p=le}},e.unstable_scheduleCallback=function(ee,F,le){var re=e.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?re+le:re):le=re,ee){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=le+j,ee={id:f++,callback:F,priorityLevel:ee,startTime:le,expirationTime:j,sortIndex:-1},le>re?(ee.sortIndex=le,t(u,ee),r(o)===null&&ee===r(u)&&(x?(y(S),S=-1):x=!0,X(E,le-re))):(ee.sortIndex=j,t(o,ee),m||h||(m=!0,Q(A))),ee},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(ee){var F=p;return function(){var le=p;p=F;try{return ee.apply(this,arguments)}finally{p=le}}}})(Ox);Lx.exports=Ox;var Uw=Lx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $w=k,oa=Uw;function Ke(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Px=new Set,fo={};function wi(e,t){ll(e,t),ll(e+"Capture",t)}function ll(e,t){for(fo[e]=t,e=0;e<t.length;e++)Px.add(t[e])}var us=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),K0=Object.prototype.hasOwnProperty,Ww=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Wh={},Hh={};function Hw(e){return K0.call(Hh,e)?!0:K0.call(Wh,e)?!1:Ww.test(e)?Hh[e]=!0:(Wh[e]=!0,!1)}function Vw(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Gw(e,t,r,n){if(t===null||typeof t>"u"||Vw(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function $n(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var gn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){gn[e]=new $n(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];gn[t]=new $n(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){gn[e]=new $n(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){gn[e]=new $n(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){gn[e]=new $n(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){gn[e]=new $n(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){gn[e]=new $n(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){gn[e]=new $n(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){gn[e]=new $n(e,5,!1,e.toLowerCase(),null,!1,!1)});var sd=/[\-:]([a-z])/g;function id(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(sd,id);gn[t]=new $n(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(sd,id);gn[t]=new $n(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(sd,id);gn[t]=new $n(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){gn[e]=new $n(e,1,!1,e.toLowerCase(),null,!1,!1)});gn.xlinkHref=new $n("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){gn[e]=new $n(e,1,!1,e.toLowerCase(),null,!0,!0)});function ld(e,t,r,n){var a=gn.hasOwnProperty(t)?gn[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Gw(t,r,a,n)&&(r=null),n||a===null?Hw(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ms=$w.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tc=Symbol.for("react.element"),Pi=Symbol.for("react.portal"),Di=Symbol.for("react.fragment"),od=Symbol.for("react.strict_mode"),X0=Symbol.for("react.profiler"),Dx=Symbol.for("react.provider"),Bx=Symbol.for("react.context"),cd=Symbol.for("react.forward_ref"),Y0=Symbol.for("react.suspense"),J0=Symbol.for("react.suspense_list"),ud=Symbol.for("react.memo"),_s=Symbol.for("react.lazy"),Ux=Symbol.for("react.offscreen"),Vh=Symbol.iterator;function Nl(e){return e===null||typeof e!="object"?null:(e=Vh&&e[Vh]||e["@@iterator"],typeof e=="function"?e:null)}var Or=Object.assign,e0;function Dl(e){if(e0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);e0=t&&t[1]||""}return`
`+e0+e}var t0=!1;function r0(e,t){if(!e||t0)return"";t0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,l=s.length-1;1<=i&&0<=l&&a[i]!==s[l];)l--;for(;1<=i&&0<=l;i--,l--)if(a[i]!==s[l]){if(i!==1||l!==1)do if(i--,l--,0>l||a[i]!==s[l]){var o=`
`+a[i].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}while(1<=i&&0<=l);break}}}finally{t0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Dl(e):""}function Kw(e){switch(e.tag){case 5:return Dl(e.type);case 16:return Dl("Lazy");case 13:return Dl("Suspense");case 19:return Dl("SuspenseList");case 0:case 2:case 15:return e=r0(e.type,!1),e;case 11:return e=r0(e.type.render,!1),e;case 1:return e=r0(e.type,!0),e;default:return""}}function Q0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Di:return"Fragment";case Pi:return"Portal";case X0:return"Profiler";case od:return"StrictMode";case Y0:return"Suspense";case J0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Bx:return(e.displayName||"Context")+".Consumer";case Dx:return(e._context.displayName||"Context")+".Provider";case cd:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ud:return t=e.displayName||null,t!==null?t:Q0(e.type)||"Memo";case _s:t=e._payload,e=e._init;try{return Q0(e(t))}catch{}}return null}function Xw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Q0(t);case 8:return t===od?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Us(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function $x(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Yw(e){var t=$x(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function rc(e){e._valueTracker||(e._valueTracker=Yw(e))}function Wx(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=$x(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Vc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Z0(e,t){var r=t.checked;return Or({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Gh(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Us(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Hx(e,t){t=t.checked,t!=null&&ld(e,"checked",t,!1)}function q0(e,t){Hx(e,t);var r=Us(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ef(e,t.type,r):t.hasOwnProperty("defaultValue")&&ef(e,t.type,Us(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Kh(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ef(e,t,r){(t!=="number"||Vc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Bl=Array.isArray;function Qi(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Us(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function tf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ke(91));return Or({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Xh(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ke(92));if(Bl(r)){if(1<r.length)throw Error(Ke(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Us(r)}}function Vx(e,t){var r=Us(t.value),n=Us(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Yh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Gx(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rf(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Gx(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var nc,Kx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(nc=nc||document.createElement("div"),nc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=nc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ho(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Kl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Jw=["Webkit","ms","Moz","O"];Object.keys(Kl).forEach(function(e){Jw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Kl[t]=Kl[e]})});function Xx(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Kl.hasOwnProperty(e)&&Kl[e]?(""+t).trim():t+"px"}function Yx(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Xx(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var Qw=Or({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nf(e,t){if(t){if(Qw[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ke(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ke(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ke(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ke(62))}}function af(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sf=null;function fd(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var lf=null,Zi=null,qi=null;function Jh(e){if(e=$o(e)){if(typeof lf!="function")throw Error(Ke(280));var t=e.stateNode;t&&(t=Iu(t),lf(e.stateNode,e.type,t))}}function Jx(e){Zi?qi?qi.push(e):qi=[e]:Zi=e}function Qx(){if(Zi){var e=Zi,t=qi;if(qi=Zi=null,Jh(e),t)for(e=0;e<t.length;e++)Jh(t[e])}}function Zx(e,t){return e(t)}function qx(){}var n0=!1;function eg(e,t,r){if(n0)return e(t,r);n0=!0;try{return Zx(e,t,r)}finally{n0=!1,(Zi!==null||qi!==null)&&(qx(),Qx())}}function po(e,t){var r=e.stateNode;if(r===null)return null;var n=Iu(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ke(231,t,typeof r));return r}var of=!1;if(us)try{var Al={};Object.defineProperty(Al,"passive",{get:function(){of=!0}}),window.addEventListener("test",Al,Al),window.removeEventListener("test",Al,Al)}catch{of=!1}function Zw(e,t,r,n,a,s,i,l,o){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var Xl=!1,Gc=null,Kc=!1,cf=null,qw={onError:function(e){Xl=!0,Gc=e}};function ek(e,t,r,n,a,s,i,l,o){Xl=!1,Gc=null,Zw.apply(qw,arguments)}function tk(e,t,r,n,a,s,i,l,o){if(ek.apply(this,arguments),Xl){if(Xl){var u=Gc;Xl=!1,Gc=null}else throw Error(Ke(198));Kc||(Kc=!0,cf=u)}}function ki(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function tg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Qh(e){if(ki(e)!==e)throw Error(Ke(188))}function rk(e){var t=e.alternate;if(!t){if(t=ki(e),t===null)throw Error(Ke(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return Qh(a),e;if(s===n)return Qh(a),t;s=s.sibling}throw Error(Ke(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,l=a.child;l;){if(l===r){i=!0,r=a,n=s;break}if(l===n){i=!0,n=a,r=s;break}l=l.sibling}if(!i){for(l=s.child;l;){if(l===r){i=!0,r=s,n=a;break}if(l===n){i=!0,n=s,r=a;break}l=l.sibling}if(!i)throw Error(Ke(189))}}if(r.alternate!==n)throw Error(Ke(190))}if(r.tag!==3)throw Error(Ke(188));return r.stateNode.current===r?e:t}function rg(e){return e=rk(e),e!==null?ng(e):null}function ng(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ng(e);if(t!==null)return t;e=e.sibling}return null}var ag=oa.unstable_scheduleCallback,Zh=oa.unstable_cancelCallback,nk=oa.unstable_shouldYield,ak=oa.unstable_requestPaint,Vr=oa.unstable_now,sk=oa.unstable_getCurrentPriorityLevel,dd=oa.unstable_ImmediatePriority,sg=oa.unstable_UserBlockingPriority,Xc=oa.unstable_NormalPriority,ik=oa.unstable_LowPriority,ig=oa.unstable_IdlePriority,ju=null,Xa=null;function lk(e){if(Xa&&typeof Xa.onCommitFiberRoot=="function")try{Xa.onCommitFiberRoot(ju,e,void 0,(e.current.flags&128)===128)}catch{}}var Oa=Math.clz32?Math.clz32:uk,ok=Math.log,ck=Math.LN2;function uk(e){return e>>>=0,e===0?32:31-(ok(e)/ck|0)|0}var ac=64,sc=4194304;function Ul(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Yc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var l=i&~a;l!==0?n=Ul(l):(s&=i,s!==0&&(n=Ul(s)))}else i=r&~a,i!==0?n=Ul(i):s!==0&&(n=Ul(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Oa(t),a=1<<r,n|=e[r],t&=~a;return n}function fk(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dk(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Oa(s),l=1<<i,o=a[i];o===-1?(!(l&r)||l&n)&&(a[i]=fk(l,t)):o<=t&&(e.expiredLanes|=l),s&=~l}}function uf(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function lg(){var e=ac;return ac<<=1,!(ac&4194240)&&(ac=64),e}function a0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Bo(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Oa(t),e[t]=r}function hk(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Oa(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function hd(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Oa(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var vr=0;function og(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var cg,pd,ug,fg,dg,ff=!1,ic=[],Fs=null,Ms=null,Rs=null,mo=new Map,xo=new Map,Es=[],pk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qh(e,t){switch(e){case"focusin":case"focusout":Fs=null;break;case"dragenter":case"dragleave":Ms=null;break;case"mouseover":case"mouseout":Rs=null;break;case"pointerover":case"pointerout":mo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":xo.delete(t.pointerId)}}function jl(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=$o(t),t!==null&&pd(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function mk(e,t,r,n,a){switch(t){case"focusin":return Fs=jl(Fs,e,t,r,n,a),!0;case"dragenter":return Ms=jl(Ms,e,t,r,n,a),!0;case"mouseover":return Rs=jl(Rs,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return mo.set(s,jl(mo.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,xo.set(s,jl(xo.get(s)||null,e,t,r,n,a)),!0}return!1}function hg(e){var t=ai(e.target);if(t!==null){var r=ki(t);if(r!==null){if(t=r.tag,t===13){if(t=tg(r),t!==null){e.blockedOn=t,dg(e.priority,function(){ug(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ic(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=df(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);sf=n,r.target.dispatchEvent(n),sf=null}else return t=$o(r),t!==null&&pd(t),e.blockedOn=r,!1;t.shift()}return!0}function ep(e,t,r){Ic(e)&&r.delete(t)}function xk(){ff=!1,Fs!==null&&Ic(Fs)&&(Fs=null),Ms!==null&&Ic(Ms)&&(Ms=null),Rs!==null&&Ic(Rs)&&(Rs=null),mo.forEach(ep),xo.forEach(ep)}function Fl(e,t){e.blockedOn===t&&(e.blockedOn=null,ff||(ff=!0,oa.unstable_scheduleCallback(oa.unstable_NormalPriority,xk)))}function go(e){function t(a){return Fl(a,e)}if(0<ic.length){Fl(ic[0],e);for(var r=1;r<ic.length;r++){var n=ic[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Fs!==null&&Fl(Fs,e),Ms!==null&&Fl(Ms,e),Rs!==null&&Fl(Rs,e),mo.forEach(t),xo.forEach(t),r=0;r<Es.length;r++)n=Es[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Es.length&&(r=Es[0],r.blockedOn===null);)hg(r),r.blockedOn===null&&Es.shift()}var el=ms.ReactCurrentBatchConfig,Jc=!0;function gk(e,t,r,n){var a=vr,s=el.transition;el.transition=null;try{vr=1,md(e,t,r,n)}finally{vr=a,el.transition=s}}function vk(e,t,r,n){var a=vr,s=el.transition;el.transition=null;try{vr=4,md(e,t,r,n)}finally{vr=a,el.transition=s}}function md(e,t,r,n){if(Jc){var a=df(e,t,r,n);if(a===null)p0(e,t,n,Qc,r),qh(e,n);else if(mk(a,e,t,r,n))n.stopPropagation();else if(qh(e,n),t&4&&-1<pk.indexOf(e)){for(;a!==null;){var s=$o(a);if(s!==null&&cg(s),s=df(e,t,r,n),s===null&&p0(e,t,n,Qc,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else p0(e,t,n,null,r)}}var Qc=null;function df(e,t,r,n){if(Qc=null,e=fd(n),e=ai(e),e!==null)if(t=ki(e),t===null)e=null;else if(r=t.tag,r===13){if(e=tg(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qc=e,null}function pg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sk()){case dd:return 1;case sg:return 4;case Xc:case ik:return 16;case ig:return 536870912;default:return 16}default:return 16}}var Ts=null,xd=null,zc=null;function mg(){if(zc)return zc;var e,t=xd,r=t.length,n,a="value"in Ts?Ts.value:Ts.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return zc=a.slice(e,1<n?1-n:void 0)}function Lc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function lc(){return!0}function tp(){return!1}function fa(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?lc:tp,this.isPropagationStopped=tp,this}return Or(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=lc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=lc)},persist:function(){},isPersistent:lc}),t}var kl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gd=fa(kl),Uo=Or({},kl,{view:0,detail:0}),yk=fa(Uo),s0,i0,Ml,Fu=Or({},Uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ml&&(Ml&&e.type==="mousemove"?(s0=e.screenX-Ml.screenX,i0=e.screenY-Ml.screenY):i0=s0=0,Ml=e),s0)},movementY:function(e){return"movementY"in e?e.movementY:i0}}),rp=fa(Fu),wk=Or({},Fu,{dataTransfer:0}),kk=fa(wk),_k=Or({},Uo,{relatedTarget:0}),l0=fa(_k),Sk=Or({},kl,{animationName:0,elapsedTime:0,pseudoElement:0}),Ek=fa(Sk),bk=Or({},kl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ck=fa(bk),Tk=Or({},kl,{data:0}),np=fa(Tk),Nk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ak={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Fk(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=jk[e])?!!t[e]:!1}function vd(){return Fk}var Mk=Or({},Uo,{key:function(e){if(e.key){var t=Nk[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Lc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Ak[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vd,charCode:function(e){return e.type==="keypress"?Lc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Lc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rk=fa(Mk),Ik=Or({},Fu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ap=fa(Ik),zk=Or({},Uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vd}),Lk=fa(zk),Ok=Or({},kl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pk=fa(Ok),Dk=Or({},Fu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Bk=fa(Dk),Uk=[9,13,27,32],yd=us&&"CompositionEvent"in window,Yl=null;us&&"documentMode"in document&&(Yl=document.documentMode);var $k=us&&"TextEvent"in window&&!Yl,xg=us&&(!yd||Yl&&8<Yl&&11>=Yl),sp=" ",ip=!1;function gg(e,t){switch(e){case"keyup":return Uk.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Bi=!1;function Wk(e,t){switch(e){case"compositionend":return vg(t);case"keypress":return t.which!==32?null:(ip=!0,sp);case"textInput":return e=t.data,e===sp&&ip?null:e;default:return null}}function Hk(e,t){if(Bi)return e==="compositionend"||!yd&&gg(e,t)?(e=mg(),zc=xd=Ts=null,Bi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return xg&&t.locale!=="ko"?null:t.data;default:return null}}var Vk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Vk[e.type]:t==="textarea"}function yg(e,t,r,n){Jx(n),t=Zc(t,"onChange"),0<t.length&&(r=new gd("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Jl=null,vo=null;function Gk(e){jg(e,0)}function Mu(e){var t=Wi(e);if(Wx(t))return e}function Kk(e,t){if(e==="change")return t}var wg=!1;if(us){var o0;if(us){var c0="oninput"in document;if(!c0){var op=document.createElement("div");op.setAttribute("oninput","return;"),c0=typeof op.oninput=="function"}o0=c0}else o0=!1;wg=o0&&(!document.documentMode||9<document.documentMode)}function cp(){Jl&&(Jl.detachEvent("onpropertychange",kg),vo=Jl=null)}function kg(e){if(e.propertyName==="value"&&Mu(vo)){var t=[];yg(t,vo,e,fd(e)),eg(Gk,t)}}function Xk(e,t,r){e==="focusin"?(cp(),Jl=t,vo=r,Jl.attachEvent("onpropertychange",kg)):e==="focusout"&&cp()}function Yk(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Mu(vo)}function Jk(e,t){if(e==="click")return Mu(t)}function Qk(e,t){if(e==="input"||e==="change")return Mu(t)}function Zk(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ba=typeof Object.is=="function"?Object.is:Zk;function yo(e,t){if(Ba(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!K0.call(t,a)||!Ba(e[a],t[a]))return!1}return!0}function up(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fp(e,t){var r=up(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=up(r)}}function _g(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?_g(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Sg(){for(var e=window,t=Vc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Vc(e.document)}return t}function wd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function qk(e){var t=Sg(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&_g(r.ownerDocument.documentElement,r)){if(n!==null&&wd(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=fp(r,s);var i=fp(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var e2=us&&"documentMode"in document&&11>=document.documentMode,Ui=null,hf=null,Ql=null,pf=!1;function dp(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;pf||Ui==null||Ui!==Vc(n)||(n=Ui,"selectionStart"in n&&wd(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ql&&yo(Ql,n)||(Ql=n,n=Zc(hf,"onSelect"),0<n.length&&(t=new gd("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ui)))}function oc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var $i={animationend:oc("Animation","AnimationEnd"),animationiteration:oc("Animation","AnimationIteration"),animationstart:oc("Animation","AnimationStart"),transitionend:oc("Transition","TransitionEnd")},u0={},Eg={};us&&(Eg=document.createElement("div").style,"AnimationEvent"in window||(delete $i.animationend.animation,delete $i.animationiteration.animation,delete $i.animationstart.animation),"TransitionEvent"in window||delete $i.transitionend.transition);function Ru(e){if(u0[e])return u0[e];if(!$i[e])return e;var t=$i[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Eg)return u0[e]=t[r];return e}var bg=Ru("animationend"),Cg=Ru("animationiteration"),Tg=Ru("animationstart"),Ng=Ru("transitionend"),Ag=new Map,hp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gs(e,t){Ag.set(e,t),wi(t,[e])}for(var f0=0;f0<hp.length;f0++){var d0=hp[f0],t2=d0.toLowerCase(),r2=d0[0].toUpperCase()+d0.slice(1);Gs(t2,"on"+r2)}Gs(bg,"onAnimationEnd");Gs(Cg,"onAnimationIteration");Gs(Tg,"onAnimationStart");Gs("dblclick","onDoubleClick");Gs("focusin","onFocus");Gs("focusout","onBlur");Gs(Ng,"onTransitionEnd");ll("onMouseEnter",["mouseout","mouseover"]);ll("onMouseLeave",["mouseout","mouseover"]);ll("onPointerEnter",["pointerout","pointerover"]);ll("onPointerLeave",["pointerout","pointerover"]);wi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wi("onBeforeInput",["compositionend","keypress","textInput","paste"]);wi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $l="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),n2=new Set("cancel close invalid load scroll toggle".split(" ").concat($l));function pp(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,tk(n,t,void 0,e),e.currentTarget=null}function jg(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var l=n[i],o=l.instance,u=l.currentTarget;if(l=l.listener,o!==s&&a.isPropagationStopped())break e;pp(a,l,u),s=o}else for(i=0;i<n.length;i++){if(l=n[i],o=l.instance,u=l.currentTarget,l=l.listener,o!==s&&a.isPropagationStopped())break e;pp(a,l,u),s=o}}}if(Kc)throw e=cf,Kc=!1,cf=null,e}function Cr(e,t){var r=t[yf];r===void 0&&(r=t[yf]=new Set);var n=e+"__bubble";r.has(n)||(Fg(t,e,2,!1),r.add(n))}function h0(e,t,r){var n=0;t&&(n|=4),Fg(r,e,n,t)}var cc="_reactListening"+Math.random().toString(36).slice(2);function wo(e){if(!e[cc]){e[cc]=!0,Px.forEach(function(r){r!=="selectionchange"&&(n2.has(r)||h0(r,!1,e),h0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[cc]||(t[cc]=!0,h0("selectionchange",!1,t))}}function Fg(e,t,r,n){switch(pg(t)){case 1:var a=gk;break;case 4:a=vk;break;default:a=md}r=a.bind(null,t,r,e),a=void 0,!of||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function p0(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var o=i.tag;if((o===3||o===4)&&(o=i.stateNode.containerInfo,o===a||o.nodeType===8&&o.parentNode===a))return;i=i.return}for(;l!==null;){if(i=ai(l),i===null)return;if(o=i.tag,o===5||o===6){n=s=i;continue e}l=l.parentNode}}n=n.return}eg(function(){var u=s,f=fd(r),d=[];e:{var p=Ag.get(e);if(p!==void 0){var h=gd,m=e;switch(e){case"keypress":if(Lc(r)===0)break e;case"keydown":case"keyup":h=Rk;break;case"focusin":m="focus",h=l0;break;case"focusout":m="blur",h=l0;break;case"beforeblur":case"afterblur":h=l0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=rp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=kk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=Lk;break;case bg:case Cg:case Tg:h=Ek;break;case Ng:h=Pk;break;case"scroll":h=yk;break;case"wheel":h=Bk;break;case"copy":case"cut":case"paste":h=Ck;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=ap}var x=(t&4)!==0,v=!x&&e==="scroll",y=x?p!==null?p+"Capture":null:p;x=[];for(var w=u,g;w!==null;){g=w;var E=g.stateNode;if(g.tag===5&&E!==null&&(g=E,y!==null&&(E=po(w,y),E!=null&&x.push(ko(w,E,g)))),v)break;w=w.return}0<x.length&&(p=new h(p,m,null,r,f),d.push({event:p,listeners:x}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==sf&&(m=r.relatedTarget||r.fromElement)&&(ai(m)||m[fs]))break e;if((h||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=u,m=m?ai(m):null,m!==null&&(v=ki(m),m!==v||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=u),h!==m)){if(x=rp,E="onMouseLeave",y="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(x=ap,E="onPointerLeave",y="onPointerEnter",w="pointer"),v=h==null?p:Wi(h),g=m==null?p:Wi(m),p=new x(E,w+"leave",h,r,f),p.target=v,p.relatedTarget=g,E=null,ai(f)===u&&(x=new x(y,w+"enter",m,r,f),x.target=g,x.relatedTarget=v,E=x),v=E,h&&m)t:{for(x=h,y=m,w=0,g=x;g;g=Ri(g))w++;for(g=0,E=y;E;E=Ri(E))g++;for(;0<w-g;)x=Ri(x),w--;for(;0<g-w;)y=Ri(y),g--;for(;w--;){if(x===y||y!==null&&x===y.alternate)break t;x=Ri(x),y=Ri(y)}x=null}else x=null;h!==null&&mp(d,p,h,x,!1),m!==null&&v!==null&&mp(d,v,m,x,!0)}}e:{if(p=u?Wi(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var A=Kk;else if(lp(p))if(wg)A=Qk;else{A=Yk;var z=Xk}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(A=Jk);if(A&&(A=A(e,u))){yg(d,A,r,f);break e}z&&z(e,p,u),e==="focusout"&&(z=p._wrapperState)&&z.controlled&&p.type==="number"&&ef(p,"number",p.value)}switch(z=u?Wi(u):window,e){case"focusin":(lp(z)||z.contentEditable==="true")&&(Ui=z,hf=u,Ql=null);break;case"focusout":Ql=hf=Ui=null;break;case"mousedown":pf=!0;break;case"contextmenu":case"mouseup":case"dragend":pf=!1,dp(d,r,f);break;case"selectionchange":if(e2)break;case"keydown":case"keyup":dp(d,r,f)}var b;if(yd)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Bi?gg(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(xg&&r.locale!=="ko"&&(Bi||S!=="onCompositionStart"?S==="onCompositionEnd"&&Bi&&(b=mg()):(Ts=f,xd="value"in Ts?Ts.value:Ts.textContent,Bi=!0)),z=Zc(u,S),0<z.length&&(S=new np(S,e,null,r,f),d.push({event:S,listeners:z}),b?S.data=b:(b=vg(r),b!==null&&(S.data=b)))),(b=$k?Wk(e,r):Hk(e,r))&&(u=Zc(u,"onBeforeInput"),0<u.length&&(f=new np("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:u}),f.data=b))}jg(d,t)})}function ko(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Zc(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=po(e,r),s!=null&&n.unshift(ko(e,s,a)),s=po(e,t),s!=null&&n.push(ko(e,s,a))),e=e.return}return n}function Ri(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function mp(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var l=r,o=l.alternate,u=l.stateNode;if(o!==null&&o===n)break;l.tag===5&&u!==null&&(l=u,a?(o=po(r,s),o!=null&&i.unshift(ko(r,o,l))):a||(o=po(r,s),o!=null&&i.push(ko(r,o,l)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var a2=/\r\n?/g,s2=/\u0000|\uFFFD/g;function xp(e){return(typeof e=="string"?e:""+e).replace(a2,`
`).replace(s2,"")}function uc(e,t,r){if(t=xp(t),xp(e)!==t&&r)throw Error(Ke(425))}function qc(){}var mf=null,xf=null;function gf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var vf=typeof setTimeout=="function"?setTimeout:void 0,i2=typeof clearTimeout=="function"?clearTimeout:void 0,gp=typeof Promise=="function"?Promise:void 0,l2=typeof queueMicrotask=="function"?queueMicrotask:typeof gp<"u"?function(e){return gp.resolve(null).then(e).catch(o2)}:vf;function o2(e){setTimeout(function(){throw e})}function m0(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),go(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);go(t)}function Is(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function vp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var _l=Math.random().toString(36).slice(2),Ka="__reactFiber$"+_l,_o="__reactProps$"+_l,fs="__reactContainer$"+_l,yf="__reactEvents$"+_l,c2="__reactListeners$"+_l,u2="__reactHandles$"+_l;function ai(e){var t=e[Ka];if(t)return t;for(var r=e.parentNode;r;){if(t=r[fs]||r[Ka]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=vp(e);e!==null;){if(r=e[Ka])return r;e=vp(e)}return t}e=r,r=e.parentNode}return null}function $o(e){return e=e[Ka]||e[fs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Wi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ke(33))}function Iu(e){return e[_o]||null}var wf=[],Hi=-1;function Ks(e){return{current:e}}function Tr(e){0>Hi||(e.current=wf[Hi],wf[Hi]=null,Hi--)}function Er(e,t){Hi++,wf[Hi]=e.current,e.current=t}var $s={},jn=Ks($s),Jn=Ks(!1),di=$s;function ol(e,t){var r=e.type.contextTypes;if(!r)return $s;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Qn(e){return e=e.childContextTypes,e!=null}function eu(){Tr(Jn),Tr(jn)}function yp(e,t,r){if(jn.current!==$s)throw Error(Ke(168));Er(jn,t),Er(Jn,r)}function Mg(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Ke(108,Xw(e)||"Unknown",a));return Or({},r,n)}function tu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||$s,di=jn.current,Er(jn,e),Er(Jn,Jn.current),!0}function wp(e,t,r){var n=e.stateNode;if(!n)throw Error(Ke(169));r?(e=Mg(e,t,di),n.__reactInternalMemoizedMergedChildContext=e,Tr(Jn),Tr(jn),Er(jn,e)):Tr(Jn),Er(Jn,r)}var ts=null,zu=!1,x0=!1;function Rg(e){ts===null?ts=[e]:ts.push(e)}function f2(e){zu=!0,Rg(e)}function Xs(){if(!x0&&ts!==null){x0=!0;var e=0,t=vr;try{var r=ts;for(vr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ts=null,zu=!1}catch(a){throw ts!==null&&(ts=ts.slice(e+1)),ag(dd,Xs),a}finally{vr=t,x0=!1}}return null}var Vi=[],Gi=0,ru=null,nu=0,ga=[],va=0,hi=null,ns=1,as="";function ei(e,t){Vi[Gi++]=nu,Vi[Gi++]=ru,ru=e,nu=t}function Ig(e,t,r){ga[va++]=ns,ga[va++]=as,ga[va++]=hi,hi=e;var n=ns;e=as;var a=32-Oa(n)-1;n&=~(1<<a),r+=1;var s=32-Oa(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,ns=1<<32-Oa(t)+a|r<<a|n,as=s+e}else ns=1<<s|r<<a|n,as=e}function kd(e){e.return!==null&&(ei(e,1),Ig(e,1,0))}function _d(e){for(;e===ru;)ru=Vi[--Gi],Vi[Gi]=null,nu=Vi[--Gi],Vi[Gi]=null;for(;e===hi;)hi=ga[--va],ga[va]=null,as=ga[--va],ga[va]=null,ns=ga[--va],ga[va]=null}var la=null,sa=null,Fr=!1,Ma=null;function zg(e,t){var r=ya(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function kp(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,la=e,sa=Is(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,la=e,sa=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=hi!==null?{id:ns,overflow:as}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ya(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,la=e,sa=null,!0):!1;default:return!1}}function kf(e){return(e.mode&1)!==0&&(e.flags&128)===0}function _f(e){if(Fr){var t=sa;if(t){var r=t;if(!kp(e,t)){if(kf(e))throw Error(Ke(418));t=Is(r.nextSibling);var n=la;t&&kp(e,t)?zg(n,r):(e.flags=e.flags&-4097|2,Fr=!1,la=e)}}else{if(kf(e))throw Error(Ke(418));e.flags=e.flags&-4097|2,Fr=!1,la=e}}}function _p(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;la=e}function fc(e){if(e!==la)return!1;if(!Fr)return _p(e),Fr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!gf(e.type,e.memoizedProps)),t&&(t=sa)){if(kf(e))throw Lg(),Error(Ke(418));for(;t;)zg(e,t),t=Is(t.nextSibling)}if(_p(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ke(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){sa=Is(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}sa=null}}else sa=la?Is(e.stateNode.nextSibling):null;return!0}function Lg(){for(var e=sa;e;)e=Is(e.nextSibling)}function cl(){sa=la=null,Fr=!1}function Sd(e){Ma===null?Ma=[e]:Ma.push(e)}var d2=ms.ReactCurrentBatchConfig;function Rl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ke(309));var n=r.stateNode}if(!n)throw Error(Ke(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var l=a.refs;i===null?delete l[s]:l[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(Ke(284));if(!r._owner)throw Error(Ke(290,e))}return e}function dc(e,t){throw e=Object.prototype.toString.call(t),Error(Ke(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Sp(e){var t=e._init;return t(e._payload)}function Og(e){function t(y,w){if(e){var g=y.deletions;g===null?(y.deletions=[w],y.flags|=16):g.push(w)}}function r(y,w){if(!e)return null;for(;w!==null;)t(y,w),w=w.sibling;return null}function n(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function a(y,w){return y=Ps(y,w),y.index=0,y.sibling=null,y}function s(y,w,g){return y.index=g,e?(g=y.alternate,g!==null?(g=g.index,g<w?(y.flags|=2,w):g):(y.flags|=2,w)):(y.flags|=1048576,w)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function l(y,w,g,E){return w===null||w.tag!==6?(w=S0(g,y.mode,E),w.return=y,w):(w=a(w,g),w.return=y,w)}function o(y,w,g,E){var A=g.type;return A===Di?f(y,w,g.props.children,E,g.key):w!==null&&(w.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===_s&&Sp(A)===w.type)?(E=a(w,g.props),E.ref=Rl(y,w,g),E.return=y,E):(E=Wc(g.type,g.key,g.props,null,y.mode,E),E.ref=Rl(y,w,g),E.return=y,E)}function u(y,w,g,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==g.containerInfo||w.stateNode.implementation!==g.implementation?(w=E0(g,y.mode,E),w.return=y,w):(w=a(w,g.children||[]),w.return=y,w)}function f(y,w,g,E,A){return w===null||w.tag!==7?(w=ci(g,y.mode,E,A),w.return=y,w):(w=a(w,g),w.return=y,w)}function d(y,w,g){if(typeof w=="string"&&w!==""||typeof w=="number")return w=S0(""+w,y.mode,g),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case tc:return g=Wc(w.type,w.key,w.props,null,y.mode,g),g.ref=Rl(y,null,w),g.return=y,g;case Pi:return w=E0(w,y.mode,g),w.return=y,w;case _s:var E=w._init;return d(y,E(w._payload),g)}if(Bl(w)||Nl(w))return w=ci(w,y.mode,g,null),w.return=y,w;dc(y,w)}return null}function p(y,w,g,E){var A=w!==null?w.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return A!==null?null:l(y,w,""+g,E);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case tc:return g.key===A?o(y,w,g,E):null;case Pi:return g.key===A?u(y,w,g,E):null;case _s:return A=g._init,p(y,w,A(g._payload),E)}if(Bl(g)||Nl(g))return A!==null?null:f(y,w,g,E,null);dc(y,g)}return null}function h(y,w,g,E,A){if(typeof E=="string"&&E!==""||typeof E=="number")return y=y.get(g)||null,l(w,y,""+E,A);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case tc:return y=y.get(E.key===null?g:E.key)||null,o(w,y,E,A);case Pi:return y=y.get(E.key===null?g:E.key)||null,u(w,y,E,A);case _s:var z=E._init;return h(y,w,g,z(E._payload),A)}if(Bl(E)||Nl(E))return y=y.get(g)||null,f(w,y,E,A,null);dc(w,E)}return null}function m(y,w,g,E){for(var A=null,z=null,b=w,S=w=0,_=null;b!==null&&S<g.length;S++){b.index>S?(_=b,b=null):_=b.sibling;var T=p(y,b,g[S],E);if(T===null){b===null&&(b=_);break}e&&b&&T.alternate===null&&t(y,b),w=s(T,w,S),z===null?A=T:z.sibling=T,z=T,b=_}if(S===g.length)return r(y,b),Fr&&ei(y,S),A;if(b===null){for(;S<g.length;S++)b=d(y,g[S],E),b!==null&&(w=s(b,w,S),z===null?A=b:z.sibling=b,z=b);return Fr&&ei(y,S),A}for(b=n(y,b);S<g.length;S++)_=h(b,y,S,g[S],E),_!==null&&(e&&_.alternate!==null&&b.delete(_.key===null?S:_.key),w=s(_,w,S),z===null?A=_:z.sibling=_,z=_);return e&&b.forEach(function(D){return t(y,D)}),Fr&&ei(y,S),A}function x(y,w,g,E){var A=Nl(g);if(typeof A!="function")throw Error(Ke(150));if(g=A.call(g),g==null)throw Error(Ke(151));for(var z=A=null,b=w,S=w=0,_=null,T=g.next();b!==null&&!T.done;S++,T=g.next()){b.index>S?(_=b,b=null):_=b.sibling;var D=p(y,b,T.value,E);if(D===null){b===null&&(b=_);break}e&&b&&D.alternate===null&&t(y,b),w=s(D,w,S),z===null?A=D:z.sibling=D,z=D,b=_}if(T.done)return r(y,b),Fr&&ei(y,S),A;if(b===null){for(;!T.done;S++,T=g.next())T=d(y,T.value,E),T!==null&&(w=s(T,w,S),z===null?A=T:z.sibling=T,z=T);return Fr&&ei(y,S),A}for(b=n(y,b);!T.done;S++,T=g.next())T=h(b,y,S,T.value,E),T!==null&&(e&&T.alternate!==null&&b.delete(T.key===null?S:T.key),w=s(T,w,S),z===null?A=T:z.sibling=T,z=T);return e&&b.forEach(function(M){return t(y,M)}),Fr&&ei(y,S),A}function v(y,w,g,E){if(typeof g=="object"&&g!==null&&g.type===Di&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case tc:e:{for(var A=g.key,z=w;z!==null;){if(z.key===A){if(A=g.type,A===Di){if(z.tag===7){r(y,z.sibling),w=a(z,g.props.children),w.return=y,y=w;break e}}else if(z.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===_s&&Sp(A)===z.type){r(y,z.sibling),w=a(z,g.props),w.ref=Rl(y,z,g),w.return=y,y=w;break e}r(y,z);break}else t(y,z);z=z.sibling}g.type===Di?(w=ci(g.props.children,y.mode,E,g.key),w.return=y,y=w):(E=Wc(g.type,g.key,g.props,null,y.mode,E),E.ref=Rl(y,w,g),E.return=y,y=E)}return i(y);case Pi:e:{for(z=g.key;w!==null;){if(w.key===z)if(w.tag===4&&w.stateNode.containerInfo===g.containerInfo&&w.stateNode.implementation===g.implementation){r(y,w.sibling),w=a(w,g.children||[]),w.return=y,y=w;break e}else{r(y,w);break}else t(y,w);w=w.sibling}w=E0(g,y.mode,E),w.return=y,y=w}return i(y);case _s:return z=g._init,v(y,w,z(g._payload),E)}if(Bl(g))return m(y,w,g,E);if(Nl(g))return x(y,w,g,E);dc(y,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,w!==null&&w.tag===6?(r(y,w.sibling),w=a(w,g),w.return=y,y=w):(r(y,w),w=S0(g,y.mode,E),w.return=y,y=w),i(y)):r(y,w)}return v}var ul=Og(!0),Pg=Og(!1),au=Ks(null),su=null,Ki=null,Ed=null;function bd(){Ed=Ki=su=null}function Cd(e){var t=au.current;Tr(au),e._currentValue=t}function Sf(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function tl(e,t){su=e,Ed=Ki=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Yn=!0),e.firstContext=null)}function ka(e){var t=e._currentValue;if(Ed!==e)if(e={context:e,memoizedValue:t,next:null},Ki===null){if(su===null)throw Error(Ke(308));Ki=e,su.dependencies={lanes:0,firstContext:e}}else Ki=Ki.next=e;return t}var si=null;function Td(e){si===null?si=[e]:si.push(e)}function Dg(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Td(t)):(r.next=a.next,a.next=r),t.interleaved=r,ds(e,n)}function ds(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ss=!1;function Nd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function is(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zs(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,fr&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ds(e,r)}return a=n.interleaved,a===null?(t.next=t,Td(n)):(t.next=a.next,a.next=t),n.interleaved=t,ds(e,r)}function Oc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,hd(e,r)}}function Ep(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function iu(e,t,r,n){var a=e.updateQueue;Ss=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var o=l,u=o.next;o.next=null,i===null?s=u:i.next=u,i=o;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==i&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=o))}if(s!==null){var d=a.baseState;i=0,f=u=o=null,l=s;do{var p=l.lane,h=l.eventTime;if((n&p)===p){f!==null&&(f=f.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,x=l;switch(p=t,h=r,x.tag){case 1:if(m=x.payload,typeof m=="function"){d=m.call(h,d,p);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=x.payload,p=typeof m=="function"?m.call(h,d,p):m,p==null)break e;d=Or({},d,p);break e;case 2:Ss=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=h,o=d):f=f.next=h,i|=p;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;p=l,l=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(f===null&&(o=d),a.baseState=o,a.firstBaseUpdate=u,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);mi|=i,e.lanes=i,e.memoizedState=d}}function bp(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Ke(191,a));a.call(n)}}}var Wo={},Ya=Ks(Wo),So=Ks(Wo),Eo=Ks(Wo);function ii(e){if(e===Wo)throw Error(Ke(174));return e}function Ad(e,t){switch(Er(Eo,t),Er(So,e),Er(Ya,Wo),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:rf(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=rf(t,e)}Tr(Ya),Er(Ya,t)}function fl(){Tr(Ya),Tr(So),Tr(Eo)}function Ug(e){ii(Eo.current);var t=ii(Ya.current),r=rf(t,e.type);t!==r&&(Er(So,e),Er(Ya,r))}function jd(e){So.current===e&&(Tr(Ya),Tr(So))}var Ir=Ks(0);function lu(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var g0=[];function Fd(){for(var e=0;e<g0.length;e++)g0[e]._workInProgressVersionPrimary=null;g0.length=0}var Pc=ms.ReactCurrentDispatcher,v0=ms.ReactCurrentBatchConfig,pi=0,Lr=null,qr=null,ln=null,ou=!1,Zl=!1,bo=0,h2=0;function kn(){throw Error(Ke(321))}function Md(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ba(e[r],t[r]))return!1;return!0}function Rd(e,t,r,n,a,s){if(pi=s,Lr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Pc.current=e===null||e.memoizedState===null?g2:v2,e=r(n,a),Zl){s=0;do{if(Zl=!1,bo=0,25<=s)throw Error(Ke(301));s+=1,ln=qr=null,t.updateQueue=null,Pc.current=y2,e=r(n,a)}while(Zl)}if(Pc.current=cu,t=qr!==null&&qr.next!==null,pi=0,ln=qr=Lr=null,ou=!1,t)throw Error(Ke(300));return e}function Id(){var e=bo!==0;return bo=0,e}function Va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ln===null?Lr.memoizedState=ln=e:ln=ln.next=e,ln}function _a(){if(qr===null){var e=Lr.alternate;e=e!==null?e.memoizedState:null}else e=qr.next;var t=ln===null?Lr.memoizedState:ln.next;if(t!==null)ln=t,qr=e;else{if(e===null)throw Error(Ke(310));qr=e,e={memoizedState:qr.memoizedState,baseState:qr.baseState,baseQueue:qr.baseQueue,queue:qr.queue,next:null},ln===null?Lr.memoizedState=ln=e:ln=ln.next=e}return ln}function Co(e,t){return typeof t=="function"?t(e):t}function y0(e){var t=_a(),r=t.queue;if(r===null)throw Error(Ke(311));r.lastRenderedReducer=e;var n=qr,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var l=i=null,o=null,u=s;do{var f=u.lane;if((pi&f)===f)o!==null&&(o=o.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};o===null?(l=o=d,i=n):o=o.next=d,Lr.lanes|=f,mi|=f}u=u.next}while(u!==null&&u!==s);o===null?i=n:o.next=l,Ba(n,t.memoizedState)||(Yn=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=o,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,Lr.lanes|=s,mi|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function w0(e){var t=_a(),r=t.queue;if(r===null)throw Error(Ke(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);Ba(s,t.memoizedState)||(Yn=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function $g(){}function Wg(e,t){var r=Lr,n=_a(),a=t(),s=!Ba(n.memoizedState,a);if(s&&(n.memoizedState=a,Yn=!0),n=n.queue,zd(Gg.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||ln!==null&&ln.memoizedState.tag&1){if(r.flags|=2048,To(9,Vg.bind(null,r,n,a,t),void 0,null),on===null)throw Error(Ke(349));pi&30||Hg(r,t,a)}return a}function Hg(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Lr.updateQueue,t===null?(t={lastEffect:null,stores:null},Lr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Vg(e,t,r,n){t.value=r,t.getSnapshot=n,Kg(t)&&Xg(e)}function Gg(e,t,r){return r(function(){Kg(t)&&Xg(e)})}function Kg(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ba(e,r)}catch{return!0}}function Xg(e){var t=ds(e,1);t!==null&&Pa(t,e,1,-1)}function Cp(e){var t=Va();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:e},t.queue=e,e=e.dispatch=x2.bind(null,Lr,e),[t.memoizedState,e]}function To(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Lr.updateQueue,t===null?(t={lastEffect:null,stores:null},Lr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Yg(){return _a().memoizedState}function Dc(e,t,r,n){var a=Va();Lr.flags|=e,a.memoizedState=To(1|t,r,void 0,n===void 0?null:n)}function Lu(e,t,r,n){var a=_a();n=n===void 0?null:n;var s=void 0;if(qr!==null){var i=qr.memoizedState;if(s=i.destroy,n!==null&&Md(n,i.deps)){a.memoizedState=To(t,r,s,n);return}}Lr.flags|=e,a.memoizedState=To(1|t,r,s,n)}function Tp(e,t){return Dc(8390656,8,e,t)}function zd(e,t){return Lu(2048,8,e,t)}function Jg(e,t){return Lu(4,2,e,t)}function Qg(e,t){return Lu(4,4,e,t)}function Zg(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function qg(e,t,r){return r=r!=null?r.concat([e]):null,Lu(4,4,Zg.bind(null,t,e),r)}function Ld(){}function e1(e,t){var r=_a();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Md(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function t1(e,t){var r=_a();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Md(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function r1(e,t,r){return pi&21?(Ba(r,t)||(r=lg(),Lr.lanes|=r,mi|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Yn=!0),e.memoizedState=r)}function p2(e,t){var r=vr;vr=r!==0&&4>r?r:4,e(!0);var n=v0.transition;v0.transition={};try{e(!1),t()}finally{vr=r,v0.transition=n}}function n1(){return _a().memoizedState}function m2(e,t,r){var n=Os(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},a1(e))s1(t,r);else if(r=Dg(e,t,r,n),r!==null){var a=Pn();Pa(r,e,n,a),i1(r,t,n)}}function x2(e,t,r){var n=Os(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(a1(e))s1(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,l=s(i,r);if(a.hasEagerState=!0,a.eagerState=l,Ba(l,i)){var o=t.interleaved;o===null?(a.next=a,Td(t)):(a.next=o.next,o.next=a),t.interleaved=a;return}}catch{}finally{}r=Dg(e,t,a,n),r!==null&&(a=Pn(),Pa(r,e,n,a),i1(r,t,n))}}function a1(e){var t=e.alternate;return e===Lr||t!==null&&t===Lr}function s1(e,t){Zl=ou=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function i1(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,hd(e,r)}}var cu={readContext:ka,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useInsertionEffect:kn,useLayoutEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useMutableSource:kn,useSyncExternalStore:kn,useId:kn,unstable_isNewReconciler:!1},g2={readContext:ka,useCallback:function(e,t){return Va().memoizedState=[e,t===void 0?null:t],e},useContext:ka,useEffect:Tp,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Dc(4194308,4,Zg.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Dc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Dc(4,2,e,t)},useMemo:function(e,t){var r=Va();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Va();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=m2.bind(null,Lr,e),[n.memoizedState,e]},useRef:function(e){var t=Va();return e={current:e},t.memoizedState=e},useState:Cp,useDebugValue:Ld,useDeferredValue:function(e){return Va().memoizedState=e},useTransition:function(){var e=Cp(!1),t=e[0];return e=p2.bind(null,e[1]),Va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Lr,a=Va();if(Fr){if(r===void 0)throw Error(Ke(407));r=r()}else{if(r=t(),on===null)throw Error(Ke(349));pi&30||Hg(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,Tp(Gg.bind(null,n,s,e),[e]),n.flags|=2048,To(9,Vg.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Va(),t=on.identifierPrefix;if(Fr){var r=as,n=ns;r=(n&~(1<<32-Oa(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=bo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=h2++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},v2={readContext:ka,useCallback:e1,useContext:ka,useEffect:zd,useImperativeHandle:qg,useInsertionEffect:Jg,useLayoutEffect:Qg,useMemo:t1,useReducer:y0,useRef:Yg,useState:function(){return y0(Co)},useDebugValue:Ld,useDeferredValue:function(e){var t=_a();return r1(t,qr.memoizedState,e)},useTransition:function(){var e=y0(Co)[0],t=_a().memoizedState;return[e,t]},useMutableSource:$g,useSyncExternalStore:Wg,useId:n1,unstable_isNewReconciler:!1},y2={readContext:ka,useCallback:e1,useContext:ka,useEffect:zd,useImperativeHandle:qg,useInsertionEffect:Jg,useLayoutEffect:Qg,useMemo:t1,useReducer:w0,useRef:Yg,useState:function(){return w0(Co)},useDebugValue:Ld,useDeferredValue:function(e){var t=_a();return qr===null?t.memoizedState=e:r1(t,qr.memoizedState,e)},useTransition:function(){var e=w0(Co)[0],t=_a().memoizedState;return[e,t]},useMutableSource:$g,useSyncExternalStore:Wg,useId:n1,unstable_isNewReconciler:!1};function ja(e,t){if(e&&e.defaultProps){t=Or({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Ef(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Or({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Ou={isMounted:function(e){return(e=e._reactInternals)?ki(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Pn(),a=Os(e),s=is(n,a);s.payload=t,r!=null&&(s.callback=r),t=zs(e,s,a),t!==null&&(Pa(t,e,a,n),Oc(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Pn(),a=Os(e),s=is(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=zs(e,s,a),t!==null&&(Pa(t,e,a,n),Oc(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Pn(),n=Os(e),a=is(r,n);a.tag=2,t!=null&&(a.callback=t),t=zs(e,a,n),t!==null&&(Pa(t,e,n,r),Oc(t,e,n))}};function Np(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!yo(r,n)||!yo(a,s):!0}function l1(e,t,r){var n=!1,a=$s,s=t.contextType;return typeof s=="object"&&s!==null?s=ka(s):(a=Qn(t)?di:jn.current,n=t.contextTypes,s=(n=n!=null)?ol(e,a):$s),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ou,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function Ap(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Ou.enqueueReplaceState(t,t.state,null)}function bf(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Nd(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=ka(s):(s=Qn(t)?di:jn.current,a.context=ol(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Ef(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Ou.enqueueReplaceState(a,a.state,null),iu(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function dl(e,t){try{var r="",n=t;do r+=Kw(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function k0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Cf(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var w2=typeof WeakMap=="function"?WeakMap:Map;function o1(e,t,r){r=is(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){fu||(fu=!0,Lf=n),Cf(e,t)},r}function c1(e,t,r){r=is(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Cf(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Cf(e,t),typeof n!="function"&&(Ls===null?Ls=new Set([this]):Ls.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function jp(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new w2;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=I2.bind(null,e,t,r),t.then(e,e))}function Fp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Mp(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=is(-1,1),t.tag=2,zs(r,t,1))),r.lanes|=1),e)}var k2=ms.ReactCurrentOwner,Yn=!1;function In(e,t,r,n){t.child=e===null?Pg(t,null,r,n):ul(t,e.child,r,n)}function Rp(e,t,r,n,a){r=r.render;var s=t.ref;return tl(t,a),n=Rd(e,t,r,n,s,a),r=Id(),e!==null&&!Yn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,hs(e,t,a)):(Fr&&r&&kd(t),t.flags|=1,In(e,t,n,a),t.child)}function Ip(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!Hd(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,u1(e,t,s,n,a)):(e=Wc(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:yo,r(i,n)&&e.ref===t.ref)return hs(e,t,a)}return t.flags|=1,e=Ps(s,n),e.ref=t.ref,e.return=t,t.child=e}function u1(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(yo(s,n)&&e.ref===t.ref)if(Yn=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Yn=!0);else return t.lanes=e.lanes,hs(e,t,a)}return Tf(e,t,r,n,a)}function f1(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Er(Yi,ra),ra|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Er(Yi,ra),ra|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Er(Yi,ra),ra|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Er(Yi,ra),ra|=n;return In(e,t,a,r),t.child}function d1(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Tf(e,t,r,n,a){var s=Qn(r)?di:jn.current;return s=ol(t,s),tl(t,a),r=Rd(e,t,r,n,s,a),n=Id(),e!==null&&!Yn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,hs(e,t,a)):(Fr&&n&&kd(t),t.flags|=1,In(e,t,r,a),t.child)}function zp(e,t,r,n,a){if(Qn(r)){var s=!0;tu(t)}else s=!1;if(tl(t,a),t.stateNode===null)Bc(e,t),l1(t,r,n),bf(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,l=t.memoizedProps;i.props=l;var o=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=ka(u):(u=Qn(r)?di:jn.current,u=ol(t,u));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==n||o!==u)&&Ap(t,i,n,u),Ss=!1;var p=t.memoizedState;i.state=p,iu(t,n,i,a),o=t.memoizedState,l!==n||p!==o||Jn.current||Ss?(typeof f=="function"&&(Ef(t,r,f,n),o=t.memoizedState),(l=Ss||Np(t,r,l,n,p,o,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=o),i.props=n,i.state=o,i.context=u,n=l):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Bg(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:ja(t.type,l),i.props=u,d=t.pendingProps,p=i.context,o=r.contextType,typeof o=="object"&&o!==null?o=ka(o):(o=Qn(r)?di:jn.current,o=ol(t,o));var h=r.getDerivedStateFromProps;(f=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==d||p!==o)&&Ap(t,i,n,o),Ss=!1,p=t.memoizedState,i.state=p,iu(t,n,i,a);var m=t.memoizedState;l!==d||p!==m||Jn.current||Ss?(typeof h=="function"&&(Ef(t,r,h,n),m=t.memoizedState),(u=Ss||Np(t,r,u,n,p,m,o)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,m,o),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,m,o)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),i.props=n,i.state=m,i.context=o,n=u):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return Nf(e,t,r,n,s,a)}function Nf(e,t,r,n,a,s){d1(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&wp(t,r,!1),hs(e,t,s);n=t.stateNode,k2.current=t;var l=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=ul(t,e.child,null,s),t.child=ul(t,null,l,s)):In(e,t,l,s),t.memoizedState=n.state,a&&wp(t,r,!0),t.child}function h1(e){var t=e.stateNode;t.pendingContext?yp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&yp(e,t.context,!1),Ad(e,t.containerInfo)}function Lp(e,t,r,n,a){return cl(),Sd(a),t.flags|=256,In(e,t,r,n),t.child}var Af={dehydrated:null,treeContext:null,retryLane:0};function jf(e){return{baseLanes:e,cachePool:null,transitions:null}}function p1(e,t,r){var n=t.pendingProps,a=Ir.current,s=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Er(Ir,a&1),e===null)return _f(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Bu(i,n,0,null),e=ci(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=jf(r),t.memoizedState=Af,e):Od(t,i));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return _2(e,t,i,n,l,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,l=a.sibling;var o={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=o,t.deletions=null):(n=Ps(a,o),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?s=Ps(l,s):(s=ci(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?jf(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=Af,n}return s=e.child,e=s.sibling,n=Ps(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Od(e,t){return t=Bu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function hc(e,t,r,n){return n!==null&&Sd(n),ul(t,e.child,null,r),e=Od(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function _2(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=k0(Error(Ke(422))),hc(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=Bu({mode:"visible",children:n.children},a,0,null),s=ci(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&ul(t,e.child,null,i),t.child.memoizedState=jf(i),t.memoizedState=Af,s);if(!(t.mode&1))return hc(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Ke(419)),n=k0(s,n,void 0),hc(e,t,i,n)}if(l=(i&e.childLanes)!==0,Yn||l){if(n=on,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,ds(e,a),Pa(n,e,a,-1))}return Wd(),n=k0(Error(Ke(421))),hc(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=z2.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,sa=Is(a.nextSibling),la=t,Fr=!0,Ma=null,e!==null&&(ga[va++]=ns,ga[va++]=as,ga[va++]=hi,ns=e.id,as=e.overflow,hi=t),t=Od(t,n.children),t.flags|=4096,t)}function Op(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Sf(e.return,t,r)}function _0(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function m1(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(In(e,t,n.children,r),n=Ir.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Op(e,r,t);else if(e.tag===19)Op(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Er(Ir,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&lu(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),_0(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&lu(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}_0(t,!0,r,null,s);break;case"together":_0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Bc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function hs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),mi|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ke(153));if(t.child!==null){for(e=t.child,r=Ps(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ps(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function S2(e,t,r){switch(t.tag){case 3:h1(t),cl();break;case 5:Ug(t);break;case 1:Qn(t.type)&&tu(t);break;case 4:Ad(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Er(au,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Er(Ir,Ir.current&1),t.flags|=128,null):r&t.child.childLanes?p1(e,t,r):(Er(Ir,Ir.current&1),e=hs(e,t,r),e!==null?e.sibling:null);Er(Ir,Ir.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return m1(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Er(Ir,Ir.current),n)break;return null;case 22:case 23:return t.lanes=0,f1(e,t,r)}return hs(e,t,r)}var x1,Ff,g1,v1;x1=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ff=function(){};g1=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,ii(Ya.current);var s=null;switch(r){case"input":a=Z0(e,a),n=Z0(e,n),s=[];break;case"select":a=Or({},a,{value:void 0}),n=Or({},n,{value:void 0}),s=[];break;case"textarea":a=tf(e,a),n=tf(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=qc)}nf(r,n);var i;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var l=a[u];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(fo.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var o=n[u];if(l=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&o!==l&&(o!=null||l!=null))if(u==="style")if(l){for(i in l)!l.hasOwnProperty(i)||o&&o.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in o)o.hasOwnProperty(i)&&l[i]!==o[i]&&(r||(r={}),r[i]=o[i])}else r||(s||(s=[]),s.push(u,r)),r=o;else u==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,l=l?l.__html:void 0,o!=null&&l!==o&&(s=s||[]).push(u,o)):u==="children"?typeof o!="string"&&typeof o!="number"||(s=s||[]).push(u,""+o):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(fo.hasOwnProperty(u)?(o!=null&&u==="onScroll"&&Cr("scroll",e),s||l===o||(s=[])):(s=s||[]).push(u,o))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};v1=function(e,t,r,n){r!==n&&(t.flags|=4)};function Il(e,t){if(!Fr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function _n(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function E2(e,t,r){var n=t.pendingProps;switch(_d(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(t),null;case 1:return Qn(t.type)&&eu(),_n(t),null;case 3:return n=t.stateNode,fl(),Tr(Jn),Tr(jn),Fd(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(fc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ma!==null&&(Df(Ma),Ma=null))),Ff(e,t),_n(t),null;case 5:jd(t);var a=ii(Eo.current);if(r=t.type,e!==null&&t.stateNode!=null)g1(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ke(166));return _n(t),null}if(e=ii(Ya.current),fc(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Ka]=t,n[_o]=s,e=(t.mode&1)!==0,r){case"dialog":Cr("cancel",n),Cr("close",n);break;case"iframe":case"object":case"embed":Cr("load",n);break;case"video":case"audio":for(a=0;a<$l.length;a++)Cr($l[a],n);break;case"source":Cr("error",n);break;case"img":case"image":case"link":Cr("error",n),Cr("load",n);break;case"details":Cr("toggle",n);break;case"input":Gh(n,s),Cr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Cr("invalid",n);break;case"textarea":Xh(n,s),Cr("invalid",n)}nf(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var l=s[i];i==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&uc(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&uc(n.textContent,l,e),a=["children",""+l]):fo.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&Cr("scroll",n)}switch(r){case"input":rc(n),Kh(n,s,!0);break;case"textarea":rc(n),Yh(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=qc)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Gx(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Ka]=t,e[_o]=n,x1(e,t,!1,!1),t.stateNode=e;e:{switch(i=af(r,n),r){case"dialog":Cr("cancel",e),Cr("close",e),a=n;break;case"iframe":case"object":case"embed":Cr("load",e),a=n;break;case"video":case"audio":for(a=0;a<$l.length;a++)Cr($l[a],e);a=n;break;case"source":Cr("error",e),a=n;break;case"img":case"image":case"link":Cr("error",e),Cr("load",e),a=n;break;case"details":Cr("toggle",e),a=n;break;case"input":Gh(e,n),a=Z0(e,n),Cr("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Or({},n,{value:void 0}),Cr("invalid",e);break;case"textarea":Xh(e,n),a=tf(e,n),Cr("invalid",e);break;default:a=n}nf(r,a),l=a;for(s in l)if(l.hasOwnProperty(s)){var o=l[s];s==="style"?Yx(e,o):s==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,o!=null&&Kx(e,o)):s==="children"?typeof o=="string"?(r!=="textarea"||o!=="")&&ho(e,o):typeof o=="number"&&ho(e,""+o):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(fo.hasOwnProperty(s)?o!=null&&s==="onScroll"&&Cr("scroll",e):o!=null&&ld(e,s,o,i))}switch(r){case"input":rc(e),Kh(e,n,!1);break;case"textarea":rc(e),Yh(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Us(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Qi(e,!!n.multiple,s,!1):n.defaultValue!=null&&Qi(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=qc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return _n(t),null;case 6:if(e&&t.stateNode!=null)v1(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ke(166));if(r=ii(Eo.current),ii(Ya.current),fc(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ka]=t,(s=n.nodeValue!==r)&&(e=la,e!==null))switch(e.tag){case 3:uc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&uc(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ka]=t,t.stateNode=n}return _n(t),null;case 13:if(Tr(Ir),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Fr&&sa!==null&&t.mode&1&&!(t.flags&128))Lg(),cl(),t.flags|=98560,s=!1;else if(s=fc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Ke(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ke(317));s[Ka]=t}else cl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;_n(t),s=!1}else Ma!==null&&(Df(Ma),Ma=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ir.current&1?en===0&&(en=3):Wd())),t.updateQueue!==null&&(t.flags|=4),_n(t),null);case 4:return fl(),Ff(e,t),e===null&&wo(t.stateNode.containerInfo),_n(t),null;case 10:return Cd(t.type._context),_n(t),null;case 17:return Qn(t.type)&&eu(),_n(t),null;case 19:if(Tr(Ir),s=t.memoizedState,s===null)return _n(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)Il(s,!1);else{if(en!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=lu(e),i!==null){for(t.flags|=128,Il(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Er(Ir,Ir.current&1|2),t.child}e=e.sibling}s.tail!==null&&Vr()>hl&&(t.flags|=128,n=!0,Il(s,!1),t.lanes=4194304)}else{if(!n)if(e=lu(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Il(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!Fr)return _n(t),null}else 2*Vr()-s.renderingStartTime>hl&&r!==1073741824&&(t.flags|=128,n=!0,Il(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Vr(),t.sibling=null,r=Ir.current,Er(Ir,n?r&1|2:r&1),t):(_n(t),null);case 22:case 23:return $d(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ra&1073741824&&(_n(t),t.subtreeFlags&6&&(t.flags|=8192)):_n(t),null;case 24:return null;case 25:return null}throw Error(Ke(156,t.tag))}function b2(e,t){switch(_d(t),t.tag){case 1:return Qn(t.type)&&eu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fl(),Tr(Jn),Tr(jn),Fd(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return jd(t),null;case 13:if(Tr(Ir),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ke(340));cl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Tr(Ir),null;case 4:return fl(),null;case 10:return Cd(t.type._context),null;case 22:case 23:return $d(),null;case 24:return null;default:return null}}var pc=!1,bn=!1,C2=typeof WeakSet=="function"?WeakSet:Set,dt=null;function Xi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Dr(e,t,n)}else r.current=null}function Mf(e,t,r){try{r()}catch(n){Dr(e,t,n)}}var Pp=!1;function T2(e,t){if(mf=Jc,e=Sg(),wd(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,l=-1,o=-1,u=0,f=0,d=e,p=null;t:for(;;){for(var h;d!==r||a!==0&&d.nodeType!==3||(l=i+a),d!==s||n!==0&&d.nodeType!==3||(o=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(h=d.firstChild)!==null;)p=d,d=h;for(;;){if(d===e)break t;if(p===r&&++u===a&&(l=i),p===s&&++f===n&&(o=i),(h=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=h}r=l===-1||o===-1?null:{start:l,end:o}}else r=null}r=r||{start:0,end:0}}else r=null;for(xf={focusedElem:e,selectionRange:r},Jc=!1,dt=t;dt!==null;)if(t=dt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,dt=e;else for(;dt!==null;){t=dt;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var x=m.memoizedProps,v=m.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?x:ja(t.type,x),v);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ke(163))}}catch(E){Dr(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,dt=e;break}dt=t.return}return m=Pp,Pp=!1,m}function ql(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&Mf(t,r,s)}a=a.next}while(a!==n)}}function Pu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Rf(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function y1(e){var t=e.alternate;t!==null&&(e.alternate=null,y1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ka],delete t[_o],delete t[yf],delete t[c2],delete t[u2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function w1(e){return e.tag===5||e.tag===3||e.tag===4}function Dp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||w1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function If(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=qc));else if(n!==4&&(e=e.child,e!==null))for(If(e,t,r),e=e.sibling;e!==null;)If(e,t,r),e=e.sibling}function zf(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(zf(e,t,r),e=e.sibling;e!==null;)zf(e,t,r),e=e.sibling}var dn=null,Fa=!1;function ws(e,t,r){for(r=r.child;r!==null;)k1(e,t,r),r=r.sibling}function k1(e,t,r){if(Xa&&typeof Xa.onCommitFiberUnmount=="function")try{Xa.onCommitFiberUnmount(ju,r)}catch{}switch(r.tag){case 5:bn||Xi(r,t);case 6:var n=dn,a=Fa;dn=null,ws(e,t,r),dn=n,Fa=a,dn!==null&&(Fa?(e=dn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):dn.removeChild(r.stateNode));break;case 18:dn!==null&&(Fa?(e=dn,r=r.stateNode,e.nodeType===8?m0(e.parentNode,r):e.nodeType===1&&m0(e,r),go(e)):m0(dn,r.stateNode));break;case 4:n=dn,a=Fa,dn=r.stateNode.containerInfo,Fa=!0,ws(e,t,r),dn=n,Fa=a;break;case 0:case 11:case 14:case 15:if(!bn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&Mf(r,t,i),a=a.next}while(a!==n)}ws(e,t,r);break;case 1:if(!bn&&(Xi(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Dr(r,t,l)}ws(e,t,r);break;case 21:ws(e,t,r);break;case 22:r.mode&1?(bn=(n=bn)||r.memoizedState!==null,ws(e,t,r),bn=n):ws(e,t,r);break;default:ws(e,t,r)}}function Bp(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new C2),t.forEach(function(n){var a=L2.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function ba(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,l=i;e:for(;l!==null;){switch(l.tag){case 5:dn=l.stateNode,Fa=!1;break e;case 3:dn=l.stateNode.containerInfo,Fa=!0;break e;case 4:dn=l.stateNode.containerInfo,Fa=!0;break e}l=l.return}if(dn===null)throw Error(Ke(160));k1(s,i,a),dn=null,Fa=!1;var o=a.alternate;o!==null&&(o.return=null),a.return=null}catch(u){Dr(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)_1(t,e),t=t.sibling}function _1(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ba(t,e),$a(e),n&4){try{ql(3,e,e.return),Pu(3,e)}catch(x){Dr(e,e.return,x)}try{ql(5,e,e.return)}catch(x){Dr(e,e.return,x)}}break;case 1:ba(t,e),$a(e),n&512&&r!==null&&Xi(r,r.return);break;case 5:if(ba(t,e),$a(e),n&512&&r!==null&&Xi(r,r.return),e.flags&32){var a=e.stateNode;try{ho(a,"")}catch(x){Dr(e,e.return,x)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,l=e.type,o=e.updateQueue;if(e.updateQueue=null,o!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Hx(a,s),af(l,i);var u=af(l,s);for(i=0;i<o.length;i+=2){var f=o[i],d=o[i+1];f==="style"?Yx(a,d):f==="dangerouslySetInnerHTML"?Kx(a,d):f==="children"?ho(a,d):ld(a,f,d,u)}switch(l){case"input":q0(a,s);break;case"textarea":Vx(a,s);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?Qi(a,!!s.multiple,h,!1):p!==!!s.multiple&&(s.defaultValue!=null?Qi(a,!!s.multiple,s.defaultValue,!0):Qi(a,!!s.multiple,s.multiple?[]:"",!1))}a[_o]=s}catch(x){Dr(e,e.return,x)}}break;case 6:if(ba(t,e),$a(e),n&4){if(e.stateNode===null)throw Error(Ke(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(x){Dr(e,e.return,x)}}break;case 3:if(ba(t,e),$a(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{go(t.containerInfo)}catch(x){Dr(e,e.return,x)}break;case 4:ba(t,e),$a(e);break;case 13:ba(t,e),$a(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(Bd=Vr())),n&4&&Bp(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(bn=(u=bn)||f,ba(t,e),bn=u):ba(t,e),$a(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(dt=e,f=e.child;f!==null;){for(d=dt=f;dt!==null;){switch(p=dt,h=p.child,p.tag){case 0:case 11:case 14:case 15:ql(4,p,p.return);break;case 1:Xi(p,p.return);var m=p.stateNode;if(typeof m.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(x){Dr(n,r,x)}}break;case 5:Xi(p,p.return);break;case 22:if(p.memoizedState!==null){$p(d);continue}}h!==null?(h.return=p,dt=h):$p(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=d.stateNode,o=d.memoizedProps.style,i=o!=null&&o.hasOwnProperty("display")?o.display:null,l.style.display=Xx("display",i))}catch(x){Dr(e,e.return,x)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(x){Dr(e,e.return,x)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ba(t,e),$a(e),n&4&&Bp(e);break;case 21:break;default:ba(t,e),$a(e)}}function $a(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(w1(r)){var n=r;break e}r=r.return}throw Error(Ke(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(ho(a,""),n.flags&=-33);var s=Dp(e);zf(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,l=Dp(e);If(e,l,i);break;default:throw Error(Ke(161))}}catch(o){Dr(e,e.return,o)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function N2(e,t,r){dt=e,S1(e)}function S1(e,t,r){for(var n=(e.mode&1)!==0;dt!==null;){var a=dt,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||pc;if(!i){var l=a.alternate,o=l!==null&&l.memoizedState!==null||bn;l=pc;var u=bn;if(pc=i,(bn=o)&&!u)for(dt=a;dt!==null;)i=dt,o=i.child,i.tag===22&&i.memoizedState!==null?Wp(a):o!==null?(o.return=i,dt=o):Wp(a);for(;s!==null;)dt=s,S1(s),s=s.sibling;dt=a,pc=l,bn=u}Up(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,dt=s):Up(e)}}function Up(e){for(;dt!==null;){var t=dt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:bn||Pu(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!bn)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:ja(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&bp(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}bp(t,i,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var o=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&r.focus();break;case"img":o.src&&(r.src=o.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&go(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ke(163))}bn||t.flags&512&&Rf(t)}catch(p){Dr(t,t.return,p)}}if(t===e){dt=null;break}if(r=t.sibling,r!==null){r.return=t.return,dt=r;break}dt=t.return}}function $p(e){for(;dt!==null;){var t=dt;if(t===e){dt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,dt=r;break}dt=t.return}}function Wp(e){for(;dt!==null;){var t=dt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Pu(4,t)}catch(o){Dr(t,r,o)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(o){Dr(t,a,o)}}var s=t.return;try{Rf(t)}catch(o){Dr(t,s,o)}break;case 5:var i=t.return;try{Rf(t)}catch(o){Dr(t,i,o)}}}catch(o){Dr(t,t.return,o)}if(t===e){dt=null;break}var l=t.sibling;if(l!==null){l.return=t.return,dt=l;break}dt=t.return}}var A2=Math.ceil,uu=ms.ReactCurrentDispatcher,Pd=ms.ReactCurrentOwner,wa=ms.ReactCurrentBatchConfig,fr=0,on=null,Jr=null,pn=0,ra=0,Yi=Ks(0),en=0,No=null,mi=0,Du=0,Dd=0,eo=null,Xn=null,Bd=0,hl=1/0,es=null,fu=!1,Lf=null,Ls=null,mc=!1,Ns=null,du=0,to=0,Of=null,Uc=-1,$c=0;function Pn(){return fr&6?Vr():Uc!==-1?Uc:Uc=Vr()}function Os(e){return e.mode&1?fr&2&&pn!==0?pn&-pn:d2.transition!==null?($c===0&&($c=lg()),$c):(e=vr,e!==0||(e=window.event,e=e===void 0?16:pg(e.type)),e):1}function Pa(e,t,r,n){if(50<to)throw to=0,Of=null,Error(Ke(185));Bo(e,r,n),(!(fr&2)||e!==on)&&(e===on&&(!(fr&2)&&(Du|=r),en===4&&bs(e,pn)),Zn(e,n),r===1&&fr===0&&!(t.mode&1)&&(hl=Vr()+500,zu&&Xs()))}function Zn(e,t){var r=e.callbackNode;dk(e,t);var n=Yc(e,e===on?pn:0);if(n===0)r!==null&&Zh(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Zh(r),t===1)e.tag===0?f2(Hp.bind(null,e)):Rg(Hp.bind(null,e)),l2(function(){!(fr&6)&&Xs()}),r=null;else{switch(og(n)){case 1:r=dd;break;case 4:r=sg;break;case 16:r=Xc;break;case 536870912:r=ig;break;default:r=Xc}r=F1(r,E1.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function E1(e,t){if(Uc=-1,$c=0,fr&6)throw Error(Ke(327));var r=e.callbackNode;if(rl()&&e.callbackNode!==r)return null;var n=Yc(e,e===on?pn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=hu(e,n);else{t=n;var a=fr;fr|=2;var s=C1();(on!==e||pn!==t)&&(es=null,hl=Vr()+500,oi(e,t));do try{M2();break}catch(l){b1(e,l)}while(!0);bd(),uu.current=s,fr=a,Jr!==null?t=0:(on=null,pn=0,t=en)}if(t!==0){if(t===2&&(a=uf(e),a!==0&&(n=a,t=Pf(e,a))),t===1)throw r=No,oi(e,0),bs(e,n),Zn(e,Vr()),r;if(t===6)bs(e,n);else{if(a=e.current.alternate,!(n&30)&&!j2(a)&&(t=hu(e,n),t===2&&(s=uf(e),s!==0&&(n=s,t=Pf(e,s))),t===1))throw r=No,oi(e,0),bs(e,n),Zn(e,Vr()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Ke(345));case 2:ti(e,Xn,es);break;case 3:if(bs(e,n),(n&130023424)===n&&(t=Bd+500-Vr(),10<t)){if(Yc(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Pn(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=vf(ti.bind(null,e,Xn,es),t);break}ti(e,Xn,es);break;case 4:if(bs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-Oa(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=Vr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*A2(n/1960))-n,10<n){e.timeoutHandle=vf(ti.bind(null,e,Xn,es),n);break}ti(e,Xn,es);break;case 5:ti(e,Xn,es);break;default:throw Error(Ke(329))}}}return Zn(e,Vr()),e.callbackNode===r?E1.bind(null,e):null}function Pf(e,t){var r=eo;return e.current.memoizedState.isDehydrated&&(oi(e,t).flags|=256),e=hu(e,t),e!==2&&(t=Xn,Xn=r,t!==null&&Df(t)),e}function Df(e){Xn===null?Xn=e:Xn.push.apply(Xn,e)}function j2(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Ba(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function bs(e,t){for(t&=~Dd,t&=~Du,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Oa(t),n=1<<r;e[r]=-1,t&=~n}}function Hp(e){if(fr&6)throw Error(Ke(327));rl();var t=Yc(e,0);if(!(t&1))return Zn(e,Vr()),null;var r=hu(e,t);if(e.tag!==0&&r===2){var n=uf(e);n!==0&&(t=n,r=Pf(e,n))}if(r===1)throw r=No,oi(e,0),bs(e,t),Zn(e,Vr()),r;if(r===6)throw Error(Ke(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ti(e,Xn,es),Zn(e,Vr()),null}function Ud(e,t){var r=fr;fr|=1;try{return e(t)}finally{fr=r,fr===0&&(hl=Vr()+500,zu&&Xs())}}function xi(e){Ns!==null&&Ns.tag===0&&!(fr&6)&&rl();var t=fr;fr|=1;var r=wa.transition,n=vr;try{if(wa.transition=null,vr=1,e)return e()}finally{vr=n,wa.transition=r,fr=t,!(fr&6)&&Xs()}}function $d(){ra=Yi.current,Tr(Yi)}function oi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,i2(r)),Jr!==null)for(r=Jr.return;r!==null;){var n=r;switch(_d(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&eu();break;case 3:fl(),Tr(Jn),Tr(jn),Fd();break;case 5:jd(n);break;case 4:fl();break;case 13:Tr(Ir);break;case 19:Tr(Ir);break;case 10:Cd(n.type._context);break;case 22:case 23:$d()}r=r.return}if(on=e,Jr=e=Ps(e.current,null),pn=ra=t,en=0,No=null,Dd=Du=mi=0,Xn=eo=null,si!==null){for(t=0;t<si.length;t++)if(r=si[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}si=null}return e}function b1(e,t){do{var r=Jr;try{if(bd(),Pc.current=cu,ou){for(var n=Lr.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}ou=!1}if(pi=0,ln=qr=Lr=null,Zl=!1,bo=0,Pd.current=null,r===null||r.return===null){en=1,No=t,Jr=null;break}e:{var s=e,i=r.return,l=r,o=t;if(t=pn,l.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){var u=o,f=l,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var h=Fp(i);if(h!==null){h.flags&=-257,Mp(h,i,l,s,t),h.mode&1&&jp(s,u,t),t=h,o=u;var m=t.updateQueue;if(m===null){var x=new Set;x.add(o),t.updateQueue=x}else m.add(o);break e}else{if(!(t&1)){jp(s,u,t),Wd();break e}o=Error(Ke(426))}}else if(Fr&&l.mode&1){var v=Fp(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Mp(v,i,l,s,t),Sd(dl(o,l));break e}}s=o=dl(o,l),en!==4&&(en=2),eo===null?eo=[s]:eo.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var y=o1(s,o,t);Ep(s,y);break e;case 1:l=o;var w=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Ls===null||!Ls.has(g)))){s.flags|=65536,t&=-t,s.lanes|=t;var E=c1(s,l,t);Ep(s,E);break e}}s=s.return}while(s!==null)}N1(r)}catch(A){t=A,Jr===r&&r!==null&&(Jr=r=r.return);continue}break}while(!0)}function C1(){var e=uu.current;return uu.current=cu,e===null?cu:e}function Wd(){(en===0||en===3||en===2)&&(en=4),on===null||!(mi&268435455)&&!(Du&268435455)||bs(on,pn)}function hu(e,t){var r=fr;fr|=2;var n=C1();(on!==e||pn!==t)&&(es=null,oi(e,t));do try{F2();break}catch(a){b1(e,a)}while(!0);if(bd(),fr=r,uu.current=n,Jr!==null)throw Error(Ke(261));return on=null,pn=0,en}function F2(){for(;Jr!==null;)T1(Jr)}function M2(){for(;Jr!==null&&!nk();)T1(Jr)}function T1(e){var t=j1(e.alternate,e,ra);e.memoizedProps=e.pendingProps,t===null?N1(e):Jr=t,Pd.current=null}function N1(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=b2(r,t),r!==null){r.flags&=32767,Jr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{en=6,Jr=null;return}}else if(r=E2(r,t,ra),r!==null){Jr=r;return}if(t=t.sibling,t!==null){Jr=t;return}Jr=t=e}while(t!==null);en===0&&(en=5)}function ti(e,t,r){var n=vr,a=wa.transition;try{wa.transition=null,vr=1,R2(e,t,r,n)}finally{wa.transition=a,vr=n}return null}function R2(e,t,r,n){do rl();while(Ns!==null);if(fr&6)throw Error(Ke(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ke(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(hk(e,s),e===on&&(Jr=on=null,pn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||mc||(mc=!0,F1(Xc,function(){return rl(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=wa.transition,wa.transition=null;var i=vr;vr=1;var l=fr;fr|=4,Pd.current=null,T2(e,r),_1(r,e),qk(xf),Jc=!!mf,xf=mf=null,e.current=r,N2(r),ak(),fr=l,vr=i,wa.transition=s}else e.current=r;if(mc&&(mc=!1,Ns=e,du=a),s=e.pendingLanes,s===0&&(Ls=null),lk(r.stateNode),Zn(e,Vr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(fu)throw fu=!1,e=Lf,Lf=null,e;return du&1&&e.tag!==0&&rl(),s=e.pendingLanes,s&1?e===Of?to++:(to=0,Of=e):to=0,Xs(),null}function rl(){if(Ns!==null){var e=og(du),t=wa.transition,r=vr;try{if(wa.transition=null,vr=16>e?16:e,Ns===null)var n=!1;else{if(e=Ns,Ns=null,du=0,fr&6)throw Error(Ke(331));var a=fr;for(fr|=4,dt=e.current;dt!==null;){var s=dt,i=s.child;if(dt.flags&16){var l=s.deletions;if(l!==null){for(var o=0;o<l.length;o++){var u=l[o];for(dt=u;dt!==null;){var f=dt;switch(f.tag){case 0:case 11:case 15:ql(8,f,s)}var d=f.child;if(d!==null)d.return=f,dt=d;else for(;dt!==null;){f=dt;var p=f.sibling,h=f.return;if(y1(f),f===u){dt=null;break}if(p!==null){p.return=h,dt=p;break}dt=h}}}var m=s.alternate;if(m!==null){var x=m.child;if(x!==null){m.child=null;do{var v=x.sibling;x.sibling=null,x=v}while(x!==null)}}dt=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,dt=i;else e:for(;dt!==null;){if(s=dt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ql(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,dt=y;break e}dt=s.return}}var w=e.current;for(dt=w;dt!==null;){i=dt;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,dt=g;else e:for(i=w;dt!==null;){if(l=dt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Pu(9,l)}}catch(A){Dr(l,l.return,A)}if(l===i){dt=null;break e}var E=l.sibling;if(E!==null){E.return=l.return,dt=E;break e}dt=l.return}}if(fr=a,Xs(),Xa&&typeof Xa.onPostCommitFiberRoot=="function")try{Xa.onPostCommitFiberRoot(ju,e)}catch{}n=!0}return n}finally{vr=r,wa.transition=t}}return!1}function Vp(e,t,r){t=dl(r,t),t=o1(e,t,1),e=zs(e,t,1),t=Pn(),e!==null&&(Bo(e,1,t),Zn(e,t))}function Dr(e,t,r){if(e.tag===3)Vp(e,e,r);else for(;t!==null;){if(t.tag===3){Vp(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ls===null||!Ls.has(n))){e=dl(r,e),e=c1(t,e,1),t=zs(t,e,1),e=Pn(),t!==null&&(Bo(t,1,e),Zn(t,e));break}}t=t.return}}function I2(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Pn(),e.pingedLanes|=e.suspendedLanes&r,on===e&&(pn&r)===r&&(en===4||en===3&&(pn&130023424)===pn&&500>Vr()-Bd?oi(e,0):Dd|=r),Zn(e,t)}function A1(e,t){t===0&&(e.mode&1?(t=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):t=1);var r=Pn();e=ds(e,t),e!==null&&(Bo(e,t,r),Zn(e,r))}function z2(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),A1(e,r)}function L2(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ke(314))}n!==null&&n.delete(t),A1(e,r)}var j1;j1=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Jn.current)Yn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Yn=!1,S2(e,t,r);Yn=!!(e.flags&131072)}else Yn=!1,Fr&&t.flags&1048576&&Ig(t,nu,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Bc(e,t),e=t.pendingProps;var a=ol(t,jn.current);tl(t,r),a=Rd(null,t,n,e,a,r);var s=Id();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Qn(n)?(s=!0,tu(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Nd(t),a.updater=Ou,t.stateNode=a,a._reactInternals=t,bf(t,n,e,r),t=Nf(null,t,n,!0,s,r)):(t.tag=0,Fr&&s&&kd(t),In(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Bc(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=P2(n),e=ja(n,e),a){case 0:t=Tf(null,t,n,e,r);break e;case 1:t=zp(null,t,n,e,r);break e;case 11:t=Rp(null,t,n,e,r);break e;case 14:t=Ip(null,t,n,ja(n.type,e),r);break e}throw Error(Ke(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ja(n,a),Tf(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ja(n,a),zp(e,t,n,a,r);case 3:e:{if(h1(t),e===null)throw Error(Ke(387));n=t.pendingProps,s=t.memoizedState,a=s.element,Bg(e,t),iu(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=dl(Error(Ke(423)),t),t=Lp(e,t,n,r,a);break e}else if(n!==a){a=dl(Error(Ke(424)),t),t=Lp(e,t,n,r,a);break e}else for(sa=Is(t.stateNode.containerInfo.firstChild),la=t,Fr=!0,Ma=null,r=Pg(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(cl(),n===a){t=hs(e,t,r);break e}In(e,t,n,r)}t=t.child}return t;case 5:return Ug(t),e===null&&_f(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,gf(n,a)?i=null:s!==null&&gf(n,s)&&(t.flags|=32),d1(e,t),In(e,t,i,r),t.child;case 6:return e===null&&_f(t),null;case 13:return p1(e,t,r);case 4:return Ad(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ul(t,null,n,r):In(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ja(n,a),Rp(e,t,n,a,r);case 7:return In(e,t,t.pendingProps,r),t.child;case 8:return In(e,t,t.pendingProps.children,r),t.child;case 12:return In(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,Er(au,n._currentValue),n._currentValue=i,s!==null)if(Ba(s.value,i)){if(s.children===a.children&&!Jn.current){t=hs(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){i=s.child;for(var o=l.firstContext;o!==null;){if(o.context===n){if(s.tag===1){o=is(-1,r&-r),o.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?o.next=o:(o.next=f.next,f.next=o),u.pending=o}}s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Sf(s.return,r,t),l.lanes|=r;break}o=o.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(Ke(341));i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Sf(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}In(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,tl(t,r),a=ka(a),n=n(a),t.flags|=1,In(e,t,n,r),t.child;case 14:return n=t.type,a=ja(n,t.pendingProps),a=ja(n.type,a),Ip(e,t,n,a,r);case 15:return u1(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ja(n,a),Bc(e,t),t.tag=1,Qn(n)?(e=!0,tu(t)):e=!1,tl(t,r),l1(t,n,a),bf(t,n,a,r),Nf(null,t,n,!0,e,r);case 19:return m1(e,t,r);case 22:return f1(e,t,r)}throw Error(Ke(156,t.tag))};function F1(e,t){return ag(e,t)}function O2(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ya(e,t,r,n){return new O2(e,t,r,n)}function Hd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function P2(e){if(typeof e=="function")return Hd(e)?1:0;if(e!=null){if(e=e.$$typeof,e===cd)return 11;if(e===ud)return 14}return 2}function Ps(e,t){var r=e.alternate;return r===null?(r=ya(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Wc(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")Hd(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Di:return ci(r.children,a,s,t);case od:i=8,a|=8;break;case X0:return e=ya(12,r,t,a|2),e.elementType=X0,e.lanes=s,e;case Y0:return e=ya(13,r,t,a),e.elementType=Y0,e.lanes=s,e;case J0:return e=ya(19,r,t,a),e.elementType=J0,e.lanes=s,e;case Ux:return Bu(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Dx:i=10;break e;case Bx:i=9;break e;case cd:i=11;break e;case ud:i=14;break e;case _s:i=16,n=null;break e}throw Error(Ke(130,e==null?e:typeof e,""))}return t=ya(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function ci(e,t,r,n){return e=ya(7,e,n,t),e.lanes=r,e}function Bu(e,t,r,n){return e=ya(22,e,n,t),e.elementType=Ux,e.lanes=r,e.stateNode={isHidden:!1},e}function S0(e,t,r){return e=ya(6,e,null,t),e.lanes=r,e}function E0(e,t,r){return t=ya(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function D2(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=a0(0),this.expirationTimes=a0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=a0(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Vd(e,t,r,n,a,s,i,l,o){return e=new D2(e,t,r,l,o),t===1?(t=1,s===!0&&(t|=8)):t=0,s=ya(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nd(s),e}function B2(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function M1(e){if(!e)return $s;e=e._reactInternals;e:{if(ki(e)!==e||e.tag!==1)throw Error(Ke(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Qn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ke(171))}if(e.tag===1){var r=e.type;if(Qn(r))return Mg(e,r,t)}return t}function R1(e,t,r,n,a,s,i,l,o){return e=Vd(r,n,!0,e,a,s,i,l,o),e.context=M1(null),r=e.current,n=Pn(),a=Os(r),s=is(n,a),s.callback=t??null,zs(r,s,a),e.current.lanes=a,Bo(e,a,n),Zn(e,n),e}function Uu(e,t,r,n){var a=t.current,s=Pn(),i=Os(a);return r=M1(r),t.context===null?t.context=r:t.pendingContext=r,t=is(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=zs(a,t,i),e!==null&&(Pa(e,a,i,s),Oc(e,a,i)),i}function pu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Gp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Gd(e,t){Gp(e,t),(e=e.alternate)&&Gp(e,t)}function U2(){return null}var I1=typeof reportError=="function"?reportError:function(e){console.error(e)};function Kd(e){this._internalRoot=e}$u.prototype.render=Kd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ke(409));Uu(e,t,null,null)};$u.prototype.unmount=Kd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;xi(function(){Uu(null,e,null,null)}),t[fs]=null}};function $u(e){this._internalRoot=e}$u.prototype.unstable_scheduleHydration=function(e){if(e){var t=fg();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Es.length&&t!==0&&t<Es[r].priority;r++);Es.splice(r,0,e),r===0&&hg(e)}};function Xd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Wu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Kp(){}function $2(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=pu(i);s.call(u)}}var i=R1(t,n,e,0,null,!1,!1,"",Kp);return e._reactRootContainer=i,e[fs]=i.current,wo(e.nodeType===8?e.parentNode:e),xi(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var u=pu(o);l.call(u)}}var o=Vd(e,0,!1,null,null,!1,!1,"",Kp);return e._reactRootContainer=o,e[fs]=o.current,wo(e.nodeType===8?e.parentNode:e),xi(function(){Uu(t,o,r,n)}),o}function Hu(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var l=a;a=function(){var o=pu(i);l.call(o)}}Uu(t,i,e,a)}else i=$2(r,t,e,a,n);return pu(i)}cg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ul(t.pendingLanes);r!==0&&(hd(t,r|1),Zn(t,Vr()),!(fr&6)&&(hl=Vr()+500,Xs()))}break;case 13:xi(function(){var n=ds(e,1);if(n!==null){var a=Pn();Pa(n,e,1,a)}}),Gd(e,1)}};pd=function(e){if(e.tag===13){var t=ds(e,134217728);if(t!==null){var r=Pn();Pa(t,e,134217728,r)}Gd(e,134217728)}};ug=function(e){if(e.tag===13){var t=Os(e),r=ds(e,t);if(r!==null){var n=Pn();Pa(r,e,t,n)}Gd(e,t)}};fg=function(){return vr};dg=function(e,t){var r=vr;try{return vr=e,t()}finally{vr=r}};lf=function(e,t,r){switch(t){case"input":if(q0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Iu(n);if(!a)throw Error(Ke(90));Wx(n),q0(n,a)}}}break;case"textarea":Vx(e,r);break;case"select":t=r.value,t!=null&&Qi(e,!!r.multiple,t,!1)}};Zx=Ud;qx=xi;var W2={usingClientEntryPoint:!1,Events:[$o,Wi,Iu,Jx,Qx,Ud]},zl={findFiberByHostInstance:ai,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},H2={bundleType:zl.bundleType,version:zl.version,rendererPackageName:zl.rendererPackageName,rendererConfig:zl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ms.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=rg(e),e===null?null:e.stateNode},findFiberByHostInstance:zl.findFiberByHostInstance||U2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xc.isDisabled&&xc.supportsFiber)try{ju=xc.inject(H2),Xa=xc}catch{}}ua.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W2;ua.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xd(t))throw Error(Ke(200));return B2(e,t,null,r)};ua.createRoot=function(e,t){if(!Xd(e))throw Error(Ke(299));var r=!1,n="",a=I1;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Vd(e,1,!1,null,null,r,!1,n,a),e[fs]=t.current,wo(e.nodeType===8?e.parentNode:e),new Kd(t)};ua.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ke(188)):(e=Object.keys(e).join(","),Error(Ke(268,e)));return e=rg(t),e=e===null?null:e.stateNode,e};ua.flushSync=function(e){return xi(e)};ua.hydrate=function(e,t,r){if(!Wu(t))throw Error(Ke(200));return Hu(null,e,t,!0,r)};ua.hydrateRoot=function(e,t,r){if(!Xd(e))throw Error(Ke(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=I1;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=R1(t,null,e,1,r??null,a,!1,s,i),e[fs]=t.current,wo(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new $u(t)};ua.render=function(e,t,r){if(!Wu(t))throw Error(Ke(200));return Hu(null,e,t,!1,r)};ua.unmountComponentAtNode=function(e){if(!Wu(e))throw Error(Ke(40));return e._reactRootContainer?(xi(function(){Hu(null,null,e,!1,function(){e._reactRootContainer=null,e[fs]=null})}),!0):!1};ua.unstable_batchedUpdates=Ud;ua.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Wu(r))throw Error(Ke(200));if(e==null||e._reactInternals===void 0)throw Error(Ke(38));return Hu(e,t,r,!1,n)};ua.version="18.3.1-next-f1338f8080-20240426";function z1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(z1)}catch(e){console.error(e)}}z1(),zx.exports=ua;var L1=zx.exports,O1,Xp=L1;O1=Xp.createRoot,Xp.hydrateRoot;const V2={},Yp=e=>{let t;const r=new Set,n=(f,d)=>{const p=typeof f=="function"?f(t):f;if(!Object.is(p,t)){const h=t;t=d??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(m=>m(t,h))}},a=()=>t,o={setState:n,getState:a,getInitialState:()=>u,subscribe:f=>(r.add(f),()=>r.delete(f)),destroy:()=>{(V2?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,a,o);return o},G2=e=>e?Yp(e):Yp;var P1={exports:{}},D1={},B1={exports:{}},U1={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pl=k;function K2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var X2=typeof Object.is=="function"?Object.is:K2,Y2=pl.useState,J2=pl.useEffect,Q2=pl.useLayoutEffect,Z2=pl.useDebugValue;function q2(e,t){var r=t(),n=Y2({inst:{value:r,getSnapshot:t}}),a=n[0].inst,s=n[1];return Q2(function(){a.value=r,a.getSnapshot=t,b0(a)&&s({inst:a})},[e,r,t]),J2(function(){return b0(a)&&s({inst:a}),e(function(){b0(a)&&s({inst:a})})},[e]),Z2(r),r}function b0(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!X2(e,r)}catch{return!0}}function e_(e,t){return t()}var t_=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?e_:q2;U1.useSyncExternalStore=pl.useSyncExternalStore!==void 0?pl.useSyncExternalStore:t_;B1.exports=U1;var r_=B1.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vu=k,n_=r_;function a_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var s_=typeof Object.is=="function"?Object.is:a_,i_=n_.useSyncExternalStore,l_=Vu.useRef,o_=Vu.useEffect,c_=Vu.useMemo,u_=Vu.useDebugValue;D1.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var s=l_(null);if(s.current===null){var i={hasValue:!1,value:null};s.current=i}else i=s.current;s=c_(function(){function o(h){if(!u){if(u=!0,f=h,h=n(h),a!==void 0&&i.hasValue){var m=i.value;if(a(m,h))return d=m}return d=h}if(m=d,s_(f,h))return m;var x=n(h);return a!==void 0&&a(m,x)?(f=h,m):(f=h,d=x)}var u=!1,f,d,p=r===void 0?null:r;return[function(){return o(t())},p===null?void 0:function(){return o(p())}]},[t,r,n,a]);var l=i_(e,s[0],s[1]);return o_(function(){i.hasValue=!0,i.value=l},[l]),u_(l),l};P1.exports=D1;var f_=P1.exports;const d_=ed(f_),$1={},{useDebugValue:h_}=Rx,{useSyncExternalStoreWithSelector:p_}=d_;let Jp=!1;const m_=e=>e;function x_(e,t=m_,r){($1?"production":void 0)!=="production"&&r&&!Jp&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Jp=!0);const n=p_(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return h_(n),n}const g_=e=>{($1?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?G2(e):e,r=(n,a)=>x_(t,n,a);return Object.assign(r,t),r},v_=e=>g_,y_={};function W1(e,t){let r;try{r=e()}catch{return}return{getItem:a=>{var s;const i=o=>o===null?null:JSON.parse(o,void 0),l=(s=r.getItem(a))!=null?s:null;return l instanceof Promise?l.then(i):i(l)},setItem:(a,s)=>r.setItem(a,JSON.stringify(s,void 0)),removeItem:a=>r.removeItem(a)}}const Ao=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(n){return Ao(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Ao(n)(r)}}}},w_=(e,t)=>(r,n,a)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:v=>v,version:0,merge:(v,y)=>({...y,...v}),...t},i=!1;const l=new Set,o=new Set;let u;try{u=s.getStorage()}catch{}if(!u)return e((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),r(...v)},n,a);const f=Ao(s.serialize),d=()=>{const v=s.partialize({...n()});let y;const w=f({state:v,version:s.version}).then(g=>u.setItem(s.name,g)).catch(g=>{y=g});if(y)throw y;return w},p=a.setState;a.setState=(v,y)=>{p(v,y),d()};const h=e((...v)=>{r(...v),d()},n,a);let m;const x=()=>{var v;if(!u)return;i=!1,l.forEach(w=>w(n()));const y=((v=s.onRehydrateStorage)==null?void 0:v.call(s,n()))||void 0;return Ao(u.getItem.bind(u))(s.name).then(w=>{if(w)return s.deserialize(w)}).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==s.version){if(s.migrate)return s.migrate(w.state,w.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return w.state}).then(w=>{var g;return m=s.merge(w,(g=n())!=null?g:h),r(m,!0),d()}).then(()=>{y==null||y(m,void 0),i=!0,o.forEach(w=>w(m))}).catch(w=>{y==null||y(void 0,w)})};return a.persist={setOptions:v=>{s={...s,...v},v.getStorage&&(u=v.getStorage())},clearStorage:()=>{u==null||u.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>i,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(o.add(v),()=>{o.delete(v)})},x(),m||h},k_=(e,t)=>(r,n,a)=>{let s={storage:W1(()=>localStorage),partialize:x=>x,version:0,merge:(x,v)=>({...v,...x}),...t},i=!1;const l=new Set,o=new Set;let u=s.storage;if(!u)return e((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),r(...x)},n,a);const f=()=>{const x=s.partialize({...n()});return u.setItem(s.name,{state:x,version:s.version})},d=a.setState;a.setState=(x,v)=>{d(x,v),f()};const p=e((...x)=>{r(...x),f()},n,a);a.getInitialState=()=>p;let h;const m=()=>{var x,v;if(!u)return;i=!1,l.forEach(w=>{var g;return w((g=n())!=null?g:p)});const y=((v=s.onRehydrateStorage)==null?void 0:v.call(s,(x=n())!=null?x:p))||void 0;return Ao(u.getItem.bind(u))(s.name).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==s.version){if(s.migrate)return[!0,s.migrate(w.state,w.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,w.state];return[!1,void 0]}).then(w=>{var g;const[E,A]=w;if(h=s.merge(A,(g=n())!=null?g:p),r(h,!0),E)return f()}).then(()=>{y==null||y(h,void 0),h=n(),i=!0,o.forEach(w=>w(h))}).catch(w=>{y==null||y(void 0,w)})};return a.persist={setOptions:x=>{s={...s,...x},x.storage&&(u=x.storage)},clearStorage:()=>{u==null||u.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>m(),hasHydrated:()=>i,onHydrate:x=>(l.add(x),()=>{l.delete(x)}),onFinishHydration:x=>(o.add(x),()=>{o.delete(x)})},s.skipHydration||m(),h||p},__=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((y_?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),w_(e,t)):k_(e,t),S_=__;let gc;const E_=new Uint8Array(16);function b_(){if(!gc&&(gc=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!gc))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gc(E_)}const fn=[];for(let e=0;e<256;++e)fn.push((e+256).toString(16).slice(1));function C_(e,t=0){return fn[e[t+0]]+fn[e[t+1]]+fn[e[t+2]]+fn[e[t+3]]+"-"+fn[e[t+4]]+fn[e[t+5]]+"-"+fn[e[t+6]]+fn[e[t+7]]+"-"+fn[e[t+8]]+fn[e[t+9]]+"-"+fn[e[t+10]]+fn[e[t+11]]+fn[e[t+12]]+fn[e[t+13]]+fn[e[t+14]]+fn[e[t+15]]}const T_=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Qp={randomUUID:T_};function ml(e,t,r){if(Qp.randomUUID&&!e)return Qp.randomUUID();e=e||{};const n=e.random||(e.rng||b_)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,C_(n)}function Zp(e,t){const r=e.replace("#",""),n=parseInt(r.slice(0,2),16),a=parseInt(r.slice(2,4),16),s=parseInt(r.slice(4,6),16);return`rgba(${n}, ${a}, ${s}, ${t})`}function Ds(e,t,r){t/=100,r/=100;const n=(1-Math.abs(2*r-1))*t,a=n*(1-Math.abs(e/60%2-1)),s=r-n/2;let i=0,l=0,o=0;0<=e&&e<60?(i=n,l=a):60<=e&&e<120?(i=a,l=n):120<=e&&e<180?(l=n,o=a):180<=e&&e<240?(l=a,o=n):240<=e&&e<300?(i=a,o=n):(i=n,o=a);const u=f=>Math.round((f+s)*255).toString(16).padStart(2,"0");return`#${u(i)}${u(l)}${u(o)}`}function ri(e){const t=e.replace("#",""),r=parseInt(t.slice(0,2),16)/255,n=parseInt(t.slice(2,4),16)/255,a=parseInt(t.slice(4,6),16)/255,s=Math.max(r,n,a),i=Math.min(r,n,a);let l=0,o=0;const u=(s+i)/2,f=s-i;if(f!==0){switch(o=u>.5?f/(2-s-i):f/(s+i),s){case r:l=(n-a)/f+(n<a?6:0);break;case n:l=(a-r)/f+2;break;case a:l=(r-n)/f+4;break}l*=60}return{h:l,s:o*100,l:u*100}}function ls(e,t=0){const r=[];if(e<=0)return r;for(let n=0;n<e;n++){const a=Math.round(360*n/e+t)%360,s=45+Math.random()*35;r.push(Ds(a,s,55))}return r}const Ze=v_()(S_((e,t)=>({sampleLists:{},activeSampleListName:null,language:"en",theme:"light",mappings:{},activeMappingId:null,datasets:{},datasetMapping:{},activeTab:"home",plotsSelectedRunId:null,interactiveAnalysis:null,blankSelections:{},blankCorrectionAssignments:null,curvesSmoothingAssignments:null,curvesSmoothingSmoothed:null,rawDataPointOverrides:{},rawDataSettings:{lowestPointCount:3,removeEarlierPoints:!0,outlierThreshold:.001,outlierWindowMinutes:400,outlierWindowPercent:0},autoRun:{runId:null,mappingId:null,stage:"idle",startedAt:null,error:null},setLanguage:r=>e({language:r}),toggleLanguage:()=>e(r=>({language:r.language==="en"?"pl":"en"})),setTheme:r=>e({theme:r}),toggleTheme:()=>e(r=>({theme:r.theme==="light"?"dark":"light"})),setActiveTab:r=>e({activeTab:r}),setPlotsSelectedRunId:r=>e({plotsSelectedRunId:r}),setInteractiveAnalysis:r=>e({interactiveAnalysis:r}),setBlankCorrectionAssignments:r=>e({blankCorrectionAssignments:r??null}),toggleBlankPoint:(r,n)=>e(a=>{if(!r||!(n!=null&&n.well))return{};const s={...a.blankSelections[r]??{}},i=n.well,l=s[i]?[...s[i]]:[],o=l.findIndex(f=>Math.abs(f.timeSeconds-n.timeSeconds)<1e-9&&Math.abs(f.value-n.value)<1e-9);o>=0?l.splice(o,1):(l.push(n),l.sort((f,d)=>f.timeSeconds-d.timeSeconds)),l.length?s[i]=l:delete s[i];const u={...a.blankSelections};return Object.keys(s).length?u[r]=s:delete u[r],{blankSelections:u}}),setBlankSelectionsForRun:(r,n)=>e(a=>{if(!r)return{};const s={};Object.entries(n??{}).forEach(([l,o])=>{if(!l||!(o!=null&&o.length))return;const u=o.filter(f=>!!(f&&typeof f.well=="string"&&Number.isFinite(f.timeSeconds)&&Number.isFinite(f.value))).map(f=>({...f,sample:f.sample??"",measurementType:f.measurementType??"value"})).sort((f,d)=>f.timeSeconds-d.timeSeconds);u.length&&(s[l]=u)});const i={...a.blankSelections};return Object.keys(s).length?i[r]=s:delete i[r],{blankSelections:i}}),clearBlankPointsForWell:(r,n)=>e(a=>{if(!r||!n)return{};const s=a.blankSelections[r];if(!s||!s[n])return{};const i={...s};delete i[n];const l={...a.blankSelections};return Object.keys(i).length?l[r]=i:delete l[r],{blankSelections:l}}),clearBlankSelections:r=>e(n=>{if(!r||!n.blankSelections[r])return{};const a={...n.blankSelections};return delete a[r],{blankSelections:a}}),setCurvesSmoothingAssignments:r=>e({curvesSmoothingAssignments:r??null}),setCurvesSmoothingSmoothed:r=>e({curvesSmoothingSmoothed:r??null}),setRawDataPointOverride:(r,n,a)=>e(s=>{if(!r||!n)return{};const i={...s.rawDataPointOverrides[r]??{}};return a?i[n]=a:delete i[n],{rawDataPointOverrides:{...s.rawDataPointOverrides,[r]:i}}}),resetRawDataPointOverrides:r=>e(n=>{if(!r||!n.rawDataPointOverrides[r])return{};const a={...n.rawDataPointOverrides};return delete a[r],{rawDataPointOverrides:a}}),setRawDataSettings:r=>e(n=>({rawDataSettings:{...n.rawDataSettings,...r}})),setAutoRun:r=>e(n=>({autoRun:{...n.autoRun??{runId:null,mappingId:null,stage:"idle",startedAt:null,error:null},...r}})),resetAutoRun:()=>e({autoRun:{runId:null,mappingId:null,stage:"idle",startedAt:null,error:null}}),createSampleList:(r,n)=>e(a=>{const s={name:r,createdAt:new Date().toISOString(),items:n};return{sampleLists:{...a.sampleLists,[r]:s},activeSampleListName:r}}),setActiveSampleList:r=>e({activeSampleListName:r}),updateSampleList:(r,n)=>e(a=>{const s=a.sampleLists[r];return s?{sampleLists:{...a.sampleLists,[r]:{...s,items:n}}}:{}}),deleteSampleList:r=>e(n=>{const{[r]:a,...s}=n.sampleLists,i=n.activeSampleListName===r?null:n.activeSampleListName;return{sampleLists:s,activeSampleListName:i}}),createMapping:(r,n)=>{const a=ml(),s=ls(n.length),i=Object.fromEntries(n.map((u,f)=>[u,s[f]])),l=Object.fromEntries(n.map((u,f)=>[u,ri(s[f]).s])),o={id:a,name:r,createdAt:new Date().toISOString(),assignments:{},samples:n,sampleColors:i,sampleSaturations:l};return e(u=>({mappings:{...u.mappings,[a]:o},activeMappingId:a})),a},updateMappingAssignments:(r,n)=>e(a=>{const s=a.mappings[r];return s?{mappings:{...a.mappings,[r]:{...s,assignments:n}}}:{}}),renameMapping:(r,n)=>e(a=>{const s=a.mappings[r];return s?{mappings:{...a.mappings,[r]:{...s,name:n}}}:{}}),setActiveMapping:r=>e({activeMappingId:r}),deleteMapping:r=>e(n=>{const{[r]:a,...s}=n.mappings,i=Object.keys(s),l=n.activeMappingId===r?i.length?i[0]:null:n.activeMappingId;return{mappings:s,activeMappingId:l}}),addDataset:r=>e(n=>({datasets:{...n.datasets,[r.runId]:r}})),removeDataset:r=>e(n=>{const{[r]:a,...s}=n.datasets,{[r]:i,...l}=n.datasetMapping??{};return{datasets:s,datasetMapping:l}}),clearAll:()=>e({sampleLists:{},activeSampleListName:null,mappings:{},activeMappingId:null,datasets:{},datasetMapping:{},blankSelections:{},blankCorrectionAssignments:null,curvesSmoothingAssignments:null,curvesSmoothingSmoothed:null,rawDataPointOverrides:{}}),setDatasetMapping:(r,n)=>e(a=>({datasetMapping:{...a.datasetMapping??{},[r]:n}})),setDatasetMappings:r=>e(n=>({datasetMapping:{...n.datasetMapping??{},...r}})),upsertDatasets:r=>e(n=>({datasets:{...n.datasets,...Object.fromEntries(r.map(a=>[a.runId,a]))}})),upsertMappings:r=>e(n=>({mappings:{...n.mappings,...Object.fromEntries(r.map(a=>[a.id,a]))}})),setSampleColor:(r,n,a)=>e(s=>{const i=s.mappings[r];if(!i)return{};const l={...i.sampleColors??{},[n]:a},o=ri(a).s,u={...i.sampleSaturations??{},[n]:o};return{mappings:{...s.mappings,[r]:{...i,sampleColors:l,sampleSaturations:u}}}}),setSampleSaturation:(r,n,a)=>e(s=>{var p;const i=s.mappings[r];if(!i)return{};const l=(p=i.sampleColors)==null?void 0:p[n];if(!l)return{};const o=ri(l),u=Ds(o.h,a,o.l),f={...i.sampleColors??{},[n]:u},d={...i.sampleSaturations??{},[n]:a};return{mappings:{...s.mappings,[r]:{...i,sampleColors:f,sampleSaturations:d}}}}),randomizeSampleColors:r=>e(n=>{const a=n.mappings[r];if(!a)return{};const s=ls(a.samples.length,Math.random()*360),i=Object.fromEntries(a.samples.map((o,u)=>[o,s[u]])),l=Object.fromEntries(a.samples.map((o,u)=>[o,ri(s[u]).s]));return{mappings:{...n.mappings,[r]:{...a,sampleColors:i,sampleSaturations:l}}}}),setMappingSamples:(r,n)=>e(a=>{const s=a.mappings[r];if(!s)return{};const i=ls(n.length),l=Object.fromEntries(n.map((f,d)=>[f,i[d]])),o=Object.fromEntries(n.map((f,d)=>[f,ri(i[d]).s])),u=Object.fromEntries(Object.entries(s.assignments).filter(([,f])=>n.includes(f)));return{mappings:{...a.mappings,[r]:{...s,samples:n,assignments:u,sampleColors:l,sampleSaturations:o}}}}),duplicateMapping:r=>{const n=t(),a=n.mappings[r];if(!a)return null;const s=ml(),i=new Set(Object.values(n.mappings).map(d=>d.name)),l=a.name.endsWith("_copy")?a.name:`${a.name}_copy`;let o=l,u=2;for(;i.has(o);)o=`${l}${u}`,u+=1;const f={id:s,name:o,createdAt:new Date().toISOString(),assignments:{...a.assignments},samples:[...a.samples],sampleColors:a.sampleColors?{...a.sampleColors}:void 0,sampleSaturations:a.sampleSaturations?{...a.sampleSaturations}:void 0,notes:a.notes};return e(d=>({mappings:{...d.mappings,[s]:f},activeMappingId:s})),s}}),{name:"bgc-webapp-storage",storage:W1(()=>localStorage),partialize:e=>({sampleLists:e.sampleLists,activeSampleListName:e.activeSampleListName,mappings:e.mappings,activeMappingId:e.activeMappingId,datasetMapping:e.datasetMapping,activeTab:e.activeTab,language:e.language,theme:e.theme,plotsSelectedRunId:e.plotsSelectedRunId,interactiveAnalysis:e.interactiveAnalysis,rawDataPointOverrides:e.rawDataPointOverrides,rawDataSettings:e.rawDataSettings})})),N_={en:{eyebrow:null,title:"Bacterial Growth Curves Analyser",subtitle:"While working with growth readers, different labs use varied devices that generate data in multiple file formats. Steps such as blank selection, curve smoothing, and log-phase detection can be done in different ways, and these differences may lead to conflicting conclusions. This program enables preliminary analysis of bacterial growth data from many file formats in line with current literature recommendations. To analyse your data, follow the instructions.",primaryCta:"Start workflow",features:[{id:"platePrep",badge:"01 Import",title:"How to prepare a plate for the reader?",description:"Description coming soon.",articleUrl:null,tone:"sunrise"},{id:"blankChoice",badge:"02 Quality",title:"Which data should be used as blank?",description:"Description coming soon.",articleUrl:null,tone:"sky"},{id:"logPhase",badge:"03 Smoothing",title:"How to determine the log phase and smooth curves?",description:"Description coming soon.",articleUrl:null,tone:"mint"},{id:"bioParams",badge:"04 Parameters",title:"How to calculate biological parameters from growth curves?",description:"Description coming soon.",articleUrl:null,tone:"sunrise"},{id:"literature",badge:"05 Outputs",title:"Literature",description:"Links coming soon.",articleUrl:null,tone:"amber"}]},pl:{eyebrow:null,title:"Analizator krzywych wzrostu",subtitle:`Podczas pracy z czytnikami wzrostu rne laboratoria uywaj rnych urzdze, ktre wytwarzaj dane w rnych formatach plikw. Kolejne kroki analizy np. wyznaczenie blank, wygadzenie wykresw, wyznaczenie fazy logarytmicznej mog by przeprowadzone rnymi sposobami, a rnice w kolejnych krokach postpowania mog doprowadzi do sprzecznych wnioskw. Ten program ma za zadanie umoliwienie wstpnej analizy danych wzrostu bakterii z wielu formatw plikw w sposb zgodny z aktualnymi zaleceniami w literaturze.
Aby przeanalizowa swoje dane podaj za instrukcjami.`,primaryCta:"Uruchom workflow",features:[{id:"platePrep",badge:"01 Import",title:"Jak przygotowa pytk do czytnika?",description:"Opis w przygotowaniu.",articleUrl:null,tone:"sunrise"},{id:"blankChoice",badge:"02 Kontrola",title:"Jakie dane wybra na blank?",description:"Opis w przygotowaniu.",articleUrl:null,tone:"sky"},{id:"logPhase",badge:"03 Wygadzanie",title:"Jak wyznaczy faz logarytmiczn i jak wygadzi krzywe wykresw?",description:"Opis w przygotowaniu.",articleUrl:null,tone:"mint"},{id:"bioParams",badge:"04 Parametry",title:"Jak obliczy biologiczne parametry z krzywych wzrostu?",description:"Opis w przygotowaniu.",articleUrl:null,tone:"sunrise"},{id:"literature",badge:"05 Wyniki",title:"Literatura",description:"Linki w przygotowaniu.",articleUrl:null,tone:"amber"}]}};function A_(){const e=Ze(n=>n.setActiveTab),t=Ze(n=>n.language),r=N_[t];return k.useEffect(()=>{window.scrollTo({top:0,behavior:"auto"})},[]),c.jsx("div",{className:"landing",children:c.jsxs("div",{className:"landing-shell",children:[c.jsxs("div",{className:"hero-panel panel",children:[c.jsxs("div",{className:"hero-content",children:[r.eyebrow&&c.jsx("p",{className:"eyebrow",children:r.eyebrow}),c.jsx("h1",{children:r.title}),c.jsx("p",{className:"hero-subtitle",children:r.subtitle})]}),c.jsx("div",{className:"hero-cta-rail",children:c.jsx("div",{className:"cta-buttons",children:c.jsx("button",{className:"cta-btn primary",onClick:()=>e("samplesMapping"),children:r.primaryCta})})})]}),c.jsx("div",{className:"feature-grid",children:r.features.map((n,a)=>c.jsxs("div",{className:`feature-card panel tone-${n.tone}`,children:[c.jsxs("div",{className:"feature-head",children:[c.jsx("h3",{children:n.title}),c.jsx("p",{children:n.description})]}),c.jsxs("div",{className:"feature-visual","aria-hidden":"true",children:[c.jsx("div",{className:"bars",children:Array.from({length:5}).map((s,i)=>c.jsx("span",{className:"bar",style:{animationDelay:`${(a+i)*.15}s`}},i))}),c.jsxs("div",{className:"sparkline",children:[c.jsx("span",{className:"dot"}),c.jsx("span",{className:"dot"}),c.jsx("span",{className:"dot"})]})]}),c.jsx("button",{className:"cta-inline",onClick:()=>n.articleUrl&&window.open(n.articleUrl,"_blank"),disabled:!n.articleUrl,children:t==="pl"?n.articleUrl?"Przejd do artykuu":"Artyku w przygotowaniu":n.articleUrl?"Open article":"Article coming soon"})]},n.id))})]})})}const H1=["A","B","C","D","E","F","G","H"],V1=[1,2,3,4,5,6,7,8,9,10,11,12],Yd=H1.flatMap(e=>V1.map(t=>`${e}${t}`));function G1(e){return Yd.includes(e.toUpperCase())}function qp(e,t){return`${e}${t}`}var K1={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){((r,n)=>{e.exports=n()})(yw,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},a,s=!n.document&&!!n.postMessage,i=n.IS_PAPA_WORKER||!1,l={},o=0,u={};function f(S){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(_){var T=A(_);T.chunkSize=parseInt(T.chunkSize),_.step||_.chunk||(T.chunkSize=null),this._handle=new x(T),(this._handle.streamer=this)._config=T}).call(this,S),this.parseChunk=function(_,T){var D=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<D){let G=this._config.newline;G||(M=this._config.quoteChar||'"',G=this._handle.guessLineEndings(_,M)),_=[..._.split(G).slice(D)].join(G)}this.isFirstChunk&&b(this._config.beforeFirstChunk)&&(M=this._config.beforeFirstChunk(_))!==void 0&&(_=M),this.isFirstChunk=!1,this._halted=!1;var D=this._partialLine+_,M=(this._partialLine="",this._handle.parse(D,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(_=M.meta.cursor,D=(this._finished||(this._partialLine=D.substring(_-this._baseIndex),this._baseIndex=_),M&&M.data&&(this._rowCount+=M.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),i)n.postMessage({results:M,workerId:u.WORKER_ID,finished:D});else if(b(this._config.chunk)&&!T){if(this._config.chunk(M,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=M=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(M.data),this._completeResults.errors=this._completeResults.errors.concat(M.errors),this._completeResults.meta=M.meta),this._completed||!D||!b(this._config.complete)||M&&M.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),D||M&&M.meta.paused||this._nextChunk(),M}this._halted=!0},this._sendError=function(_){b(this._config.error)?this._config.error(_):i&&this._config.error&&n.postMessage({workerId:u.WORKER_ID,error:_,finished:!1})}}function d(S){var _;(S=S||{}).chunkSize||(S.chunkSize=u.RemoteChunkSize),f.call(this,S),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(T){this._input=T,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(_=new XMLHttpRequest,this._config.withCredentials&&(_.withCredentials=this._config.withCredentials),s||(_.onload=z(this._chunkLoaded,this),_.onerror=z(this._chunkError,this)),_.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var T,D=this._config.downloadRequestHeaders;for(T in D)_.setRequestHeader(T,D[T])}var M;this._config.chunkSize&&(M=this._start+this._config.chunkSize-1,_.setRequestHeader("Range","bytes="+this._start+"-"+M));try{_.send(this._config.downloadRequestBody)}catch(G){this._chunkError(G.message)}s&&_.status===0&&this._chunkError()}},this._chunkLoaded=function(){_.readyState===4&&(_.status<200||400<=_.status?this._chunkError():(this._start+=this._config.chunkSize||_.responseText.length,this._finished=!this._config.chunkSize||this._start>=(T=>(T=T.getResponseHeader("Content-Range"))!==null?parseInt(T.substring(T.lastIndexOf("/")+1)):-1)(_),this.parseChunk(_.responseText)))},this._chunkError=function(T){T=_.statusText||T,this._sendError(new Error(T))}}function p(S){(S=S||{}).chunkSize||(S.chunkSize=u.LocalChunkSize),f.call(this,S);var _,T,D=typeof FileReader<"u";this.stream=function(M){this._input=M,T=M.slice||M.webkitSlice||M.mozSlice,D?((_=new FileReader).onload=z(this._chunkLoaded,this),_.onerror=z(this._chunkError,this)):_=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var M=this._input,G=(this._config.chunkSize&&(G=Math.min(this._start+this._config.chunkSize,this._input.size),M=T.call(M,this._start,G)),_.readAsText(M,this._config.encoding));D||this._chunkLoaded({target:{result:G}})},this._chunkLoaded=function(M){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(M.target.result)},this._chunkError=function(){this._sendError(_.error)}}function h(S){var _;f.call(this,S=S||{}),this.stream=function(T){return _=T,this._nextChunk()},this._nextChunk=function(){var T,D;if(!this._finished)return T=this._config.chunkSize,_=T?(D=_.substring(0,T),_.substring(T)):(D=_,""),this._finished=!_,this.parseChunk(D)}}function m(S){f.call(this,S=S||{});var _=[],T=!0,D=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(M){this._input=M,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){D&&_.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),_.length?this.parseChunk(_.shift()):T=!0},this._streamData=z(function(M){try{_.push(typeof M=="string"?M:M.toString(this._config.encoding)),T&&(T=!1,this._checkIsFinished(),this.parseChunk(_.shift()))}catch(G){this._streamError(G)}},this),this._streamError=z(function(M){this._streamCleanUp(),this._sendError(M)},this),this._streamEnd=z(function(){this._streamCleanUp(),D=!0,this._streamData("")},this),this._streamCleanUp=z(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function x(S){var _,T,D,M,G=Math.pow(2,53),Y=-G,J=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Q=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,X=this,ee=0,F=0,le=!1,re=!1,j=[],R={data:[],errors:[],meta:{}};function B(_e){return S.skipEmptyLines==="greedy"?_e.join("").trim()==="":_e.length===1&&_e[0].length===0}function V(){if(R&&D&&(ke("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),D=!1),S.skipEmptyLines&&(R.data=R.data.filter(function(C){return!B(C)})),te()){let C=function(we,he){b(S.transformHeader)&&(we=S.transformHeader(we,he)),j.push(we)};var Ee=C;if(R)if(Array.isArray(R.data[0])){for(var _e=0;te()&&_e<R.data.length;_e++)R.data[_e].forEach(C);R.data.splice(0,1)}else R.data.forEach(C)}function ge(C,we){for(var he=S.header?{}:[],Ce=0;Ce<C.length;Ce++){var Ae=Ce,be=C[Ce],be=((qe,Ie)=>(ht=>(S.dynamicTypingFunction&&S.dynamicTyping[ht]===void 0&&(S.dynamicTyping[ht]=S.dynamicTypingFunction(ht)),(S.dynamicTyping[ht]||S.dynamicTyping)===!0))(qe)?Ie==="true"||Ie==="TRUE"||Ie!=="false"&&Ie!=="FALSE"&&((ht=>{if(J.test(ht)&&(ht=parseFloat(ht),Y<ht&&ht<G))return 1})(Ie)?parseFloat(Ie):Q.test(Ie)?new Date(Ie):Ie===""?null:Ie):Ie)(Ae=S.header?Ce>=j.length?"__parsed_extra":j[Ce]:Ae,be=S.transform?S.transform(be,Ae):be);Ae==="__parsed_extra"?(he[Ae]=he[Ae]||[],he[Ae].push(be)):he[Ae]=be}return S.header&&(Ce>j.length?ke("FieldMismatch","TooManyFields","Too many fields: expected "+j.length+" fields but parsed "+Ce,F+we):Ce<j.length&&ke("FieldMismatch","TooFewFields","Too few fields: expected "+j.length+" fields but parsed "+Ce,F+we)),he}var ye;R&&(S.header||S.dynamicTyping||S.transform)&&(ye=1,!R.data.length||Array.isArray(R.data[0])?(R.data=R.data.map(ge),ye=R.data.length):R.data=ge(R.data,0),S.header&&R.meta&&(R.meta.fields=j),F+=ye)}function te(){return S.header&&j.length===0}function ke(_e,ge,ye,Ee){_e={type:_e,code:ge,message:ye},Ee!==void 0&&(_e.row=Ee),R.errors.push(_e)}b(S.step)&&(M=S.step,S.step=function(_e){R=_e,te()?V():(V(),R.data.length!==0&&(ee+=_e.data.length,S.preview&&ee>S.preview?T.abort():(R.data=R.data[0],M(R,X))))}),this.parse=function(_e,ge,ye){var Ee=S.quoteChar||'"',Ee=(S.newline||(S.newline=this.guessLineEndings(_e,Ee)),D=!1,S.delimiter?b(S.delimiter)&&(S.delimiter=S.delimiter(_e),R.meta.delimiter=S.delimiter):((Ee=((C,we,he,Ce,Ae)=>{var be,qe,Ie,ht;Ae=Ae||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var yt=0;yt<Ae.length;yt++){for(var Pt,Fe=Ae[yt],vt=0,jt=0,ft=0,kt=(Ie=void 0,new y({comments:Ce,delimiter:Fe,newline:we,preview:10}).parse(C)),Se=0;Se<kt.data.length;Se++)he&&B(kt.data[Se])?ft++:(Pt=kt.data[Se].length,jt+=Pt,Ie===void 0?Ie=Pt:0<Pt&&(vt+=Math.abs(Pt-Ie),Ie=Pt));0<kt.data.length&&(jt/=kt.data.length-ft),(qe===void 0||vt<=qe)&&(ht===void 0||ht<jt)&&1.99<jt&&(qe=vt,be=Fe,ht=jt)}return{successful:!!(S.delimiter=be),bestDelimiter:be}})(_e,S.newline,S.skipEmptyLines,S.comments,S.delimitersToGuess)).successful?S.delimiter=Ee.bestDelimiter:(D=!0,S.delimiter=u.DefaultDelimiter),R.meta.delimiter=S.delimiter),A(S));return S.preview&&S.header&&Ee.preview++,_=_e,T=new y(Ee),R=T.parse(_,ge,ye),V(),le?{meta:{paused:!0}}:R||{meta:{paused:!1}}},this.paused=function(){return le},this.pause=function(){le=!0,T.abort(),_=b(S.chunk)?"":_.substring(T.getCharIndex())},this.resume=function(){X.streamer._halted?(le=!1,X.streamer.parseChunk(_,!0)):setTimeout(X.resume,3)},this.aborted=function(){return re},this.abort=function(){re=!0,T.abort(),R.meta.aborted=!0,b(S.complete)&&S.complete(R),_=""},this.guessLineEndings=function(C,Ee){C=C.substring(0,1048576);var Ee=new RegExp(v(Ee)+"([^]*?)"+v(Ee),"gm"),ye=(C=C.replace(Ee,"")).split("\r"),Ee=C.split(`
`),C=1<Ee.length&&Ee[0].length<ye[0].length;if(ye.length===1||C)return`
`;for(var we=0,he=0;he<ye.length;he++)ye[he][0]===`
`&&we++;return we>=ye.length/2?`\r
`:"\r"}}function v(S){return S.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y(S){var _=(S=S||{}).delimiter,T=S.newline,D=S.comments,M=S.step,G=S.preview,Y=S.fastMode,J=null,Q=!1,X=S.quoteChar==null?'"':S.quoteChar,ee=X;if(S.escapeChar!==void 0&&(ee=S.escapeChar),(typeof _!="string"||-1<u.BAD_DELIMITERS.indexOf(_))&&(_=","),D===_)throw new Error("Comment character same as delimiter");D===!0?D="#":(typeof D!="string"||-1<u.BAD_DELIMITERS.indexOf(D))&&(D=!1),T!==`
`&&T!=="\r"&&T!==`\r
`&&(T=`
`);var F=0,le=!1;this.parse=function(re,j,R){if(typeof re!="string")throw new Error("Input must be a string");var B=re.length,V=_.length,te=T.length,ke=D.length,_e=b(M),ge=[],ye=[],Ee=[],C=F=0;if(!re)return vt();if(Y||Y!==!1&&re.indexOf(X)===-1){for(var we=re.split(T),he=0;he<we.length;he++){if(Ee=we[he],F+=Ee.length,he!==we.length-1)F+=T.length;else if(R)return vt();if(!D||Ee.substring(0,ke)!==D){if(_e){if(ge=[],ht(Ee.split(_)),jt(),le)return vt()}else ht(Ee.split(_));if(G&&G<=he)return ge=ge.slice(0,G),vt(!0)}}return vt()}for(var Ce=re.indexOf(_,F),Ae=re.indexOf(T,F),be=new RegExp(v(ee)+v(X),"g"),qe=re.indexOf(X,F);;)if(re[F]===X)for(qe=F,F++;;){if((qe=re.indexOf(X,qe+1))===-1)return R||ye.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ge.length,index:F}),Pt();if(qe===B-1)return Pt(re.substring(F,qe).replace(be,X));if(X===ee&&re[qe+1]===ee)qe++;else if(X===ee||qe===0||re[qe-1]!==ee){Ce!==-1&&Ce<qe+1&&(Ce=re.indexOf(_,qe+1));var Ie=yt((Ae=Ae!==-1&&Ae<qe+1?re.indexOf(T,qe+1):Ae)===-1?Ce:Math.min(Ce,Ae));if(re.substr(qe+1+Ie,V)===_){Ee.push(re.substring(F,qe).replace(be,X)),re[F=qe+1+Ie+V]!==X&&(qe=re.indexOf(X,F)),Ce=re.indexOf(_,F),Ae=re.indexOf(T,F);break}if(Ie=yt(Ae),re.substring(qe+1+Ie,qe+1+Ie+te)===T){if(Ee.push(re.substring(F,qe).replace(be,X)),Fe(qe+1+Ie+te),Ce=re.indexOf(_,F),qe=re.indexOf(X,F),_e&&(jt(),le))return vt();if(G&&ge.length>=G)return vt(!0);break}ye.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ge.length,index:F}),qe++}}else if(D&&Ee.length===0&&re.substring(F,F+ke)===D){if(Ae===-1)return vt();F=Ae+te,Ae=re.indexOf(T,F),Ce=re.indexOf(_,F)}else if(Ce!==-1&&(Ce<Ae||Ae===-1))Ee.push(re.substring(F,Ce)),F=Ce+V,Ce=re.indexOf(_,F);else{if(Ae===-1)break;if(Ee.push(re.substring(F,Ae)),Fe(Ae+te),_e&&(jt(),le))return vt();if(G&&ge.length>=G)return vt(!0)}return Pt();function ht(ft){ge.push(ft),C=F}function yt(ft){var kt=0;return kt=ft!==-1&&(ft=re.substring(qe+1,ft))&&ft.trim()===""?ft.length:kt}function Pt(ft){return R||(ft===void 0&&(ft=re.substring(F)),Ee.push(ft),F=B,ht(Ee),_e&&jt()),vt()}function Fe(ft){F=ft,ht(Ee),Ee=[],Ae=re.indexOf(T,F)}function vt(ft){if(S.header&&!j&&ge.length&&!Q){var kt=ge[0],Se=Object.create(null),ot=new Set(kt);let Xe=!1;for(let Rt=0;Rt<kt.length;Rt++){let q=kt[Rt];if(Se[q=b(S.transformHeader)?S.transformHeader(q,Rt):q]){let oe,pe=Se[q];for(;oe=q+"_"+pe,pe++,ot.has(oe););ot.add(oe),kt[Rt]=oe,Se[q]++,Xe=!0,(J=J===null?{}:J)[oe]=q}else Se[q]=1,kt[Rt]=q;ot.add(q)}Xe&&console.warn("Duplicate headers found and renamed."),Q=!0}return{data:ge,errors:ye,meta:{delimiter:_,linebreak:T,aborted:le,truncated:!!ft,cursor:C+(j||0),renamedHeaders:J}}}function jt(){M(vt()),ge=[],ye=[]}},this.abort=function(){le=!0},this.getCharIndex=function(){return F}}function w(S){var _=S.data,T=l[_.workerId],D=!1;if(_.error)T.userError(_.error,_.file);else if(_.results&&_.results.data){var M={abort:function(){D=!0,g(_.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:E,resume:E};if(b(T.userStep)){for(var G=0;G<_.results.data.length&&(T.userStep({data:_.results.data[G],errors:_.results.errors,meta:_.results.meta},M),!D);G++);delete _.results}else b(T.userChunk)&&(T.userChunk(_.results,M,_.file),delete _.results)}_.finished&&!D&&g(_.workerId,_.results)}function g(S,_){var T=l[S];b(T.userComplete)&&T.userComplete(_),T.terminate(),delete l[S]}function E(){throw new Error("Not implemented.")}function A(S){if(typeof S!="object"||S===null)return S;var _,T=Array.isArray(S)?[]:{};for(_ in S)T[_]=A(S[_]);return T}function z(S,_){return function(){S.apply(_,arguments)}}function b(S){return typeof S=="function"}return u.parse=function(S,_){var T=(_=_||{}).dynamicTyping||!1;if(b(T)&&(_.dynamicTypingFunction=T,T={}),_.dynamicTyping=T,_.transform=!!b(_.transform)&&_.transform,!_.worker||!u.WORKERS_SUPPORTED)return T=null,u.NODE_STREAM_INPUT,typeof S=="string"?(S=(D=>D.charCodeAt(0)!==65279?D:D.slice(1))(S),T=new(_.download?d:h)(_)):S.readable===!0&&b(S.read)&&b(S.on)?T=new m(_):(n.File&&S instanceof File||S instanceof Object)&&(T=new p(_)),T.stream(S);(T=(()=>{var D;return!!u.WORKERS_SUPPORTED&&(D=(()=>{var M=n.URL||n.webkitURL||null,G=r.toString();return u.BLOB_URL||(u.BLOB_URL=M.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",G,")();"],{type:"text/javascript"})))})(),(D=new n.Worker(D)).onmessage=w,D.id=o++,l[D.id]=D)})()).userStep=_.step,T.userChunk=_.chunk,T.userComplete=_.complete,T.userError=_.error,_.step=b(_.step),_.chunk=b(_.chunk),_.complete=b(_.complete),_.error=b(_.error),delete _.worker,T.postMessage({input:S,config:_,workerId:T.id})},u.unparse=function(S,_){var T=!1,D=!0,M=",",G=`\r
`,Y='"',J=Y+Y,Q=!1,X=null,ee=!1,F=((()=>{if(typeof _=="object"){if(typeof _.delimiter!="string"||u.BAD_DELIMITERS.filter(function(j){return _.delimiter.indexOf(j)!==-1}).length||(M=_.delimiter),typeof _.quotes!="boolean"&&typeof _.quotes!="function"&&!Array.isArray(_.quotes)||(T=_.quotes),typeof _.skipEmptyLines!="boolean"&&typeof _.skipEmptyLines!="string"||(Q=_.skipEmptyLines),typeof _.newline=="string"&&(G=_.newline),typeof _.quoteChar=="string"&&(Y=_.quoteChar),typeof _.header=="boolean"&&(D=_.header),Array.isArray(_.columns)){if(_.columns.length===0)throw new Error("Option columns is empty");X=_.columns}_.escapeChar!==void 0&&(J=_.escapeChar+Y),_.escapeFormulae instanceof RegExp?ee=_.escapeFormulae:typeof _.escapeFormulae=="boolean"&&_.escapeFormulae&&(ee=/^[=+\-@\t\r].*$/)}})(),new RegExp(v(Y),"g"));if(typeof S=="string"&&(S=JSON.parse(S)),Array.isArray(S)){if(!S.length||Array.isArray(S[0]))return le(null,S,Q);if(typeof S[0]=="object")return le(X||Object.keys(S[0]),S,Q)}else if(typeof S=="object")return typeof S.data=="string"&&(S.data=JSON.parse(S.data)),Array.isArray(S.data)&&(S.fields||(S.fields=S.meta&&S.meta.fields||X),S.fields||(S.fields=Array.isArray(S.data[0])?S.fields:typeof S.data[0]=="object"?Object.keys(S.data[0]):[]),Array.isArray(S.data[0])||typeof S.data[0]=="object"||(S.data=[S.data])),le(S.fields||[],S.data||[],Q);throw new Error("Unable to serialize unrecognized input");function le(j,R,B){var V="",te=(typeof j=="string"&&(j=JSON.parse(j)),typeof R=="string"&&(R=JSON.parse(R)),Array.isArray(j)&&0<j.length),ke=!Array.isArray(R[0]);if(te&&D){for(var _e=0;_e<j.length;_e++)0<_e&&(V+=M),V+=re(j[_e],_e);0<R.length&&(V+=G)}for(var ge=0;ge<R.length;ge++){var ye=(te?j:R[ge]).length,Ee=!1,C=te?Object.keys(R[ge]).length===0:R[ge].length===0;if(B&&!te&&(Ee=B==="greedy"?R[ge].join("").trim()==="":R[ge].length===1&&R[ge][0].length===0),B==="greedy"&&te){for(var we=[],he=0;he<ye;he++){var Ce=ke?j[he]:he;we.push(R[ge][Ce])}Ee=we.join("").trim()===""}if(!Ee){for(var Ae=0;Ae<ye;Ae++){0<Ae&&!C&&(V+=M);var be=te&&ke?j[Ae]:Ae;V+=re(R[ge][be],Ae)}ge<R.length-1&&(!B||0<ye&&!C)&&(V+=G)}}return V}function re(j,R){var B,V;return j==null?"":j.constructor===Date?JSON.stringify(j).slice(1,25):(V=!1,ee&&typeof j=="string"&&ee.test(j)&&(j="'"+j,V=!0),B=j.toString().replace(F,J),(V=V||T===!0||typeof T=="function"&&T(j,R)||Array.isArray(T)&&T[R]||((te,ke)=>{for(var _e=0;_e<ke.length;_e++)if(-1<te.indexOf(ke[_e]))return!0;return!1})(B,u.BAD_DELIMITERS)||-1<B.indexOf(M)||B.charAt(0)===" "||B.charAt(B.length-1)===" ")?Y+B+Y:B)}},u.RECORD_SEP="",u.UNIT_SEP="",u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!s&&!!n.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=y,u.ParserHandle=x,u.NetworkStreamer=d,u.FileStreamer=p,u.StringStreamer=h,u.ReadableStreamStreamer=m,n.jQuery&&((a=n.jQuery).fn.parse=function(S){var _=S.config||{},T=[];return this.each(function(G){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var Y=0;Y<this.files.length;Y++)T.push({file:this.files[Y],inputElem:this,instanceConfig:a.extend({},_)})}),D(),this;function D(){if(T.length===0)b(S.complete)&&S.complete();else{var G,Y,J,Q,X=T[0];if(b(S.before)){var ee=S.before(X.file,X.inputElem);if(typeof ee=="object"){if(ee.action==="abort")return G="AbortError",Y=X.file,J=X.inputElem,Q=ee.reason,void(b(S.error)&&S.error({name:G},Y,J,Q));if(ee.action==="skip")return void M();typeof ee.config=="object"&&(X.instanceConfig=a.extend(X.instanceConfig,ee.config))}else if(ee==="skip")return void M()}var F=X.instanceConfig.complete;X.instanceConfig.complete=function(le){b(F)&&F(le,X.file,X.inputElem),M()},u.parse(X.file,X.instanceConfig)}}function M(){T.splice(0,1),D()}}),i&&(n.onmessage=function(S){S=S.data,u.WORKER_ID===void 0&&S&&(u.WORKER_ID=S.workerId),typeof S.input=="string"?n.postMessage({workerId:u.WORKER_ID,results:u.parse(S.input,S.config),finished:!0}):(n.File&&S.input instanceof File||S.input instanceof Object)&&(S=u.parse(S.input,S.config))&&n.postMessage({workerId:u.WORKER_ID,results:S,finished:!0})}),(d.prototype=Object.create(f.prototype)).constructor=d,(p.prototype=Object.create(f.prototype)).constructor=p,(h.prototype=Object.create(h.prototype)).constructor=h,(m.prototype=Object.create(f.prototype)).constructor=m,u})})(K1);var j_=K1.exports;const Jd=ed(j_);function F_(e,t){const r=Jd.unparse(t),n=new Blob([r],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(n),s=document.createElement("a");s.href=a,s.download=e,s.click(),URL.revokeObjectURL(a)}function M_(e){const t=new Map;for(const r of e.rows){const n=R_(r.well),a=zr(n),s=+(r.timeSeconds/60).toFixed(6),i=`${n}|${s}`,l=t.get(i);l?l.val_od600=r.value:t.set(i,{well:a,time_min:s,val_od600:r.value})}return Array.from(t.values()).sort((r,n)=>{const a=String(r.well).localeCompare(String(n.well),void 0,{numeric:!0});return a!==0?a:r.time_min-n.time_min})}function zr(e){const t=/^([A-Ha-h])\s*(\d{1,2})$/.exec(e.trim());if(!t)return e;const r=t[1].toUpperCase(),n=t[2].padStart(2,"0");return`${r}${n}`}function R_(e){const t=/^\s*([A-Ha-h])\s*0*([1-9]|1[0-2])\s*$/.exec(String(e??""));if(!t)return String(e??"").trim().toUpperCase();const r=t[1].toUpperCase(),n=parseInt(t[2],10);return`${r}${n}`}function em(e,t,r=8){const n=window.innerWidth,a=window.innerHeight,s=d=>Math.max(r,Math.min(d,n-t.width-r)),i=d=>Math.max(r,Math.min(d,a-t.height-r)),l=e.left+(e.width-t.width)/2,o=e.top+(e.height-t.height)/2,u=[{top:e.bottom+r,left:s(l)},{top:e.top-t.height-r,left:s(l)},{top:i(o),left:s((n-t.width)/2)}],f=d=>d.left>=r&&d.top>=r&&d.left+t.width<=n-r&&d.top+t.height<=a-r;for(const d of u)if(f(d))return d;return{top:i(e.bottom+r),left:s(l)}}function Qr({anchorRef:e,open:t,children:r}){const n=k.useRef(null),[a,s]=k.useState(null);return k.useLayoutEffect(()=>{if(!t){s(null);return}const i=e.current,l=n.current;if(!i||!l)return;const o=i.getBoundingClientRect(),u=l.getBoundingClientRect();s(em(o,u))},[t,e]),k.useEffect(()=>{if(!t)return;const i=()=>{const l=e.current,o=n.current;!l||!o||s(em(l.getBoundingClientRect(),o.getBoundingClientRect()))};return window.addEventListener("resize",i),window.addEventListener("scroll",i,!0),()=>{window.removeEventListener("resize",i),window.removeEventListener("scroll",i,!0)}},[t,e]),t?L1.createPortal(c.jsx("div",{ref:n,className:"help-tooltip",style:{position:"fixed",top:a?a.top:-9999,left:a?a.left:-9999,opacity:a?1:0,pointerEvents:a?"auto":"none",zIndex:1e4},children:r}),document.body):null}function I_(e){const t=e.replace(/\r/g,"").split(/\n|,|;|\t/).map(a=>a.trim()).filter(Boolean),r=new Set,n=[];for(const a of t)r.has(a)||(r.add(a),n.push(a));return n}function z_({onMappingImported:e}){const t=Ze(C=>C.sampleLists),r=Ze(C=>C.activeSampleListName),n=Ze(C=>C.createMapping),a=Ze(C=>C.mappings),s=Ze(C=>C.activeMappingId),i=Ze(C=>C.setActiveMapping),l=Ze(C=>C.updateMappingAssignments),o=Ze(C=>C.renameMapping),u=Ze(C=>C.deleteMapping),f=Ze(C=>C.createSampleList),d=Ze(C=>C.updateSampleList),p=Ze(C=>C.setActiveSampleList),h=Ze(C=>C.setMappingSamples),m=Ze(C=>C.duplicateMapping),x=Ze(C=>C.setSampleColor),v=Ze(C=>C.setSampleSaturation),y=Ze(C=>C.randomizeSampleColors),g=Ze(C=>C.language)==="pl",E=r?t[r]:null,[A,z]=k.useState(0),[b,S]=k.useState(()=>(E==null?void 0:E.items.join(`
`))??""),_=s?a[s]:null,T=(_==null?void 0:_.assignments)??{},D=(_==null?void 0:_.samples)??[],M=D.length?D:(E==null?void 0:E.items)??[],G=(_==null?void 0:_.sampleColors)??{},Y=(_==null?void 0:_.sampleSaturations)??{},J=k.useMemo(()=>I_(b),[b]),Q=k.useRef(null),X=k.useRef(null),ee=k.useRef(null),F=k.useRef(null),le=k.useRef(null),[re,j]=k.useState({}),[R,B]=k.useState(!0);k.useEffect(()=>{z(0)},[s]),k.useEffect(()=>{_&&(!_.sampleColors||Object.keys(_.sampleColors).length!==_.samples.length||!_.sampleSaturations||Object.keys(_.sampleSaturations).length!==_.samples.length)&&y(_.id)},[_==null?void 0:_.id]),k.useEffect(()=>{const C="_Current";t[C]?d(C,J):f(C,J),r!==C&&p(C)},[J.join("")]),k.useEffect(()=>{if(J.length===0)return;if(!s&&Object.values(a).length===0&&R){const we=n(`Mapping: ${(E==null?void 0:E.name)??"_Current"}`,J);i(we);return}const C=s?a[s]:null;if(!C){const we=Object.keys(a)[0];we&&i(we);return}C.samples.join("")!==J.join("")&&h(C.id,J)},[E==null?void 0:E.name,s,J,n,a,i,h,R]);function V(C){if(!_)return;const we=D[A];we&&l(_.id,{...T,[C]:we})}function te(C){if(!_)return;const{[C]:we,...he}=T;l(_.id,he)}function ke(C){const we=/^\s*([A-Ha-h])\s*0*([1-9]|1[0-2])\s*$/.exec(C||"");if(!we)return null;const he=we[1].toUpperCase(),Ce=parseInt(we[2],10);return qp(he,Ce)}function _e(C){const we=C.samples.length?C.samples:M,he={};for(const ht of Yd){const yt=C.assignments[ht];yt&&(he[yt]||(he[yt]=[]),he[yt].push(zr(ht)))}const Ce=we.map((ht,yt)=>{var Pt,Fe;return{name:ht,order:yt,color:((Pt=C.sampleColors)==null?void 0:Pt[ht])??null,saturation:((Fe=C.sampleSaturations)==null?void 0:Fe[ht])??null,wells:(he[ht]??[]).map(vt=>vt).sort((vt,jt)=>vt.localeCompare(jt,void 0,{numeric:!0}))}}),Ae={type:"mapping",version:1,name:C.name,createdAt:C.createdAt??new Date().toISOString(),samples:Ce},be=new Blob([JSON.stringify(Ae,null,2)],{type:"application/json;charset=utf-8;"}),qe=URL.createObjectURL(be),Ie=document.createElement("a");Ie.href=qe,Ie.download=`${C.name.replace(/\s+/g,"_")}.mapping.json`,Ie.click(),URL.revokeObjectURL(qe)}async function ge(C){const we=await C.text();let he;try{he=JSON.parse(we)}catch{throw new Error("Invalid mapping JSON")}if(he!=null&&he.type&&he.type!=="mapping")throw new Error("Unsupported mapping JSON");const Ce=Array.isArray(he==null?void 0:he.samples)?he.samples:[],Ae=Ce.map(Fe=>Fe!=null&&Fe.name?String(Fe.name).trim():"").filter(Fe=>!!Fe).filter((Fe,vt,jt)=>jt.indexOf(Fe)===vt),be=Array.isArray(he==null?void 0:he.assignments)?he.assignments:[],qe=be.length?be:Ce,Ie={};for(const Fe of qe){const vt=(Fe==null?void 0:Fe.sample)??(Fe==null?void 0:Fe.Sample)??(Fe==null?void 0:Fe.name),jt=vt?String(vt).trim():"";if(!jt)continue;const ft=Array.isArray(Fe==null?void 0:Fe.wells)?Fe.wells:(Fe==null?void 0:Fe.wells)??(Fe==null?void 0:Fe.Wells),kt=[];if(Array.isArray(ft))for(const Se of ft)typeof Se!="string"&&typeof Se!="number"||kt.push(String(Se));else typeof ft=="string"&&kt.push(...ft.split(/[,\s]+/));if(kt.length)for(const Se of kt){const ot=ke(String(Se));ot&&(Ie[ot]=jt)}else{const Se=ke((Fe==null?void 0:Fe.well)??(Fe==null?void 0:Fe.Well));if(!Se)continue;Ie[Se]=jt}Ae.includes(jt)||Ae.push(jt)}const ht=Ae.length?Ae:Array.from(new Set(Object.values(Ie))).sort((Fe,vt)=>Fe.localeCompare(vt,void 0,{numeric:!0}));if(!ht.length)return null;const yt=typeof(he==null?void 0:he.name)=="string"&&he.name.trim().length?he.name.trim():C.name.replace(/\.[^/.]+$/,"")||`Imported mapping ${new Date().toLocaleTimeString()}`,Pt=n(yt,ht);l(Pt,Ie);for(const Fe of Ce){const vt=Fe!=null&&Fe.name?String(Fe.name).trim():"";if(!vt)continue;const jt=(Fe==null?void 0:Fe.color)??(Fe==null?void 0:Fe.Color)??(Fe==null?void 0:Fe.colour)??(Fe==null?void 0:Fe.Colour);if(typeof jt=="string"&&/^#?[0-9A-Fa-f]{6}$/.test(jt.trim())){const Se=jt.trim();x(Pt,vt,Se.startsWith("#")?Se:`#${Se}`)}const ft=(Fe==null?void 0:Fe.saturation)??(Fe==null?void 0:Fe.Saturation),kt=typeof ft=="number"?ft:typeof ft=="string"&&ft.trim().length?Number(ft):Number.NaN;if(!Number.isNaN(kt)){const Se=Math.max(0,Math.min(100,Math.round(kt)));v(Pt,vt,Se)}}return S(ht.join(`
`)),z(0),i(Pt),Pt}async function ye(C){let we=null;for(const he of Array.from(C)){const Ce=await ge(he);Ce&&(we=Ce)}we&&(i(we),e==null||e())}const Ee=k.useMemo(()=>{const C={};return Object.values(T).forEach(we=>{C[we]=(C[we]??0)+1}),C},[T]);return k.useEffect(()=>{function C(we){!_||D.length===0||(we.key==="ArrowDown"&&(z(he=>(he+1)%D.length),we.preventDefault()),we.key==="ArrowUp"&&(z(he=>(he-1+D.length)%D.length),we.preventDefault()))}return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[_,D.length]),c.jsxs("div",{className:"mapping-grid",children:[c.jsxs("div",{className:"panel panel-soft",children:[c.jsxs("div",{className:"panel-heading with-help",children:[c.jsxs("div",{children:[c.jsxs("strong",{children:[" ",g?"Lista prb":"Sample List"]}),c.jsx("p",{className:"small",children:g?"Jeli zaimportowae ju plik z danymi, poniej wpisz nazwy wsyzstkich prb, ktre chcesz przypisa do odpowiednich dokw pytki. Nazwy rozdziel przecinkiem lub zapisz kad w nowej linii. Moesz zapisa list prb do pliku tekstowego, eby nie musie jej wpisywa za kadym razem. Moesz wybra plik tekstowy z list prb.":"If you have already imported a data file, enter below the names of all samples you want to assign to the appropriate plate wells. Separate names with commas or put each on a new line. You can save the sample list to a text file so you don't have to type it each time. You can also choose a text file with the sample list."})]}),c.jsx("button",{ref:X,className:"help-btn",type:"button",onClick:()=>j(C=>({...C,samples:!C.samples})),children:"?"})]}),c.jsx(Qr,{anchorRef:X,open:!!re.samples,children:g?"Lista prb zostanie wykorzystana do zmapowania ich na doki pytki. W kolejnym kroku przypiszesz prby do odpoweidnich dokw.":"The sample list will be used to map them to plate wells. In the next step, you will assign samples to the appropriate wells."}),c.jsx("textarea",{value:b,onChange:C=>S(C.target.value),onDragOver:C=>C.preventDefault(),onDrop:C=>{var he;C.preventDefault();const we=(he=C.dataTransfer.files)==null?void 0:he[0];we&&we.text().then(Ce=>S(Ce))},placeholder:g?`Prba_1
Prba_2
...`:`Sample_1
Sample_2
...`}),c.jsxs("div",{className:"row",style:{marginTop:8,gap:8,flexWrap:"wrap"},children:[c.jsxs("label",{className:"btn basic-btn",style:{cursor:"pointer"},children:[g?"Wybierz plik":"Choose file",c.jsx("input",{type:"file",accept:".txt,.json",style:{display:"none"},onChange:C=>{var he;const we=(he=C.target.files)==null?void 0:he[0];we&&we.text().then(Ce=>S(Ce)),C.currentTarget.value=""}})]}),c.jsx("button",{className:"btn basic-btn",onClick:()=>{if(J.length===0)return;const C=new Blob([J.join(`
`)],{type:"text/plain;charset=utf-8;"}),we=URL.createObjectURL(C),he=document.createElement("a");he.href=we,he.download="samples.txt",he.click(),URL.revokeObjectURL(we)},children:g?"Zapisz list":"Save List"})]}),c.jsxs("div",{className:"small",children:[g?"Wczytanych pozycji: ":"Items parsed: ",J.length]})]}),c.jsxs("div",{className:"panel panel-soft",onDragOver:C=>{C.preventDefault(),C.stopPropagation()},onDrop:C=>{var he;C.preventDefault(),C.stopPropagation();const we=(he=C.dataTransfer)==null?void 0:he.files;we&&we.length&&ye(we)},children:[c.jsxs("div",{className:"panel-heading with-help",children:[c.jsxs("div",{children:[c.jsxs("strong",{children:[" ",g?"Zmapowanie":"Mappings"]}),c.jsx("p",{className:"small",children:g?'W panelach poniej przypisz prby do odpowiednich dokw. Kiedy do zrobisz, w tym panelu nadaj nazw temu zmapowaniu. Aby nie powtarza tego kroku moesz zapisywa mapowania ("Pobierz") i wczytywa je ("Importuj"). Jeeli kilka twoich pytek rni si tylko niektrymi dokiami, moesz skopiowa i edytowa obecne mapowanie ("Nowe zmapowanie").':'In the panels below, assign samples to the appropriate wells. When you are done, in this panel, name this mapping. To avoid repeating this step, you can save mappings ("Download") and load them ("Import"). If several of your plates differ only by some wells, you can copy and edit the current mapping ("New mapping").'})]}),c.jsx("button",{ref:ee,className:"help-btn",type:"button",onClick:()=>j(C=>({...C,mappings:!C.mappings})),children:"?"})]}),c.jsx(Qr,{anchorRef:ee,open:!!re.mappings,children:g?'W kolejnych krokach zmapowanie zostanie przypisane do pliku z przekonwertowanymi danymi i zostanie utworzony plik "przypisania" (.assignment.json) zawierajcy wszystkie dane niezbdne do daljszej analizy.)':'In the next steps, the mapping will be assigned to the converted data file, and an "assignment" file (.assignment.json) containing all the data necessary for further analysis will be created.)'}),c.jsxs("div",{style:{marginTop:8},children:[Object.values(a).length===0&&c.jsx("div",{className:"small",children:"No mappings yet. Add samples to create one automatically."}),c.jsx("ul",{className:"mapping-list",children:Object.values(a).map(C=>c.jsx("li",{style:{marginBottom:6},children:c.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[c.jsx("input",{type:"radio",name:"mapping",checked:s===C.id,onChange:()=>i(C.id)}),c.jsx("input",{type:"text",value:C.name,onChange:we=>o(C.id,we.target.value)}),c.jsxs("span",{className:"badge",children:[Object.keys(C.assignments).length,"/96"]}),c.jsx("button",{className:"btn",type:"button",onClick:we=>{we.preventDefault(),we.stopPropagation(),_e(C)},children:g?"Pobierz":"Download"}),c.jsx("button",{className:"btn warn",onClick:we=>{we.preventDefault(),we.stopPropagation(),B(!1),u(C.id)},children:g?"Usu":"Delete"})]})},C.id))})]}),c.jsxs("div",{className:"row",style:{marginTop:8,gap:8,flexWrap:"wrap"},children:[c.jsx("button",{className:"btn primary",onClick:()=>{if(_)m(_.id);else if(J.length){const C=n(`Mapping: ${(E==null?void 0:E.name)??"_Current"}`,J);i(C)}B(!1)},disabled:!_&&J.length===0,title:g?"Zduplikuj biece mapowanie":"Duplicate current mapping",children:g?"Nowe mapowanie":"New mapping"}),c.jsx("button",{className:"btn basic-btn",onClick:()=>{var C;return(C=Q.current)==null?void 0:C.click()},children:g?"Importuj JSON":"Import JSON"}),c.jsx("button",{className:"btn basic-btn warn",onClick:()=>_&&l(_.id,{}),title:g?"Wyczy wszystkie przypisania dokw":"Clear all well assignments",disabled:!_,children:g?"Wyczy wszystko":"Clear all"})]}),c.jsx("input",{ref:Q,type:"file",accept:".json,application/json",multiple:!0,style:{display:"none"},onChange:C=>{const we=C.target.files;we&&we.length&&ye(we),C.currentTarget.value=""}})]}),c.jsxs("div",{className:"panel panel-soft samples-panel",children:[c.jsxs("div",{className:"panel-heading with-help",children:[c.jsxs("div",{children:[c.jsxs("strong",{children:[" ",g?"Przypisywanie prb":"Assigning samples"," (",M.length,")"]}),c.jsx("p",{className:"small",children:g?"Przypisz ponisze prby do opowiednich dokw klikajc doki w kolejnym panelu.":"Assign the samples below to the appropriate wells by clicking the wells in the next panel."})]}),c.jsx("button",{ref:F,className:"help-btn",type:"button",onClick:()=>j(C=>({...C,samplesAssign:!C.samplesAssign})),children:"?"})]}),c.jsx(Qr,{anchorRef:F,open:!!re.samplesAssign,children:g?"Lista prbek wymagajcych przypisania do dokw. Kliknij prbk, aby j aktywowa, zmieniaj kolory lub nasycenie.":"List of samples that need assigning to wells. Click a sample to activate it; adjust colors or saturation."}),M.length===0&&c.jsx("div",{className:"small",children:"No samples. Enter samples on the left to build the list."}),c.jsx("div",{style:{maxHeight:360,overflow:"auto",border:"1px solid rgba(255,255,255,.06)",borderRadius:8,padding:8,marginTop:8},children:c.jsx("ol",{children:M.map((C,we)=>{const he=G[C]??"#60a5fa",Ce=Y[C]??65;return c.jsxs("li",{className:["sample-row",we===A?"active":""].join(" "),onClick:()=>z(we),title:`Click to select sample "${C}"`,children:[c.jsxs("label",{title:`Pick color for sample ${C}`,onClick:Ae=>Ae.stopPropagation(),style:{position:"relative",width:14,height:14,flex:"0 0 14px"},children:[c.jsx("input",{type:"color","aria-label":`Pick color for ${C}`,value:he,onChange:Ae=>_&&x(_.id,C,Ae.target.value),style:{position:"absolute",inset:0,opacity:0,cursor:"pointer"}}),c.jsx("span",{style:{position:"absolute",left:we===A?0:2,top:we===A?0:2,width:we===A?0:10,height:we===A?0:10,borderLeft:we===A?"7px solid transparent":void 0,borderRight:we===A?"7px solid transparent":void 0,borderBottom:we===A?`14px solid ${he}`:void 0,background:we===A?void 0:he,borderRadius:we===A?void 0:"50%"}})]}),c.jsxs("span",{style:{flex:1},children:[C," ",c.jsxs("span",{className:"small",children:["(",Ee[C]??0,")"]})]}),c.jsx("input",{type:"range",min:0,max:100,value:Ce,title:`Saturation for ${C}`,onChange:Ae=>_&&v(_.id,C,Number(Ae.target.value)),style:{width:80},onClick:Ae=>Ae.stopPropagation()})]},we)})})}),c.jsx("div",{className:"small",style:{marginTop:6},children:g?"Klikajc na doek przypiszesz aktualnie zaznaczon prb (trjkt); klikajc ponownie usuniesz przypisanie. Klikaj na prby na licie lub uyj strzaek na klawiaturze, aby zmieni aktualnie zaznaczon prb. Kliknij na koo/trjkt obok prby aby zmieni jej kolor; suwak ustawia nasycenie.":"Click the colored square to change color; click a row to make that sample active. The slider sets saturation."}),c.jsx("div",{className:"row",style:{marginTop:8,justifyContent:"flex-end"},children:c.jsx("button",{className:"btn basic-btn",onClick:()=>_&&y(_.id),disabled:!_,children:g?"Losuj kolory":"Randomize colors"})})]}),c.jsxs("div",{className:"panel panel-soft plate-panel",style:{overflowX:"auto"},children:[c.jsxs("div",{className:"panel-heading with-help",children:[c.jsxs("div",{children:[c.jsxs("strong",{children:[" ",g?"Pytka 96-dokowa":"96-well Plate"]}),c.jsx("p",{className:"small",children:g?"Kliknij doek, aby przypisa aktywn prbk lub usun przypisanie. Uyj strzaek gra/d do zmiany przypisywanej prbki.":"Click a well to assign the active sample or to clear the assignment. Use up/down arrows to change the assigned sample."})]}),c.jsx("button",{ref:le,className:"help-btn",type:"button",onClick:()=>j(C=>({...C,plate:!C.plate})),children:"?"})]}),c.jsx(Qr,{anchorRef:le,open:!!re.plate,children:g?"Kliknij doek, aby przypisa aktywn prbk; kliknij ponownie, aby usun. Uyj strzaek gra/d do zmiany aktywnej prbki.":"Click a well to assign the active sample; click again to clear. Use up/down arrows to change the active sample."}),c.jsxs("div",{className:"grid96",style:{marginTop:8},children:[c.jsx("div",{}),Array.from({length:12},(C,we)=>c.jsx("div",{className:"collabel",children:we+1},we)),H1.map(C=>c.jsxs("div",{style:{display:"contents"},children:[c.jsx("div",{className:"rowlabel",children:C}),V1.map(we=>{const he=qp(C,we),Ce=T[he],Ae=Ce?G[Ce]??"#34d399":"",be=Ce&&Ce===D[A],qe={};return Ce&&(qe.background=Zp(Ae,.35),qe.borderColor=Zp(Ae,.8)),be&&(qe.boxShadow="0 0 0 2px var(--accent)"),c.jsx("div",{className:"well",style:Object.keys(qe).length?qe:void 0,title:Ce?`${he} -> ${Ce}`:he,onClick:()=>Ce?te(he):V(he),children:Ce||he},he)})]},C))]}),c.jsx("div",{className:"small",style:{marginTop:8},children:g?c.jsxs(c.Fragment,{children:["Kliknij, aby przypisa ",c.jsx("b",{children:M[A]??"(brak)"})," do doka. Kliknij ponownie, aby usun. Zapisz plik zmapowania w jednym z poprzednich paneli, aby nie musie powtarza tego kroku."]}):c.jsxs(c.Fragment,{children:["Click to assign ",c.jsx("b",{children:M[A]??"(none)"})," to a well. Click again to clear. Save the mapping file in one of the previous panels to avoid repeating this step."]})})]})]})}function tm(e,t){const a=((e||"").trim().replace(/(\.data\.converted)?\.(json|csv)$/i,"")||t).replace(/[^a-zA-Z0-9._-]+/g,"_");return a.length?a:t}function Ll(e){return e.sourceFile?e.sourceFile.replace(/\.[^/.]+$/,""):`dataset-${e.runId.slice(0,6)}`}function L_(e){const t=new Map;return e.rows.forEach(r=>{if(!Number.isFinite(r==null?void 0:r.timeSeconds)||!Number.isFinite(r==null?void 0:r.value))return;const n=zr(r.well);if(!n)return;const a=+(r.timeSeconds/60).toFixed(6),s=`${n}|${a}`,i=`val_${String((r==null?void 0:r.measurementType)||e.measurementType||"value").toLowerCase()}`,l=t.get(s)??{well:n,time_min:a};l[i]=r.value,t.set(s,l)}),Array.from(t.values()).sort((r,n)=>{const a=String(r.well).localeCompare(String(n.well),void 0,{numeric:!0});return a!==0?a:r.time_min-n.time_min})}function O_({ds:e,baseName:t,onBaseChange:r,onDownloadJson:n,onDownloadCsv:a}){const s=i=>{i.key==="Enter"&&(i.preventDefault(),n())};return c.jsxs("tr",{children:[c.jsx("td",{children:e.sourceFile||e.runId}),c.jsx("td",{children:c.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[c.jsx("input",{value:t,onChange:i=>r(i.target.value),onKeyDown:s,style:{border:"1px solid rgba(0,0,0,.18)",borderRadius:4,padding:"2px 6px",minWidth:160},"aria-label":"Base filename",placeholder:"dataset"}),c.jsx("span",{className:"small",children:".data.json / .data.converted.csv"})]})}),c.jsx("td",{children:c.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[c.jsx("button",{className:"btn basic-btn",type:"button",onClick:n,children:"JSON"}),c.jsx("button",{className:"btn basic-btn",type:"button",onClick:a,children:"CSV"})]})})]})}function P_(){const e=Ze(o=>Object.values(o.datasets)),r=Ze(o=>o.language)==="pl",[n,a]=k.useState({}),s=k.useMemo(()=>[...e].sort((o,u)=>new Date(u.createdAt).getTime()-new Date(o.createdAt).getTime()),[e]),i=k.useCallback(o=>{const u=tm(n[o.runId]??Ll(o),Ll(o)),f=L_(o),{rows:d,...p}=o,h={meta:p,rows:f},m=new Blob([JSON.stringify(h,null,2)],{type:"application/json;charset=utf-8"}),x=URL.createObjectURL(m),v=document.createElement("a");v.href=x,v.download=`${u}.data.json`,v.click(),URL.revokeObjectURL(x)},[n]),l=k.useCallback(o=>{const f=`${tm(n[o.runId]??Ll(o),Ll(o))}.data.converted.csv`;F_(f,M_(o))},[n]);return c.jsxs("div",{className:"panel panel-soft full-span",children:[c.jsx("div",{className:"panel-heading with-help",children:c.jsxs("div",{children:[c.jsxs("h3",{children:[" ",r?"Eksportuj dane":"Export data"]}),c.jsx("p",{className:"small",children:r?c.jsxs(c.Fragment,{children:["Moesz pobra na swoje urzdzenie plik z danymi przekonwertowany na format, na ktrym pracuje program (.json) lub w formacie .csv. ",c.jsx("strong",{children:"Ten krok jest opcjonalny."})]}):c.jsxs(c.Fragment,{children:["You can download the converted data file (.json) or in .csv format to your device."," ",c.jsx("strong",{children:"This step is optional."})]})})]})}),c.jsxs("table",{className:"table",style:{marginTop:8},children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:r?"Plik":"File"}),c.jsx("th",{children:r?"Nazwa wyjciowa":"Output name"}),c.jsx("th",{children:r?"Akcje":"Actions"})]})}),c.jsxs("tbody",{children:[s.map(o=>c.jsx(O_,{ds:o,baseName:n[o.runId]??Ll(o),onBaseChange:u=>a(f=>({...f,[o.runId]:u})),onDownloadJson:()=>i(o),onDownloadCsv:()=>l(o)},o.runId)),s.length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:3,children:c.jsx("div",{className:"small",children:r?"Brak danych. Najpierw zaimportuj plik w panelu 0 lub 1.":"No data. Import a file in panel 0 or 1 first."})})})]})]})]})}function D_(e){const t={};return Object.entries(e??{}).forEach(([r,n])=>{const a=zr(String(r)),s=String(n??"").trim();!a||!s||(t[a]=s)}),t}function B_(e){const t=e.samples.length?e.samples:Array.from(new Set(Object.values(e.assignments))).sort((a,s)=>a.localeCompare(s,void 0,{numeric:!0})),r={};Object.entries(e.assignments).forEach(([a,s])=>{const i=s==null?void 0:s.trim();i&&(r[i]||(r[i]=[]),r[i].push(zr(a)))});const n=t.map((a,s)=>{var i,l;return{name:a,order:s,color:((i=e.sampleColors)==null?void 0:i[a])??null,saturation:((l=e.sampleSaturations)==null?void 0:l[a])??null,wells:(r[a]??[]).map(o=>o).sort((o,u)=>o.localeCompare(u,void 0,{numeric:!0}))}});return{type:"mapping",version:1,id:e.id,name:e.name,createdAt:e.createdAt??new Date().toISOString(),notes:e.notes,samples:n}}function X1(e,t){const r=B_(t),n=Array.from(new Set(e.rows.filter(h=>Number.isFinite(h==null?void 0:h.timeSeconds)&&Number.isFinite(h==null?void 0:h.value)).map(h=>zr(h.well)))).sort((h,m)=>String(h).localeCompare(String(m),void 0,{numeric:!0})),a={},s=D_(Object.keys(t.assignments??{}).length>0?t.assignments:Object.fromEntries((Array.isArray(t.samples)?t.samples:[]).flatMap(h=>Array.isArray(h==null?void 0:h.wells)?h.wells.map(m=>[zr(m),(h==null?void 0:h.name)??""]):[]).filter(([h,m])=>!!(h&&m))));n.forEach(h=>{const m=(s[h]??"").trim();m&&(a[m]||(a[m]=[]),a[m].push(zr(h)))});const i=Object.keys(s).length,l=n.length;if(i!==l){const h=Object.values(a).flat().filter(x=>!n.includes(x)).slice(0,12),m=n.filter(x=>!Object.values(a).flat().includes(x)).slice(0,12);console.warn(`[ASSIGNMENT] Well count mismatch for run "${e.sourceFile||e.runId}": mapping has ${i} wells, dataset has ${l}. `+(h.length?`Missing in data: ${h.join(", ")}. `:"")+(m.length?`Extra in data: ${m.join(", ")}. `:""))}const o={};Object.entries(a).forEach(([h,m])=>{m.map(x=>x).sort((x,v)=>x.localeCompare(v,void 0,{numeric:!0})).forEach((x,v)=>{o[x]=v+1})});const u=new Map;e.rows.forEach(h=>{if(!Number.isFinite(h==null?void 0:h.timeSeconds)||!Number.isFinite(h==null?void 0:h.value))return;const m=zr(h.well),x=(s[m]??"").trim();if(!x)return;const v=+(h.timeSeconds/60).toFixed(6),y=`${m}|${v}`;let w=u.get(y);w||(w={well:m,sample:x,replicate:o[m]??1,time_min:v},u.set(y,w));const g=`val_${String(h.measurementType||"value").toLowerCase()}`;w[g]=h.value});const f=Array.from(u.values()).sort((h,m)=>{const x=String(h.well).localeCompare(String(m.well),void 0,{numeric:!0});return x!==0?x:h.time_min-m.time_min});if(!f.length)return null;const{rows:d,...p}=e;return{mapping:r,dataset:{meta:p,rows:f}}}function U_(e,t,r){if(!Object.keys(t).length)return null;const n=Object.fromEntries(e.map(s=>[s.runId,s])),a=[];for(const[s,i]of Object.entries(t)){const l=n[s],o=r[i];if(!l||!o)continue;const u=X1(l,o);u&&a.push(u)}return a.length?{version:5,createdAt:new Date().toISOString(),assignments:a}:null}const C0={flexRowWrap:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},assignmentInput:{border:"1px solid rgba(0,0,0,.15)",borderRadius:4,padding:"2px 6px",minWidth:180}};function $_({ds:e,mappingId:t,saved:r,mappings:n,onChangeMapping:a,assignmentName:s,onAssignmentNameChange:i,onAssign:l,onOpenPlots:o,onAutoRun:u,isPl:f}){const d=!t,p=h=>{h.key==="Enter"&&(h.preventDefault(),d||l())};return c.jsxs("tr",{children:[c.jsx("td",{children:e.sourceFile}),c.jsx("td",{children:c.jsxs("div",{style:C0.flexRowWrap,children:[c.jsxs("select",{value:t,onChange:h=>a(h.target.value),title:"Select mapping for this dataset",children:[c.jsx("option",{value:"",children:"(no mapping)"}),n.map(h=>c.jsx("option",{value:h.id,children:h.name},h.id))]}),r&&c.jsx("span",{className:"badge",children:f?"zapisane":"saved"})]})}),c.jsx("td",{children:c.jsxs("div",{style:C0.flexRowWrap,children:[c.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[c.jsx("input",{value:s,onChange:h=>i(h.target.value),onKeyDown:p,style:C0.assignmentInput,"aria-label":"Assignment filename",placeholder:"assignment"}),c.jsx("span",{children:".assignment.json"})]}),c.jsx("button",{className:"btn basic-btn",type:"button",disabled:d,onClick:l,children:f?"Pobierz":"Download"}),c.jsx("button",{className:"btn primary",type:"button",onClick:o,children:f?"Kolejny etap":"Next step"}),c.jsx("button",{className:"btn primary",type:"button",onClick:u,children:f?"Automatyczna analiza":"Auto analysis"})]})})]})}function W_(){const e=Ze(F=>Object.values(F.datasets)),t=Ze(F=>Object.values(F.mappings)),r=Ze(F=>F.datasetMapping??{}),n=Ze(F=>F.setDatasetMapping),a=Ze(F=>F.setDatasetMappings),s=Ze(F=>F.setActiveTab),i=Ze(F=>F.setPlotsSelectedRunId),l=Ze(F=>F.setBlankCorrectionAssignments),o=Ze(F=>F.setCurvesSmoothingAssignments),u=Ze(F=>F.setCurvesSmoothingSmoothed),f=Ze(F=>F.setAutoRun),d=Ze(F=>F.resetAutoRun),[p,h]=k.useState({}),[m]=k.useState(()=>({...r})),[x,v]=k.useState({}),[y,w]=k.useState([]),[g,E]=k.useState(!1),z=Ze(F=>F.language)==="pl",b=k.useRef(null),S=k.useMemo(()=>[...e].sort((F,le)=>new Date(le.createdAt).getTime()-new Date(F.createdAt).getTime()),[e]),_=k.useMemo(()=>Object.fromEntries(t.map(F=>[F.id,F])),[t]),T=k.useCallback(F=>`${(F.sourceFile?F.sourceFile.replace(/\.[^/.]+$/,""):F.runId)||"assignment"}-assignment`,[]);k.useEffect(()=>{v(F=>{let le=!1;const re={...F},j=new Set(e.map(R=>R.runId));for(const R of e)re[R.runId]||(re[R.runId]=T(R),le=!0);for(const R of Object.keys(re))j.has(R)||(delete re[R],le=!0);return le?re:F})},[e,T]);const D=k.useCallback((F,le)=>{const R=((F||"").trim().replace(/(\.data\.converted)?\.(json|csv)$/i,"")||le).replace(/[^a-zA-Z0-9._-]+/g,"_");return R.length?R:le},[]),M=k.useCallback(F=>U_(e,F,_),[e,_]),G=k.useCallback((F,le)=>{const re=new Blob([JSON.stringify(F,null,2)],{type:"application/json;charset=utf-8"}),j=URL.createObjectURL(re),R=document.createElement("a");R.href=j,R.download=`${le}.assignment.json`,R.click(),URL.revokeObjectURL(j)},[]),Y=k.useCallback((F,le)=>{if(!le){w(B=>[`[WARN] Select mapping before downloading ${F.sourceFile??F.runId}`,...B].slice(0,200));return}const re=M({[F.runId]:le});if(!re){w(B=>[`[ERR] Cannot build assignment for ${F.sourceFile??F.runId}`,...B].slice(0,200));return}const j=x[F.runId]??T(F),R=D(j,T(F));G(re,R),a({[F.runId]:le}),w(B=>[`[FILE] ${F.sourceFile??F.runId} -> ${R}.assignment.json`,...B].slice(0,200))},[x,M,T,D,G,a,w]),J=k.useCallback(()=>{if(!S.length){w(re=>["[INFO] No datasets to download",...re].slice(0,200));return}const F={};for(const re of S){const j=p[re.runId]??r[re.runId]??m[re.runId]??"";if(!j)continue;const R=M({[re.runId]:j});if(!R)continue;const B=x[re.runId]??T(re),V=D(B,T(re));G(R,V),F[re.runId]=j}if(!Object.keys(F).length){w(re=>["[INFO] No mappings selected to download",...re].slice(0,200));return}a(F),w(re=>[`${Object.keys(F).length} assignment file(s) downloaded`,...re].slice(0,200));const le=Object.keys(F)[0];le&&(i(le),s("plots"))},[x,p,M,r,S,G,T,D,m,s,a,w,i]),Q=k.useCallback((F,le)=>{h(re=>({...re,[F]:le})),n(F,le)},[n]),X=k.useCallback(F=>{i(F),s("plots"),typeof window<"u"&&window.scrollTo({top:0,behavior:"smooth"})},[s,i]),ee=k.useCallback((F,le)=>{if(!le){w(re=>[`[WARN] Select a mapping before fast-tracking ${F.sourceFile??F.runId}.`,...re].slice(0,200));return}d(),l(null),o(null),u(null),n(F.runId,le),i(F.runId),f({runId:F.runId,mappingId:le,stage:"toBlank",startedAt:new Date().toISOString(),error:null}),s("plots"),w(re=>[`[AUTO] Fast-track analysis queued for ${F.sourceFile??F.runId}.`,...re].slice(0,200))},[d,l,o,u,n,i,f,s,w]);return c.jsxs("div",{className:"panel panel-soft full-span",children:[c.jsxs("div",{className:"panel-heading with-help",children:[c.jsxs("div",{children:[c.jsxs("h3",{children:[" ",z?"Przypisz zmapowania do plikw":"Assign mappings to files"]}),c.jsx("p",{className:"small",children:z?"Pocz kady plik danych ze zmapowaniem prb do dokw, nazwij i pobierz plik przypisania (.assignment.json) i przejd do kolejnych krokw (wykluczanie danych z analizy, ustalanie blank, wygadzanie krzywych). Moesz kontrolowa kady kolejny etap lub przejs od razu do wynikw - program przeprowadzi analiz z doylnymi parametrami. Przy pierwszym uyciu zaleca si kontrolowanie kadego etapu.":"Pair each converted dataset with a plate mapping, download assignment files, and jump to plots."})]}),c.jsx("button",{ref:b,className:"help-btn",type:"button",onClick:()=>E(F=>!F),children:"?"})]}),c.jsx(Qr,{anchorRef:b,open:g,children:z?"Wybierz mapowanie dla kadej konwertowanej prbki. Moesz pobra pojedynczy plik assignment albo wszystkie naraz.":"Select a mapping for each converted dataset. Download a single assignment file or all at once."}),c.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginBottom:8},children:c.jsx("button",{className:"btn basic-btn",type:"button",onClick:J,disabled:S.length===0,children:z?"Pobierz wszystkie assignmenty":"Download all assignments"})}),c.jsxs("table",{className:"table",style:{marginTop:8},children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:z?"Plik":"File"}),c.jsx("th",{children:z?"Mapowanie":"Mapping"}),c.jsx("th",{children:z?"Akcje":"Actions"})]})}),c.jsxs("tbody",{children:[S.map(F=>{const le=r[F.runId]??m[F.runId]??"",re=p[F.runId]??le;return c.jsx($_,{ds:F,mappingId:re,saved:!!r[F.runId],mappings:t,assignmentName:x[F.runId]??T(F),onAssignmentNameChange:j=>v(R=>({...R,[F.runId]:j})),onChangeMapping:j=>Q(F.runId,j),onAssign:()=>Y(F,re),onOpenPlots:()=>X(F.runId),onAutoRun:()=>ee(F,re),isPl:z},F.runId)}),S.length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:3,children:c.jsx("div",{className:"small",children:z?"Brak skonwertowanych danych. Najpierw zaimportuj pliki pomiarowe.":"No converted datasets. Import measurement files to begin."})})})]})]})]})}async function H_(e,t={}){return{storedAs:"local-test-no-endpoint"}}function V_(e){const t=e.trim();if(/^\d+(\.\d+)?$/.test(t))return parseFloat(t)*60;const r=/^(\d{1,2}):(\d{2})(?::(\d{2}))?$/.exec(t);if(!r)return NaN;const n=parseInt(r[1]||"0",10),a=parseInt(r[2]||"0",10),s=parseInt(r[3]||"0",10);return n*3600+a*60+s}const G_={id:"well-time-long-csv",label:"Long CSV (Well,Time,OD)",description:"Kolumny: Well, Time, OD (czas w min lub HH:MM:SS)",fileExtensions:[".csv",".txt"],detect:e=>{const t=e.slice(0,1024).toLowerCase();return t.includes("well")&&t.includes("time")&&(t.includes("od")||t.includes("value"))},parse:async(e,t)=>{var d;const r=String(e),n=Jd.parse(r,{header:!0,dynamicTyping:!1,skipEmptyLines:"greedy"});if((d=n.errors)!=null&&d.length)return{ok:!1,error:"Bd parsowania CSV: "+n.errors[0].message};const a=n.data,s=[],i=ml(),l="Plate-1",o="OD600",u=[];for(const p of a){const h=(p.Well??p.well??"").toString().trim(),m=(p.Time??p.time??"").toString().trim(),x=(p.OD??p.od??p.Value??p.value??"").toString().trim();if(!h||!m||!x)continue;if(!G1(h)){s.push(`Niepoprawny well: ${h}`);continue}const v=V_(m);if(isNaN(v)){s.push(`Nie mona rozpozna czasu: ${m}`);continue}const y=parseFloat(x);if(isNaN(y)){s.push(`Nie mona rozpozna wartoci OD: ${x}`);continue}u.push({runId:i,plateId:l,sourceFile:t,well:h.toUpperCase(),timeSeconds:v,timeLabel:m,measurementType:o,value:y})}return{ok:!0,dataset:{runId:i,plateId:l,sourceFile:t,measurementType:o,createdAt:new Date().toISOString(),parserId:"well-time-long-csv",rows:u},warnings:s}}};function K_(e){const t=e.trim();if(/^\d+(\.\d+)?$/.test(t))return parseFloat(t)*60;const r=/^(\d{1,2}):(\d{2})(?::(\d{2}))?$/.exec(t);if(!r)return NaN;const n=parseInt(r[1]||"0",10),a=parseInt(r[2]||"0",10),s=parseInt(r[3]||"0",10);return n*3600+a*60+s}const X_={id:"timeseries-wide-csv",label:"Wide CSV (Time, A1..H12)",description:"Kolumny: Time, nastpnie A1..H12 (kada kolumna to doek).",fileExtensions:[".csv",".txt"],detect:e=>{const t=e.slice(0,1024);return/Time/i.test(t)&&/A1/i.test(t)&&/H12/i.test(t)},parse:async(e,t)=>{var f;const r=String(e),n=Jd.parse(r,{header:!0,dynamicTyping:!1,skipEmptyLines:"greedy"});if((f=n.errors)!=null&&f.length)return{ok:!1,error:"Bd parsowania CSV: "+n.errors[0].message};const a=n.data,s=ml(),i="Plate-1",l="OD600",o=[];return a.forEach(d=>{const p=(d.Time??d.time??"").toString().trim();if(!p)return;const h=K_(p);if(!isNaN(h)){for(const m of Yd)if(m in d){const x=(d[m]??"").toString().trim();if(x==="")continue;const v=parseFloat(x);if(isNaN(v))continue;o.push({runId:s,plateId:i,sourceFile:t,well:m,timeSeconds:h,timeLabel:p,measurementType:l,value:v})}}}),{ok:!0,dataset:{runId:s,plateId:i,sourceFile:t,measurementType:l,createdAt:new Date().toISOString(),parserId:"timeseries-wide-csv",rows:o}}}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Y1=1252,Y_=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Qd={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Zd=function(e){Y_.indexOf(e)!=-1&&(Y1=Qd[0]=e)};function J_(){Zd(1252)}var Ia=function(e){Zd(e)};function J1(){Ia(1200),J_()}function rm(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Q_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Q1(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Wl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Q_(e.slice(2)):t==254&&r==255?Q1(e.slice(2)):t==65279?e.slice(1):e},vc=function(t){return String.fromCharCode(t)},nm=function(t){return String.fromCharCode(t)},jo,As="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function am(e){for(var t="",r=0,n=0,a=0,s=0,i=0,l=0,o=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,a=e.charCodeAt(u++),l=(n&15)<<2|a>>6,o=a&63,isNaN(n)?l=o=64:isNaN(a)&&(o=64),t+=As.charAt(s)+As.charAt(i)+As.charAt(l)+As.charAt(o);return t}function ca(e){var t="",r=0,n=0,a=0,s=0,i=0,l=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=As.indexOf(e.charAt(u++)),i=As.indexOf(e.charAt(u++)),r=s<<2|i>>4,t+=String.fromCharCode(r),l=As.indexOf(e.charAt(u++)),n=(i&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),o=As.indexOf(e.charAt(u++)),a=(l&3)<<6|o,o!==64&&(t+=String.fromCharCode(a));return t}var ar=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),_i=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ws(e){return ar?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function sm(e){return ar?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ra=function(t){return ar?_i(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Si(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function qd(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return qd(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Cs=ar?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:_i(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Z_(e){for(var t=[],r=0,n=e.length+250,a=Ws(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var l=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|l>>6&15|(i&3)<<4,a[r++]=128|l&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Ws(65535),n=65530)}return t.push(a.slice(0,r)),Cs(t)}var Dn=/\u0000/g,Hl=/[\u0001-\u0006]/g;function nl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function za(e,t){var r=""+e;return r.length>=t?r:Br("0",t-r.length)+r}function eh(e,t){var r=""+e;return r.length>=t?r:Br(" ",t-r.length)+r}function mu(e,t){var r=""+e;return r.length>=t?r:r+Br(" ",t-r.length)}function q_(e,t){var r=""+Math.round(e);return r.length>=t?r:Br("0",t-r.length)+r}function eS(e,t){var r=""+e;return r.length>=t?r:Br("0",t-r.length)+r}var im=Math.pow(2,32);function Ii(e,t){if(e>im||e<-im)return q_(e,t);var r=Math.round(e);return eS(r,t)}function xu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var lm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],T0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function tS(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Yt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},om={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},rS={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function gu(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,l=0,o=1,u=0,f=0,d=Math.floor(a);u<t&&(d=Math.floor(a),l=d*i+s,f=d*u+o,!(a-d<5e-8));)a=1/(a-d),s=i,i=l,o=u,u=f;if(f>t&&(u>t?(f=o,l=s):(f=u,l=i)),!r)return[0,n*l,f];var p=Math.floor(n*l/f);return[p,n*l-p*f,f]}function li(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var o=new Date(1900,0,1);o.setDate(o.getDate()+n-1),i=[o.getFullYear(),o.getMonth()+1,o.getDate()],s=o.getDay(),n<60&&(s=(s+6)%7),r&&(s=oS(o,i))}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var Z1=new Date(1899,11,31,0,0,0),nS=Z1.getTime(),aS=new Date(1900,2,1,0,0,0);function q1(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=aS&&(r+=24*60*60*1e3),(r-(nS+(e.getTimezoneOffset()-Z1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function th(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function sS(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function iS(e){var t=e<0?12:11,r=th(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function lS(e){var t=th(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Fo(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=iS(e):t===10?r=e.toFixed(10).substr(0,12):r=lS(e),th(sS(r.toUpperCase()))}function gi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Fo(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Sa(14,q1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function oS(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function cS(e,t,r,n){var a="",s=0,i=0,l=r.y,o,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:o=l%100,u=2;break;default:o=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:o=r.m,u=t.length;break;case 3:return T0[r.m-1][1];case 5:return T0[r.m-1][0];default:return T0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:o=r.d,u=t.length;break;case 3:return lm[r.q][0];default:return lm[r.q][1]}break;case 104:switch(t.length){case 1:case 2:o=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:o=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:o=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?za(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=za(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":o=r.D*24+r.H;break;case"[m]":case"[mm]":o=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":o=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:o=l,u=1;break}var f=u>0?za(o,u):"";return f}function js(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var ev=/%/g;function uS(e,t,r){var n=t.replace(ev,""),a=t.length-n.length;return os(e,n,r*Math.pow(10,2*a))+Br("%",a)}function fS(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return os(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function tv(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tv(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,o,u,f){return o+u+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var rv=/# (\?+)( ?)\/( ?)(\d+)/;function dS(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,l=n;return r+(s===0?"":""+s)+" "+(i===0?Br(" ",e[1].length+1+e[4].length):eh(i,e[1].length)+e[2]+"/"+e[3]+za(l,e[4].length))}function hS(e,t,r){return r+(t===0?"":""+t)+Br(" ",e[1].length+2+e[4].length)}var nv=/^#*0*\.([0#]+)/,av=/\).*[0#]/,sv=/\(###\) ###\\?-####/;function zn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function cm(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function um(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function pS(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function mS(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ma(e,t,r){if(e.charCodeAt(0)===40&&!t.match(av)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ma("n",n,r):"("+ma("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return fS(e,t,r);if(t.indexOf("%")!==-1)return uS(e,t,r);if(t.indexOf("E")!==-1)return tv(t,r);if(t.charCodeAt(0)===36)return"$"+ma(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,l,o=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ii(o,t.length);if(t.match(/^[#?]+$/))return a=Ii(r,0),a==="0"&&(a=""),a.length>t.length?a:zn(t.substr(0,t.length-a.length))+a;if(s=t.match(rv))return dS(s,o,u);if(t.match(/^#+0+$/))return u+Ii(o,t.length-t.indexOf("0"));if(s=t.match(nv))return a=cm(r,s[1].length).replace(/^([^\.]+)$/,"$1."+zn(s[1])).replace(/\.$/,"."+zn(s[1])).replace(/\.(\d*)$/,function(m,x){return"."+x+Br("0",zn(s[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+cm(o,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+js(Ii(o,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ma(e,t,-r):js(""+(Math.floor(r)+pS(r,s[1].length)))+"."+za(um(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return ma(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=nl(ma(e,t.replace(/[\\-]/g,""),r)),i=0,nl(nl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<a.length?a.charAt(i++):m==="0"?"0":""}));if(t.match(sv))return a=ma(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),l=gu(o,Math.pow(10,i)-1,!1),a=""+u,f=os("n",s[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=mu(l[2],i),f.length<s[4].length&&(f=zn(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),l=gu(o,Math.pow(10,i)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?eh(l[1],i)+s[2]+"/"+s[3]+mu(l[2],i):Br(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Ii(r,0),t.length<=a.length?a:zn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,p=t.length-a.length-d;return zn(t.substr(0,d)+a+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=um(r,s[1].length),r<0?"-"+ma(e,t,-r):js(mS(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?za(0,3-m.length):"")+m})+"."+za(i,s[1].length);switch(t){case"###,##0.00":return ma(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=js(Ii(o,0));return h!=="0"?u+h:"";case"###,###.00":return ma(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ma(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function xS(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return os(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function gS(e,t,r){var n=t.replace(ev,""),a=t.length-n.length;return os(e,n,r*Math.pow(10,2*a))+Br("%",a)}function iv(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+iv(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,o,u,f){return o+u+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ha(e,t,r){if(e.charCodeAt(0)===40&&!t.match(av)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ha("n",n,r):"("+Ha("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return xS(e,t,r);if(t.indexOf("%")!==-1)return gS(e,t,r);if(t.indexOf("E")!==-1)return iv(t,r);if(t.charCodeAt(0)===36)return"$"+Ha(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,l,o=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+za(o,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:zn(t.substr(0,t.length-a.length))+a;if(s=t.match(rv))return hS(s,o,u);if(t.match(/^#+0+$/))return u+za(o,t.length-t.indexOf("0"));if(s=t.match(nv))return a=(""+r).replace(/^([^\.]+)$/,"$1."+zn(s[1])).replace(/\.$/,"."+zn(s[1])),a=a.replace(/\.(\d*)$/,function(m,x){return"."+x+Br("0",zn(s[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+js(""+o);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ha(e,t,-r):js(""+r)+"."+Br("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Ha(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=nl(Ha(e,t.replace(/[\\-]/g,""),r)),i=0,nl(nl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<a.length?a.charAt(i++):m==="0"?"0":""}));if(t.match(sv))return a=Ha(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),l=gu(o,Math.pow(10,i)-1,!1),a=""+u,f=os("n",s[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=mu(l[2],i),f.length<s[4].length&&(f=zn(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),l=gu(o,Math.pow(10,i)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?eh(l[1],i)+s[2]+"/"+s[3]+mu(l[2],i):Br(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:zn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,p=t.length-a.length-d;return zn(t.substr(0,d)+a+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ha(e,t,-r):js(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?za(0,3-m.length):"")+m})+"."+za(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=js(""+o);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return Ha(e,t.slice(0,t.lastIndexOf(".")),r)+zn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function os(e,t,r){return(r|0)===r?Ha(e,t,r):ma(e,t,r)}function vS(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var lv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Sl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":xu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(lv))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function yS(e,t,r,n){for(var a=[],s="",i=0,l="",o="t",u,f,d,p="H";i<e.length;)switch(l=e.charAt(i)){case"G":if(!xu(e,i))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(d=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++i;break;case"\\":var h=e.charAt(++i),m=h==="("||h===")"?h:"t";a[a.length]={t:m,v:h},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=li(t,r,e.charAt(i+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},o=l,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=li(t,r),u==null))return"";for(s=l;++i<e.length&&e.charAt(i).toLowerCase()===l;)s+=l;l==="m"&&o.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=p),a[a.length]={t:l,v:s},o=l;break;case"A":case"a":case"":var x={t:l,v:l};if(u==null&&(u=li(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",p="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",i+=5,p="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",i+=5,p="h"):(x.t="t",++i),u==null&&x.t==="T")return"";a[a.length]=x,o=l;break;case"[":for(s=l;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(lv)){if(u==null&&(u=li(t,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},o=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Sl(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++i<e.length&&(l=e.charAt(i))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++i<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(i))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++i)===l;)s+=l;a[a.length]={t:l,v:s},o=l;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++i;break}var v=0,y=0,w;for(i=a.length-1,o="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=p,o="h",v<1&&(v=1);break;case"s":(w=a[i].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":o=a[i].t;break;case"m":o==="s"&&(a[i].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[i].v.match(/[Hh]/)&&(v=1),v<2&&a[i].v.match(/[Mm]/)&&(v=2),v<3&&a[i].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var g="",E;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=cS(a[i].t.charCodeAt(0),a[i].v,u,y),a[i].t="t";break;case"n":case"?":for(E=i+1;a[E]!=null&&((l=a[E].t)==="?"||l==="D"||(l===" "||l==="t")&&a[E+1]!=null&&(a[E+1].t==="?"||a[E+1].t==="t"&&a[E+1].v==="/")||a[i].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[E].v==="/"||a[E].v===" "&&a[E+1]!=null&&a[E+1].t=="?"));)a[i].v+=a[E].v,a[E]={v:"",t:";"},++E;g+=a[i].v,i=E-1;break;case"G":a[i].t="t",a[i].v=gi(t,r);break}var A="",z,b;if(g.length>0){g.charCodeAt(0)==40?(z=t<0&&g.charCodeAt(0)===45?-t:t,b=os("n",g,z)):(z=t<0&&n>1?-t:t,b=os("n",g,z),z<0&&a[0]&&a[0].t=="t"&&(b=b.substr(1),a[0].v="-"+a[0].v)),E=b.length-1;var S=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){S=i;break}var _=a.length;if(S===a.length&&b.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(E>=a[i].v.length-1?(E-=a[i].v.length,a[i].v=b.substr(E+1,a[i].v.length)):E<0?a[i].v="":(a[i].v=b.substr(0,E+1),E=-1),a[i].t="t",_=i);E>=0&&_<a.length&&(a[_].v=b.substr(0,E+1)+a[_].v)}else if(S!==a.length&&b.indexOf("E")===-1){for(E=b.indexOf(".")-1,i=S;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(f=a[i].v.indexOf(".")>-1&&i===S?a[i].v.indexOf(".")-1:a[i].v.length-1,A=a[i].v.substr(f+1);f>=0;--f)E>=0&&(a[i].v.charAt(f)==="0"||a[i].v.charAt(f)==="#")&&(A=b.charAt(E--)+A);a[i].v=A,a[i].t="t",_=i}for(E>=0&&_<a.length&&(a[_].v=b.substr(0,E+1)+a[_].v),E=b.indexOf(".")+1,i=S;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==S)){for(f=a[i].v.indexOf(".")>-1&&i===S?a[i].v.indexOf(".")+1:0,A=a[i].v.substr(0,f);f<a[i].v.length;++f)E<b.length&&(A+=b.charAt(E++));a[i].v=A,a[i].t="t",_=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(z=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=os(a[i].t,a[i].v,z),a[i].t="t");var T="";for(i=0;i!==a.length;++i)a[i]!=null&&(T+=a[i].v);return T}var fm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function dm(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function wS(e,t){var r=vS(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(fm),l=r[1].match(fm);return dm(t,i)?[n,r[0]]:dm(t,l)?[n,r[1]]:[n,r[i!=null&&l!=null?2:1]]}return[n,s]}function Sa(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Yt)[e],n==null&&(n=r.table&&r.table[om[e]]||Yt[om[e]]),n==null&&(n=rS[e]||"General");break}if(xu(n,0))return gi(t,r);t instanceof Date&&(t=q1(t,r.date1904));var a=wS(n,t);if(xu(a[1]))return gi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return yS(a[1],t,r,a[0])}function ui(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Yt[r]==null){t<0&&(t=r);continue}if(Yt[r]==e){t=r;break}}t<0&&(t=391)}return Yt[t]=e,t}function ov(){Yt=tS()}var kS={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},cv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function _S(e){var t=typeof e=="number"?Yt[e]:e;return t=t.replace(cv,"(\\d+)"),new RegExp("^"+t+"$")}function SS(e,t,r){var n=-1,a=-1,s=-1,i=-1,l=-1,o=-1;(t.match(cv)||[]).forEach(function(d,p){var h=parseInt(r[p+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":i=h;break;case"s":o=h;break;case"m":i>=0?l=h:a=h;break}}),o>=0&&l==-1&&a>=0&&(l=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return i==-1&&l==-1&&o==-1?u:n==-1&&a==-1&&s==-1?f:u+"T"+f}var ES=function(){var e={};e.version="1.2.0";function t(){for(var b=0,S=new Array(256),_=0;_!=256;++_)b=_,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,S[_]=b;return typeof Int32Array<"u"?new Int32Array(S):S}var r=t();function n(b){var S=0,_=0,T=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(T=0;T!=256;++T)D[T]=b[T];for(T=0;T!=256;++T)for(_=b[T],S=256+T;S<4096;S+=256)_=D[S]=_>>>8^b[_&255];var M=[];for(T=1;T!=16;++T)M[T-1]=typeof Int32Array<"u"?D.subarray(T*256,T*256+256):D.slice(T*256,T*256+256);return M}var a=n(r),s=a[0],i=a[1],l=a[2],o=a[3],u=a[4],f=a[5],d=a[6],p=a[7],h=a[8],m=a[9],x=a[10],v=a[11],y=a[12],w=a[13],g=a[14];function E(b,S){for(var _=S^-1,T=0,D=b.length;T<D;)_=_>>>8^r[(_^b.charCodeAt(T++))&255];return~_}function A(b,S){for(var _=S^-1,T=b.length-15,D=0;D<T;)_=g[b[D++]^_&255]^w[b[D++]^_>>8&255]^y[b[D++]^_>>16&255]^v[b[D++]^_>>>24]^x[b[D++]]^m[b[D++]]^h[b[D++]]^p[b[D++]]^d[b[D++]]^f[b[D++]]^u[b[D++]]^o[b[D++]]^l[b[D++]]^i[b[D++]]^s[b[D++]]^r[b[D++]];for(T+=15;D<T;)_=_>>>8^r[(_^b[D++])&255];return~_}function z(b,S){for(var _=S^-1,T=0,D=b.length,M=0,G=0;T<D;)M=b.charCodeAt(T++),M<128?_=_>>>8^r[(_^M)&255]:M<2048?(_=_>>>8^r[(_^(192|M>>6&31))&255],_=_>>>8^r[(_^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,G=b.charCodeAt(T++)&1023,_=_>>>8^r[(_^(240|M>>8&7))&255],_=_>>>8^r[(_^(128|M>>2&63))&255],_=_>>>8^r[(_^(128|G>>6&15|(M&3)<<4))&255],_=_>>>8^r[(_^(128|G&63))&255]):(_=_>>>8^r[(_^(224|M>>12&15))&255],_=_>>>8^r[(_^(128|M>>6&63))&255],_=_>>>8^r[(_^(128|M&63))&255]);return~_}return e.table=r,e.bstr=E,e.buf=A,e.str=z,e}(),lr=function(){var t={};t.version="1.2.1";function r(N,P){for(var O=N.split("/"),I=P.split("/"),W=0,H=0,ce=Math.min(O.length,I.length);W<ce;++W){if(H=O[W].length-I[W].length)return H;if(O[W]!=I[W])return O[W]<I[W]?-1:1}return O.length-I.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var P=N.lastIndexOf("/");return P===-1?N:N.slice(0,P+1)}function a(N){if(N.charAt(N.length-1)=="/")return a(N.slice(0,-1));var P=N.lastIndexOf("/");return P===-1?N:N.slice(P+1)}function s(N,P){typeof P=="string"&&(P=new Date(P));var O=P.getHours();O=O<<6|P.getMinutes(),O=O<<5|P.getSeconds()>>>1,N.write_shift(2,O);var I=P.getFullYear()-1980;I=I<<4|P.getMonth()+1,I=I<<5|P.getDate(),N.write_shift(2,I)}function i(N){var P=N.read_shift(2)&65535,O=N.read_shift(2)&65535,I=new Date,W=O&31;O>>>=5;var H=O&15;O>>>=4,I.setMilliseconds(0),I.setFullYear(O+1980),I.setMonth(H-1),I.setDate(W);var ce=P&31;P>>>=5;var ve=P&63;return P>>>=6,I.setHours(P),I.setMinutes(ve),I.setSeconds(ce<<1),I}function l(N){hn(N,0);for(var P={},O=0;N.l<=N.length-4;){var I=N.read_shift(2),W=N.read_shift(2),H=N.l+W,ce={};switch(I){case 21589:O=N.read_shift(1),O&1&&(ce.mtime=N.read_shift(4)),W>5&&(O&2&&(ce.atime=N.read_shift(4)),O&4&&(ce.ctime=N.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}N.l=H,P[I]=ce}return P}var o;function u(){return o||(o={})}function f(N,P){if(N[0]==80&&N[1]==75)return Qe(N,P);if((N[0]|32)==109&&(N[1]|32)==105)return at(N,P);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var O=3,I=512,W=0,H=0,ce=0,ve=0,Z=0,fe=[],de=N.slice(0,512);hn(de,0);var Re=d(de);switch(O=Re[0],O){case 3:I=512;break;case 4:I=4096;break;case 0:if(Re[1]==0)return Qe(N,P);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}I!==512&&(de=N.slice(0,I),hn(de,28));var Ge=N.slice(0,I);p(de,O);var Je=de.read_shift(4,"i");if(O===3&&Je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Je);de.l+=4,ce=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),ve=de.read_shift(4,"i"),W=de.read_shift(4,"i"),Z=de.read_shift(4,"i"),H=de.read_shift(4,"i");for(var Ue=-1,U=0;U<109&&(Ue=de.read_shift(4,"i"),!(Ue<0));++U)fe[U]=Ue;var ae=h(N,I);v(Z,H,ae,I,fe);var me=w(ae,ce,fe,I);me[ce].name="!Directory",W>0&&ve!==G&&(me[ve].name="!MiniFAT"),me[fe[0]].name="!FAT",me.fat_addrs=fe,me.ssz=I;var Te={},Ye=[],wt=[],We=[];g(ce,me,ae,Ye,W,Te,wt,ve),m(wt,We,Ye),Ye.shift();var ze={FileIndex:wt,FullPaths:We};return P&&P.raw&&(ze.raw={header:Ge,sectors:ae}),ze}function d(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(Y,"Header Signature: "),N.l+=16;var P=N.read_shift(2,"u");return[N.read_shift(2,"u"),P]}function p(N,P){var O=9;switch(N.l+=2,O=N.read_shift(2)){case 9:if(P!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(P!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function h(N,P){for(var O=Math.ceil(N.length/P)-1,I=[],W=1;W<O;++W)I[W-1]=N.slice(W*P,(W+1)*P);return I[O-1]=N.slice(O*P),I}function m(N,P,O){for(var I=0,W=0,H=0,ce=0,ve=0,Z=O.length,fe=[],de=[];I<Z;++I)fe[I]=de[I]=I,P[I]=O[I];for(;ve<de.length;++ve)I=de[ve],W=N[I].L,H=N[I].R,ce=N[I].C,fe[I]===I&&(W!==-1&&fe[W]!==W&&(fe[I]=fe[W]),H!==-1&&fe[H]!==H&&(fe[I]=fe[H])),ce!==-1&&(fe[ce]=I),W!==-1&&I!=fe[I]&&(fe[W]=fe[I],de.lastIndexOf(W)<ve&&de.push(W)),H!==-1&&I!=fe[I]&&(fe[H]=fe[I],de.lastIndexOf(H)<ve&&de.push(H));for(I=1;I<Z;++I)fe[I]===I&&(H!==-1&&fe[H]!==H?fe[I]=fe[H]:W!==-1&&fe[W]!==W&&(fe[I]=fe[W]));for(I=1;I<Z;++I)if(N[I].type!==0){if(ve=I,ve!=fe[ve])do ve=fe[ve],P[I]=P[ve]+"/"+P[I];while(ve!==0&&fe[ve]!==-1&&ve!=fe[ve]);fe[I]=-1}for(P[0]+="/",I=1;I<Z;++I)N[I].type!==2&&(P[I]+="/")}function x(N,P,O){for(var I=N.start,W=N.size,H=[],ce=I;O&&W>0&&ce>=0;)H.push(P.slice(ce*M,ce*M+M)),W-=M,ce=ni(O,ce*4);return H.length===0?Zr(0):Cs(H).slice(0,N.size)}function v(N,P,O,I,W){var H=G;if(N===G){if(P!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var ce=O[N],ve=(I>>>2)-1;if(!ce)return;for(var Z=0;Z<ve&&(H=ni(ce,Z*4))!==G;++Z)W.push(H);v(ni(ce,I-4),P-1,O,I,W)}}function y(N,P,O,I,W){var H=[],ce=[];W||(W=[]);var ve=I-1,Z=0,fe=0;for(Z=P;Z>=0;){W[Z]=!0,H[H.length]=Z,ce.push(N[Z]);var de=O[Math.floor(Z*4/I)];if(fe=Z*4&ve,I<4+fe)throw new Error("FAT boundary crossed: "+Z+" 4 "+I);if(!N[de])break;Z=ni(N[de],fe)}return{nodes:H,data:_m([ce])}}function w(N,P,O,I){var W=N.length,H=[],ce=[],ve=[],Z=[],fe=I-1,de=0,Re=0,Ge=0,Je=0;for(de=0;de<W;++de)if(ve=[],Ge=de+P,Ge>=W&&(Ge-=W),!ce[Ge]){Z=[];var Ue=[];for(Re=Ge;Re>=0;){Ue[Re]=!0,ce[Re]=!0,ve[ve.length]=Re,Z.push(N[Re]);var U=O[Math.floor(Re*4/I)];if(Je=Re*4&fe,I<4+Je)throw new Error("FAT boundary crossed: "+Re+" 4 "+I);if(!N[U]||(Re=ni(N[U],Je),Ue[Re]))break}H[Ge]={nodes:ve,data:_m([Z])}}return H}function g(N,P,O,I,W,H,ce,ve){for(var Z=0,fe=I.length?2:0,de=P[N].data,Re=0,Ge=0,Je;Re<de.length;Re+=128){var Ue=de.slice(Re,Re+128);hn(Ue,64),Ge=Ue.read_shift(2),Je=ih(Ue,0,Ge-fe),I.push(Je);var U={name:Je,type:Ue.read_shift(1),color:Ue.read_shift(1),L:Ue.read_shift(4,"i"),R:Ue.read_shift(4,"i"),C:Ue.read_shift(4,"i"),clsid:Ue.read_shift(16),state:Ue.read_shift(4,"i"),start:0,size:0},ae=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);ae!==0&&(U.ct=E(Ue,Ue.l-8));var me=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);me!==0&&(U.mt=E(Ue,Ue.l-8)),U.start=Ue.read_shift(4,"i"),U.size=Ue.read_shift(4,"i"),U.size<0&&U.start<0&&(U.size=U.type=0,U.start=G,U.name=""),U.type===5?(Z=U.start,W>0&&Z!==G&&(P[Z].name="!StreamData")):U.size>=4096?(U.storage="fat",P[U.start]===void 0&&(P[U.start]=y(O,U.start,P.fat_addrs,P.ssz)),P[U.start].name=U.name,U.content=P[U.start].data.slice(0,U.size)):(U.storage="minifat",U.size<0?U.size=0:Z!==G&&U.start!==G&&P[Z]&&(U.content=x(U,P[Z].data,(P[ve]||{}).data))),U.content&&hn(U.content,0),H[Je]=U,ce.push(U)}}function E(N,P){return new Date((na(N,P+4)/1e7*Math.pow(2,32)+na(N,P)/1e7-11644473600)*1e3)}function A(N,P){return u(),f(o.readFileSync(N),P)}function z(N,P){var O=P&&P.type;switch(O||ar&&Buffer.isBuffer(N)&&(O="buffer"),O||"base64"){case"file":return A(N,P);case"base64":return f(Ra(ca(N)),P);case"binary":return f(Ra(N),P)}return f(N,P)}function b(N,P){var O=P||{},I=O.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=I+"/",N.FileIndex[0]={name:I,type:5}),O.CLSID&&(N.FileIndex[0].clsid=O.CLSID),S(N)}function S(N){var P="Sh33tJ5";if(!lr.find(N,"/"+P)){var O=Zr(4);O[0]=55,O[1]=O[3]=50,O[2]=54,N.FileIndex.push({name:P,type:2,content:O,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+P),_(N)}}function _(N,P){b(N);for(var O=!1,I=!1,W=N.FullPaths.length-1;W>=0;--W){var H=N.FileIndex[W];switch(H.type){case 0:I?O=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:I=!0,isNaN(H.R*H.L*H.C)&&(O=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!P)){var ce=new Date(1987,1,19),ve=0,Z=Object.create?Object.create(null):{},fe=[];for(W=0;W<N.FullPaths.length;++W)Z[N.FullPaths[W]]=!0,N.FileIndex[W].type!==0&&fe.push([N.FullPaths[W],N.FileIndex[W]]);for(W=0;W<fe.length;++W){var de=n(fe[W][0]);I=Z[de],I||(fe.push([de,{name:a(de).replace("/",""),type:1,clsid:Q,ct:ce,mt:ce,content:null}]),Z[de]=!0)}for(fe.sort(function(Je,Ue){return r(Je[0],Ue[0])}),N.FullPaths=[],N.FileIndex=[],W=0;W<fe.length;++W)N.FullPaths[W]=fe[W][0],N.FileIndex[W]=fe[W][1];for(W=0;W<fe.length;++W){var Re=N.FileIndex[W],Ge=N.FullPaths[W];if(Re.name=a(Ge).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||Q,W===0)Re.C=fe.length>1?1:-1,Re.size=0,Re.type=5;else if(Ge.slice(-1)=="/"){for(ve=W+1;ve<fe.length&&n(N.FullPaths[ve])!=Ge;++ve);for(Re.C=ve>=fe.length?-1:ve,ve=W+1;ve<fe.length&&n(N.FullPaths[ve])!=n(Ge);++ve);Re.R=ve>=fe.length?-1:ve,Re.type=1}else n(N.FullPaths[W+1]||"")==n(Ge)&&(Re.R=W+1),Re.type=2}}}function T(N,P){var O=P||{};if(O.fileType=="mad")return rr(N,O);switch(_(N),O.fileType){case"zip":return je(N,O)}var I=function(Je){for(var Ue=0,U=0,ae=0;ae<Je.FileIndex.length;++ae){var me=Je.FileIndex[ae];if(me.content){var Te=me.content.length;Te>0&&(Te<4096?Ue+=Te+63>>6:U+=Te+511>>9)}}for(var Ye=Je.FullPaths.length+3>>2,wt=Ue+7>>3,We=Ue+127>>7,ze=wt+U+Ye+We,ct=ze+127>>7,ie=ct<=109?0:Math.ceil((ct-109)/127);ze+ct+ie+127>>7>ct;)ie=++ct<=109?0:Math.ceil((ct-109)/127);var $e=[1,ie,ct,We,Ye,U,Ue,0];return Je.FileIndex[0].size=Ue<<6,$e[7]=(Je.FileIndex[0].start=$e[0]+$e[1]+$e[2]+$e[3]+$e[4]+$e[5])+($e[6]+7>>3),$e}(N),W=Zr(I[7]<<9),H=0,ce=0;{for(H=0;H<8;++H)W.write_shift(1,J[H]);for(H=0;H<8;++H)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),H=0;H<3;++H)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,I[2]),W.write_shift(4,I[0]+I[1]+I[2]+I[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,I[3]?I[0]+I[1]+I[2]-1:G),W.write_shift(4,I[3]),W.write_shift(-4,I[1]?I[0]-1:G),W.write_shift(4,I[1]),H=0;H<109;++H)W.write_shift(-4,H<I[2]?I[1]+H:-1)}if(I[1])for(ce=0;ce<I[1];++ce){for(;H<236+ce*127;++H)W.write_shift(-4,H<I[2]?I[1]+H:-1);W.write_shift(-4,ce===I[1]-1?G:ce+1)}var ve=function(Je){for(ce+=Je;H<ce-1;++H)W.write_shift(-4,H+1);Je&&(++H,W.write_shift(-4,G))};for(ce=H=0,ce+=I[1];H<ce;++H)W.write_shift(-4,X.DIFSECT);for(ce+=I[2];H<ce;++H)W.write_shift(-4,X.FATSECT);ve(I[3]),ve(I[4]);for(var Z=0,fe=0,de=N.FileIndex[0];Z<N.FileIndex.length;++Z)de=N.FileIndex[Z],de.content&&(fe=de.content.length,!(fe<4096)&&(de.start=ce,ve(fe+511>>9)));for(ve(I[6]+7>>3);W.l&511;)W.write_shift(-4,X.ENDOFCHAIN);for(ce=H=0,Z=0;Z<N.FileIndex.length;++Z)de=N.FileIndex[Z],de.content&&(fe=de.content.length,!(!fe||fe>=4096)&&(de.start=ce,ve(fe+63>>6)));for(;W.l&511;)W.write_shift(-4,X.ENDOFCHAIN);for(H=0;H<I[4]<<2;++H){var Re=N.FullPaths[H];if(!Re||Re.length===0){for(Z=0;Z<17;++Z)W.write_shift(4,0);for(Z=0;Z<3;++Z)W.write_shift(4,-1);for(Z=0;Z<12;++Z)W.write_shift(4,0);continue}de=N.FileIndex[H],H===0&&(de.start=de.size?de.start-1:G);var Ge=H===0&&O.root||de.name;if(fe=2*(Ge.length+1),W.write_shift(64,Ge,"utf16le"),W.write_shift(2,fe),W.write_shift(1,de.type),W.write_shift(1,de.color),W.write_shift(-4,de.L),W.write_shift(-4,de.R),W.write_shift(-4,de.C),de.clsid)W.write_shift(16,de.clsid,"hex");else for(Z=0;Z<4;++Z)W.write_shift(4,0);W.write_shift(4,de.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,de.start),W.write_shift(4,de.size),W.write_shift(4,0)}for(H=1;H<N.FileIndex.length;++H)if(de=N.FileIndex[H],de.size>=4096)if(W.l=de.start+1<<9,ar&&Buffer.isBuffer(de.content))de.content.copy(W,W.l,0,de.size),W.l+=de.size+511&-512;else{for(Z=0;Z<de.size;++Z)W.write_shift(1,de.content[Z]);for(;Z&511;++Z)W.write_shift(1,0)}for(H=1;H<N.FileIndex.length;++H)if(de=N.FileIndex[H],de.size>0&&de.size<4096)if(ar&&Buffer.isBuffer(de.content))de.content.copy(W,W.l,0,de.size),W.l+=de.size+63&-64;else{for(Z=0;Z<de.size;++Z)W.write_shift(1,de.content[Z]);for(;Z&63;++Z)W.write_shift(1,0)}if(ar)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function D(N,P){var O=N.FullPaths.map(function(Z){return Z.toUpperCase()}),I=O.map(function(Z){var fe=Z.split("/");return fe[fe.length-(Z.slice(-1)=="/"?2:1)]}),W=!1;P.charCodeAt(0)===47?(W=!0,P=O[0].slice(0,-1)+P):W=P.indexOf("/")!==-1;var H=P.toUpperCase(),ce=W===!0?O.indexOf(H):I.indexOf(H);if(ce!==-1)return N.FileIndex[ce];var ve=!H.match(Hl);for(H=H.replace(Dn,""),ve&&(H=H.replace(Hl,"!")),ce=0;ce<O.length;++ce)if((ve?O[ce].replace(Hl,"!"):O[ce]).replace(Dn,"")==H||(ve?I[ce].replace(Hl,"!"):I[ce]).replace(Dn,"")==H)return N.FileIndex[ce];return null}var M=64,G=-2,Y="d0cf11e0a1b11ae1",J=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",X={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:G,FREESECT:-1,HEADER_SIGNATURE:Y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(N,P,O){u();var I=T(N,O);o.writeFileSync(P,I)}function F(N){for(var P=new Array(N.length),O=0;O<N.length;++O)P[O]=String.fromCharCode(N[O]);return P.join("")}function le(N,P){var O=T(N,P);switch(P&&P.type||"buffer"){case"file":return u(),o.writeFileSync(P.filename,O),O;case"binary":return typeof O=="string"?O:F(O);case"base64":return am(typeof O=="string"?O:F(O));case"buffer":if(ar)return Buffer.isBuffer(O)?O:_i(O);case"array":return typeof O=="string"?Ra(O):O}return O}var re;function j(N){try{var P=N.InflateRaw,O=new P;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)re=N;else throw new Error("zlib does not expose bytesRead")}catch(I){console.error("cannot use native zlib: "+(I.message||I))}}function R(N,P){if(!re)return Lt(N,P);var O=re.InflateRaw,I=new O,W=I._processChunk(N.slice(N.l),I._finishFlushFlag);return N.l+=I.bytesRead,W}function B(N){return re?re.deflateRawSync(N):Xe(N)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ke=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function _e(N){var P=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(P>>16|P>>8|P)&255}for(var ge=typeof Uint8Array<"u",ye=ge?new Uint8Array(256):[],Ee=0;Ee<256;++Ee)ye[Ee]=_e(Ee);function C(N,P){var O=ye[N&255];return P<=8?O>>>8-P:(O=O<<8|ye[N>>8&255],P<=16?O>>>16-P:(O=O<<8|ye[N>>16&255],O>>>24-P))}function we(N,P){var O=P&7,I=P>>>3;return(N[I]|(O<=6?0:N[I+1]<<8))>>>O&3}function he(N,P){var O=P&7,I=P>>>3;return(N[I]|(O<=5?0:N[I+1]<<8))>>>O&7}function Ce(N,P){var O=P&7,I=P>>>3;return(N[I]|(O<=4?0:N[I+1]<<8))>>>O&15}function Ae(N,P){var O=P&7,I=P>>>3;return(N[I]|(O<=3?0:N[I+1]<<8))>>>O&31}function be(N,P){var O=P&7,I=P>>>3;return(N[I]|(O<=1?0:N[I+1]<<8))>>>O&127}function qe(N,P,O){var I=P&7,W=P>>>3,H=(1<<O)-1,ce=N[W]>>>I;return O<8-I||(ce|=N[W+1]<<8-I,O<16-I)||(ce|=N[W+2]<<16-I,O<24-I)||(ce|=N[W+3]<<24-I),ce&H}function Ie(N,P,O){var I=P&7,W=P>>>3;return I<=5?N[W]|=(O&7)<<I:(N[W]|=O<<I&255,N[W+1]=(O&7)>>8-I),P+3}function ht(N,P,O){var I=P&7,W=P>>>3;return O=(O&1)<<I,N[W]|=O,P+1}function yt(N,P,O){var I=P&7,W=P>>>3;return O<<=I,N[W]|=O&255,O>>>=8,N[W+1]=O,P+8}function Pt(N,P,O){var I=P&7,W=P>>>3;return O<<=I,N[W]|=O&255,O>>>=8,N[W+1]=O&255,N[W+2]=O>>>8,P+16}function Fe(N,P){var O=N.length,I=2*O>P?2*O:P+5,W=0;if(O>=P)return N;if(ar){var H=sm(I);if(N.copy)N.copy(H);else for(;W<N.length;++W)H[W]=N[W];return H}else if(ge){var ce=new Uint8Array(I);if(ce.set)ce.set(N);else for(;W<O;++W)ce[W]=N[W];return ce}return N.length=I,N}function vt(N){for(var P=new Array(N),O=0;O<N;++O)P[O]=0;return P}function jt(N,P,O){var I=1,W=0,H=0,ce=0,ve=0,Z=N.length,fe=ge?new Uint16Array(32):vt(32);for(H=0;H<32;++H)fe[H]=0;for(H=Z;H<O;++H)N[H]=0;Z=N.length;var de=ge?new Uint16Array(Z):vt(Z);for(H=0;H<Z;++H)fe[W=N[H]]++,I<W&&(I=W),de[H]=0;for(fe[0]=0,H=1;H<=I;++H)fe[H+16]=ve=ve+fe[H-1]<<1;for(H=0;H<Z;++H)ve=N[H],ve!=0&&(de[H]=fe[ve+16]++);var Re=0;for(H=0;H<Z;++H)if(Re=N[H],Re!=0)for(ve=C(de[H],I)>>I-Re,ce=(1<<I+4-Re)-1;ce>=0;--ce)P[ve|ce<<Re]=Re&15|H<<4;return I}var ft=ge?new Uint16Array(512):vt(512),kt=ge?new Uint16Array(32):vt(32);if(!ge){for(var Se=0;Se<512;++Se)ft[Se]=0;for(Se=0;Se<32;++Se)kt[Se]=0}(function(){for(var N=[],P=0;P<32;P++)N.push(5);jt(N,kt,32);var O=[];for(P=0;P<=143;P++)O.push(8);for(;P<=255;P++)O.push(9);for(;P<=279;P++)O.push(7);for(;P<=287;P++)O.push(8);jt(O,ft,288)})();var ot=function(){for(var P=ge?new Uint8Array(32768):[],O=0,I=0;O<ke.length-1;++O)for(;I<ke[O+1];++I)P[I]=O;for(;I<32768;++I)P[I]=29;var W=ge?new Uint8Array(259):[];for(O=0,I=0;O<te.length-1;++O)for(;I<te[O+1];++I)W[I]=O;function H(ve,Z){for(var fe=0;fe<ve.length;){var de=Math.min(65535,ve.length-fe),Re=fe+de==ve.length;for(Z.write_shift(1,+Re),Z.write_shift(2,de),Z.write_shift(2,~de&65535);de-- >0;)Z[Z.l++]=ve[fe++]}return Z.l}function ce(ve,Z){for(var fe=0,de=0,Re=ge?new Uint16Array(32768):[];de<ve.length;){var Ge=Math.min(65535,ve.length-de);if(Ge<10){for(fe=Ie(Z,fe,+(de+Ge==ve.length)),fe&7&&(fe+=8-(fe&7)),Z.l=fe/8|0,Z.write_shift(2,Ge),Z.write_shift(2,~Ge&65535);Ge-- >0;)Z[Z.l++]=ve[de++];fe=Z.l*8;continue}fe=Ie(Z,fe,+(de+Ge==ve.length)+2);for(var Je=0;Ge-- >0;){var Ue=ve[de];Je=(Je<<5^Ue)&32767;var U=-1,ae=0;if((U=Re[Je])&&(U|=de&-32768,U>de&&(U-=32768),U<de))for(;ve[U+ae]==ve[de+ae]&&ae<250;)++ae;if(ae>2){Ue=W[ae],Ue<=22?fe=yt(Z,fe,ye[Ue+1]>>1)-1:(yt(Z,fe,3),fe+=5,yt(Z,fe,ye[Ue-23]>>5),fe+=3);var me=Ue<8?0:Ue-4>>2;me>0&&(Pt(Z,fe,ae-te[Ue]),fe+=me),Ue=P[de-U],fe=yt(Z,fe,ye[Ue]>>3),fe-=3;var Te=Ue<4?0:Ue-2>>1;Te>0&&(Pt(Z,fe,de-U-ke[Ue]),fe+=Te);for(var Ye=0;Ye<ae;++Ye)Re[Je]=de&32767,Je=(Je<<5^ve[de])&32767,++de;Ge-=ae-1}else Ue<=143?Ue=Ue+48:fe=ht(Z,fe,1),fe=yt(Z,fe,ye[Ue]),Re[Je]=de&32767,++de}fe=yt(Z,fe,0)-1}return Z.l=(fe+7)/8|0,Z.l}return function(Z,fe){return Z.length<8?H(Z,fe):ce(Z,fe)}}();function Xe(N){var P=Zr(50+Math.floor(N.length*1.1)),O=ot(N,P);return P.slice(0,O)}var Rt=ge?new Uint16Array(32768):vt(32768),q=ge?new Uint16Array(32768):vt(32768),oe=ge?new Uint16Array(128):vt(128),pe=1,He=1;function st(N,P){var O=Ae(N,P)+257;P+=5;var I=Ae(N,P)+1;P+=5;var W=Ce(N,P)+4;P+=4;for(var H=0,ce=ge?new Uint8Array(19):vt(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=1,fe=ge?new Uint8Array(8):vt(8),de=ge?new Uint8Array(8):vt(8),Re=ce.length,Ge=0;Ge<W;++Ge)ce[V[Ge]]=H=he(N,P),Z<H&&(Z=H),fe[H]++,P+=3;var Je=0;for(fe[0]=0,Ge=1;Ge<=Z;++Ge)de[Ge]=Je=Je+fe[Ge-1]<<1;for(Ge=0;Ge<Re;++Ge)(Je=ce[Ge])!=0&&(ve[Ge]=de[Je]++);var Ue=0;for(Ge=0;Ge<Re;++Ge)if(Ue=ce[Ge],Ue!=0){Je=ye[ve[Ge]]>>8-Ue;for(var U=(1<<7-Ue)-1;U>=0;--U)oe[Je|U<<Ue]=Ue&7|Ge<<3}var ae=[];for(Z=1;ae.length<O+I;)switch(Je=oe[be(N,P)],P+=Je&7,Je>>>=3){case 16:for(H=3+we(N,P),P+=2,Je=ae[ae.length-1];H-- >0;)ae.push(Je);break;case 17:for(H=3+he(N,P),P+=3;H-- >0;)ae.push(0);break;case 18:for(H=11+be(N,P),P+=7;H-- >0;)ae.push(0);break;default:ae.push(Je),Z<Je&&(Z=Je);break}var me=ae.slice(0,O),Te=ae.slice(O);for(Ge=O;Ge<286;++Ge)me[Ge]=0;for(Ge=I;Ge<30;++Ge)Te[Ge]=0;return pe=jt(me,Rt,286),He=jt(Te,q,30),P}function _t(N,P){if(N[0]==3&&!(N[1]&3))return[Ws(P),2];for(var O=0,I=0,W=sm(P||1<<18),H=0,ce=W.length>>>0,ve=0,Z=0;!(I&1);){if(I=he(N,O),O+=3,I>>>1)I>>1==1?(ve=9,Z=5):(O=st(N,O),ve=pe,Z=He);else{O&7&&(O+=8-(O&7));var fe=N[O>>>3]|N[(O>>>3)+1]<<8;if(O+=32,fe>0)for(!P&&ce<H+fe&&(W=Fe(W,H+fe),ce=W.length);fe-- >0;)W[H++]=N[O>>>3],O+=8;continue}for(;;){!P&&ce<H+32767&&(W=Fe(W,H+32767),ce=W.length);var de=qe(N,O,ve),Re=I>>>1==1?ft[de]:Rt[de];if(O+=Re&15,Re>>>=4,!(Re>>>8&255))W[H++]=Re;else{if(Re==256)break;Re-=257;var Ge=Re<8?0:Re-4>>2;Ge>5&&(Ge=0);var Je=H+te[Re];Ge>0&&(Je+=qe(N,O,Ge),O+=Ge),de=qe(N,O,Z),Re=I>>>1==1?kt[de]:q[de],O+=Re&15,Re>>>=4;var Ue=Re<4?0:Re-2>>1,U=ke[Re];for(Ue>0&&(U+=qe(N,O,Ue),O+=Ue),!P&&ce<Je&&(W=Fe(W,Je+100),ce=W.length);H<Je;)W[H]=W[H-U],++H}}}return P?[W,O+7>>>3]:[W.slice(0,H),O+7>>>3]}function Lt(N,P){var O=N.slice(N.l||0),I=_t(O,P);return N.l+=I[1],I[0]}function xr(N,P){if(N)typeof console<"u"&&console.error(P);else throw new Error(P)}function Qe(N,P){var O=N;hn(O,0);var I=[],W=[],H={FileIndex:I,FullPaths:W};b(H,{root:P.root});for(var ce=O.length-4;(O[ce]!=80||O[ce+1]!=75||O[ce+2]!=5||O[ce+3]!=6)&&ce>=0;)--ce;O.l=ce+4,O.l+=4;var ve=O.read_shift(2);O.l+=6;var Z=O.read_shift(4);for(O.l=Z,ce=0;ce<ve;++ce){O.l+=20;var fe=O.read_shift(4),de=O.read_shift(4),Re=O.read_shift(2),Ge=O.read_shift(2),Je=O.read_shift(2);O.l+=8;var Ue=O.read_shift(4),U=l(O.slice(O.l+Re,O.l+Re+Ge));O.l+=Re+Ge+Je;var ae=O.l;O.l=Ue+4,rt(O,fe,de,H,U),O.l=ae}return H}function rt(N,P,O,I,W){N.l+=2;var H=N.read_shift(2),ce=N.read_shift(2),ve=i(N);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var Z=N.read_shift(4),fe=N.read_shift(4),de=N.read_shift(4),Re=N.read_shift(2),Ge=N.read_shift(2),Je="",Ue=0;Ue<Re;++Ue)Je+=String.fromCharCode(N[N.l++]);if(Ge){var U=l(N.slice(N.l,N.l+Ge));(U[21589]||{}).mt&&(ve=U[21589].mt),((W||{})[21589]||{}).mt&&(ve=W[21589].mt)}N.l+=Ge;var ae=N.slice(N.l,N.l+fe);switch(ce){case 8:ae=R(N,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var me=!1;H&8&&(Z=N.read_shift(4),Z==134695760&&(Z=N.read_shift(4),me=!0),fe=N.read_shift(4),de=N.read_shift(4)),fe!=P&&xr(me,"Bad compressed size: "+P+" != "+fe),de!=O&&xr(me,"Bad uncompressed size: "+O+" != "+de),hr(I,Je,ae,{unsafe:!0,mt:ve})}function je(N,P){var O=P||{},I=[],W=[],H=Zr(1),ce=O.compression?8:0,ve=0,Z=0,fe=0,de=0,Re=0,Ge=N.FullPaths[0],Je=Ge,Ue=N.FileIndex[0],U=[],ae=0;for(Z=1;Z<N.FullPaths.length;++Z)if(Je=N.FullPaths[Z].slice(Ge.length),Ue=N.FileIndex[Z],!(!Ue.size||!Ue.content||Je=="Sh33tJ5")){var me=de,Te=Zr(Je.length);for(fe=0;fe<Je.length;++fe)Te.write_shift(1,Je.charCodeAt(fe)&127);Te=Te.slice(0,Te.l),U[Re]=ES.buf(Ue.content,0);var Ye=Ue.content;ce==8&&(Ye=B(Ye)),H=Zr(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,ve),H.write_shift(2,ce),Ue.mt?s(H,Ue.mt):H.write_shift(4,0),H.write_shift(-4,U[Re]),H.write_shift(4,Ye.length),H.write_shift(4,Ue.content.length),H.write_shift(2,Te.length),H.write_shift(2,0),de+=H.length,I.push(H),de+=Te.length,I.push(Te),de+=Ye.length,I.push(Ye),H=Zr(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,ve),H.write_shift(2,ce),H.write_shift(4,0),H.write_shift(-4,U[Re]),H.write_shift(4,Ye.length),H.write_shift(4,Ue.content.length),H.write_shift(2,Te.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,me),ae+=H.l,W.push(H),ae+=Te.length,W.push(Te),++Re}return H=Zr(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,Re),H.write_shift(2,Re),H.write_shift(4,ae),H.write_shift(4,de),H.write_shift(2,0),Cs([Cs(I),Cs(W),H])}var Be={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ve(N,P){if(N.ctype)return N.ctype;var O=N.name||"",I=O.match(/\.([^\.]+)$/);return I&&Be[I[1]]||P&&(I=(O=P).match(/[\.\\]([^\.\\])+$/),I&&Be[I[1]])?Be[I[1]]:"application/octet-stream"}function Kt(N){for(var P=am(N),O=[],I=0;I<P.length;I+=76)O.push(P.slice(I,I+76));return O.join(`\r
`)+`\r
`}function St(N){var P=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(fe){var de=fe.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});P=P.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),P.charAt(0)==`
`&&(P="=0D"+P.slice(1)),P=P.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],I=P.split(`\r
`),W=0;W<I.length;++W){var H=I[W];if(H.length==0){O.push("");continue}for(var ce=0;ce<H.length;){var ve=76,Z=H.slice(ce,ce+ve);Z.charAt(ve-1)=="="?ve--:Z.charAt(ve-2)=="="?ve-=2:Z.charAt(ve-3)=="="&&(ve-=3),Z=H.slice(ce,ce+ve),ce+=ve,ce<H.length&&(Z+="="),O.push(Z)}}return O.join(`\r
`)}function yr(N){for(var P=[],O=0;O<N.length;++O){for(var I=N[O];O<=N.length&&I.charAt(I.length-1)=="=";)I=I.slice(0,I.length-1)+N[++O];P.push(I)}for(var W=0;W<P.length;++W)P[W]=P[W].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return Ra(P.join(`\r
`))}function Tt(N,P,O){for(var I="",W="",H="",ce,ve=0;ve<10;++ve){var Z=P[ve];if(!Z||Z.match(/^\s*$/))break;var fe=Z.match(/^(.*?):\s*([^\s].*)$/);if(fe)switch(fe[1].toLowerCase()){case"content-location":I=fe[2].trim();break;case"content-type":H=fe[2].trim();break;case"content-transfer-encoding":W=fe[2].trim();break}}switch(++ve,W.toLowerCase()){case"base64":ce=Ra(ca(P.slice(ve).join("")));break;case"quoted-printable":ce=yr(P.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var de=hr(N,I.slice(O.length),ce,{unsafe:!0});H&&(de.ctype=H)}function at(N,P){if(F(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=P&&P.root||"",I=(ar&&Buffer.isBuffer(N)?N.toString("binary"):F(N)).split(`\r
`),W=0,H="";for(W=0;W<I.length;++W)if(H=I[W],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),O||(O=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),H.slice(0,O.length)!=O););var ce=(I[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var ve="--"+(ce[1]||""),Z=[],fe=[],de={FileIndex:Z,FullPaths:fe};b(de);var Re,Ge=0;for(W=0;W<I.length;++W){var Je=I[W];Je!==ve&&Je!==ve+"--"||(Ge++&&Tt(de,I.slice(Re,W),O),Re=W)}return de}function rr(N,P){var O=P||{},I=O.boundary||"SheetJS";I="------="+I;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+I.slice(2)+'"',"","",""],H=N.FullPaths[0],ce=H,ve=N.FileIndex[0],Z=1;Z<N.FullPaths.length;++Z)if(ce=N.FullPaths[Z].slice(H.length),ve=N.FileIndex[Z],!(!ve.size||!ve.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ae){return"_x"+ae.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ae){return"_u"+ae.charCodeAt(0).toString(16)+"_"});for(var fe=ve.content,de=ar&&Buffer.isBuffer(fe)?fe.toString("binary"):F(fe),Re=0,Ge=Math.min(1024,de.length),Je=0,Ue=0;Ue<=Ge;++Ue)(Je=de.charCodeAt(Ue))>=32&&Je<128&&++Re;var U=Re>=Ge*4/5;W.push(I),W.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+ce),W.push("Content-Transfer-Encoding: "+(U?"quoted-printable":"base64")),W.push("Content-Type: "+Ve(ve,ce)),W.push(""),W.push(U?St(de):Kt(de))}return W.push(I+`--\r
`),W.join(`\r
`)}function er(N){var P={};return b(P,N),P}function hr(N,P,O,I){var W=I&&I.unsafe;W||b(N);var H=!W&&lr.find(N,P);if(!H){var ce=N.FullPaths[0];P.slice(0,ce.length)==ce?ce=P:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+P).replace("//","/")),H={name:a(P),type:2},N.FileIndex.push(H),N.FullPaths.push(ce),W||lr.utils.cfb_gc(N)}return H.content=O,H.size=O?O.length:0,I&&(I.CLSID&&(H.clsid=I.CLSID),I.mt&&(H.mt=I.mt),I.ct&&(H.ct=I.ct)),H}function pr(N,P){b(N);var O=lr.find(N,P);if(O){for(var I=0;I<N.FileIndex.length;++I)if(N.FileIndex[I]==O)return N.FileIndex.splice(I,1),N.FullPaths.splice(I,1),!0}return!1}function Ht(N,P,O){b(N);var I=lr.find(N,P);if(I){for(var W=0;W<N.FileIndex.length;++W)if(N.FileIndex[W]==I)return N.FileIndex[W].name=a(O),N.FullPaths[W]=O,!0}return!1}function Ot(N){_(N,!0)}return t.find=D,t.read=z,t.parse=f,t.write=le,t.writeFile=ee,t.utils={cfb_new:er,cfb_add:hr,cfb_del:pr,cfb_mov:Ht,cfb_gc:Ot,ReadShift:ro,CheckField:Fv,prep_blob:hn,bconcat:Cs,use_zlib:j,_deflateRaw:Xe,_inflateRaw:Lt,consts:X},t}();function bS(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ja(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function rh(e){for(var t=[],r=Ja(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var vu=new Date(1899,11,30,0,0,0);function Bn(e,t){var r=e.getTime(),n=vu.getTime()+(e.getTimezoneOffset()-vu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var uv=new Date,CS=vu.getTime()+(uv.getTimezoneOffset()-vu.getTimezoneOffset())*6e4,hm=uv.getTimezoneOffset();function Gu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+CS),t.getTimezoneOffset()!==hm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-hm)*6e4),t}function TS(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var pm=new Date("2017-02-19T19:06:09.000Z"),fv=isNaN(pm.getFullYear())?new Date("2/19/17"):pm,NS=fv.getFullYear()==2017;function cn(e,t){var r=new Date(e);if(NS)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(fv.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function vi(e,t){if(ar&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Gl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Gl(Q1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Gl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Gl(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function mn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=mn(e[r]));return t}function Br(e,t){for(var r="";r.length<t;)r+=e;return r}function Da(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var AS=["january","february","march","april","may","june","july","august","september","october","november","december"];function xl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&AS.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var jS=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],l=1;l<s.length;++l)i.push(a),i.push(s[l]);return i}}();function dv(e){return e?e.content&&e.type?vi(e.content,!0):e.data?Wl(e.data):e.asNodeBuffer&&ar?Wl(e.asNodeBuffer().toString("binary")):e.asBinary?Wl(e.asBinary()):e._data&&e._data.getContent?Wl(vi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function hv(e){if(!e)return null;if(e.data)return rm(e.data);if(e.asNodeBuffer&&ar)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?rm(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function FS(e){return e&&e.name.slice(-4)===".bin"?hv(e):dv(e)}function xa(e,t){for(var r=e.FullPaths||Ja(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function nh(e,t){var r=xa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Xr(e,t,r){if(!r)return FS(nh(e,t));if(!t)return null;try{return Xr(e,t)}catch{return null}}function aa(e,t,r){if(!r)return dv(nh(e,t));if(!t)return null;try{return aa(e,t)}catch{return null}}function MS(e,t,r){return hv(nh(e,t))}function mm(e){for(var t=e.FullPaths||Ja(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function RS(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ar?n=_i(r):n=Z_(r),lr.utils.cfb_add(e,t,n)}lr.utils.cfb_add(e,t,r)}else e.file(t,r)}function pv(e,t){switch(t.type){case"base64":return lr.read(e,{type:"base64"});case"binary":return lr.read(e,{type:"binary"});case"buffer":case"array":return lr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Vl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var mv=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,IS=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,xm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,zS=/<[^>]*>/g,Mn=mv.match(xm)?xm:zS,LS=/<\w*:/,OS=/<(\/?)\w+:/;function It(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(IS),l=0,o="",u=0,f="",d="",p=1;if(i)for(u=0;u!=i.length;++u){for(d=i[u],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(f=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(p=(a=d.charCodeAt(s+1))==34||a==39?1:0,o=d.slice(s+1+p,d.length-p),l=0;l!=f.length&&f.charCodeAt(l)!==58;++l);if(l===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=o,n[f.toLowerCase()]=o;else{var h=(l===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(l+1);if(n[h]&&f.slice(l-3,l)=="ext")continue;n[h]=o,n[h.toLowerCase()]=o}}return n}function Qa(e){return e.replace(OS,"<$1")}var xv={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},PS=rh(xv),dr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(l,o){return xv[l]||String.fromCharCode(parseInt(o,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,o){return String.fromCharCode(parseInt(o,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),DS=/[&<>'"]/g,BS=/[\u0000-\u001f]/g;function ah(e){var t=e+"";return t.replace(DS,function(r){return PS[r]}).replace(/\n/g,"<br/>").replace(BS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var gm=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function jr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function N0(e){for(var t="",r=0,n=0,a=0,s=0,i=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function vm(e){var t=Ws(2*e.length),r,n,a=1,s=0,i=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function ym(e){return _i(e,"binary").toString("utf8")}var yc="foo bar baz",br=ar&&(ym(yc)==N0(yc)&&ym||vm(yc)==N0(yc)&&vm)||N0,Gl=ar?function(e){return _i(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Mo=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),gv=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),US=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),$S=/<\/?(?:vt:)?variant>/g,WS=/<(?:vt:)([^>]*)>([\s\S]*)</;function wm(e,t){var r=It(e),n=e.match(US(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace($S,"").match(WS);i&&a.push({v:br(i[2]),t:i[1]})}),a}var HS=/(^\s|\s$|\n)/;function VS(e){return Ja(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function GS(e,t,r){return"<"+e+(r!=null?VS(r):"")+(t!=null?(t.match(HS)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function sh(e){if(ar&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return br(Si(qd(e)));throw new Error("Bad input format: expected Buffer or string")}var Ro=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,KS={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},XS=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function YS(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function JS(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var km=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},_m=ar?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:_i(t)})):km(e)}:km,Sm=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(ss(e,a)));return n.join("").replace(Dn,"")},ih=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Dn,""):Sm(e,t,r)}:Sm,Em=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},vv=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Em(e,t,r)}:Em,bm=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Li(e,a)));return n.join("")},Ho=ar?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):bm(t,r,n)}:bm,yv=function(e,t){var r=na(e,t);return r>0?Ho(e,t+4,t+4+r-1):""},wv=yv,kv=function(e,t){var r=na(e,t);return r>0?Ho(e,t+4,t+4+r-1):""},_v=kv,Sv=function(e,t){var r=2*na(e,t);return r>0?Ho(e,t+4,t+4+r-1):""},Ev=Sv,bv=function(t,r){var n=na(t,r);return n>0?ih(t,r+4,r+4+n):""},Cv=bv,Tv=function(e,t){var r=na(e,t);return r>0?Ho(e,t+4,t+4+r):""},Nv=Tv,Av=function(e,t){return YS(e,t)},yu=Av,jv=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ar&&(wv=function(t,r){if(!Buffer.isBuffer(t))return yv(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},_v=function(t,r){if(!Buffer.isBuffer(t))return kv(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Ev=function(t,r){if(!Buffer.isBuffer(t))return Sv(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Cv=function(t,r){if(!Buffer.isBuffer(t))return bv(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Nv=function(t,r){if(!Buffer.isBuffer(t))return Tv(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},yu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Av(t,r)},jv=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Li=function(e,t){return e[t]},ss=function(e,t){return e[t+1]*256+e[t]},QS=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},na=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ni=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},ZS=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ro(e,t){var r="",n,a,s=[],i,l,o,u;switch(t){case"dbcs":if(u=this.l,ar&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)r+=String.fromCharCode(ss(this,u)),u+=2;e*=2;break;case"utf8":r=Ho(this,this.l,this.l+e);break;case"utf16le":e*=2,r=ih(this,this.l,this.l+e);break;case"wstr":return ro.call(this,e,"dbcs");case"lpstr-ansi":r=wv(this,this.l),e=4+na(this,this.l);break;case"lpstr-cp":r=_v(this,this.l),e=4+na(this,this.l);break;case"lpwstr":r=Ev(this,this.l),e=4+2*na(this,this.l);break;case"lpp4":e=4+na(this,this.l),r=Cv(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+na(this,this.l),r=Nv(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Li(this,this.l+e++))!==0;)s.push(vc(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=ss(this,this.l+e))!==0;)s.push(vc(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,o=0;o<e;++o){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Li(this,u),this.l=u+1,l=ro.call(this,e-o,i?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(vc(ss(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,o=0;o!=e;++o){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Li(this,u),this.l=u+1,l=ro.call(this,e-o,i?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(vc(Li(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=Li(this,this.l),this.l++,n;case 2:return n=(t==="i"?QS:ss)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ni:ZS)(this,this.l),this.l+=4,n):(a=na(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=yu(this,this.l):a=yu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=vv(this,this.l,e);break}}return this.l+=e,r}var qS=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},eE=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},tE=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function rE(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)tE(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,qS(this,t,this.l);break;case 8:if(n=8,r==="f"){JS(this,t,this.l);break}case 16:break;case-4:n=4,eE(this,t,this.l);break}return this.l+=n,this}function Fv(e,t){var r=vv(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function hn(e,t){e.l=t,e.read_shift=ro,e.chk=Fv,e.write_shift=rE}function Fn(e,t){e.l+=t}function Zr(e){var t=Ws(e);return hn(t,0),t}function xs(e,t,r){if(e){var n,a,s;hn(e,e.l||0);for(var i=e.length,l=0,o=0;e.l<i;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=bu[l]||bu[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;o=e.l+s;var f=u.f&&u.f(e,s,r);if(e.l=o,t(f,u,l))return}}}function Bf(){var e=[],t=ar?256:2048,r=function(u){var f=Zr(u);return hn(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},i=function(){return a(),Cs(e)},l=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:i,_bufs:e}}function no(e,t,r){var n=mn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Cm(e,t,r){var n=mn(e);return n.s=no(n.s,t.s,r),n.e=no(n.e,t.s,r),n}function ao(e,t){if(e.cRel&&e.c<0)for(e=mn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=mn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Wt(e);return!e.cRel&&e.cRel!=null&&(r=sE(r)),!e.rRel&&e.rRel!=null&&(r=nE(r)),r}function A0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+tn(e.s.c)+":"+(e.e.cRel?"":"$")+tn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+xn(e.s.r)+":"+(e.e.rRel?"":"$")+xn(e.e.r):ao(e.s,t.biff)+":"+ao(e.e,t.biff)}function lh(e){return parseInt(aE(e),10)-1}function xn(e){return""+(e+1)}function nE(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function aE(e){return e.replace(/\$(\d+)$/,"$1")}function oh(e){for(var t=iE(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function tn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function sE(e){return e.replace(/^([A-Z])/,"$$$1")}function iE(e){return e.replace(/^\$([A-Z])/,"$1")}function lE(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function On(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Wt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function El(e){var t=e.indexOf(":");return t==-1?{s:On(e),e:On(e)}:{s:On(e.slice(0,t)),e:On(e.slice(t+1))}}function or(e,t){return typeof t>"u"||typeof t=="number"?or(e.s,e.e):(typeof e!="string"&&(e=Wt(e)),typeof t!="string"&&(t=Wt(t)),e==t?e:e+":"+t)}function Ur(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Tm(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Sa(e.z,r?Bn(t):t)}catch{}try{return e.w=Sa((e.XF||{}).numFmtId||(r?14:0),r?Bn(t):t)}catch{return""+t}}function ps(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ci[e.v]||e.v:t==null?Tm(e,e.v):Tm(e,t))}function Ys(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Mv(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?On(n.origin):n.origin;i=o.r,l=o.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Ur(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(u.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[d].length;++p)if(!(typeof t[d][p]>"u")){var h={v:t[d][p]},m=i+d,x=l+p;if(u.s.r>m&&(u.s.r=m),u.s.c>x&&(u.s.c=x),u.e.r<m&&(u.e.r=m),u.e.c<x&&(u.e.c=x),t[d][p]&&typeof t[d][p]=="object"&&!Array.isArray(t[d][p])&&!(t[d][p]instanceof Date))h=t[d][p];else if(Array.isArray(h.v)&&(h.f=t[d][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Yt[14],n.cellDates?(h.t="d",h.w=Sa(h.z,Bn(h.v))):(h.t="n",h.v=Bn(h.v),h.w=Sa(h.z,h.v))):h.t="s";if(a)s[m]||(s[m]=[]),s[m][x]&&s[m][x].z&&(h.z=s[m][x].z),s[m][x]=h;else{var v=Wt({c:x,r:m});s[v]&&s[v].z&&(h.z=s[v].z),s[v]=h}}}return u.s.c<1e7&&(s["!ref"]=or(u)),s}function bl(e,t){return Mv(null,e,t)}function oE(e){return e.read_shift(4,"i")}function An(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function cE(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ch(e,t){var r=e.l,n=e.read_shift(1),a=An(e),s=[],i={t:a,h:a};if(n&1){for(var l=e.read_shift(4),o=0;o!=l;++o)s.push(cE(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var uE=ch;function Ea(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ei(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var fE=An;function uh(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var dE=An,Uf=uh;function fh(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?yu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ni(t,0)>>2;return r?a/100:a}function Rv(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var bi=Rv;function Cn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function hE(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=fi[a];u&&(t.rgb=zo(u));break;case 2:t.rgb=zo([i,l,o]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function pE(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Iv(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function mE(e){return Iv(e,1)}function xE(e){return Iv(e,2)}var dh=2,Kn=3,wc=11,Nm=12,wu=19,kc=64,gE=65,vE=71,yE=4108,wE=4126,sn=80,zv=81,kE=[sn,zv],_E={1:{n:"CodePage",t:dh},2:{n:"Category",t:sn},3:{n:"PresentationFormat",t:sn},4:{n:"ByteCount",t:Kn},5:{n:"LineCount",t:Kn},6:{n:"ParagraphCount",t:Kn},7:{n:"SlideCount",t:Kn},8:{n:"NoteCount",t:Kn},9:{n:"HiddenCount",t:Kn},10:{n:"MultimediaClipCount",t:Kn},11:{n:"ScaleCrop",t:wc},12:{n:"HeadingPairs",t:yE},13:{n:"TitlesOfParts",t:wE},14:{n:"Manager",t:sn},15:{n:"Company",t:sn},16:{n:"LinksUpToDate",t:wc},17:{n:"CharacterCount",t:Kn},19:{n:"SharedDoc",t:wc},22:{n:"HyperlinksChanged",t:wc},23:{n:"AppVersion",t:Kn,p:"version"},24:{n:"DigSig",t:gE},26:{n:"ContentType",t:sn},27:{n:"ContentStatus",t:sn},28:{n:"Language",t:sn},29:{n:"Version",t:sn},255:{},2147483648:{n:"Locale",t:wu},2147483651:{n:"Behavior",t:wu},1919054434:{}},SE={1:{n:"CodePage",t:dh},2:{n:"Title",t:sn},3:{n:"Subject",t:sn},4:{n:"Author",t:sn},5:{n:"Keywords",t:sn},6:{n:"Comments",t:sn},7:{n:"Template",t:sn},8:{n:"LastAuthor",t:sn},9:{n:"RevNumber",t:sn},10:{n:"EditTime",t:kc},11:{n:"LastPrinted",t:kc},12:{n:"CreatedDate",t:kc},13:{n:"ModifiedDate",t:kc},14:{n:"PageCount",t:Kn},15:{n:"WordCount",t:Kn},16:{n:"CharCount",t:Kn},17:{n:"Thumbnail",t:vE},18:{n:"Application",t:sn},19:{n:"DocSecurity",t:Kn},255:{},2147483648:{n:"Locale",t:wu},2147483651:{n:"Behavior",t:wu},1919054434:{}},Am={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},EE=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function bE(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var CE=bE([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),fi=mn(CE),Ci={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Lv={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},jm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function TE(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function NE(e){var t=TE();if(!e||!e.match)return t;var r={};if((e.match(Mn)||[]).forEach(function(n){var a=It(n);switch(a[0].replace(LS,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[jm[a.ContentType]]!==void 0&&t[jm[a.ContentType]].push(a.PartName);break}}),t.xmlns!==KS.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Ji={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function $f(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function so(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Mn)||[]).forEach(function(a){var s=It(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:Vl(s.Target,t);r[l]=i,n[s.Id]=i}}),r["!id"]=n,r}var AE="application/vnd.oasis.opendocument.spreadsheet";function jE(e,t){for(var r=sh(e),n,a;n=Ro.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=It(n[0],!1),a.path=="/"&&a.type!==AE)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var io=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],FE=function(){for(var e=new Array(io.length),t=0;t<io.length;++t){var r=io[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Ov(e){var t={};e=br(e);for(var r=0;r<io.length;++r){var n=io[r],a=e.match(FE[r]);a!=null&&a.length>0&&(t[n[1]]=dr(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=cn(t[n[1]]))}return t}var ME=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Pv(e,t,r,n){var a=[];if(typeof e=="string")a=wm(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(f){return{v:f}}));var i=typeof t=="string"?wm(t,n).map(function(f){return f.v}):t,l=0,o=0;if(i.length>0)for(var u=0;u!==a.length;u+=2){switch(o=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=o,r.SheetNames=i.slice(l,l+o);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=o,r.DefinedNames=i.slice(l,l+o);break;case"Charts":case"Diagramme":r.Chartsheets=o,r.ChartNames=i.slice(l,l+o);break}l+=o}}function RE(e,t,r){var n={};return t||(t={}),e=br(e),ME.forEach(function(a){var s=(e.match(Mo(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=dr(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Pv(n.HeadingPairs,n.TitlesOfParts,t,r),t}var IE=/<[^>]+>[^<]*/g;function zE(e,t){var r={},n="",a=e.match(IE);if(a)for(var s=0;s!=a.length;++s){var i=a[s],l=It(i);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=dr(l.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var o=i.split(">"),u=o[0].slice(4),f=o[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=dr(f);break;case"bool":r[n]=jr(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=cn(f);break;case"cy":case"error":r[n]=dr(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,o)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var LE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},j0;function OE(e,t,r){j0||(j0=rh(LE)),t=j0[t]||t,e[t]=r}function hh(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Dv(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Bv(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Uv(e,t,r){return t===31?Bv(e):Dv(e,t,r)}function Wf(e,t,r){return Uv(e,t,r===!1?0:4)}function PE(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Uv(e,t,0)}function DE(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Dn,""),e.l-a&2&&(e.l+=2)}return r}function BE(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Dn,"");return r}function UE(e){var t=e.l,r=ku(e,zv);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ku(e,Kn);return[r,n]}function $E(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(UE(e));return r}function Fm(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Dn,"").replace(Hl,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function $v(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function WE(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ku(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==Nm&&n!==t&&kE.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Nm?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Dv(e,n,4).replace(Dn,"");case 31:return Bv(e);case 64:return hh(e);case 65:return $v(e);case 71:return WE(e);case 80:return Wf(e,n,!s.raw).replace(Dn,"");case 81:return PE(e,n).replace(Dn,"");case 4108:return $E(e);case 4126:case 4127:return n==4127?DE(e):BE(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Mm(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,l=0,o=-1,u={};for(i=0;i!=a;++i){var f=e.read_shift(4),d=e.read_shift(4);s[i]=[f,d+r]}s.sort(function(w,g){return w[1]-g[1]});var p={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var h=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,h=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(h=!1,e.l=s[i][1]),h)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[s[i][0]];if(p[m.n]=ku(e,m.t,{raw:!0}),m.p==="version"&&(p[m.n]=String(p[m.n]>>16)+"."+("0000"+String(p[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(p[m.n]){case 0:p[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ia(l=p[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[m.n])}}else if(s[i][0]===1){if(l=p.CodePage=ku(e,dh),Ia(l),o!==-1){var x=e.l;e.l=s[o][1],u=Fm(e,l),e.l=x}}else if(s[i][0]===0){if(l===0){o=i,e.l=s[i+1][1];continue}u=Fm(e,l)}else{var v=u[s[i][0]],y;switch(e[e.l]){case 65:e.l+=4,y=$v(e);break;case 30:e.l+=4,y=Wf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=Wf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=Hr(e,4);break;case 64:e.l+=4,y=cn(hh(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[v]=y}}return e.l=r+n,p}function Rm(e,t,r){var n=e.content;if(!n)return{};hn(n,0);var a,s,i,l,o=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==lr.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(i=n.read_shift(16),o=n.read_shift(4));var d=Mm(n,t),p={SystemIdentifier:u};for(var h in d)p[h]=d[h];if(p.FMTID=s,a===1)return p;if(o-n.l==2&&(n.l+=2),n.l!==o)throw new Error("Length mismatch 2: "+n.l+" !== "+o);var m;try{m=Mm(n,null)}catch{}for(h in m)p[h]=m[h];return p.FMTID=[s,i],p}function ks(e,t){return e.read_shift(t),null}function HE(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Hr(e,t){return e.read_shift(t)===1}function Yr(e){return e.read_shift(2,"u")}function Wv(e,t){return HE(e,t,Yr)}function VE(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Vo(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function GE(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,l,o={};a&&(i=e.read_shift(2)),n&&(l=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*i),n&&(e.l+=l),o.t=f,a||(o.raw="<t>"+o.t+"</t>",o.r=o.t),o}function yi(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Go(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):yi(e,n,r)}function Ti(e,t,r){if(r.biff>5)return Go(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function KE(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function XE(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Dn,"");return n&&(e.l+=24),a}function YE(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Dn,"");return r+i}function JE(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return XE(e);case"0303000000000000c000000000000046":return YE(e);default:throw new Error("Unsupported Moniker "+r)}}function _c(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Dn,""):"";return r}function QE(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,l,o,u="",f,d;a&16&&(s=_c(e,r-e.l)),a&128&&(i=_c(e,r-e.l)),(a&257)===257&&(l=_c(e,r-e.l)),(a&257)===1&&(o=JE(e,r-e.l)),a&8&&(u=_c(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=hh(e)),e.l=r;var p=i||l||o||"";p&&u&&(p+="#"+u),p||(p="#"+u),a&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var h={Target:p};return f&&(h.guid=f),d&&(h.time=d),s&&(h.Tooltip=s),h}function Hv(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function Vv(e,t){var r=Hv(e);return r[3]=0,r}function Za(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ZE(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function qE(e,t,r){return t===0?"":Ti(e,t,r)}function eb(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function Gv(e){var t=e.read_shift(2),r=fh(e);return[t,r]}function tb(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Vo(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function Ku(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Kv(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var rb=Kv;function Xv(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function nb(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function ab(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Sn(e){e.l+=2,e.l+=e.read_shift(2)}var sb={0:Sn,4:Sn,5:Sn,6:Sn,7:ab,8:Sn,9:Sn,10:Sn,11:Sn,12:Sn,13:nb,14:Sn,15:Sn,16:Sn,17:Sn,18:Sn,19:Sn,20:Sn,21:Xv};function ib(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(sb[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Sc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function lb(e,t){return t===0||e.read_shift(2),1200}function ob(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Ti(e,0,r);return e.read_shift(t+n-e.l),a}function cb(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function ub(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=Vo(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function fb(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(GE(e));return s.Count=n,s.Unique=a,s}function db(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function hb(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function pb(e){var t=ZE(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function mb(e){return e.read_shift(2),e.read_shift(4)}function Im(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function xb(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:l,Selected:o,TabRatio:u}}function gb(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function vb(){}function yb(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Vo(e,0,r),n}function wb(e){var t=Za(e);return t.isst=e.read_shift(4),t}function kb(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Za(e);r.biff==2&&e.l++;var s=Go(e,n-e.l,r);return a.val=s,a}function _b(e,t,r){var n=e.read_shift(2),a=Ti(e,0,r);return[n,a]}var Sb=Ti;function zm(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),l=e.read_shift(2),o=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:i,c:o}}}function Eb(e){var t=e.read_shift(2),r=e.read_shift(2),n=Gv(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function bb(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(Gv(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function Cb(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function Tb(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(2);return a.patternType=EE[l>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=o&127,a.icvBack=o>>7&127,a.fsxButton=o>>14&1),a}function Nb(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Tb(e,t,n.fStyle,r),n}function Ab(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Lm(e,t,r){var n=Za(e);(r.biff==2||t==9)&&++e.l;var a=VE(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function jb(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Za(e),a=Cn(e);return n.val=a,n}var Om=qE;function Fb(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=yi(e,s),l=[];n>e.l;)l.push(Go(e));return[s,a,i,l]}function Pm(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=tb(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var Mb=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Dm(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),o=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),o=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=yi(e,i,r);a&32&&(u=Mb[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||l===0||!(f>0)?[]:h4(e,f,r,l);return{chKey:s,Name:u,itab:o,rgce:d}}function Yv(e,t,r){if(r.biff<8)return Rb(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(eb(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Rb(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Vo(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Ib(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=yi(e,n,r),i=yi(e,a,r);return[s,i]}function zb(e,t,r){var n=Kv(e);e.l++;var a=e.read_shift(1);return t-=8,[p4(e,t,r),a,n]}function Bm(e,t,r){var n=rb(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,f4(e,t,r)]}function Lb(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Ob(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),l=Ti(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,i,s]}}function Pb(e,t,r){return Ob(e,t,r)}function Db(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Ku(e));return r}function Bb(e,t,r){if(r&&r.biff<8)return $b(e,t,r);var n=Xv(e),a=ib(e,t-22,n[1]);return{cmo:n,ft:a}}var Ub={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function $b(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Ub[n]||Fn)(e,t,r)),{cmo:[a,n,s],ft:i}}function Wb(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=KE(e,6,r);var l=e.read_shift(2);e.read_shift(2),Yr(e,2);var o=e.read_shift(2);e.l+=o;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],d=yi(e,e.lens[u+1]-e.lens[u]-1);if(a+=d,a.length>=(f?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function Hb(e,t){var r=Ku(e);e.l+=16;var n=QE(e,t-24);return[r,n]}function Vb(e,t){e.read_shift(2);var r=Ku(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Dn,""),[r,n]}function Gb(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Am[r]||r,r=e.read_shift(2),t[1]=Am[r]||r,t}function Kb(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Vv(e));return r}function Xb(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Vv(e));return r}function Yb(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Jv(e,t,r){if(!r.cellStyles)return Fn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:i,ixfe:l,flags:o};return(r.biff>=5||!r.biff)&&(u.level=o>>8&7),u}function Jb(e,t){var r={};return t<32||(e.l+=16,r.header=Cn(e),r.footer=Cn(e),e.l+=2),r}function Qb(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var Zb=Za,qb=Wv,eC=Go;function tC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function rC(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Za(e);++e.l;var a=Ti(e,t-7,r);return n.t="str",n.val=a,n}function nC(e){var t=Za(e);++e.l;var r=Cn(e);return t.t="n",t.val=r,t}function aC(e){var t=Za(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function sC(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function iC(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function lC(e,t,r){var n=e.l+t,a=Za(e),s=e.read_shift(2),i=yi(e,s,r);return e.l=n,a.t="str",a.val=i,a}var oC=[2,3,48,49,131,139,140,245],Um=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=rh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,o){var u=[],f=Ws(1);switch(o.type){case"base64":f=Ra(ca(l));break;case"binary":f=Ra(l);break;case"buffer":case"array":f=l;break}hn(f,0);var d=f.read_shift(1),p=!!(d&136),h=!1,m=!1;switch(d){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var x=0,v=521;d==2&&(x=f.read_shift(2)),f.l+=3,d!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),d!=2&&(v=f.read_shift(2));var y=f.read_shift(2),w=o.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=e[f[f.l]]),f.l+=1,f.l+=2),m&&(f.l+=36);for(var g=[],E={},A=Math.min(f.length,d==2?521:v-10-(h?264:0)),z=m?32:11;f.l<A&&f[f.l]!=13;)switch(E={},E.name=jo.utils.decode(w,f.slice(f.l,f.l+z)).replace(/[\u0000\r\n].*$/g,""),f.l+=z,E.type=String.fromCharCode(f.read_shift(1)),d!=2&&!m&&(E.offset=f.read_shift(4)),E.len=f.read_shift(1),d==2&&(E.offset=f.read_shift(2)),E.dec=f.read_shift(1),E.name.length&&g.push(E),d!=2&&(f.l+=m?13:14),E.type){case"B":(!h||E.len!=8)&&o.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":o.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(f[f.l]!==13&&(f.l=v-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=v;var b=0,S=0;for(u[0]=[],S=0;S!=g.length;++S)u[0][S]=g[S].name;for(;x-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,u[++b]=[],S=0,S=0;S!=g.length;++S){var _=f.slice(f.l,f.l+g[S].len);f.l+=g[S].len,hn(_,0);var T=jo.utils.decode(w,_);switch(g[S].type){case"C":T.trim().length&&(u[b][S]=T.replace(/\s+$/,""));break;case"D":T.length===8?u[b][S]=new Date(+T.slice(0,4),+T.slice(4,6)-1,+T.slice(6,8)):u[b][S]=T;break;case"F":u[b][S]=parseFloat(T.trim());break;case"+":case"I":u[b][S]=m?_.read_shift(-4,"i")^2147483648:_.read_shift(4,"i");break;case"L":switch(T.trim().toUpperCase()){case"Y":case"T":u[b][S]=!0;break;case"N":case"F":u[b][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+T+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[b][S]="##MEMO##"+(m?parseInt(T.trim(),10):_.read_shift(4));break;case"N":T=T.replace(/\u0000/g,"").trim(),T&&T!="."&&(u[b][S]=+T||0);break;case"@":u[b][S]=new Date(_.read_shift(-8,"f")-621356832e5);break;case"T":u[b][S]=new Date((_.read_shift(4)-2440588)*864e5+_.read_shift(4));break;case"Y":u[b][S]=_.read_shift(4,"i")/1e4+_.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[b][S]=-_.read_shift(-8,"f");break;case"B":if(h&&g[S].len==8){u[b][S]=_.read_shift(8,"f");break}case"G":case"P":_.l+=g[S].len;break;case"0":if(g[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[S].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return o&&o.sheetRows&&(u=u.slice(0,o.sheetRows)),o.DBF=g,u}function n(l,o){var u=o||{};u.dateNF||(u.dateNF="yyyymmdd");var f=bl(r(l,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function a(l,o){try{return Ys(n(l,o),o)}catch(u){if(o&&o.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(l,o){var u=o||{};if(+u.codepage>=0&&Ia(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Bf(),d=Jf(l,{header:1,raw:!0,cellDates:!0}),p=d[0],h=d.slice(1),m=l["!cols"]||[],x=0,v=0,y=0,w=1;for(x=0;x<p.length;++x){if(((m[x]||{}).DBF||{}).name){p[x]=m[x].DBF.name,++y;continue}if(p[x]!=null){if(++y,typeof p[x]=="number"&&(p[x]=p[x].toString(10)),typeof p[x]!="string")throw new Error("DBF Invalid column name "+p[x]+" |"+typeof p[x]+"|");if(p.indexOf(p[x])!==x){for(v=0;v<1024;++v)if(p.indexOf(p[x]+"_"+v)==-1){p[x]+="_"+v;break}}}}var g=Ur(l["!ref"]),E=[],A=[],z=[];for(x=0;x<=g.e.c-g.s.c;++x){var b="",S="",_=0,T=[];for(v=0;v<h.length;++v)h[v][x]!=null&&T.push(h[v][x]);if(T.length==0||p[x]==null){E[x]="?";continue}for(v=0;v<T.length;++v){switch(typeof T[v]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=T[v]instanceof Date?"D":"C";break;default:S="C"}_=Math.max(_,String(T[v]).length),b=b&&b!=S?"C":S}_>250&&(_=250),S=((m[x]||{}).DBF||{}).type,S=="C"&&m[x].DBF.len>_&&(_=m[x].DBF.len),b=="B"&&S=="N"&&(b="N",z[x]=m[x].DBF.dec,_=m[x].DBF.len),A[x]=b=="C"||S=="N"?_:s[b]||0,w+=A[x],E[x]=b}var D=f.next(32);for(D.write_shift(4,318902576),D.write_shift(4,h.length),D.write_shift(2,296+32*y),D.write_shift(2,w),x=0;x<4;++x)D.write_shift(4,0);for(D.write_shift(4,0|(+t[Y1]||3)<<8),x=0,v=0;x<p.length;++x)if(p[x]!=null){var M=f.next(32),G=(p[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,G,"sbcs"),M.write_shift(1,E[x]=="?"?"C":E[x],"sbcs"),M.write_shift(4,v),M.write_shift(1,A[x]||s[E[x]]||0),M.write_shift(1,z[x]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),v+=A[x]||s[E[x]]||0}var Y=f.next(264);for(Y.write_shift(4,13),x=0;x<65;++x)Y.write_shift(4,0);for(x=0;x<h.length;++x){var J=f.next(w);for(J.write_shift(1,0),v=0;v<p.length;++v)if(p[v]!=null)switch(E[v]){case"L":J.write_shift(1,h[x][v]==null?63:h[x][v]?84:70);break;case"B":J.write_shift(8,h[x][v]||0,"f");break;case"N":var Q="0";for(typeof h[x][v]=="number"&&(Q=h[x][v].toFixed(z[v]||0)),y=0;y<A[v]-Q.length;++y)J.write_shift(1,32);J.write_shift(1,Q,"sbcs");break;case"D":h[x][v]?(J.write_shift(4,("0000"+h[x][v].getFullYear()).slice(-4),"sbcs"),J.write_shift(2,("00"+(h[x][v].getMonth()+1)).slice(-2),"sbcs"),J.write_shift(2,("00"+h[x][v].getDate()).slice(-2),"sbcs")):J.write_shift(8,"00000000","sbcs");break;case"C":var X=String(h[x][v]!=null?h[x][v]:"").slice(0,A[v]);for(J.write_shift(1,X,"sbcs"),y=0;y<A[v]-X.length;++y)J.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),cC=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ja(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,h){var m=e[h];return typeof m=="number"?nm(m):m},n=function(p,h,m){var x=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return x==59?p:nm(x)};e["|"]=254;function a(p,h){switch(h.type){case"base64":return s(ca(p),h);case"binary":return s(p,h);case"buffer":return s(ar&&Buffer.isBuffer(p)?p.toString("binary"):Si(p),h);case"array":return s(vi(p),h)}throw new Error("Unrecognized type "+h.type)}function s(p,h){var m=p.split(/[\n\r]+/),x=-1,v=-1,y=0,w=0,g=[],E=[],A=null,z={},b=[],S=[],_=[],T=0,D;for(+h.codepage>=0&&Ia(+h.codepage);y!==m.length;++y){T=0;var M=m[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),G=M.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),Y=G[0],J;if(M.length>0)switch(Y){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":G[1].charAt(0)=="P"&&E.push(M.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,X=!1,ee=!1,F=!1,le=-1,re=-1;for(w=1;w<G.length;++w)switch(G[w].charAt(0)){case"A":break;case"X":v=parseInt(G[w].slice(1))-1,X=!0;break;case"Y":for(x=parseInt(G[w].slice(1))-1,X||(v=0),D=g.length;D<=x;++D)g[D]=[];break;case"K":J=G[w].slice(1),J.charAt(0)==='"'?J=J.slice(1,J.length-1):J==="TRUE"?J=!0:J==="FALSE"?J=!1:isNaN(Da(J))?isNaN(xl(J).getDate())||(J=cn(J)):(J=Da(J),A!==null&&Sl(A)&&(J=Gu(J))),Q=!0;break;case"E":F=!0;var j=al(G[w].slice(1),{r:x,c:v});g[x][v]=[g[x][v],j];break;case"S":ee=!0,g[x][v]=[g[x][v],"S5S"];break;case"G":break;case"R":le=parseInt(G[w].slice(1))-1;break;case"C":re=parseInt(G[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+M)}if(Q&&(g[x][v]&&g[x][v].length==2?g[x][v][0]=J:g[x][v]=J,A=null),ee){if(F)throw new Error("SYLK shared formula cannot have own formula");var R=le>-1&&g[le][re];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");g[x][v][1]=iy(R[1],{r:x-le,c:v-re})}break;case"F":var B=0;for(w=1;w<G.length;++w)switch(G[w].charAt(0)){case"X":v=parseInt(G[w].slice(1))-1,++B;break;case"Y":for(x=parseInt(G[w].slice(1))-1,D=g.length;D<=x;++D)g[D]=[];break;case"M":T=parseInt(G[w].slice(1))/20;break;case"F":break;case"G":break;case"P":A=E[parseInt(G[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(_=G[w].slice(1).split(" "),D=parseInt(_[0],10);D<=parseInt(_[1],10);++D)T=parseInt(_[2],10),S[D-1]=T===0?{hidden:!0}:{wch:T},gl(S[D-1]);break;case"C":v=parseInt(G[w].slice(1))-1,S[v]||(S[v]={});break;case"R":x=parseInt(G[w].slice(1))-1,b[x]||(b[x]={}),T>0?(b[x].hpt=T,b[x].hpx=Lo(T)):T===0&&(b[x].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+M)}B<1&&(A=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+M)}}return b.length>0&&(z["!rows"]=b),S.length>0&&(z["!cols"]=S),h&&h.sheetRows&&(g=g.slice(0,h.sheetRows)),[g,z]}function i(p,h){var m=a(p,h),x=m[0],v=m[1],y=bl(x,h);return Ja(v).forEach(function(w){y[w]=v[w]}),y}function l(p,h){return Ys(i(p,h),h)}function o(p,h,m,x){var v="C;Y"+(m+1)+";X"+(x+1)+";K";switch(p.t){case"n":v+=p.v||0,p.f&&!p.F&&(v+=";E"+YT(p.f,{r:m,c:x}));break;case"b":v+=p.v?"TRUE":"FALSE";break;case"e":v+=p.w||p.v;break;case"d":v+='"'+(p.w||p.v)+'"';break;case"s":v+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function u(p,h){h.forEach(function(m,x){var v="F;W"+(x+1)+" "+(x+1)+" ";m.hidden?v+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Su(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Eu(m.wpx)),typeof m.wch=="number"&&(v+=Math.round(m.wch))),v.charAt(v.length-1)!=" "&&p.push(v)})}function f(p,h){h.forEach(function(m,x){var v="F;";m.hidden?v+="M0;":m.hpt?v+="M"+20*m.hpt+";":m.hpx&&(v+="M"+20*ny(m.hpx)+";"),v.length>2&&p.push(v+"R"+(x+1))})}function d(p,h){var m=["ID;PWXL;N;E"],x=[],v=Ur(p["!ref"]),y,w=Array.isArray(p),g=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),p["!cols"]&&u(m,p["!cols"]),p["!rows"]&&f(m,p["!rows"]),m.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var E=v.s.r;E<=v.e.r;++E)for(var A=v.s.c;A<=v.e.c;++A){var z=Wt({r:E,c:A});y=w?(p[E]||[])[A]:p[z],!(!y||y.v==null&&(!y.f||y.F))&&x.push(o(y,p,E,A))}return m.join(g)+g+x.join(g)+g+"E"+g}return{to_workbook:l,to_sheet:i,from_sheet:d}}(),uC=function(){function e(s,i){switch(i.type){case"base64":return t(ca(s),i);case"binary":return t(s,i);case"buffer":return t(ar&&Buffer.isBuffer(s)?s.toString("binary"):Si(s),i);case"array":return t(vi(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var l=s.split(`
`),o=-1,u=-1,f=0,d=[];f!==l.length;++f){if(l[f].trim()==="BOT"){d[++o]=[],u=0;continue}if(!(o<0)){var p=l[f].trim().split(","),h=p[0],m=p[1];++f;for(var x=l[f]||"";(x.match(/["]/g)||[]).length&1&&f<l.length-1;)x+=`
`+l[++f];switch(x=x.trim(),+h){case-1:if(x==="BOT"){d[++o]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?d[o][u]=!0:x==="FALSE"?d[o][u]=!1:isNaN(Da(m))?isNaN(xl(m).getDate())?d[o][u]=m:d[o][u]=cn(m):d[o][u]=Da(m),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),d[o][u++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(s,i){return bl(e(s,i),i)}function n(s,i){return Ys(r(s,i),i)}var a=function(){var s=function(o,u,f,d,p){o.push(u),o.push(f+","+d),o.push('"'+p.replace(/"/g,'""')+'"')},i=function(o,u,f,d){o.push(u+","+f),o.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(o){var u=[],f=Ur(o["!ref"]),d,p=Array.isArray(o);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){i(u,-1,0,"BOT");for(var m=f.s.c;m<=f.e.c;++m){var x=Wt({r:h,c:m});if(d=p?(o[h]||[])[m]:o[x],!d){i(u,1,0,"");continue}switch(d.t){case"n":var v=d.w;!v&&d.v!=null&&(v=d.v),v==null?d.f&&!d.F?i(u,1,0,"="+d.f):i(u,1,0,""):i(u,0,v,"V");break;case"b":i(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Sa(d.z||Yt[14],Bn(cn(d.v)))),i(u,0,d.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var y=`\r
`,w=u.join(y);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),fC=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,p){for(var h=d.split(`
`),m=-1,x=-1,v=0,y=[];v!==h.length;++v){var w=h[v].trim().split(":");if(w[0]==="cell"){var g=On(w[1]);if(y.length<=g.r)for(m=y.length;m<=g.r;++m)y[m]||(y[m]=[]);switch(m=g.r,x=g.c,w[2]){case"t":y[m][x]=e(w[3]);break;case"v":y[m][x]=+w[3];break;case"vtf":var E=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[m][x]=!!+w[4];break;default:y[m][x]=+w[4];break}w[2]=="vtf"&&(y[m][x]=[y[m][x],E])}}}return p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),y}function n(d,p){return bl(r(d,p),p)}function a(d,p){return Ys(n(d,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),o="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var p=[],h=[],m,x="",v=El(d["!ref"]),y=Array.isArray(d),w=v.s.r;w<=v.e.r;++w)for(var g=v.s.c;g<=v.e.c;++g)if(x=Wt({r:w,c:g}),m=y?(d[w]||[])[g]:d[x],!(!m||m.v==null||m.t==="z")){switch(h=["cell",x,"t"],m.t){case"s":case"str":h.push(t(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=t(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var E=Bn(cn(m.v));h[2]="vtc",h[3]="nd",h[4]=""+E,h[5]=m.w||Sa(m.z||Yt[14],E);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function f(d){return[s,i,l,i,u(d),o].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),Io=function(){function e(f,d,p,h,m){m.raw?d[p][h]=f:f===""||(f==="TRUE"?d[p][h]=!0:f==="FALSE"?d[p][h]=!1:isNaN(Da(f))?isNaN(xl(f).getDate())?d[p][h]=f:d[p][h]=cn(f):d[p][h]=Da(f))}function t(f,d){var p=d||{},h=[];if(!f||f.length===0)return h;for(var m=f.split(/[\r\n]/),x=m.length-1;x>=0&&m[x].length===0;)--x;for(var v=10,y=0,w=0;w<=x;++w)y=m[w].indexOf(" "),y==-1?y=m[w].length:y++,v=Math.max(v,y);for(w=0;w<=x;++w){h[w]=[];var g=0;for(e(m[w].slice(0,v).trim(),h,w,g,p),g=1;g<=(m[w].length-v)/10+1;++g)e(m[w].slice(v+(g-1)*10,v+g*10).trim(),h,w,g,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},p=!1,h=0,m=0;h<f.length;++h)(m=f.charCodeAt(h))==34?p=!p:!p&&m in r&&(d[m]=(d[m]||0)+1);m=[];for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&m.push([d[h],h]);if(!m.length){d=n;for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&m.push([d[h],h])}return m.sort(function(x,v){return x[0]-v[0]||n[x[1]]-n[v[1]]}),r[m.pop()[1]]||44}function s(f,d){var p=d||{},h="",m=p.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(h=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(h=f.charAt(4),f=f.slice(6)):h=a(f.slice(0,1024)):p&&p.FS?h=p.FS:h=a(f.slice(0,1024));var v=0,y=0,w=0,g=0,E=0,A=h.charCodeAt(0),z=!1,b=0,S=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var _=p.dateNF!=null?_S(p.dateNF):null;function T(){var D=f.slice(g,E),M={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)M.t="z";else if(p.raw)M.t="s",M.v=D;else if(D.trim().length===0)M.t="s",M.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(M.t="s",M.v=D.slice(2,-1).replace(/""/g,'"')):QT(D)?(M.t="n",M.f=D.slice(1)):(M.t="s",M.v=D);else if(D=="TRUE")M.t="b",M.v=!0;else if(D=="FALSE")M.t="b",M.v=!1;else if(!isNaN(w=Da(D)))M.t="n",p.cellText!==!1&&(M.w=D),M.v=w;else if(!isNaN(xl(D).getDate())||_&&D.match(_)){M.z=p.dateNF||Yt[14];var G=0;_&&D.match(_)&&(D=SS(D,p.dateNF,D.match(_)||[]),G=1),p.cellDates?(M.t="d",M.v=cn(D,G)):(M.t="n",M.v=Bn(cn(D,G))),p.cellText!==!1&&(M.w=Sa(M.z,M.v instanceof Date?Bn(M.v):M.v)),p.cellNF||delete M.z}else M.t="s",M.v=D;if(M.t=="z"||(p.dense?(m[v]||(m[v]=[]),m[v][y]=M):m[Wt({c:y,r:v})]=M),g=E+1,S=f.charCodeAt(g),x.e.c<y&&(x.e.c=y),x.e.r<v&&(x.e.r=v),b==A)++y;else if(y=0,++v,p.sheetRows&&p.sheetRows<=v)return!0}e:for(;E<f.length;++E)switch(b=f.charCodeAt(E)){case 34:S===34&&(z=!z);break;case A:case 10:case 13:if(!z&&T())break e;break}return E-g>0&&T(),m["!ref"]=or(x),m}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):bl(t(f,d),d)}function l(f,d){var p="",h=d.type=="string"?[0,0,0,0]:kh(f,d);switch(d.type){case"base64":p=ca(f);break;case"binary":p=f;break;case"buffer":d.codepage==65001?p=f.toString("utf8"):d.codepage&&typeof jo<"u"||(p=ar&&Buffer.isBuffer(f)?f.toString("binary"):Si(f));break;case"array":p=vi(f);break;case"string":p=f;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=br(p.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?p=br(p):d.type=="binary"&&typeof jo<"u",p.slice(0,19)=="socialcalc:version:"?fC.to_sheet(d.type=="string"?p:br(p),d):i(p,d)}function o(f,d){return Ys(l(f,d),d)}function u(f){for(var d=[],p=Ur(f["!ref"]),h,m=Array.isArray(f),x=p.s.r;x<=p.e.r;++x){for(var v=[],y=p.s.c;y<=p.e.c;++y){var w=Wt({r:x,c:y});if(h=m?(f[x]||[])[y]:f[w],!h||h.v==null){v.push("          ");continue}for(var g=(h.w||(ps(h),h.w)||"").slice(0,10);g.length<10;)g+=" ";v.push(g+(y===0?" ":""))}d.push(v.join(""))}return d.join(`
`)}return{to_workbook:o,to_sheet:l,from_sheet:u}}();function dC(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=cC.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Io.to_workbook(e,t)}}var lo=function(){function e(j,R,B){if(j){hn(j,j.l||0);for(var V=B.Enum||le;j.l<j.length;){var te=j.read_shift(2),ke=V[te]||V[65535],_e=j.read_shift(2),ge=j.l+_e,ye=ke.f&&ke.f(j,_e,B);if(j.l=ge,R(ye,ke,te))return}}}function t(j,R){switch(R.type){case"base64":return r(Ra(ca(j)),R);case"binary":return r(Ra(j),R);case"buffer":case"array":return r(j,R)}throw"Unsupported type "+R.type}function r(j,R){if(!j)return j;var B=R||{},V=B.dense?[]:{},te="Sheet1",ke="",_e=0,ge={},ye=[],Ee=[],C={s:{r:0,c:0},e:{r:0,c:0}},we=B.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)B.Enum=le,e(j,function(be,qe,Ie){switch(Ie){case 0:B.vers=be,be>=4096&&(B.qpro=!0);break;case 6:C=be;break;case 204:be&&(ke=be);break;case 222:ke=be;break;case 15:case 51:B.qpro||(be[1].v=be[1].v.slice(1));case 13:case 14:case 16:Ie==14&&(be[2]&112)==112&&(be[2]&15)>1&&(be[2]&15)<15&&(be[1].z=B.dateNF||Yt[14],B.cellDates&&(be[1].t="d",be[1].v=Gu(be[1].v))),B.qpro&&be[3]>_e&&(V["!ref"]=or(C),ge[te]=V,ye.push(te),V=B.dense?[]:{},C={s:{r:0,c:0},e:{r:0,c:0}},_e=be[3],te=ke||"Sheet"+(_e+1),ke="");var ht=B.dense?(V[be[0].r]||[])[be[0].c]:V[Wt(be[0])];if(ht){ht.t=be[1].t,ht.v=be[1].v,be[1].z!=null&&(ht.z=be[1].z),be[1].f!=null&&(ht.f=be[1].f);break}B.dense?(V[be[0].r]||(V[be[0].r]=[]),V[be[0].r][be[0].c]=be[1]):V[Wt(be[0])]=be[1];break}},B);else if(j[2]==26||j[2]==14)B.Enum=re,j[2]==14&&(B.qpro=!0,j.l=0),e(j,function(be,qe,Ie){switch(Ie){case 204:te=be;break;case 22:be[1].v=be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(be[3]>_e&&(V["!ref"]=or(C),ge[te]=V,ye.push(te),V=B.dense?[]:{},C={s:{r:0,c:0},e:{r:0,c:0}},_e=be[3],te="Sheet"+(_e+1)),we>0&&be[0].r>=we)break;B.dense?(V[be[0].r]||(V[be[0].r]=[]),V[be[0].r][be[0].c]=be[1]):V[Wt(be[0])]=be[1],C.e.c<be[0].c&&(C.e.c=be[0].c),C.e.r<be[0].r&&(C.e.r=be[0].r);break;case 27:be[14e3]&&(Ee[be[14e3][0]]=be[14e3][1]);break;case 1537:Ee[be[0]]=be[1],be[0]==_e&&(te=be[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(V["!ref"]=or(C),ge[ke||te]=V,ye.push(ke||te),!Ee.length)return{SheetNames:ye,Sheets:ge};for(var he={},Ce=[],Ae=0;Ae<Ee.length;++Ae)ge[ye[Ae]]?(Ce.push(Ee[Ae]||ye[Ae]),he[Ee[Ae]]=ge[Ee[Ae]]||ge[ye[Ae]]):(Ce.push(Ee[Ae]),he[Ee[Ae]]={"!ref":"A1"});return{SheetNames:Ce,Sheets:he}}function n(j,R){var B=R||{};if(+B.codepage>=0&&Ia(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var V=Bf(),te=Ur(j["!ref"]),ke=Array.isArray(j),_e=[];Ta(V,0,s(1030)),Ta(V,6,o(te));for(var ge=Math.min(te.e.r,8191),ye=te.s.r;ye<=ge;++ye)for(var Ee=xn(ye),C=te.s.c;C<=te.e.c;++C){ye===te.s.r&&(_e[C]=tn(C));var we=_e[C]+Ee,he=ke?(j[ye]||[])[C]:j[we];if(!(!he||he.t=="z"))if(he.t=="n")(he.v|0)==he.v&&he.v>=-32768&&he.v<=32767?Ta(V,13,h(ye,C,he.v)):Ta(V,14,x(ye,C,he.v));else{var Ce=ps(he);Ta(V,15,d(ye,C,Ce.slice(0,239)))}}return Ta(V,1),V.end()}function a(j,R){var B=R||{};if(+B.codepage>=0&&Ia(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var V=Bf();Ta(V,0,i(j));for(var te=0,ke=0;te<j.SheetNames.length;++te)(j.Sheets[j.SheetNames[te]]||{})["!ref"]&&Ta(V,27,F(j.SheetNames[te],ke++));var _e=0;for(te=0;te<j.SheetNames.length;++te){var ge=j.Sheets[j.SheetNames[te]];if(!(!ge||!ge["!ref"])){for(var ye=Ur(ge["!ref"]),Ee=Array.isArray(ge),C=[],we=Math.min(ye.e.r,8191),he=ye.s.r;he<=we;++he)for(var Ce=xn(he),Ae=ye.s.c;Ae<=ye.e.c;++Ae){he===ye.s.r&&(C[Ae]=tn(Ae));var be=C[Ae]+Ce,qe=Ee?(ge[he]||[])[Ae]:ge[be];if(!(!qe||qe.t=="z"))if(qe.t=="n")Ta(V,23,T(he,Ae,_e,qe.v));else{var Ie=ps(qe);Ta(V,22,b(he,Ae,_e,Ie.slice(0,239)))}}++_e}}return Ta(V,1),V.end()}function s(j){var R=Zr(2);return R.write_shift(2,j),R}function i(j){var R=Zr(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var B=0,V=0,te=0,ke=0;ke<j.SheetNames.length;++ke){var _e=j.SheetNames[ke],ge=j.Sheets[_e];if(!(!ge||!ge["!ref"])){++te;var ye=El(ge["!ref"]);B<ye.e.r&&(B=ye.e.r),V<ye.e.c&&(V=ye.e.c)}}return B>8191&&(B=8191),R.write_shift(2,B),R.write_shift(1,te),R.write_shift(1,V),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function l(j,R,B){var V={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&B.qpro?(V.s.c=j.read_shift(1),j.l++,V.s.r=j.read_shift(2),V.e.c=j.read_shift(1),j.l++,V.e.r=j.read_shift(2),V):(V.s.c=j.read_shift(2),V.s.r=j.read_shift(2),R==12&&B.qpro&&(j.l+=2),V.e.c=j.read_shift(2),V.e.r=j.read_shift(2),R==12&&B.qpro&&(j.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function o(j){var R=Zr(8);return R.write_shift(2,j.s.c),R.write_shift(2,j.s.r),R.write_shift(2,j.e.c),R.write_shift(2,j.e.r),R}function u(j,R,B){var V=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(V[0].c=j.read_shift(1),V[3]=j.read_shift(1),V[0].r=j.read_shift(2),j.l+=2):(V[2]=j.read_shift(1),V[0].c=j.read_shift(2),V[0].r=j.read_shift(2)),V}function f(j,R,B){var V=j.l+R,te=u(j,R,B);if(te[1].t="s",B.vers==20768){j.l++;var ke=j.read_shift(1);return te[1].v=j.read_shift(ke,"utf8"),te}return B.qpro&&j.l++,te[1].v=j.read_shift(V-j.l,"cstr"),te}function d(j,R,B){var V=Zr(7+B.length);V.write_shift(1,255),V.write_shift(2,R),V.write_shift(2,j),V.write_shift(1,39);for(var te=0;te<V.length;++te){var ke=B.charCodeAt(te);V.write_shift(1,ke>=128?95:ke)}return V.write_shift(1,0),V}function p(j,R,B){var V=u(j,R,B);return V[1].v=j.read_shift(2,"i"),V}function h(j,R,B){var V=Zr(7);return V.write_shift(1,255),V.write_shift(2,R),V.write_shift(2,j),V.write_shift(2,B,"i"),V}function m(j,R,B){var V=u(j,R,B);return V[1].v=j.read_shift(8,"f"),V}function x(j,R,B){var V=Zr(13);return V.write_shift(1,255),V.write_shift(2,R),V.write_shift(2,j),V.write_shift(8,B,"f"),V}function v(j,R,B){var V=j.l+R,te=u(j,R,B);if(te[1].v=j.read_shift(8,"f"),B.qpro)j.l=V;else{var ke=j.read_shift(2);E(j.slice(j.l,j.l+ke),te),j.l+=ke}return te}function y(j,R,B){var V=R&32768;return R&=-32769,R=(V?j:0)+(R>=8192?R-16384:R),(V?"":"$")+(B?tn(R):xn(R))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(j,R){hn(j,0);for(var B=[],V=0,te="",ke="",_e="",ge="";j.l<j.length;){var ye=j[j.l++];switch(ye){case 0:B.push(j.read_shift(8,"f"));break;case 1:ke=y(R[0].c,j.read_shift(2),!0),te=y(R[0].r,j.read_shift(2),!1),B.push(ke+te);break;case 2:{var Ee=y(R[0].c,j.read_shift(2),!0),C=y(R[0].r,j.read_shift(2),!1);ke=y(R[0].c,j.read_shift(2),!0),te=y(R[0].r,j.read_shift(2),!1),B.push(Ee+C+":"+ke+te)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(j.read_shift(2));break;case 6:{for(var we="";ye=j[j.l++];)we+=String.fromCharCode(ye);B.push('"'+we.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:ge=B.pop(),_e=B.pop(),B.push(["AND","OR"][ye-20]+"("+_e+","+ge+")");break;default:if(ye<32&&g[ye])ge=B.pop(),_e=B.pop(),B.push(_e+g[ye]+ge);else if(w[ye]){if(V=w[ye][1],V==69&&(V=j[j.l++]),V>B.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+B.join("|")+"|");return}var he=B.slice(-V);B.length-=V,B.push(w[ye][0]+"("+he.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}B.length==1?R[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function A(j){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=j.read_shift(2),R[3]=j[j.l++],R[0].c=j[j.l++],R}function z(j,R){var B=A(j);return B[1].t="s",B[1].v=j.read_shift(R-4,"cstr"),B}function b(j,R,B,V){var te=Zr(6+V.length);te.write_shift(2,j),te.write_shift(1,B),te.write_shift(1,R),te.write_shift(1,39);for(var ke=0;ke<V.length;++ke){var _e=V.charCodeAt(ke);te.write_shift(1,_e>=128?95:_e)}return te.write_shift(1,0),te}function S(j,R){var B=A(j);B[1].v=j.read_shift(2);var V=B[1].v>>1;if(B[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return B[1].v=V,B}function _(j,R){var B=A(j),V=j.read_shift(4),te=j.read_shift(4),ke=j.read_shift(2);if(ke==65535)return V===0&&te===3221225472?(B[1].t="e",B[1].v=15):V===0&&te===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var _e=ke&32768;return ke=(ke&32767)-16446,B[1].v=(1-_e*2)*(te*Math.pow(2,ke+32)+V*Math.pow(2,ke)),B}function T(j,R,B,V){var te=Zr(14);if(te.write_shift(2,j),te.write_shift(1,B),te.write_shift(1,R),V==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var ke=0,_e=0,ge=0,ye=0;return V<0&&(ke=1,V=-V),_e=Math.log2(V)|0,V/=Math.pow(2,_e-31),ye=V>>>0,ye&2147483648||(V/=2,++_e,ye=V>>>0),V-=ye,ye|=2147483648,ye>>>=0,V*=Math.pow(2,32),ge=V>>>0,te.write_shift(4,ge),te.write_shift(4,ye),_e+=16383+(ke?32768:0),te.write_shift(2,_e),te}function D(j,R){var B=_(j);return j.l+=R-14,B}function M(j,R){var B=A(j),V=j.read_shift(4);return B[1].v=V>>6,B}function G(j,R){var B=A(j),V=j.read_shift(8,"f");return B[1].v=V,B}function Y(j,R){var B=G(j);return j.l+=R-10,B}function J(j,R){return j[j.l+R-1]==0?j.read_shift(R,"cstr"):""}function Q(j,R){var B=j[j.l++];B>R-1&&(B=R-1);for(var V="";V.length<B;)V+=String.fromCharCode(j[j.l++]);return V}function X(j,R,B){if(!(!B.qpro||R<21)){var V=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var te=j.read_shift(R-21,"cstr");return[V,te]}}function ee(j,R){for(var B={},V=j.l+R;j.l<V;){var te=j.read_shift(2);if(te==14e3){for(B[te]=[0,""],B[te][0]=j.read_shift(2);j[j.l];)B[te][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return B}function F(j,R){var B=Zr(5+j.length);B.write_shift(2,14e3),B.write_shift(2,R);for(var V=0;V<j.length;++V){var te=j.charCodeAt(V);B[B.l++]=te>127?95:te}return B[B.l++]=0,B}var le={0:{n:"BOF",f:Yr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:m},15:{n:"LABEL",f},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:J},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:_},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:G},40:{n:"FORMULA28",f:Y},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:J},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:X},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function hC(e){var t={},r=e.match(Mn),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=It(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Qd[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var pC=function(){var e=Mo("t"),t=Mo("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var l={t:"s",v:dr(i[1])},o=s.match(t);return o&&(l.s=hC(o[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),mC=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var o=a.valign||"";return o=="superscript"||o=="super"?o="sup":o=="subscript"&&(o="sub"),o!=""&&(s.push("<"+o+">"),i.push("</"+o+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),xC=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,gC=/<(?:\w+:)?r>/,vC=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ph(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=dr(br(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=br(e),r&&(n.h=ah(n.t))):e.match(gC)&&(n.r=br(e),n.t=dr(br((e.replace(vC,"").match(xC)||[]).join("").replace(Mn,""))),r&&(n.h=mC(pC(n.r)))),n):{t:""}}var yC=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,wC=/<(?:\w+:)?(?:si|sstItem)>/g,kC=/<\/(?:\w+:)?(?:si|sstItem)>/;function _C(e,t){var r=[],n="";if(!e)return r;var a=e.match(yC);if(a){n=a[2].replace(wC,"").split(kC);for(var s=0;s!=n.length;++s){var i=ph(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=It(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function SC(e){return[e.read_shift(4),e.read_shift(4)]}function EC(e,t){var r=[],n=!1;return xs(e,function(s,i,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function Qv(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function cs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function bC(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=cs(e,4),t.U=cs(e,4),t.W=cs(e,4),t}function CC(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function TC(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(CC(e));return t}function NC(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function AC(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=cs(e,4),t.U=cs(e,4),t.W=cs(e,4),t}function jC(e){var t=AC(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Zv(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function qv(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function FC(e){var t=cs(e);switch(t.Minor){case 2:return[t.Minor,MC(e)];case 3:return[t.Minor,RC()];case 4:return[t.Minor,IC(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function MC(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Zv(e,r),a=qv(e,e.length-e.l);return{t:"Std",h:n,v:a}}function RC(){throw new Error("File is password-protected: ECMA-376 Extensible")}function IC(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Mn,function(s){var i=It(s);switch(Qa(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=i[l]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function zC(e,t){var r={},n=r.EncryptionVersionInfo=cs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Zv(e,a),t-=a,r.EncryptionVerifier=qv(e,t),r}function LC(e){var t={},r=t.EncryptionVersionInfo=cs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function OC(e){var t=0,r,n=Qv(e),a=n.length+1,s,i,l,o,u;for(r=Ws(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],l=t&16384?1:0,o=t<<1&32767,u=l|o,t=u^i;return t^52811}var ey=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,l){return n(i^l)},s=function(i){for(var l=t[i.length-1],o=104,u=i.length-1;u>=0;--u)for(var f=i[u],d=0;d!=7;++d)f&64&&(l^=r[o]),f*=2,--o;return l};return function(i){for(var l=Qv(i),o=s(l),u=l.length,f=Ws(16),d=0;d!=16;++d)f[d]=0;var p,h,m;for((u&1)===1&&(p=o>>8,f[u]=a(e[0],p),--u,p=o&255,h=l[l.length-1],f[u]=a(h,p));u>0;)--u,p=o>>8,f[u]=a(l[u],p),--u,p=o&255,f[u]=a(l[u],p);for(u=15,m=15-l.length;m>0;)p=o>>8,f[u]=a(e[m],p),--u,--m,p=o&255,f[u]=a(l[u],p),--u,--m;return f}}(),PC=function(e,t,r,n,a){a||(a=t),n||(n=ey(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},DC=function(e){var t=0,r=ey(e);return function(n){var a=PC("",n,t,r);return t=a[1],a[0]}};function BC(e,t,r,n){var a={key:Yr(e),verificationBytes:Yr(e)};return r.password&&(a.verifier=OC(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=DC(r.password)),a}function UC(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=LC(e):n.Data=zC(e,t),n}function $C(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?UC(e,t-2,n):BC(e,r.biff>=8?t:t-2,r,n),n}var WC=function(){function e(a,s){switch(s.type){case"base64":return t(ca(a),s);case"binary":return t(a,s);case"buffer":return t(ar&&Buffer.isBuffer(a)?a.toString("binary"):Si(a),s);case"array":return t(vi(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},l=i.dense?[]:{},o=a.match(/\\trowd.*?\\row\b/g);if(!o.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:o.length-1}};return o.forEach(function(f,d){Array.isArray(l)&&(l[d]=[]);for(var p=/\\\w+\b/g,h=0,m,x=-1;m=p.exec(f);){switch(m[0]){case"\\cell":var v=f.slice(h,p.lastIndex-m[0].length);if(v[0]==" "&&(v=v.slice(1)),++x,v.length){var y={v,t:"s"};Array.isArray(l)?l[d][x]=y:l[Wt({r:d,c:x})]=y}break}h=p.lastIndex}x>u.e.c&&(u.e.c=x)}),l["!ref"]=or(u),l}function r(a,s){return Ys(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=Ur(a["!ref"]),l,o=Array.isArray(a),u=i.s.r;u<=i.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=Wt({r:u,c:f});l=o?(a[u]||[])[f]:a[d],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(ps(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function HC(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function zo(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function VC(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var l=0,o=0,u=a+s;switch(o=i/(u>1?2-u:u),a){case t:l=((r-n)/i+6)%6;break;case r:l=(n-t)/i+2;break;case n:l=(t-r)/i+4;break}return[l/6,o,u/2]}function GC(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],l=6*t,o;if(r!==0)switch(l|0){case 0:case 6:o=a*l,i[0]+=a,i[1]+=o;break;case 1:o=a*(2-l),i[0]+=o,i[1]+=a;break;case 2:o=a*(l-2),i[1]+=a,i[2]+=o;break;case 3:o=a*(4-l),i[1]+=o,i[2]+=a;break;case 4:o=a*(l-4),i[2]+=a,i[0]+=o;break;case 5:o=a*(6-l),i[2]+=o,i[0]+=a;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function _u(e,t){if(t===0)return e;var r=VC(HC(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),zo(GC(r))}var ty=6,KC=15,XC=1,Ln=ty;function Su(e){return Math.floor((e+Math.round(128/Ln)/256)*Ln)}function Eu(e){return Math.floor((e-5)/Ln*100+.5)/100}function Hf(e){return Math.round((e*Ln+5)/Ln*256)/256}function F0(e){return Hf(Eu(Su(e)))}function mh(e){var t=Math.abs(e-F0(e)),r=Ln;if(t>.005)for(Ln=XC;Ln<KC;++Ln)Math.abs(e-F0(e))<=t&&(t=Math.abs(e-F0(e)),r=Ln);Ln=r}function gl(e){e.width?(e.wpx=Su(e.width),e.wch=Eu(e.wpx),e.MDW=Ln):e.wpx?(e.wch=Eu(e.wpx),e.width=Hf(e.wch),e.MDW=Ln):typeof e.wch=="number"&&(e.width=Hf(e.wch),e.wpx=Su(e.width),e.MDW=Ln),e.customWidth&&delete e.customWidth}var YC=96,ry=YC;function ny(e){return e*96/ry}function Lo(e){return e*ry/96}var JC={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function QC(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Mn)||[]).forEach(function(i){var l=It(i);switch(Qa(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=jr(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=jr(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function ZC(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Mn)||[]).forEach(function(i){var l=It(i);switch(Qa(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function qC(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Mn)||[]).forEach(function(i){var l=It(i);switch(Qa(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=br(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?jr(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?jr(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?jr(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?jr(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?jr(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?jr(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?jr(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Qd[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=jr(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var o=fi[a.color.index];a.color.index==81&&(o=fi[1]),o||(o=fi[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=_u(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function eT(e,t,r){t.NumberFmt=[];for(var n=Ja(Yt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Yt[n[a]];var s=e[0].match(Mn);if(s)for(a=0;a<s.length;++a){var i=It(s[a]);switch(Qa(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=dr(br(i.formatCode)),o=parseInt(i.numFmtId,10);if(t.NumberFmt[o]=l,o>0){if(o>392){for(o=392;o>60&&t.NumberFmt[o]!=null;--o);t.NumberFmt[o]=l}ui(l,o)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Ec=["numFmtId","fillId","fontId","borderId","xfId"],bc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function tT(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Mn)||[]).forEach(function(s){var i=It(s),l=0;switch(Qa(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],l=0;l<Ec.length;++l)n[Ec[l]]&&(n[Ec[l]]=parseInt(n[Ec[l]],10));for(l=0;l<bc.length;++l)n[bc[l]]&&(n[bc[l]]=jr(n[bc[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var o={};i.vertical&&(o.vertical=i.vertical),i.horizontal&&(o.horizontal=i.horizontal),i.textRotation!=null&&(o.textRotation=i.textRotation),i.indent&&(o.indent=i.indent),i.wrapText&&(o.wrapText=jr(i.wrapText)),n.alignment=o;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var rT=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,o,u){var f={};if(!l)return f;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=l.match(t))&&eT(d,f,u),(d=l.match(a))&&qC(d,f,o,u),(d=l.match(n))&&ZC(d,f,o,u),(d=l.match(s))&&QC(d,f,o,u),(d=l.match(r))&&tT(d,f,u),f}}();function nT(e,t){var r=e.read_shift(2),n=An(e);return[r,n]}function aT(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=pE(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var l=e.read_shift(1);l>0&&(n.family=l);var o=e.read_shift(1);switch(o>0&&(n.charset=o),e.l++,n.color=hE(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=An(e),n}var sT=Fn;function iT(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var lT=Fn;function oT(e,t,r){var n={};n.NumberFmt=[];for(var a in Yt)n.NumberFmt[a]=Yt[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return xs(e,function(o,u,f){switch(f){case 44:n.NumberFmt[o[0]]=o[1],ui(o[1],o[0]);break;case 43:n.Fonts.push(o),o.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(o.color.rgb=_u(t.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(o);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(u.T>0)s.push(f);else if(u.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var cT=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function uT(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Mn)||[]).forEach(function(a){var s=It(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[cT.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function fT(){}function dT(){}var hT=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,pT=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,mT=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function xT(e,t,r){t.themeElements={};var n;[["clrScheme",hT,uT],["fontScheme",pT,fT],["fmtScheme",mT,dT]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var gT=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ay(e,t){(!e||e.length===0)&&(e=vT());var r,n={};if(!(r=e.match(gT)))throw new Error("themeElements not found in theme");return xT(r[0],n,t),n.raw=e,n}function vT(e,t){var r=[mv];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function yT(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=pv(s,{type:"array"})}catch{return}var l=aa(i,"theme/theme/theme1.xml",!0);if(l)return ay(l,r)}}function wT(e){return e.read_shift(4)}function kT(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=_T(e,4);break;case 2:t.xclrValue=Hv(e);break;case 3:t.xclrValue=wT(e);break;case 4:e.l+=4;break}return e.l+=8,t}function _T(e,t){return Fn(e,t)}function ST(e,t){return Fn(e,t)}function ET(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=kT(e);break;case 6:n[1]=ST(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function bT(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(ET(e,r-e.l));return{ixfe:n,ext:s}}function CT(e,t){t.forEach(function(r){switch(r[0]){}})}function TT(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:An(e)}}function NT(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function AT(e){return e.l+=4,e.read_shift(4)!=0}function jT(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,l=2;return xs(e,function(o,u,f){switch(f){case 335:n.Types.push({name:o.name});break;case 51:o.forEach(function(d){l==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):l==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:l=o?1:0;break;case 338:l=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!u.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function FT(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Mn,function(l){var o=It(l);switch(Qa(o[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:o.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==o.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[o.t-1].name,index:+o.v}):s==0&&n.Value.push({type:n.Types[o.t-1].name,index:+o.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+o.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+o[0]+" in metadata")}return l}),n}function MT(e){var t=[];if(!e)return t;var r=1;return(e.match(Mn)||[]).forEach(function(n){var a=It(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function RT(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Wt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function IT(e,t,r){var n=[];return xs(e,function(s,i,l){switch(l){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function zT(e,t,r,n){if(!e)return e;var a=n||{},s=!1;xs(e,function(l,o,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!o.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function LT(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function $m(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var l=On(i.ref);if(a?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[i.ref],!s){s={t:"z"},a?e[l.r][l.c]=s:e[i.ref]=s;var o=Ur(e["!ref"]||"BDWGO1000001:A1");o.s.r>l.r&&(o.s.r=l.r),o.e.r<l.r&&(o.e.r=l.r),o.s.c>l.c&&(o.s.c=l.c),o.e.c<l.c&&(o.e.c=l.c);var u=or(o);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}s.c.push(f)})}function OT(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?comment[^>]*>/);if(l){var o=It(l[0]),u={author:o.authorId&&r[o.authorId]||"sheetjsghost",ref:o.ref,guid:o.guid},f=On(o.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!d&&!!d[1]&&ph(d[1])||{r:"",t:"",h:""};u.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),u.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=p.h),n.push(u)}}}}),n}function PT(e,t){var r=[],n=!1,a={},s=0;return e.replace(Mn,function(l,o){var u=It(l);switch(Qa(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=o+l.length;break;case"</text>":a.t=e.slice(s,o).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function DT(e,t){var r=[],n=!1;return e.replace(Mn,function(s){var i=It(s);switch(Qa(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function BT(e){var t={};t.iauthor=e.read_shift(4);var r=bi(e);return t.rfx=r.s,t.ref=Wt(r.s),e.l+=16,t}var UT=An;function $T(e,t){var r=[],n=[],a={},s=!1;return xs(e,function(l,o,u){switch(u){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!o.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var WT="application/vnd.ms-office.vbaProject";function HT(e){var t=lr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");lr.utils.cfb_add(t,a,e.FileIndex[n].content)}}),lr.write(t)}function VT(){return{"!type":"dialog"}}function GT(){return{"!type":"dialog"}}function KT(){return{"!type":"macro"}}function XT(){return{"!type":"macro"}}var al=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var l=!1,o=!1;s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1)),i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return l?f+=t.c:--f,o?u+=t.r:--u,a+(l?"":"$")+tn(f)+(o?"":"$")+xn(u)}return function(a,s){return t=s,a.replace(e,r)}}(),sy=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,YT=function(){return function(t,r){return t.replace(sy,function(n,a,s,i,l,o){var u=oh(i)-(s?0:r.c),f=lh(o)-(l?0:r.r),d=f==0?"":l?f+1:"["+f+"]",p=u==0?"":s?u+1:"["+u+"]";return a+"R"+d+"C"+p})}}();function iy(e,t){return e.replace(sy,function(r,n,a,s,i,l){return n+(a=="$"?a+s:tn(oh(s)+t.c))+(i=="$"?i+l:xn(lh(l)+t.r))})}function JT(e,t,r){var n=El(t),a=n.s,s=On(r),i={r:s.r-a.r,c:s.c-a.c};return iy(e,i)}function QT(e){return e.length!=1}function Wm(e){return e.replace(/_xlfn\./g,"")}function Kr(e){e.l+=1}function Hs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function ly(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return oy(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=Hs(e),l=Hs(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function oy(e){var t=Hs(e),r=Hs(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function ZT(e,t,r){if(r.biff<8)return oy(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=Hs(e),i=Hs(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function cy(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return qT(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Hs(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function qT(e){var t=Hs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function eN(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function tN(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return rN(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:l}}function rN(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function nN(e,t,r){var n=(e[e.l++]&96)>>5,a=ly(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function aN(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=ly(e,s,r);return[n,a,i]}function sN(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function iN(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function lN(e,t,r){var n=(e[e.l++]&96)>>5,a=ZT(e,t-1,r);return[n,a]}function oN(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Hm(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function cN(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function uN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function fN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function dN(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function hN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function uy(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function pN(e){return e.read_shift(2),uy(e)}function mN(e){return e.read_shift(2),uy(e)}function xN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=cy(e,0,r);return[n,a]}function gN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=tN(e,0,r);return[n,a]}function vN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=cy(e,0,r);return[n,a,s]}function yN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[w4[a],hy[a],n]}function wN(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:kN(e);return[a,(s[0]===0?hy:y4)[s[1]]]}function kN(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function _N(e,t,r){e.l+=r&&r.biff==2?3:4}function SN(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function EN(e){return e.l++,Ci[e.read_shift(1)]}function bN(e){return e.l++,e.read_shift(2)}function CN(e){return e.l++,e.read_shift(1)!==0}function TN(e){return e.l++,Cn(e)}function NN(e,t,r){return e.l++,Vo(e,t-1,r)}function AN(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Hr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ci[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Cn(e);break;case 2:r[1]=Ti(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function jN(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?bi:Ku)(e));return a}function FN(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var l=0;l!=a;++l)i[s][l]=AN(e,r.biff);return i}function MN(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function RN(e,t,r){if(r.biff==5)return IN(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function IN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function zN(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function LN(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function ON(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function PN(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var DN=Fn,BN=Fn,UN=Fn;function Ko(e,t,r){return e.l+=2,[eN(e)]}function xh(e){return e.l+=6,[]}var $N=Ko,WN=xh,HN=xh,VN=Ko;function fy(e){return e.l+=2,[Yr(e),e.read_shift(2)&1]}var GN=Ko,KN=fy,XN=xh,YN=Ko,JN=Ko,QN=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ZN(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=QN[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function qN(e){return e.l+=2,[e.read_shift(4)]}function e4(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function t4(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function r4(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function n4(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function a4(e){return e.l+=4,[0,0]}var Vm={1:{n:"PtgExp",f:SN},2:{n:"PtgTbl",f:UN},3:{n:"PtgAdd",f:Kr},4:{n:"PtgSub",f:Kr},5:{n:"PtgMul",f:Kr},6:{n:"PtgDiv",f:Kr},7:{n:"PtgPower",f:Kr},8:{n:"PtgConcat",f:Kr},9:{n:"PtgLt",f:Kr},10:{n:"PtgLe",f:Kr},11:{n:"PtgEq",f:Kr},12:{n:"PtgGe",f:Kr},13:{n:"PtgGt",f:Kr},14:{n:"PtgNe",f:Kr},15:{n:"PtgIsect",f:Kr},16:{n:"PtgUnion",f:Kr},17:{n:"PtgRange",f:Kr},18:{n:"PtgUplus",f:Kr},19:{n:"PtgUminus",f:Kr},20:{n:"PtgPercent",f:Kr},21:{n:"PtgParen",f:Kr},22:{n:"PtgMissArg",f:Kr},23:{n:"PtgStr",f:NN},26:{n:"PtgSheet",f:e4},27:{n:"PtgEndSheet",f:t4},28:{n:"PtgErr",f:EN},29:{n:"PtgBool",f:CN},30:{n:"PtgInt",f:bN},31:{n:"PtgNum",f:TN},32:{n:"PtgArray",f:oN},33:{n:"PtgFunc",f:yN},34:{n:"PtgFuncVar",f:wN},35:{n:"PtgName",f:MN},36:{n:"PtgRef",f:xN},37:{n:"PtgArea",f:nN},38:{n:"PtgMemArea",f:zN},39:{n:"PtgMemErr",f:DN},40:{n:"PtgMemNoMem",f:BN},41:{n:"PtgMemFunc",f:LN},42:{n:"PtgRefErr",f:ON},43:{n:"PtgAreaErr",f:sN},44:{n:"PtgRefN",f:gN},45:{n:"PtgAreaN",f:lN},46:{n:"PtgMemAreaN",f:r4},47:{n:"PtgMemNoMemN",f:n4},57:{n:"PtgNameX",f:RN},58:{n:"PtgRef3d",f:vN},59:{n:"PtgArea3d",f:aN},60:{n:"PtgRefErr3d",f:PN},61:{n:"PtgAreaErr3d",f:iN},255:{}},s4={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},i4={1:{n:"PtgElfLel",f:fy},2:{n:"PtgElfRw",f:YN},3:{n:"PtgElfCol",f:$N},6:{n:"PtgElfRwV",f:JN},7:{n:"PtgElfColV",f:VN},10:{n:"PtgElfRadical",f:GN},11:{n:"PtgElfRadicalS",f:XN},13:{n:"PtgElfColS",f:WN},15:{n:"PtgElfColSV",f:HN},16:{n:"PtgElfRadicalLel",f:KN},25:{n:"PtgList",f:ZN},29:{n:"PtgSxName",f:qN},255:{}},l4={0:{n:"PtgAttrNoop",f:a4},1:{n:"PtgAttrSemi",f:hN},2:{n:"PtgAttrIf",f:fN},4:{n:"PtgAttrChoose",f:cN},8:{n:"PtgAttrGoto",f:uN},16:{n:"PtgAttrSum",f:_N},32:{n:"PtgAttrBaxcel",f:Hm},33:{n:"PtgAttrBaxcel",f:Hm},64:{n:"PtgAttrSpace",f:pN},65:{n:"PtgAttrSpaceSemi",f:mN},128:{n:"PtgAttrIfError",f:dN},255:{}};function Xo(e,t,r,n){if(n.biff<8)return Fn(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=FN(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=jN(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(Fn(e,t)),s}function Yo(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=Vm[s]||Vm[s4[s]],(s===24||s===25)&&(a=(s===24?i4:l4)[e[e.l+1]]),!a||!a.f?Fn(e,t):i.push([a.n,a.f(e,t,r)]);return i}function o4(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var c4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function u4(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function dy(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Gm(e,t,r){var n=dy(e,t,r);return n=="#REF"?n:u4(n,r)}function En(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},l=[],o,u,f,d=0,p=0,h,m="";if(!e[0]||!e[0][0])return"";for(var x=-1,v="",y=0,w=e[0].length;y<w;++y){var g=e[0][y];switch(g[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=l.pop(),u=l.pop(),x>=0){switch(e[0][x][1][0]){case 0:v=Br(" ",e[0][x][1][1]);break;case 1:v=Br("\r",e[0][x][1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+v,x=-1}l.push(u+c4[g[0]]+o);break;case"PtgIsect":o=l.pop(),u=l.pop(),l.push(u+" "+o);break;case"PtgUnion":o=l.pop(),u=l.pop(),l.push(u+","+o);break;case"PtgRange":o=l.pop(),u=l.pop(),l.push(u+":"+o);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=no(g[1][1],i,a),l.push(ao(f,s));break;case"PtgRefN":f=r?no(g[1][1],r,a):g[1][1],l.push(ao(f,s));break;case"PtgRef3d":d=g[1][1],f=no(g[1][2],i,a),m=Gm(n,d,a),l.push(m+"!"+ao(f,s));break;case"PtgFunc":case"PtgFuncVar":var E=g[1][0],A=g[1][1];E||(E=0),E&=127;var z=E==0?[]:l.slice(-E);l.length-=E,A==="User"&&(A=z.shift()),l.push(A+"("+z.join(",")+")");break;case"PtgBool":l.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(g[1]);break;case"PtgNum":l.push(String(g[1]));break;case"PtgStr":l.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(g[1]);break;case"PtgAreaN":h=Cm(g[1][1],r?{s:r}:i,a),l.push(A0(h,a));break;case"PtgArea":h=Cm(g[1][1],i,a),l.push(A0(h,a));break;case"PtgArea3d":d=g[1][1],h=g[1][2],m=Gm(n,d,a),l.push(m+"!"+A0(h,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=g[1][2];var b=(n.names||[])[p-1]||(n[0]||[])[p],S=b?b.Name:"SH33TJSNAME"+String(p);S&&S.slice(0,6)=="_xlfn."&&!a.xlfn&&(S=S.slice(6)),l.push(S);break;case"PtgNameX":var _=g[1][1];p=g[1][2];var T;if(a.biff<=5)_<0&&(_=-_),n[_]&&(T=n[_][p]);else{var D="";if(((n[_]||[])[0]||[])[0]==14849||(((n[_]||[])[0]||[])[0]==1025?n[_][p]&&n[_][p].itab>0&&(D=n.SheetNames[n[_][p].itab-1]+"!"):D=n.SheetNames[p-1]+"!"),n[_]&&n[_][p])D+=n[_][p].Name;else if(n[0]&&n[0][p])D+=n[0][p].Name;else{var M=(dy(n,_,a)||"").split(";;");M[p-1]?D=M[p-1]:D+="SH33TJSERRX"}l.push(D);break}T||(T={Name:"SH33TJSERRY"}),l.push(T.Name);break;case"PtgParen":var G="(",Y=")";if(x>=0){switch(v="",e[0][x][1][0]){case 2:G=Br(" ",e[0][x][1][1])+G;break;case 3:G=Br("\r",e[0][x][1][1])+G;break;case 4:Y=Br(" ",e[0][x][1][1])+Y;break;case 5:Y=Br("\r",e[0][x][1][1])+Y;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}l.push(G+l.pop()+Y);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":f={c:g[1][1],r:g[1][0]};var J={c:r.c,r:r.r};if(n.sharedf[Wt(f)]){var Q=n.sharedf[Wt(f)];l.push(En(Q,i,J,n,a))}else{var X=!1;for(o=0;o!=n.arrayf.length;++o)if(u=n.arrayf[o],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){l.push(En(u[1],i,J,n,a)),X=!0;break}X||l.push(g[1])}break;case"PtgArray":l.push("{"+o4(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&ee.indexOf(e[0][y][0])==-1){g=e[0][x];var F=!0;switch(g[1][0]){case 4:F=!1;case 0:v=Br(" ",g[1][1]);break;case 5:F=!1;case 1:v=Br("\r",g[1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}l.push((F?v:"")+l.pop()+(F?"":v)),x=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function f4(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Fn(e,t-2)];var l=Yo(e,i,r);return t!==i+a&&(s=Xo(e,t-i-a,l,r)),e.l=n,[l,s]}function d4(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Fn(e,t-2)];var l=Yo(e,i,r);return t!==i+a&&(s=Xo(e,t-i-a,l,r)),e.l=n,[l,s]}function h4(e,t,r,n){var a=e.l+t,s=Yo(e,n,r),i;return a!==e.l&&(i=Xo(e,a-e.l,s,r)),[s,i]}function p4(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=Yo(e,s,r);return s==65535?[[],Fn(e,t-2)]:(t!==s+2&&(a=Xo(e,n-s-2,i,r)),[i,a])}function m4(e){var t;if(ss(e,e.l+6)!==65535)return[Cn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function M0(e,t,r){var n=e.l+t,a=Za(e);r.biff==2&&++e.l;var s=m4(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=d4(e,n-e.l,r);return{cell:a,val:s[0],formula:l,shared:i>>3&1,tt:s[1]}}function Xu(e,t,r){var n=e.read_shift(4),a=Yo(e,n,r),s=e.read_shift(4),i=s>0?Xo(e,s,a,r):null;return[a,i]}var x4=Xu,Yu=Xu,g4=Xu,v4=Xu,y4={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},hy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},w4={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Km(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function R0(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var oo={},sl={};function co(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function py(e,t,r,n,a,s){try{n.cellNF&&(e.z=Yt[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=cn(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Yt[t]==null&&ui(kS[t]||"General",t),e.t==="e")e.w=e.w||Ci[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fo(e.v);else if(e.t==="d"){var i=Bn(e.v);(i|0)===i?e.w=i.toString(10):e.w=Fo(i)}else{if(e.v===void 0)return"";e.w=gi(e.v,sl)}else e.t==="d"?e.w=Sa(t,Bn(e.v),sl):e.w=Sa(t,e.v,sl)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=_u(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=_u(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function k4(e,t){var r=Ur(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=or(r))}var _4=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,S4=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,E4=/<(?:\w:)?hyperlink [^>]*>/mg,b4=/"(\w*:\w*)"/,C4=/<(?:\w:)?col\b[^>]*[\/]?>/g,T4=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,N4=/<(?:\w:)?pageMargins[^>]*\/>/g,my=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,A4=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,j4=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function F4(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},o={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",d=e.match(S4);d?(u=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):u=f=e;var p=u.match(my);p?gh(p[0],l,a,r):(p=u.match(A4))&&M4(p[0],p[1]||"",l,a,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=u.slice(h,h+50).match(b4);m&&k4(l,m[1])}var x=u.match(j4);x&&x[1]&&P4(x[1],a);var v=[];if(t.cellStyles){var y=u.match(C4);y&&z4(v,y)}d&&D4(d[1],l,t,o,s,i);var w=f.match(T4);w&&(l["!autofilter"]=L4(w[0]));var g=[],E=f.match(_4);if(E)for(h=0;h!=E.length;++h)g[h]=Ur(E[h].slice(E[h].indexOf('"')+1));var A=f.match(E4);A&&R4(l,A,n);var z=f.match(N4);if(z&&(l["!margins"]=I4(It(z[0]))),!l["!ref"]&&o.e.c>=o.s.c&&o.e.r>=o.s.r&&(l["!ref"]=or(o)),t.sheetRows>0&&l["!ref"]){var b=Ur(l["!ref"]);t.sheetRows<=+b.e.r&&(b.e.r=t.sheetRows-1,b.e.r>o.e.r&&(b.e.r=o.e.r),b.e.r<b.s.r&&(b.s.r=b.e.r),b.e.c>o.e.c&&(b.e.c=o.e.c),b.e.c<b.s.c&&(b.s.c=b.e.c),l["!fullref"]=l["!ref"],l["!ref"]=or(b))}return v.length>0&&(l["!cols"]=v),g.length>0&&(l["!merges"]=g),l}function gh(e,t,r,n){var a=It(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=dr(br(a.codeName)))}function M4(e,t,r,n,a){gh(e.slice(0,e.indexOf(">")),r,n,a)}function R4(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=It(br(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+dr(s.location))):(s.Target="#"+dr(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=Ur(s.ref),o=l.s.r;o<=l.e.r;++o)for(var u=l.s.c;u<=l.e.c;++u){var f=Wt({c:u,r:o});n?(e[o]||(e[o]=[]),e[o][u]||(e[o][u]={t:"z",v:void 0}),e[o][u].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function I4(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function z4(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=It(t[n],!0);a.hidden&&(a.hidden=jr(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,mh(a.width)),gl(a);s<=i;)e[s++]=mn(a)}}function L4(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var O4=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function P4(e,t){t.Views||(t.Views=[{}]),(e.match(O4)||[]).forEach(function(r,n){var a=It(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),jr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var D4=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Mo("v"),i=Mo("f");return function(o,u,f,d,p,h){for(var m=0,x="",v=[],y=[],w=0,g=0,E=0,A="",z,b,S=0,_=0,T,D,M=0,G=0,Y=Array.isArray(h.CellXf),J,Q=[],X=[],ee=Array.isArray(u),F=[],le={},re=!1,j=!!f.sheetStubs,R=o.split(t),B=0,V=R.length;B!=V;++B){x=R[B].trim();var te=x.length;if(te!==0){var ke=0;e:for(m=0;m<te;++m)switch(x[m]){case">":if(x[m-1]!="/"){++m;break e}if(f&&f.cellStyles){if(b=It(x.slice(ke,m),!0),S=b.r!=null?parseInt(b.r,10):S+1,_=-1,f.sheetRows&&f.sheetRows<S)continue;le={},re=!1,b.ht&&(re=!0,le.hpt=parseFloat(b.ht),le.hpx=Lo(le.hpt)),b.hidden=="1"&&(re=!0,le.hidden=!0),b.outlineLevel!=null&&(re=!0,le.level=+b.outlineLevel),re&&(F[S-1]=le)}break;case"<":ke=m;break}if(ke>=m)break;if(b=It(x.slice(ke,m),!0),S=b.r!=null?parseInt(b.r,10):S+1,_=-1,!(f.sheetRows&&f.sheetRows<S)){d.s.r>S-1&&(d.s.r=S-1),d.e.r<S-1&&(d.e.r=S-1),f&&f.cellStyles&&(le={},re=!1,b.ht&&(re=!0,le.hpt=parseFloat(b.ht),le.hpx=Lo(le.hpt)),b.hidden=="1"&&(re=!0,le.hidden=!0),b.outlineLevel!=null&&(re=!0,le.level=+b.outlineLevel),re&&(F[S-1]=le)),v=x.slice(m).split(e);for(var _e=0;_e!=v.length&&v[_e].trim().charAt(0)=="<";++_e);for(v=v.slice(_e),m=0;m!=v.length;++m)if(x=v[m].trim(),x.length!==0){if(y=x.match(r),w=m,g=0,E=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,y!=null&&y.length===2){for(w=0,A=y[1],g=0;g!=A.length&&!((E=A.charCodeAt(g)-64)<1||E>26);++g)w=26*w+E;--w,_=w}else++_;for(g=0;g!=x.length&&x.charCodeAt(g)!==62;++g);if(++g,b=It(x.slice(0,g),!0),b.r||(b.r=Wt({r:S-1,c:_})),A=x.slice(g),z={t:""},(y=A.match(s))!=null&&y[1]!==""&&(z.v=dr(y[1])),f.cellFormula){if((y=A.match(i))!=null&&y[1]!==""){if(z.f=dr(br(y[1])).replace(/\r\n/g,`
`),f.xlfn||(z.f=Wm(z.f)),y[0].indexOf('t="array"')>-1)z.F=(A.match(a)||[])[1],z.F.indexOf(":")>-1&&Q.push([Ur(z.F),z.F]);else if(y[0].indexOf('t="shared"')>-1){D=It(y[0]);var ge=dr(br(y[1]));f.xlfn||(ge=Wm(ge)),X[parseInt(D.si,10)]=[D,ge,b.r]}}else(y=A.match(/<f[^>]*\/>/))&&(D=It(y[0]),X[D.si]&&(z.f=JT(X[D.si][1],X[D.si][2],b.r)));var ye=On(b.r);for(g=0;g<Q.length;++g)ye.r>=Q[g][0].s.r&&ye.r<=Q[g][0].e.r&&ye.c>=Q[g][0].s.c&&ye.c<=Q[g][0].e.c&&(z.F=Q[g][1])}if(b.t==null&&z.v===void 0)if(z.f||z.F)z.v=0,z.t="n";else if(j)z.t="z";else continue;else z.t=b.t||"n";switch(d.s.c>_&&(d.s.c=_),d.e.c<_&&(d.e.c=_),z.t){case"n":if(z.v==""||z.v==null){if(!j)continue;z.t="z"}else z.v=parseFloat(z.v);break;case"s":if(typeof z.v>"u"){if(!j)continue;z.t="z"}else T=oo[parseInt(z.v,10)],z.v=T.t,z.r=T.r,f.cellHTML&&(z.h=T.h);break;case"str":z.t="s",z.v=z.v!=null?br(z.v):"",f.cellHTML&&(z.h=ah(z.v));break;case"inlineStr":y=A.match(n),z.t="s",y!=null&&(T=ph(y[1]))?(z.v=T.t,f.cellHTML&&(z.h=T.h)):z.v="";break;case"b":z.v=jr(z.v);break;case"d":f.cellDates?z.v=cn(z.v,1):(z.v=Bn(cn(z.v,1)),z.t="n");break;case"e":(!f||f.cellText!==!1)&&(z.w=z.v),z.v=Lv[z.v];break}if(M=G=0,J=null,Y&&b.s!==void 0&&(J=h.CellXf[b.s],J!=null&&(J.numFmtId!=null&&(M=J.numFmtId),f.cellStyles&&J.fillId!=null&&(G=J.fillId))),py(z,M,G,f,p,h),f.cellDates&&Y&&z.t=="n"&&Sl(Yt[M])&&(z.t="d",z.v=Gu(z.v)),b.cm&&f.xlmeta){var Ee=(f.xlmeta.Cell||[])[+b.cm-1];Ee&&Ee.type=="XLDAPR"&&(z.D=!0)}if(ee){var C=On(b.r);u[C.r]||(u[C.r]=[]),u[C.r][C.c]=z}else u[b.r]=z}}}}F.length>0&&(u["!rows"]=F)}}();function B4(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}var U4=bi;function $4(){}function W4(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=fE(e),r}function H4(e){var t=Ea(e);return[t]}function V4(e){var t=Ei(e);return[t]}function G4(e){var t=Ea(e),r=e.read_shift(1);return[t,r,"b"]}function K4(e){var t=Ei(e),r=e.read_shift(1);return[t,r,"b"]}function X4(e){var t=Ea(e),r=e.read_shift(1);return[t,r,"e"]}function Y4(e){var t=Ei(e),r=e.read_shift(1);return[t,r,"e"]}function J4(e){var t=Ea(e),r=e.read_shift(4);return[t,r,"s"]}function Q4(e){var t=Ei(e),r=e.read_shift(4);return[t,r,"s"]}function Z4(e){var t=Ea(e),r=Cn(e);return[t,r,"n"]}function xy(e){var t=Ei(e),r=Cn(e);return[t,r,"n"]}function q4(e){var t=Ea(e),r=fh(e);return[t,r,"n"]}function eA(e){var t=Ei(e),r=fh(e);return[t,r,"n"]}function tA(e){var t=Ea(e),r=ch(e);return[t,r,"is"]}function rA(e){var t=Ea(e),r=An(e);return[t,r,"str"]}function nA(e){var t=Ei(e),r=An(e);return[t,r,"str"]}function aA(e,t,r){var n=e.l+t,a=Ea(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var l=Yu(e,n-e.l,r);i[3]=En(l,null,a,r.supbooks,r)}else e.l=n;return i}function sA(e,t,r){var n=e.l+t,a=Ea(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var l=Yu(e,n-e.l,r);i[3]=En(l,null,a,r.supbooks,r)}else e.l=n;return i}function iA(e,t,r){var n=e.l+t,a=Ea(e);a.r=r["!row"];var s=Cn(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var l=Yu(e,n-e.l,r);i[3]=En(l,null,a,r.supbooks,r)}else e.l=n;return i}function lA(e,t,r){var n=e.l+t,a=Ea(e);a.r=r["!row"];var s=An(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var l=Yu(e,n-e.l,r);i[3]=En(l,null,a,r.supbooks,r)}else e.l=n;return i}var oA=bi;function cA(e,t){var r=e.l+t,n=bi(e),a=uh(e),s=An(e),i=An(e),l=An(e);e.l=r;var o={rfx:n,relId:a,loc:s,display:l};return i&&(o.Tooltip=i),o}function uA(){}function fA(e,t,r){var n=e.l+t,a=Rv(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var l=x4(e,n-e.l,r);i[1]=l}else e.l=n;return i}function dA(e,t,r){var n=e.l+t,a=bi(e),s=[a];if(r.cellFormula){var i=v4(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}var hA=["left","right","top","bottom","header","footer"];function pA(e){var t={};return hA.forEach(function(r){t[r]=Cn(e)}),t}function mA(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function xA(){}function gA(){}function vA(e,t,r,n,a,s,i){if(!e)return e;var l=t||{};n||(n={"!id":{}});var o=l.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,p=!1,h,m,x,v,y,w,g,E,A,z=[];l.biff=12,l["!row"]=0;var b=0,S=!1,_=[],T={},D=l.supbooks||a.supbooks||[[]];if(D.sharedf=T,D.arrayf=_,D.SheetNames=a.SheetNames||a.Sheets.map(function(ee){return ee.name}),!l.supbooks&&(l.supbooks=D,a.Names))for(var M=0;M<a.Names.length;++M)D[0][M+1]=a.Names[M];var G=[],Y=[],J=!1;bu[16]={n:"BrtShortReal",f:xy};var Q;if(xs(e,function(F,le,re){if(!p)switch(re){case 148:u=F;break;case 0:h=F,l.sheetRows&&l.sheetRows<=h.r&&(p=!0),E=xn(v=h.r),l["!row"]=h.r,(F.hidden||F.hpt||F.level!=null)&&(F.hpt&&(F.hpx=Lo(F.hpt)),Y[F.r]=F);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:F[2]},F[2]){case"n":m.v=F[1];break;case"s":g=oo[F[1]],m.v=g.t,m.r=g.r;break;case"b":m.v=!!F[1];break;case"e":m.v=F[1],l.cellText!==!1&&(m.w=Ci[m.v]);break;case"str":m.t="s",m.v=F[1];break;case"is":m.t="s",m.v=F[1].t;break}if((x=i.CellXf[F[0].iStyleRef])&&py(m,x.numFmtId,null,l,s,i),y=F[0].c==-1?y+1:F[0].c,l.dense?(o[v]||(o[v]=[]),o[v][y]=m):o[tn(y)+E]=m,l.cellFormula){for(S=!1,b=0;b<_.length;++b){var j=_[b];h.r>=j[0].s.r&&h.r<=j[0].e.r&&y>=j[0].s.c&&y<=j[0].e.c&&(m.F=or(j[0]),S=!0)}!S&&F.length>3&&(m.f=F[3])}if(f.s.r>h.r&&(f.s.r=h.r),f.s.c>y&&(f.s.c=y),f.e.r<h.r&&(f.e.r=h.r),f.e.c<y&&(f.e.c=y),l.cellDates&&x&&m.t=="n"&&Sl(Yt[x.numFmtId])){var R=li(m.v);R&&(m.t="d",m.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}Q&&(Q.type=="XLDAPR"&&(m.D=!0),Q=void 0);break;case 1:case 12:if(!l.sheetStubs||d)break;m={t:"z",v:void 0},y=F[0].c==-1?y+1:F[0].c,l.dense?(o[v]||(o[v]=[]),o[v][y]=m):o[tn(y)+E]=m,f.s.r>h.r&&(f.s.r=h.r),f.s.c>y&&(f.s.c=y),f.e.r<h.r&&(f.e.r=h.r),f.e.c<y&&(f.e.c=y),Q&&(Q.type=="XLDAPR"&&(m.D=!0),Q=void 0);break;case 176:z.push(F);break;case 49:Q=((l.xlmeta||{}).Cell||[])[F-1];break;case 494:var B=n["!id"][F.relId];for(B?(F.Target=B.Target,F.loc&&(F.Target+="#"+F.loc),F.Rel=B):F.relId==""&&(F.Target="#"+F.loc),v=F.rfx.s.r;v<=F.rfx.e.r;++v)for(y=F.rfx.s.c;y<=F.rfx.e.c;++y)l.dense?(o[v]||(o[v]=[]),o[v][y]||(o[v][y]={t:"z",v:void 0}),o[v][y].l=F):(w=Wt({c:y,r:v}),o[w]||(o[w]={t:"z",v:void 0}),o[w].l=F);break;case 426:if(!l.cellFormula)break;_.push(F),A=l.dense?o[v][y]:o[tn(y)+E],A.f=En(F[1],f,{r:h.r,c:y},D,l),A.F=or(F[0]);break;case 427:if(!l.cellFormula)break;T[Wt(F[0].s)]=F[1],A=l.dense?o[v][y]:o[tn(y)+E],A.f=En(F[1],f,{r:h.r,c:y},D,l);break;case 60:if(!l.cellStyles)break;for(;F.e>=F.s;)G[F.e--]={width:F.w/256,hidden:!!(F.flags&1),level:F.level},J||(J=!0,mh(F.w/256)),gl(G[F.e+1]);break;case 161:o["!autofilter"]={ref:or(F)};break;case 476:o["!margins"]=F;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),F.name&&(a.Sheets[r].CodeName=F.name),(F.above||F.left)&&(o["!outline"]={above:F.above,left:F.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),F.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!le.T){if(!d||l.WTF)throw new Error("Unexpected record 0x"+re.toString(16))}}},l),delete l.supbooks,delete l["!row"],!o["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(o["!ref"]=or(u||f)),l.sheetRows&&o["!ref"]){var X=Ur(o["!ref"]);l.sheetRows<=+X.e.r&&(X.e.r=l.sheetRows-1,X.e.r>f.e.r&&(X.e.r=f.e.r),X.e.r<X.s.r&&(X.s.r=X.e.r),X.e.c>f.e.c&&(X.e.c=f.e.c),X.e.c<X.s.c&&(X.s.c=X.e.c),o["!fullref"]=o["!ref"],o["!ref"]=or(X))}return z.length>0&&(o["!merges"]=z),G.length>0&&(o["!cols"]=G),Y.length>0&&(o["!rows"]=Y),o}function yA(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=dr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function wA(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var l=0,o=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var p=yA(d);f.s.r=f.s.c=0,f.e.c=l,u=tn(l),p[0].forEach(function(h,m){i[u+xn(m)]={t:"n",v:h,z:p[1]},o=m}),f.e.r<o&&(f.e.r=o),++l}),l>0&&(i["!ref"]=or(f)),i}function kA(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,l=e.match(my);return l&&gh(l[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function _A(e,t){e.l+=10;var r=An(e);return{name:r}}function SA(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return xs(e,function(o,u,f){switch(f){case 550:s["!rel"]=o;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),o.name&&(a.Sheets[r].CodeName=o.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var gy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],EA=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],bA=[],CA=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Xm(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=jr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Ym(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=jr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function vy(e){Ym(e.WBProps,gy),Ym(e.CalcPr,CA),Xm(e.WBView,EA),Xm(e.Sheets,bA),sl.date1904=jr(e.WBProps.date1904)}var TA="][*?/\\".split("");function NA(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return TA.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var AA=/<\w+:workbook/;function jA(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Mn,function(o,u){var f=It(o);switch(Qa(f[0])){case"<?xml":break;case"<workbook":o.match(AA)&&(a="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":gy.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=jr(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=br(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=dr(br(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=br(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),jr(f.hidden||"0")&&(s.Hidden=!0),i=u+o.length;break;case"</definedName>":s.Ref=dr(br(e.slice(i,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return o}),XS.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return vy(r),r}function FA(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Uf(e),r.name=An(e),r}function MA(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?An(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function RA(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function IA(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=dE(e),i=g4(e,0,r),l=uh(e);e.l=n;var o={Name:s,Ptg:i};return a<268435455&&(o.Sheet=a),l&&(o.Comment=l),o}function zA(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],bu[16]={n:"BrtFRTArchID$",f:RA},xs(e,function(o,u,f){switch(f){case 156:i.SheetNames.push(o.name),r.Sheets.push(o);break;case 153:r.WBProps=o;break;case 39:o.Sheet!=null&&(t.SID=o.Sheet),o.Ref=En(o.Ptg,null,null,i,t),delete t.SID,delete o.Ptg,s.push(o);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,o]):i[0]=[f,o],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(o),i.XTI=i.XTI.concat(o);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),vy(r),r.Names=s,r.supbooks=i,r}function LA(e,t,r){return t.slice(-4)===".bin"?zA(e,r):jA(e,r)}function OA(e,t,r,n,a,s,i,l){return t.slice(-4)===".bin"?vA(e,n,r,a,s,i,l):F4(e,n,r,a,s,i,l)}function PA(e,t,r,n,a,s,i,l){return t.slice(-4)===".bin"?SA(e,n,r,a,s):kA(e,n,r,a,s)}function DA(e,t,r,n,a,s,i,l){return t.slice(-4)===".bin"?KT():XT()}function BA(e,t,r,n,a,s,i,l){return t.slice(-4)===".bin"?VT():GT()}function UA(e,t,r,n){return t.slice(-4)===".bin"?oT(e,r,n):rT(e,r,n)}function $A(e,t,r){return ay(e,r)}function WA(e,t,r){return t.slice(-4)===".bin"?EC(e,r):_C(e,r)}function HA(e,t,r){return t.slice(-4)===".bin"?$T(e,r):OT(e,r)}function VA(e,t,r){return t.slice(-4)===".bin"?IT(e):MT(e)}function GA(e,t,r,n){return r.slice(-4)===".bin"?zT(e,t,r,n):void 0}function KA(e,t,r){return t.slice(-4)===".bin"?jT(e,t,r):FT(e,t,r)}var yy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wy=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ca(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(yy),s,i,l,o;if(a)for(o=0;o!=a.length;++o)s=a[o].match(wy),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(i+1),n[l]=s[2].slice(1,s[2].length-1));return n}function XA(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(yy),a,s,i,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(wy),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var uo;function YA(e,t){var r=uo[e]||dr(e);return r==="General"?gi(t):Sa(r,t)}function JA(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=jr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=cn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[dr(t)]=a}function QA(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ci[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fo(e.v):e.w=gi(e.v):e.w=YA(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=uo[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Sl(n)){var a=li(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function ZA(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=JC[n.Pattern]||n.Pattern)}e[t.ID]=t}function qA(e,t,r,n,a,s,i,l,o,u){var f="General",d=n.StyleID,p={};u=u||{};var h=[],m=0;for(d===void 0&&l&&(d=l.StyleID),d===void 0&&i&&(d=i.StyleID);s[d]!==void 0&&(s[d].nf&&(f=s[d].nf),s[d].Interior&&h.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=jr(e);break;case"String":n.t="s",n.r=gm(dr(e)),n.v=e.indexOf("<")>-1?dr(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(cn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=dr(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Lv[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=gm(t||e));break}if(QA(n,f,u),u.cellFormula!==!1)if(n.Formula){var x=dr(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=al(x,a),delete n.Formula,n.ArrayRange=="RC"?n.F=al("RC:RC",a):n.ArrayRange&&(n.F=al(n.ArrayRange,a),o.push([Ur(n.F),n.F]))}else for(m=0;m<o.length;++m)a.r>=o[m][0].s.r&&a.r<=o[m][0].e.r&&a.c>=o[m][0].s.c&&a.c<=o[m][0].e.c&&(n.F=o[m][1]);u.cellStyles&&(h.forEach(function(v){!p.patternType&&v.patternType&&(p.patternType=v.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function ej(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function I0(e,t){var r=t||{};ov();var n=Wl(sh(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=br(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=mn(r);return i.type="string",Io.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(qe){a.indexOf("<"+qe)>=0&&(s=!0)}),s)return cj(n,r);uo={"General Number":"General","General Date":Yt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Yt[15],"Short Date":Yt[14],"Long Time":Yt[19],"Medium Time":Yt[18],"Short Time":Yt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Yt[2],Standard:Yt[4],Percent:Yt[10],Scientific:Yt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,o=[],u,f={},d=[],p=r.dense?[]:{},h="",m={},x={},v=Ca('<Data ss:Type="String">'),y=0,w=0,g=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},z={},b="",S=0,_=[],T={},D={},M=0,G=[],Y=[],J={},Q=[],X,ee=!1,F=[],le=[],re={},j=0,R=0,B={Sheets:[],WBProps:{date1904:!1}},V={};Ro.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";l=Ro.exec(n);)switch(l[3]=(te=l[3]).toLowerCase()){case"data":if(te=="data"){if(l[1]==="/"){if((u=o.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&o.push([l[3],!0]);break}if(o[o.length-1][1])break;l[1]==="/"?qA(n.slice(y,l.index),b,v,o[o.length-1][0]=="comment"?J:m,{c:w,r:g},A,Q[w],x,F,r):(b="",v=Ca(l[0]),y=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Y.length>0&&(m.c=Y),(!r.sheetRows||r.sheetRows>g)&&m.v!==void 0&&(r.dense?(p[g]||(p[g]=[]),p[g][w]=m):p[tn(w)+xn(g)]=m),m.HRef&&(m.l={Target:dr(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(j=w+(parseInt(m.MergeAcross,10)|0),R=g+(parseInt(m.MergeDown,10)|0),_.push({s:{c:w,r:g},e:{c:j,r:R}})),!r.sheetStubs)m.MergeAcross?w=j+1:++w;else if(m.MergeAcross||m.MergeDown){for(var ke=w;ke<=j;++ke)for(var _e=g;_e<=R;++_e)(ke>w||_e>g)&&(r.dense?(p[_e]||(p[_e]=[]),p[_e][ke]={t:"z"}):p[tn(ke)+xn(_e)]={t:"z"});w=j+1}else++w;else m=XA(l[0]),m.Index&&(w=+m.Index-1),w<E.s.c&&(E.s.c=w),w>E.e.c&&(E.e.c=w),l[0].slice(-2)==="/>"&&++w,Y=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(g<E.s.r&&(E.s.r=g),g>E.e.r&&(E.e.r=g),l[0].slice(-2)==="/>"&&(x=Ca(l[0]),x.Index&&(g=+x.Index-1)),w=0,++g):(x=Ca(l[0]),x.Index&&(g=+x.Index-1),re={},(x.AutoFitHeight=="0"||x.Height)&&(re.hpx=parseInt(x.Height,10),re.hpt=ny(re.hpx),le[g]=re),x.Hidden=="1"&&(re.hidden=!0,le[g]=re));break;case"worksheet":if(l[1]==="/"){if((u=o.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));d.push(h),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(p["!ref"]=or(E),r.sheetRows&&r.sheetRows<=E.e.r&&(p["!fullref"]=p["!ref"],E.e.r=r.sheetRows-1,p["!ref"]=or(E))),_.length&&(p["!merges"]=_),Q.length>0&&(p["!cols"]=Q),le.length>0&&(p["!rows"]=le),f[h]=p}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=w=0,o.push([l[3],!1]),u=Ca(l[0]),h=dr(u.Name),p=r.dense?[]:{},_=[],F=[],le=[],V={name:h,Hidden:0},B.Sheets.push(V);break;case"table":if(l[1]==="/"){if((u=o.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;o.push([l[3],!1]),Q=[],ee=!1}break;case"style":l[1]==="/"?ZA(A,z,r):z=Ca(l[0]);break;case"numberformat":z.nf=dr(Ca(l[0]).Format||"General"),uo[z.nf]&&(z.nf=uo[z.nf]);for(var ge=0;ge!=392&&Yt[ge]!=z.nf;++ge);if(ge==392){for(ge=57;ge!=392;++ge)if(Yt[ge]==null){ui(z.nf,ge);break}}break;case"column":if(o[o.length-1][0]!=="table")break;if(X=Ca(l[0]),X.Hidden&&(X.hidden=!0,delete X.Hidden),X.Width&&(X.wpx=parseInt(X.Width,10)),!ee&&X.wpx>10){ee=!0,Ln=ty;for(var ye=0;ye<Q.length;++ye)Q[ye]&&gl(Q[ye])}ee&&gl(X),Q[X.Index-1||Q.length]=X;for(var Ee=0;Ee<+X.Span;++Ee)Q[Q.length]=mn(X);break;case"namedrange":if(l[1]==="/")break;B.Names||(B.Names=[]);var C=It(l[0]),we={Name:C.Name,Ref:al(C.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(we.Sheet=B.Sheets.length-1),B.Names.push(we);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?b+=n.slice(S,l.index):S=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;z.Interior=Ca(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?OE(T,te,n.slice(M,l.index)):M=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=o.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else o.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=o.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));ej(J),Y.push(J)}else o.push([l[3],!1]),u=Ca(l[0]),J={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=o.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var he=Ca(l[0]);p["!autofilter"]={ref:al(he.Range).replace(/\$/g,"")},o.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=o.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&o.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=o.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&o.push([l[3],!0]);break;case"null":break;default:if(o.length==0&&l[3]=="document"||o.length==0&&l[3]=="uof")return tx(n,r);var Ce=!0;switch(o[o.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ce=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ce=!1}break;case"excelworkbook":switch(l[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ce=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Ce=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(M,l.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else M=l.index+l[0].length;break;case"header":p["!margins"]||co(p["!margins"]={},"xlml"),isNaN(+It(l[0]).Margin)||(p["!margins"].header=+It(l[0]).Margin);break;case"footer":p["!margins"]||co(p["!margins"]={},"xlml"),isNaN(+It(l[0]).Margin)||(p["!margins"].footer=+It(l[0]).Margin);break;case"pagemargins":var Ae=It(l[0]);p["!margins"]||co(p["!margins"]={},"xlml"),isNaN(+Ae.Top)||(p["!margins"].top=+Ae.Top),isNaN(+Ae.Left)||(p["!margins"].left=+Ae.Left),isNaN(+Ae.Right)||(p["!margins"].right=+Ae.Right),isNaN(+Ae.Bottom)||(p["!margins"].bottom=+Ae.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ce=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ce=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ce=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ce=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ce=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ce=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ce=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ce=!1}break;case"smarttags":break;default:Ce=!1;break}if(Ce||l[3].match(/!\[CDATA/))break;if(!o[o.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+o.join("|");if(o[o.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?JA(D,te,G,n.slice(M,l.index)):(G=l,M=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+o.join("|")}var be={};return!r.bookSheets&&!r.bookProps&&(be.Sheets=f),be.SheetNames=d,be.Workbook=B,be.SSF=mn(Yt),be.Props=T,be.Custprops=D,be}function Vf(e,t){switch(wh(t=t||{}),t.type||"base64"){case"base64":return I0(ca(e),t);case"binary":case"buffer":case"file":return I0(e,t);case"array":return I0(Si(e),t)}}function tj(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=mE(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=xE(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var rj=[60,1084,2066,2165,2175];function nj(e,t,r,n,a){var s=n,i=[],l=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}i.push(l),r.l+=s;for(var o=ss(r,r.l),u=Gf[o],f=0;u!=null&&rj.indexOf(o)>-1;)s=ss(r,r.l+2),f=r.l+4,o==2066?f+=4:(o==2165||o==2175)&&(f+=12),l=r.slice(f,r.l+4+s),i.push(l),r.l+=4+s,u=Gf[o=ss(r,r.l)];var d=Cs(i);hn(d,0);var p=0;d.lens=[];for(var h=0;h<i.length;++h)d.lens.push(p),p+=i[h].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function Wa(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Yt[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ci[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fo(e.v):e.w=gi(e.v):e.w=Sa(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Sl(Yt[n]||String(n))){var a=li(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Cc(e,t,r){return{v:e,ixfe:t,t:r}}function aj(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},l=null,o=[],u="",f={},d,p="",h,m,x,v,y={},w=[],g,E,A=[],z=[],b={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},_=function(Xe){return Xe<8?fi[Xe]:Xe<64&&z[Xe-8]||fi[Xe]},T=function(Xe,Rt,q){var oe=Rt.XF.data;if(!(!oe||!oe.patternType||!q||!q.cellStyles)){Rt.s={},Rt.s.patternType=oe.patternType;var pe;(pe=zo(_(oe.icvFore)))&&(Rt.s.fgColor={rgb:pe}),(pe=zo(_(oe.icvBack)))&&(Rt.s.bgColor={rgb:pe})}},D=function(Xe,Rt,q){if(!(re>1)&&!(q.sheetRows&&Xe.r>=q.sheetRows)){if(q.cellStyles&&Rt.XF&&Rt.XF.data&&T(Xe,Rt,q),delete Rt.ixfe,delete Rt.XF,d=Xe,p=Wt(Xe),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Xe.r<i.s.r&&(i.s.r=Xe.r),Xe.c<i.s.c&&(i.s.c=Xe.c),Xe.r+1>i.e.r&&(i.e.r=Xe.r+1),Xe.c+1>i.e.c&&(i.e.c=Xe.c+1),q.cellFormula&&Rt.f){for(var oe=0;oe<w.length;++oe)if(!(w[oe][0].s.c>Xe.c||w[oe][0].s.r>Xe.r)&&!(w[oe][0].e.c<Xe.c||w[oe][0].e.r<Xe.r)){Rt.F=or(w[oe][0]),(w[oe][0].s.c!=Xe.c||w[oe][0].s.r!=Xe.r)&&delete Rt.f,Rt.f&&(Rt.f=""+En(w[oe][1],i,Xe,F,M));break}}q.dense?(a[Xe.r]||(a[Xe.r]=[]),a[Xe.r][Xe.c]=Rt):a[p]=Rt}},M={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(M.password=t.password);var G,Y=[],J=[],Q=[],X=[],ee=!1,F=[];F.SheetNames=M.snames,F.sharedf=M.sharedf,F.arrayf=M.arrayf,F.names=[],F.XTI=[];var le=0,re=0,j=0,R=[],B=[],V;M.codepage=1200,Ia(1200);for(var te=!1;e.l<e.length-1;){var ke=e.l,_e=e.read_shift(2);if(_e===0&&le===10)break;var ge=e.l===e.length?0:e.read_shift(2),ye=Gf[_e];if(ye&&ye.f){if(t.bookSheets&&le===133&&_e!==133)break;if(le=_e,ye.r===2||ye.r==12){var Ee=e.read_shift(2);if(ge-=2,!M.enc&&Ee!==_e&&((Ee&255)<<8|Ee>>8)!==_e)throw new Error("rt mismatch: "+Ee+"!="+_e);ye.r==12&&(e.l+=10,ge-=10)}var C={};if(_e===10?C=ye.f(e,ge,M):C=nj(_e,ye,e,ge,M),re==0&&[9,521,1033,2057].indexOf(le)===-1)continue;switch(_e){case 34:r.opts.Date1904=b.WBProps.date1904=C;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(M.enc||(e.l=0),M.enc=C,!t.password)throw new Error("File is password-protected");if(C.valid==null)throw new Error("Encryption scheme unsupported");if(!C.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=C;break;case 66:var we=Number(C);switch(we){case 21010:we=1200;break;case 32768:we=1e4;break;case 32769:we=1252;break}Ia(M.codepage=we),te=!0;break;case 317:M.rrtabid=C;break;case 25:M.winlocked=C;break;case 439:r.opts.RefreshAll=C;break;case 12:r.opts.CalcCount=C;break;case 16:r.opts.CalcDelta=C;break;case 17:r.opts.CalcIter=C;break;case 13:r.opts.CalcMode=C;break;case 14:r.opts.CalcPrecision=C;break;case 95:r.opts.CalcSaveRecalc=C;break;case 15:M.CalcRefMode=C;break;case 2211:r.opts.FullCalc=C;break;case 129:C.fDialog&&(a["!type"]="dialog"),C.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),C.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:A.push(C);break;case 430:F.push([C]),F[F.length-1].XTI=[];break;case 35:case 547:F[F.length-1].push(C);break;case 24:case 536:V={Name:C.Name,Ref:En(C.rgce,i,null,F,M)},C.itab>0&&(V.Sheet=C.itab-1),F.names.push(V),F[0]||(F[0]=[],F[0].XTI=[]),F[F.length-1].push(C),C.Name=="_xlnm._FilterDatabase"&&C.itab>0&&C.rgce&&C.rgce[0]&&C.rgce[0][0]&&C.rgce[0][0][0]=="PtgArea3d"&&(B[C.itab-1]={ref:or(C.rgce[0][0][1][2])});break;case 22:M.ExternCount=C;break;case 23:F.length==0&&(F[0]=[],F[0].XTI=[]),F[F.length-1].XTI=F[F.length-1].XTI.concat(C),F.XTI=F.XTI.concat(C);break;case 2196:if(M.biff<8)break;V!=null&&(V.Comment=C[1]);break;case 18:a["!protect"]=C;break;case 19:C!==0&&M.WTF&&console.error("Password verifier: "+C);break;case 133:s[C.pos]=C,M.snames.push(C.name);break;case 10:{if(--re)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=or(i),t.sheetRows&&t.sheetRows<=i.e.r){var he=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=or(i),i.e.r=he}i.e.r++,i.e.c++}Y.length>0&&(a["!merges"]=Y),J.length>0&&(a["!objects"]=J),Q.length>0&&(a["!cols"]=Q),X.length>0&&(a["!rows"]=X),b.Sheets.push(S)}u===""?f=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[_e]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[C.BIFFVer]||8),M.biffguess=C.BIFFVer==0,C.BIFFVer==0&&C.dt==4096&&(M.biff=5,te=!0,Ia(M.codepage=28591)),M.biff==8&&C.BIFFVer==0&&C.dt==16&&(M.biff=2),re++)break;if(a=t.dense?[]:{},M.biff<8&&!te&&(te=!0,Ia(M.codepage=t.codepage||1252)),M.biff<5||C.BIFFVer==0&&C.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ce={pos:e.l-ge,name:u};s[Ce.pos]=Ce,M.snames.push(u)}else u=(s[ke]||{name:""}).name;C.dt==32&&(a["!type"]="chart"),C.dt==64&&(a["!type"]="macro"),Y=[],J=[],M.arrayf=w=[],Q=[],X=[],ee=!1,S={Hidden:(s[ke]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[C.r]||[])[C.c]:a[Wt({c:C.c,r:C.r})])&&++C.c,g={ixfe:C.ixfe,XF:A[C.ixfe]||{},v:C.val,t:"n"},j>0&&(g.z=R[g.ixfe>>8&63]),Wa(g,t,r.opts.Date1904),D({c:C.c,r:C.r},g,t);break;case 5:case 517:g={ixfe:C.ixfe,XF:A[C.ixfe],v:C.val,t:C.t},j>0&&(g.z=R[g.ixfe>>8&63]),Wa(g,t,r.opts.Date1904),D({c:C.c,r:C.r},g,t);break;case 638:g={ixfe:C.ixfe,XF:A[C.ixfe],v:C.rknum,t:"n"},j>0&&(g.z=R[g.ixfe>>8&63]),Wa(g,t,r.opts.Date1904),D({c:C.c,r:C.r},g,t);break;case 189:for(var Ae=C.c;Ae<=C.C;++Ae){var be=C.rkrec[Ae-C.c][0];g={ixfe:be,XF:A[be],v:C.rkrec[Ae-C.c][1],t:"n"},j>0&&(g.z=R[g.ixfe>>8&63]),Wa(g,t,r.opts.Date1904),D({c:Ae,r:C.r},g,t)}break;case 6:case 518:case 1030:{if(C.val=="String"){l=C;break}if(g=Cc(C.val,C.cell.ixfe,C.tt),g.XF=A[g.ixfe],t.cellFormula){var qe=C.formula;if(qe&&qe[0]&&qe[0][0]&&qe[0][0][0]=="PtgExp"){var Ie=qe[0][0][1][0],ht=qe[0][0][1][1],yt=Wt({r:Ie,c:ht});y[yt]?g.f=""+En(C.formula,i,C.cell,F,M):g.F=((t.dense?(a[Ie]||[])[ht]:a[yt])||{}).F}else g.f=""+En(C.formula,i,C.cell,F,M)}j>0&&(g.z=R[g.ixfe>>8&63]),Wa(g,t,r.opts.Date1904),D(C.cell,g,t),l=C}break;case 7:case 519:if(l)l.val=C,g=Cc(C,l.cell.ixfe,"s"),g.XF=A[g.ixfe],t.cellFormula&&(g.f=""+En(l.formula,i,l.cell,F,M)),j>0&&(g.z=R[g.ixfe>>8&63]),Wa(g,t,r.opts.Date1904),D(l.cell,g,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(C);var Pt=Wt(C[0].s);if(h=t.dense?(a[C[0].s.r]||[])[C[0].s.c]:a[Pt],t.cellFormula&&h){if(!l||!Pt||!h)break;h.f=""+En(C[1],i,C[0],F,M),h.F=or(C[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!l)break;y[Wt(l.cell)]=C[0],h=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[Wt(l.cell)],(h||{}).f=""+En(C[0],i,d,F,M)}}break;case 253:g=Cc(o[C.isst].t,C.ixfe,"s"),o[C.isst].h&&(g.h=o[C.isst].h),g.XF=A[g.ixfe],j>0&&(g.z=R[g.ixfe>>8&63]),Wa(g,t,r.opts.Date1904),D({c:C.c,r:C.r},g,t);break;case 513:t.sheetStubs&&(g={ixfe:C.ixfe,XF:A[C.ixfe],t:"z"},j>0&&(g.z=R[g.ixfe>>8&63]),Wa(g,t,r.opts.Date1904),D({c:C.c,r:C.r},g,t));break;case 190:if(t.sheetStubs)for(var Fe=C.c;Fe<=C.C;++Fe){var vt=C.ixfe[Fe-C.c];g={ixfe:vt,XF:A[vt],t:"z"},j>0&&(g.z=R[g.ixfe>>8&63]),Wa(g,t,r.opts.Date1904),D({c:Fe,r:C.r},g,t)}break;case 214:case 516:case 4:g=Cc(C.val,C.ixfe,"s"),g.XF=A[g.ixfe],j>0&&(g.z=R[g.ixfe>>8&63]),Wa(g,t,r.opts.Date1904),D({c:C.c,r:C.r},g,t);break;case 0:case 512:re===1&&(i=C);break;case 252:o=C;break;case 1054:if(M.biff==4){R[j++]=C[1];for(var jt=0;jt<j+163&&Yt[jt]!=C[1];++jt);jt>=163&&ui(C[1],j+163)}else ui(C[1],C[0]);break;case 30:{R[j++]=C;for(var ft=0;ft<j+163&&Yt[ft]!=C;++ft);ft>=163&&ui(C,j+163)}break;case 229:Y=Y.concat(C);break;case 93:J[C.cmo[0]]=M.lastobj=C;break;case 438:M.lastobj.TxO=C;break;case 127:M.lastobj.ImData=C;break;case 440:for(v=C[0].s.r;v<=C[0].e.r;++v)for(x=C[0].s.c;x<=C[0].e.c;++x)h=t.dense?(a[v]||[])[x]:a[Wt({c:x,r:v})],h&&(h.l=C[1]);break;case 2048:for(v=C[0].s.r;v<=C[0].e.r;++v)for(x=C[0].s.c;x<=C[0].e.c;++x)h=t.dense?(a[v]||[])[x]:a[Wt({c:x,r:v})],h&&h.l&&(h.l.Tooltip=C[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;h=t.dense?(a[C[0].r]||[])[C[0].c]:a[Wt(C[0])];var kt=J[C[2]];h||(t.dense?(a[C[0].r]||(a[C[0].r]=[]),h=a[C[0].r][C[0].c]={t:"z"}):h=a[Wt(C[0])]={t:"z"},i.e.r=Math.max(i.e.r,C[0].r),i.s.r=Math.min(i.s.r,C[0].r),i.e.c=Math.max(i.e.c,C[0].c),i.s.c=Math.min(i.s.c,C[0].c)),h.c||(h.c=[]),m={a:C[1],t:kt.TxO.t},h.c.push(m)}break;case 2173:CT(A[C.ixfe],C.ext);break;case 125:{if(!M.cellStyles)break;for(;C.e>=C.s;)Q[C.e--]={width:C.w/256,level:C.level||0,hidden:!!(C.flags&1)},ee||(ee=!0,mh(C.w/256)),gl(Q[C.e+1])}break;case 520:{var Se={};C.level!=null&&(X[C.r]=Se,Se.level=C.level),C.hidden&&(X[C.r]=Se,Se.hidden=!0),C.hpt&&(X[C.r]=Se,Se.hpt=C.hpt,Se.hpx=Lo(C.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||co(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[_e]]=C;break;case 161:a["!margins"]||co(a["!margins"]={}),a["!margins"].header=C.header,a["!margins"].footer=C.footer;break;case 574:C.RTL&&(b.Views[0].RTL=!0);break;case 146:z=C;break;case 2198:G=C;break;case 140:E=C;break;case 442:u?S.CodeName=C||S.name:b.WBProps.CodeName=C||"ThisWorkbook";break}}else ye||console.error("Missing Info for XLS Record 0x"+_e.toString(16)),e.l+=ge}return r.SheetNames=Ja(s).sort(function(ot,Xe){return Number(ot)-Number(Xe)}).map(function(ot){return s[ot].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&B.forEach(function(ot,Xe){r.Sheets[r.SheetNames[Xe]]["!autofilter"]=ot}),r.Strings=o,r.SSF=mn(Yt),M.enc&&(r.Encryption=M.enc),G&&(r.Themes=G),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),F.names.length>0&&(b.Names=F.names),r.Workbook=b,r}var Jm={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function sj(e,t,r){var n=lr.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Rm(n,_E,Jm.DSI);for(var s in a)t[s]=a[s]}catch(u){if(r.WTF)throw u}var i=lr.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var l=Rm(i,SE,Jm.SI);for(var o in l)t[o]==null&&(t[o]=l[o])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(Pv(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function ky(e,t){t||(t={}),wh(t),J1(),t.codepage&&Zd(t.codepage);var r,n;if(e.FullPaths){if(lr.find(e,"/encryption"))throw new Error("File is password-protected");r=lr.find(e,"!CompObj"),n=lr.find(e,"/Workbook")||lr.find(e,"/Book")}else{switch(t.type){case"base64":e=Ra(ca(e));break;case"binary":e=Ra(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}hn(e,0),n={content:e}}var a,s;if(r&&tj(r),t.bookProps&&!t.bookSheets)a={};else{var i=ar?"buffer":"array";if(n&&n.content)a=aj(n.content,t);else if((s=lr.find(e,"PerfectOffice_MAIN"))&&s.content)a=lo.to_workbook(s.content,(t.type=i,t));else if((s=lr.find(e,"NativeContent_MAIN"))&&s.content)a=lo.to_workbook(s.content,(t.type=i,t));else throw(s=lr.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&lr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=HT(e))}var l={};return e.FullPaths&&sj(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}var bu={0:{f:B4},1:{f:H4},2:{f:q4},3:{f:X4},4:{f:G4},5:{f:Z4},6:{f:rA},7:{f:J4},8:{f:lA},9:{f:iA},10:{f:aA},11:{f:sA},12:{f:V4},13:{f:eA},14:{f:Y4},15:{f:K4},16:{f:xy},17:{f:nA},18:{f:Q4},19:{f:ch},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:IA},40:{},42:{},43:{f:aT},44:{f:nT},45:{f:sT},46:{f:lT},47:{f:iT},48:{},49:{f:oE},50:{},51:{f:NT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Jv},62:{f:tA},63:{f:RT},64:{f:xA},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Fn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:mA},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:W4},148:{f:U4,p:16},151:{f:uA},152:{},153:{f:MA},154:{},155:{},156:{f:FA},157:{},158:{},159:{T:1,f:SC},160:{T:-1},161:{T:1,f:bi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:oA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:TT},336:{T:-1},337:{f:AT,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Uf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Yv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:fA},427:{f:dA},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:pA},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:$4},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:cA},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Uf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:UT},633:{T:1},634:{T:-1},635:{T:1,f:BT},636:{T:-1},637:{f:uE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:_A},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:gA},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Gf={6:{f:M0},10:{f:ks},12:{f:Yr},13:{f:Yr},14:{f:Hr},15:{f:Hr},16:{f:Cn},17:{f:Hr},18:{f:Hr},19:{f:Yr},20:{f:Om},21:{f:Om},23:{f:Yv},24:{f:Dm},25:{f:Hr},26:{},27:{},28:{f:Pb},29:{},34:{f:Hr},35:{f:Pm},38:{f:Cn},39:{f:Cn},40:{f:Cn},41:{f:Cn},42:{f:Hr},43:{f:Hr},47:{f:$C},49:{f:yb},51:{f:Yr},60:{},61:{f:xb},64:{f:Hr},65:{f:vb},66:{f:Yr},77:{},80:{},81:{},82:{},85:{f:Yr},89:{},90:{},91:{},92:{f:ob},93:{f:Bb},94:{},95:{f:Hr},96:{},97:{},99:{f:Hr},125:{f:Jv},128:{f:Ab},129:{f:cb},130:{f:Yr},131:{f:Hr},132:{f:Hr},133:{f:ub},134:{},140:{f:Gb},141:{f:Yr},144:{},146:{f:Xb},151:{},152:{},153:{},154:{},155:{},156:{f:Yr},157:{},158:{},160:{f:qb},161:{f:Jb},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:bb},190:{f:Cb},193:{f:ks},197:{},198:{},199:{},200:{},201:{},202:{f:Hr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Yr},220:{},221:{f:Hr},222:{},224:{f:Nb},225:{f:lb},226:{f:ks},227:{},229:{f:Db},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:fb},253:{f:wb},255:{f:db},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Wv},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Hr},353:{f:ks},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Fb},431:{f:Hr},432:{},433:{},434:{},437:{},438:{f:Wb},439:{f:Hr},440:{f:Hb},441:{},442:{f:Go},443:{},444:{f:Yr},445:{},446:{},448:{f:ks},449:{f:mb,r:2},450:{f:ks},512:{f:zm},513:{f:Zb},515:{f:jb},516:{f:kb},517:{f:Lm},519:{f:eC},520:{f:hb},523:{},545:{f:Bm},549:{f:Im},566:{},574:{f:gb},638:{f:Eb},659:{},1048:{},1054:{f:_b},1084:{},1212:{f:zb},2048:{f:Vb},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Sc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ks},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Yb,r:12},2173:{f:bT,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Hr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Ib,r:12},2197:{},2198:{f:yT,r:12},2199:{},2200:{},2201:{},2202:{f:Lb,r:12},2203:{f:ks},2204:{},2205:{},2206:{},2207:{},2211:{f:pb},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Yr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Qb},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Kb},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:zm},1:{},2:{f:aC},3:{f:nC},4:{f:rC},5:{f:Lm},7:{f:sC},8:{},9:{f:Sc},11:{},22:{f:Yr},30:{f:Sb},31:{},32:{},33:{f:Bm},36:{},37:{f:Im},50:{f:iC},62:{},52:{},67:{},68:{f:Yr},69:{},86:{},126:{},127:{f:tC},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:lC},223:{},234:{},354:{},421:{},518:{f:M0},521:{f:Sc},536:{f:Dm},547:{f:Pm},561:{},579:{},1030:{f:M0},1033:{f:Sc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ta(e,t,r,n){var a=t;if(!isNaN(a)){var s=(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&jv(r)&&e.push(r)}}function Qm(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,l=s&&s.index||e.length,o=jS(e.slice(i,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,d=0,p=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<o.length;++i){var x=o[i].trim(),v=x.slice(0,3).toLowerCase();if(v=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(v!="<td"&&v!="<th")){var y=x.split(/<\/t[dh]>/i);for(l=0;l<y.length;++l){var w=y[l].trim();if(w.match(/<t[dh]/i)){for(var g=w,E=0;g.charAt(0)=="<"&&(E=g.indexOf(">"))>-1;)g=g.slice(E+1);for(var A=0;A<m.length;++A){var z=m[A];z.s.c==f&&z.s.r<u&&u<=z.e.r&&(f=z.e.c+1,A=-1)}var b=It(w.slice(0,w.indexOf(">")));p=b.colspan?+b.colspan:1,((d=+b.rowspan)>1||p>1)&&m.push({s:{r:u,c:f},e:{r:u+(d||1)-1,c:f+p-1}});var S=b.t||b["data-t"]||"";if(!g.length){f+=p;continue}if(g=gv(g),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>f&&(h.s.c=f),h.e.c<f&&(h.e.c=f),!g.length){f+=p;continue}var _={t:"s",v:g};r.raw||!g.trim().length||S=="s"||(g==="TRUE"?_={t:"b",v:!0}:g==="FALSE"?_={t:"b",v:!1}:isNaN(Da(g))?isNaN(xl(g).getDate())||(_={t:"d",v:cn(g)},r.cellDates||(_={t:"n",v:Bn(_.v)}),_.z=r.dateNF||Yt[14]):_={t:"n",v:Da(g)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=_):n[Wt({r:u,c:f})]=_,f+=p}}}}return n["!ref"]=or(h),m.length&&(n["!merges"]=m),n}function ij(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var l=0,o=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>i)&&!(a[u].e.r<r||a[u].e.c<i)){if(a[u].s.r<r||a[u].s.c<i){l=-1;break}l=a[u].e.r-a[u].s.r+1,o=a[u].e.c-a[u].s.c+1;break}if(!(l<0)){var f=Wt({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],p=d&&d.v!=null&&(d.h||ah(d.w||(ps(d),d.w)||""))||"",h={};l>1&&(h.rowspan=l),o>1&&(h.colspan=o),n.editable?p='<span contenteditable="true">'+p+"</span>":d&&(h["data-t"]=d&&d.t||"z",d.v!=null&&(h["data-v"]=d.v),d.z!=null&&(h["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+d.l.Target+'">'+p+"</a>")),h.id=(n.id||"sjs")+"-"+f,s.push(GS("td",p,h))}}var m="<tr>";return m+s.join("")+"</tr>"}var lj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',oj="</body></html>";function cj(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ys(Qm(r[0],t),t);var n=_h();return r.forEach(function(a,s){Sh(n,Qm(a,t),"Sheet"+(s+1))}),n}function uj(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function fj(e,t){var r=t||{},n=r.header!=null?r.header:lj,a=r.footer!=null?r.footer:oj,s=[n],i=El(e["!ref"]);r.dense=Array.isArray(e),s.push(uj(e,i,r));for(var l=i.s.r;l<=i.e.r;++l)s.push(ij(e,i,l,r));return s.push("</table>"+a),s.join("")}function _y(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?On(n.origin):n.origin;a=i.r,s=i.c}var l=t.getElementsByTagName("tr"),o=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var f=El(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),a==-1&&(u.e.r=a=f.e.r+1)}var d=[],p=0,h=e["!rows"]||(e["!rows"]=[]),m=0,x=0,v=0,y=0,w=0,g=0;for(e["!cols"]||(e["!cols"]=[]);m<l.length&&x<o;++m){var E=l[m];if(Zm(E)){if(n.display)continue;h[x]={hidden:!0}}var A=E.children;for(v=y=0;v<A.length;++v){var z=A[v];if(!(n.display&&Zm(z))){var b=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):gv(z.innerHTML),S=z.getAttribute("data-z")||z.getAttribute("z");for(p=0;p<d.length;++p){var _=d[p];_.s.c==y+s&&_.s.r<x+a&&x+a<=_.e.r&&(y=_.e.c+1-s,p=-1)}g=+z.getAttribute("colspan")||1,((w=+z.getAttribute("rowspan")||1)>1||g>1)&&d.push({s:{r:x+a,c:y+s},e:{r:x+a+(w||1)-1,c:y+s+(g||1)-1}});var T={t:"s",v:b},D=z.getAttribute("data-t")||z.getAttribute("t")||"";b!=null&&(b.length==0?T.t=D||"z":n.raw||b.trim().length==0||D=="s"||(b==="TRUE"?T={t:"b",v:!0}:b==="FALSE"?T={t:"b",v:!1}:isNaN(Da(b))?isNaN(xl(b).getDate())||(T={t:"d",v:cn(b)},n.cellDates||(T={t:"n",v:Bn(T.v)}),T.z=n.dateNF||Yt[14]):T={t:"n",v:Da(b)})),T.z===void 0&&S!=null&&(T.z=S);var M="",G=z.getElementsByTagName("A");if(G&&G.length)for(var Y=0;Y<G.length&&!(G[Y].hasAttribute("href")&&(M=G[Y].getAttribute("href"),M.charAt(0)!="#"));++Y);M&&M.charAt(0)!="#"&&(T.l={Target:M}),n.dense?(e[x+a]||(e[x+a]=[]),e[x+a][y+s]=T):e[Wt({c:y+s,r:x+a})]=T,u.e.c<y+s&&(u.e.c=y+s),y+=g}}++x}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,x-1+a),e["!ref"]=or(u),x>=o&&(e["!fullref"]=or((u.e.r=l.length-m+x-1+a,u))),e}function Sy(e,t){var r=t||{},n=r.dense?[]:{};return _y(n,e,t)}function dj(e,t){return Ys(Sy(e,t),t)}function Zm(e){var t="",r=hj(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function hj(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function pj(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=dr(t.replace(/<[^>]*>/g,""));return[r]}var qm={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ey(e,t){var r=t||{},n=sh(e),a=[],s,i,l={name:""},o="",u=0,f,d,p={},h=[],m=r.dense?[]:{},x,v,y={value:""},w="",g=0,E=[],A=-1,z=-1,b={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,_={},T=[],D={},M=0,G=0,Y=[],J=1,Q=1,X=[],ee={Names:[]},F={},le=["",""],re=[],j={},R="",B=0,V=!1,te=!1,ke=0;for(Ro.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Ro.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(b.e.c>=b.s.c&&b.e.r>=b.s.r?m["!ref"]=or(b):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=b.e.r&&(m["!fullref"]=m["!ref"],b.e.r=r.sheetRows-1,m["!ref"]=or(b)),T.length&&(m["!merges"]=T),Y.length&&(m["!rows"]=Y),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),h.push(f.name),p[f.name]=m,te=!1):x[0].charAt(x[0].length-2)!=="/"&&(f=It(x[0],!1),A=z=-1,b.s.r=b.s.c=1e7,b.e.r=b.e.c=0,m=r.dense?[]:{},T=[],Y=[],te=!0);break;case"table-row-group":x[1]==="/"?--S:++S;break;case"table-row":case"":if(x[1]==="/"){A+=J,J=1;break}if(d=It(x[0],!1),d.?A=d.-1:A==-1&&(A=0),J=+d["number-rows-repeated"]||1,J<10)for(ke=0;ke<J;++ke)S>0&&(Y[A+ke]={level:S});z=-1;break;case"covered-table-cell":x[1]!=="/"&&++z,r.sheetStubs&&(r.dense?(m[A]||(m[A]=[]),m[A][z]={t:"z"}):m[Wt({r:A,c:z})]={t:"z"}),w="",E=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++z,y=It(x[0],!1),Q=parseInt(y["number-columns-repeated"]||"1",10),v={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(v.f=Km(dr(y.formula))),(y.||y["value-type"])=="string"&&(v.t="s",v.v=dr(y["string-value"]||""),r.dense?(m[A]||(m[A]=[]),m[A][z]=v):m[Wt({r:A,c:z})]=v),z+=Q-1;else if(x[1]!=="/"){++z,w="",g=0,E=[],Q=1;var _e=J?A+J-1:A;if(z>b.e.c&&(b.e.c=z),z<b.s.c&&(b.s.c=z),A<b.s.r&&(b.s.r=A),_e>b.e.r&&(b.e.r=_e),y=It(x[0],!1),re=[],j={},v={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=dr(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(M=parseInt(y["number-matrix-rows-spanned"],10)||0,G=parseInt(y["number-matrix-columns-spanned"],10)||0,D={s:{r:A,c:z},e:{r:A+M-1,c:z+G-1}},v.F=or(D),X.push([D,v.F])),y.formula)v.f=Km(y.formula);else for(ke=0;ke<X.length;++ke)A>=X[ke][0].s.r&&A<=X[ke][0].e.r&&z>=X[ke][0].s.c&&z<=X[ke][0].e.c&&(v.F=X[ke][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(M=parseInt(y["number-rows-spanned"],10)||0,G=parseInt(y["number-columns-spanned"],10)||0,D={s:{r:A,c:z},e:{r:A+M-1,c:z+G-1}},T.push(D)),y["number-columns-repeated"]&&(Q=parseInt(y["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=jr(y["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(y.value);break;case"percentage":v.t="n",v.v=parseFloat(y.value);break;case"currency":v.t="n",v.v=parseFloat(y.value);break;case"date":v.t="d",v.v=cn(y["date-value"]),r.cellDates||(v.t="n",v.v=Bn(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=TS(y["time-value"])/86400,r.cellDates&&(v.t="d",v.v=Gu(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(y.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",y["string-value"]!=null&&(w=dr(y["string-value"]),E=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(V=!1,v.t==="s"&&(v.v=w||"",E.length&&(v.R=E),V=g==0),F.Target&&(v.l=F),re.length>0&&(v.c=re,re=[]),w&&r.cellText!==!1&&(v.w=w),V&&(v.t="z",delete v.v),(!V||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=A))for(var ge=0;ge<J;++ge){if(Q=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(m[A+ge]||(m[A+ge]=[]),m[A+ge][z]=ge==0?v:mn(v);--Q>0;)m[A+ge][z+Q]=mn(v);else for(m[Wt({r:A+ge,c:z})]=v;--Q>0;)m[Wt({r:A+ge,c:z+Q})]=mn(v);b.e.c<=z&&(b.e.c=z)}Q=parseInt(y["number-columns-repeated"]||"1",10),z+=Q-1,Q=0,v={},w="",E=[]}F={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s;j.t=w,E.length&&(j.R=E),j.a=R,re.push(j)}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);R="",B=0,w="",g=0,E=[];break;case"creator":x[1]==="/"?R=n.slice(B,x.index):B=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);w="",g=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(_[l.name]=o,(s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(o="",l=It(x[0],!1),a.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=It(x[0],!1),o+=qm[x[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=It(x[0],!1),o+=qm[x[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":o+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":i=It(x[0],!1),le=R0(i["cell-range-address"]);var ye={Name:i.name,Ref:le[0]+"!"+le[1]};te&&(ye.Sheet=h.length),ee.Names.push(ye);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(x[1]==="/"&&(!y||!y["string-value"])){var Ee=pj(n.slice(g,x.index));w=(w.length>0?w+`
`:"")+Ee[0]}else It(x[0],!1),g=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{le=R0(It(x[0])["target-range-address"]),p[le[0]]["!autofilter"]={ref:le[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(F=It(x[0],!1),!F.href)break;F.Target=dr(F.href),delete F.href,F.Target.charAt(0)=="#"&&F.Target.indexOf(".")>-1?(le=R0(F.Target.slice(1)),F.Target="#"+le[0]+"!"+le[1]):F.Target.match(/^\.\.[\\\/]/)&&(F.Target=F.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var C={Sheets:p,SheetNames:h,Workbook:ee};return r.bookSheets&&delete C.Sheets,C}function ex(e,t){t=t||{},xa(e,"META-INF/manifest.xml")&&jE(Xr(e,"META-INF/manifest.xml"),t);var r=aa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Ey(br(r),t);return xa(e,"meta.xml")&&(n.Props=Ov(Xr(e,"meta.xml"))),n}function tx(e,t){return Ey(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function vh(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Kf(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):br(Si(e))}function Xf(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function rx(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function mj(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Oo(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function rn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Nn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Oo(e,r),s=a&7;a=Math.floor(a/8);var i=0,l;if(a==0)break;switch(s){case 0:{for(var o=r[0];e[r[0]++]>=128;);l=e.slice(o,r[0])}break;case 5:i=4,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Oo(e,r),l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:l,type:s};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function yh(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function xj(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Oo(e,n),s=Nn(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:rn(s[1][0].data),messages:[]};s[2].forEach(function(l){var o=Nn(l.data),u=rn(o[3][0].data);i.messages.push({meta:o,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(i.merge=rn(s[3][0].data)>>>0>0),r.push(i)}return r}function gj(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Oo(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var l=i-59;i=t[r[0]],l>1&&(i|=t[r[0]+1]<<8),l>2&&(i|=t[r[0]+2]<<16),l>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=l}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var o=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,o=(t[r[0]++]&224)<<3,o|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(o=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(o=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Xf(a)],o==0)throw new Error("Invalid offset 0");if(o>a[0].length)throw new Error("Invalid offset beyond length");if(u>=o)for(a.push(a[0].slice(-o)),u-=o;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-o,-o+u))}}var f=Xf(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function vj(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(gj(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Xf(t)}function yj(e,t,r,n){var a=vh(e),s=a.getUint32(4,!0),i=(n>1?12:8)+rx(s&(n>1?3470:398))*4,l=-1,o=-1,u=NaN,f=new Date(2001,0,1);s&512&&(l=a.getUint32(i,!0),i+=4),i+=rx(s&(n>1?12288:4096))*4,s&16&&(o=a.getUint32(i,!0),i+=4),s&32&&(u=a.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(l>-1)d={t:"s",v:r[l]};else if(o>-1)d={t:"s",v:t[o]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function wj(e,t,r){var n=vh(e),a=n.getUint32(8,!0),s=12,i=-1,l=-1,o=NaN,u=NaN,f=new Date(2001,0,1);a&1&&(o=mj(e,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(l=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:o};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:o};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function kj(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return yj(e,t,r,e[0]);case 5:return wj(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Bs(e){var t=Nn(e);return Oo(t[1][0].data)}function nx(e,t){var r=Nn(t.data),n=rn(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var l=Nn(i.data),o=rn(l[1][0].data)>>>0;switch(n){case 1:s[o]=Kf(l[3][0].data);break;case 8:{var u=e[Bs(l[9][0].data)][0],f=Nn(u.data),d=e[Bs(f[1][0].data)][0],p=rn(d.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var h=Nn(d.data);s[o]=h[3].map(function(m){return Kf(m.data)}).join("")}break}}),s}function _j(e,t){var r,n,a,s,i,l,o,u,f,d,p,h,m,x,v=Nn(e),y=rn(v[1][0].data)>>>0,w=rn(v[2][0].data)>>>0,g=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&rn(v[8][0].data)>0||!1,E,A;if((s=(a=v[7])==null?void 0:a[0])!=null&&s.data&&t!=0)E=(l=(i=v[7])==null?void 0:i[0])==null?void 0:l.data,A=(u=(o=v[6])==null?void 0:o[0])==null?void 0:u.data;else if((d=(f=v[4])==null?void 0:f[0])!=null&&d.data&&t!=1)E=(h=(p=v[4])==null?void 0:p[0])==null?void 0:h.data,A=(x=(m=v[3])==null?void 0:m[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var z=g?4:1,b=vh(E),S=[],_=0;_<E.length/2;++_){var T=b.getUint16(_*2,!0);T<65535&&S.push([_,T])}if(S.length!=w)throw"Expected ".concat(w," cells, found ").concat(S.length);var D=[];for(_=0;_<S.length-1;++_)D[S[_][0]]=A.subarray(S[_][1]*z,S[_+1][1]*z);return S.length>=1&&(D[S[S.length-1][0]]=A.subarray(S[S.length-1][1]*z)),{R:y,cells:D}}function Sj(e,t){var r,n=Nn(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?rn(n[7][0].data)>>>0>0?1:0:-1,s=yh(n[5],function(i){return _j(i,a)});return{nrows:rn(n[4][0].data)>>>0,data:s.reduce(function(i,l){return i[l.R]||(i[l.R]=[]),l.cells.forEach(function(o,u){if(i[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));i[l.R][u]=o}),i},[])}}function Ej(e,t,r){var n,a=Nn(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(rn(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(rn(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=or(s);var i=Nn(a[4][0].data),l=nx(e,e[Bs(i[4][0].data)][0]),o=(n=i[17])!=null&&n[0]?nx(e,e[Bs(i[17][0].data)][0]):[],u=Nn(i[3][0].data),f=0;u[1].forEach(function(d){var p=Nn(d.data),h=e[Bs(p[2][0].data)][0],m=rn(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var x=Sj(e,h);x.data.forEach(function(v,y){v.forEach(function(w,g){var E=Wt({r:f+y,c:g}),A=kj(w,l,o);A&&(r[E]=A)})}),f+=x.nrows})}function bj(e,t){var r=Nn(t.data),n={"!ref":"A1"},a=e[Bs(r[2][0].data)],s=rn(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Ej(e,a[0],n),n}function Cj(e,t){var r,n=Nn(t.data),a={name:(r=n[1])!=null&&r[0]?Kf(n[1][0].data):"",sheets:[]},s=yh(n[2],Bs);return s.forEach(function(i){e[i].forEach(function(l){var o=rn(l.meta[1][0].data);o==6e3&&a.sheets.push(bj(e,l))})}),a}function Tj(e,t){var r=_h(),n=Nn(t.data),a=yh(n[1],Bs);if(a.forEach(function(s){e[s].forEach(function(i){var l=rn(i.meta[1][0].data);if(l==2){var o=Cj(e,i);o.sheets.forEach(function(u,f){Sh(r,u,f==0?o.name:o.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function z0(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(o){if(o.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(o){if(o.name.match(/\.iwa$/)){var u;try{u=vj(o.content)}catch(d){return console.log("?? "+o.content.length+" "+(d.message||d))}var f;try{f=xj(u)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){s[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&rn(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||i.forEach(function(o){s[o].forEach(function(u){var f=rn(u.meta[1][0].data)>>>0;if(f==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return Tj(s,l)}function Nj(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function wh(e){Nj([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Aj(e){return Ji.WS.indexOf(e)>-1?"sheet":e==Ji.CS?"chart":e==Ji.DS?"dialog":e==Ji.MS?"macro":e&&e.length?e:"sheet"}function jj(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Aj(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Fj(e,t,r,n,a,s,i,l,o,u,f,d){try{s[n]=so(aa(e,r,!0),t);var p=Xr(e,t),h;switch(l){case"sheet":h=OA(p,t,a,o,s[n],u,f,d);break;case"chart":if(h=PA(p,t,a,o,s[n],u,f,d),!h||!h["!drawel"])break;var m=Vl(h["!drawel"].Target,t),x=$f(m),v=LT(aa(e,m,!0),so(aa(e,x,!0),m)),y=Vl(v,m),w=$f(y);h=wA(aa(e,y,!0),y,o,so(aa(e,w,!0),y),u,h);break;case"macro":h=DA(p,t,a,o,s[n],u,f,d);break;case"dialog":h=BA(p,t,a,o,s[n],u,f,d);break;default:throw new Error("Unrecognized sheet type "+l)}i[n]=h;var g=[];s&&s[n]&&Ja(s[n]).forEach(function(E){var A="";if(s[n][E].Type==Ji.CMNT){A=Vl(s[n][E].Target,t);var z=HA(Xr(e,A,!0),A,o);if(!z||!z.length)return;$m(h,z,!1)}s[n][E].Type==Ji.TCMNT&&(A=Vl(s[n][E].Target,t),g=g.concat(PT(Xr(e,A,!0),o)))}),g&&g.length&&$m(h,g,!0,o.people||[])}catch(E){if(o.WTF)throw E}}function pa(e){return e.charAt(0)=="/"?e.slice(1):e}function Mj(e,t){if(ov(),t=t||{},wh(t),xa(e,"META-INF/manifest.xml")||xa(e,"objectdata.xml"))return ex(e,t);if(xa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof z0<"u"){if(e.FileIndex)return z0(e);var r=lr.utils.cfb_new();return mm(e).forEach(function(Y){RS(r,Y,MS(e,Y))}),z0(r)}throw new Error("Unsupported NUMBERS file")}if(!xa(e,"[Content_Types].xml"))throw xa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):xa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=mm(e),a=NE(aa(e,"[Content_Types].xml")),s=!1,i,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",Xr(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!Xr(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var o={},u={};if(!t.bookSheets&&!t.bookProps){if(oo=[],a.sst)try{oo=WA(Xr(e,pa(a.sst)),a.sst,t)}catch(Y){if(t.WTF)throw Y}t.cellStyles&&a.themes.length&&(o=$A(aa(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=UA(Xr(e,pa(a.style)),a.style,o,t))}a.links.map(function(Y){try{var J=so(aa(e,$f(pa(Y))),Y);return GA(Xr(e,pa(Y)),J,Y,t)}catch{}});var f=LA(Xr(e,pa(a.workbooks[0])),a.workbooks[0],t),d={},p="";a.coreprops.length&&(p=Xr(e,pa(a.coreprops[0]),!0),p&&(d=Ov(p)),a.extprops.length!==0&&(p=Xr(e,pa(a.extprops[0]),!0),p&&RE(p,d,t)));var h={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(p=aa(e,pa(a.custprops[0]),!0),p&&(h=zE(p,t)));var m={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(J){return J.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(m.Props=d,m.Custprops=h),t.bookSheets&&typeof i<"u"&&(m.SheetNames=i),t.bookSheets?m.SheetNames:t.bookProps))return m;i={};var x={};t.bookDeps&&a.calcchain&&(x=VA(Xr(e,pa(a.calcchain)),a.calcchain));var v=0,y={},w,g;{var E=f.Sheets;d.Worksheets=E.length,d.SheetNames=[];for(var A=0;A!=E.length;++A)d.SheetNames[A]=E[A].name}var z=s?"bin":"xml",b=a.workbooks[0].lastIndexOf("/"),S=(a.workbooks[0].slice(0,b+1)+"_rels/"+a.workbooks[0].slice(b+1)+".rels").replace(/^\//,"");xa(e,S)||(S="xl/_rels/workbook."+z+".rels");var _=so(aa(e,S,!0),S.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=KA(Xr(e,pa(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=DT(Xr(e,pa(a.people[0])),t)),_&&(_=jj(_,f.Sheets));var T=Xr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=d.Worksheets;++v){var D="sheet";if(_&&_[v]?(w="xl/"+_[v][1].replace(/[\/]?xl\//,""),xa(e,w)||(w=_[v][1]),xa(e,w)||(w=S.replace(/_rels\/.*$/,"")+_[v][1]),D=_[v][2]):(w="xl/worksheets/sheet"+(v+1-T)+"."+z,w=w.replace(/sheet0\./,"sheet.")),g=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(d.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var M=!1,G=0;G!=t.sheets.length;++G)typeof t.sheets[G]=="number"&&t.sheets[G]==v&&(M=1),typeof t.sheets[G]=="string"&&t.sheets[G].toLowerCase()==d.SheetNames[v].toLowerCase()&&(M=1);if(!M)continue e}}Fj(e,w,g,d.SheetNames[v],v,y,i,D,t,f,o,u)}return m={Directory:a,Workbook:f,Props:d,Custprops:h,Deps:x,Sheets:i,SheetNames:d.SheetNames,Strings:oo,Styles:u,Themes:o,SSF:mn(Yt)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(Y,J){Y=Y.replace(/^Root Entry[\/]/,""),m.keys.push(Y),m.files[Y]=e.FileIndex[J]}))),t&&t.bookVBA&&(a.vba.length>0?m.vbaraw=Xr(e,pa(a.vba[0]),!0):a.defaults&&a.defaults.bin===WT&&(m.vbaraw=Xr(e,"xl/vbaProject.bin",!0))),m}function Rj(e,t){var r=t||{},n="Workbook",a=lr.find(e,n);try{if(n="/!DataSpaces/Version",a=lr.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(bC(a.content),n="/!DataSpaces/DataSpaceMap",a=lr.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=TC(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=lr.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=NC(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=lr.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);jC(a.content)}catch{}if(n="/EncryptionInfo",a=lr.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=FC(a.content);if(n="/EncryptedPackage",a=lr.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function kh(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ca(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Ij(e,t){return lr.find(e,"EncryptedPackage")?Rj(e,t):ky(e,t)}function zj(e,t){var r,n=e,a=t||{};return a.type||(a.type=ar&&Buffer.isBuffer(e)?"buffer":"base64"),r=pv(n,a),Mj(r,a)}function by(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Vf(e.slice(r),t);default:break e}return Io.to_workbook(e,t)}function Lj(e,t){var r="",n=kh(e,t);switch(t.type){case"base64":r=ca(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=vi(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=br(r)),t.type="binary",by(r,t)}function Oj(e,t){var r=e;return t.type=="base64"&&(r=ca(r)),r=jo.utils.decode(1200,r.slice(2),"str"),t.type="binary",by(r,t)}function Pj(e){return e.match(/[^\x00-\x7F]/)?Gl(e):e}function L0(e,t,r,n){return n?(r.type="string",Io.to_workbook(e,r)):Io.to_workbook(t,r)}function Yf(e,t){J1();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Yf(new Uint8Array(e),(r=mn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),sl={},r.dateNF&&(sl.dateNF=r.dateNF),r.type||(r.type=ar&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ar?"buffer":"binary",n=bS(e),typeof Uint8Array<"u"&&!ar&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Pj(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),l=new Uint8Array(i);if(l.foo="bar",!l.foo)return r=mn(r),r.type="array",Yf(qd(n),r)}switch((a=kh(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Ij(lr.read(n,r),r);break;case 9:if(a[1]<=8)return ky(n,r);break;case 60:return Vf(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return dC(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return uC.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?zj(n,r):L0(e,n,r,s);case 239:return a[3]===60?Vf(n,r):L0(e,n,r,s);case 255:if(a[1]===254)return Oj(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return lo.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return lo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Um.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return WC.to_workbook(n,r);break;case 10:case 13:case 32:return Lj(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return oC.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Um.to_workbook(n,r):L0(e,n,r,s)}function Dj(e,t,r,n,a,s,i,l){var o=xn(r),u=l.defval,f=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),d=!0,p=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!i||e[r])for(var h=t.s.c;h<=t.e.c;++h){var m=i?e[r][h]:e[n[h]+o];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[h]!=null&&(p[s[h]]=u);continue}var x=m.v;switch(m.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[h]!=null){if(x==null)if(m.t=="e"&&x===null)p[s[h]]=null;else if(u!==void 0)p[s[h]]=u;else if(f&&x===null)p[s[h]]=null;else continue;else p[s[h]]=f&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?x:ps(m,x,l);x!=null&&(d=!1)}}return{row:p,isempty:d}}function Jf(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,l="",o={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":o=Ur(f);break;case"number":o=Ur(e["!ref"]),o.s.r=f;break;default:o=f}n>0&&(a=0);var d=xn(o.s.r),p=[],h=[],m=0,x=0,v=Array.isArray(e),y=o.s.r,w=0,g={};v&&!e[y]&&(e[y]=[]);var E=u.skipHidden&&e["!cols"]||[],A=u.skipHidden&&e["!rows"]||[];for(w=o.s.c;w<=o.e.c;++w)if(!(E[w]||{}).hidden)switch(p[w]=tn(w),r=v?e[y][w]:e[p[w]+d],n){case 1:s[w]=w-o.s.c;break;case 2:s[w]=p[w];break;case 3:s[w]=u.header[w-o.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=i=ps(r,null,u),x=g[i]||0,!x)g[i]=1;else{do l=i+"_"+x++;while(g[l]);g[i]=x,g[l]=1}s[w]=l}for(y=o.s.r+a;y<=o.e.r;++y)if(!(A[y]||{}).hidden){var z=Dj(e,o,y,p,n,s,v,u);(z.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[m++]=z.row)}return h.length=m,h}var ax=/"/g;function Bj(e,t,r,n,a,s,i,l){for(var o=!0,u=[],f="",d=xn(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var h=l.dense?(e[r]||[])[p]:e[n[p]+d];if(h==null)f="";else if(h.v!=null){o=!1,f=""+(l.rawNumbers&&h.t=="n"?h.v:ps(h,null,l));for(var m=0,x=0;m!==f.length;++m)if((x=f.charCodeAt(m))===a||x===s||x===34||l.forceQuotes){f='"'+f.replace(ax,'""')+'"';break}f=="ID"&&(f='"ID"')}else h.f!=null&&!h.F?(o=!1,f="="+h.f,f.indexOf(",")>=0&&(f='"'+f.replace(ax,'""')+'"')):f="";u.push(f)}return l.blankrows===!1&&o?null:u.join(i)}function Cy(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Ur(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,o=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(p[m]||{}).hidden||(d[m]=tn(m));for(var x=0,v=a.s.r;v<=a.e.r;++v)(h[v]||{}).hidden||(f=Bj(e,a,v,d,i,o,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((x++?l:"")+f)));return delete n.dense,r.join("")}function Uj(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Cy(e,t);return r}function $j(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Ur(e["!ref"]),s="",i=[],l,o=[],u=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)i[l]=tn(l);for(var f=a.s.r;f<=a.e.r;++f)for(s=xn(f),l=a.s.c;l<=a.e.c;++l)if(t=i[l]+s,r=u?(e[f]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}o[o.length]=t+"="+n}return o}function Ty(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?On(n.origin):n.origin;i=o.r,l=o.c}var u,f={s:{c:0,r:0},e:{c:l,r:i+t.length-1+a}};if(s["!ref"]){var d=Ur(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+a)}else i==-1&&(i=0,f.e.r=t.length-1+a);var p=n.header||[],h=0;t.forEach(function(x,v){Ja(x).forEach(function(y){(h=p.indexOf(y))==-1&&(p[h=p.length]=y);var w=x[y],g="z",E="",A=Wt({c:l+h,r:i+v+a});u=Po(s,A),w&&typeof w=="object"&&!(w instanceof Date)?s[A]=w:(typeof w=="number"?g="n":typeof w=="boolean"?g="b":typeof w=="string"?g="s":w instanceof Date?(g="d",n.cellDates||(g="n",w=Bn(w)),E=n.dateNF||Yt[14]):w===null&&n.nullError&&(g="e",w=0),u?(u.t=g,u.v=w,delete u.w,delete u.R,E&&(u.z=E)):s[A]=u={t:g,v:w},E&&(u.z=E))})}),f.e.c=Math.max(f.e.c,l+p.length-1);var m=xn(i);if(a)for(h=0;h<p.length;++h)s[tn(h+l)+m]={t:"s",v:p[h]};return s["!ref"]=or(f),s}function Wj(e,t){return Ty(null,e,t)}function Po(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=On(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Po(e,Wt(t)):Po(e,Wt({r:t,c:r||0}))}function Hj(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function _h(){return{SheetNames:[],Sheets:{}}}function Sh(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(NA(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Vj(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Hj(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Gj(e,t){return e.z=t,e}function Ny(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Kj(e,t,r){return Ny(e,"#"+t,r)}function Xj(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Yj(e,t,r,n){for(var a=typeof t!="string"?t:Ur(t),s=typeof t=="string"?t:or(t),i=a.s.r;i<=a.e.r;++i)for(var l=a.s.c;l<=a.e.c;++l){var o=Po(e,i,l);o.t="n",o.F=s,delete o.v,i==a.s.r&&l==a.s.c&&(o.f=r,n&&(o.D=!0))}return e}var Jj={encode_col:tn,encode_row:xn,encode_cell:Wt,encode_range:or,decode_col:oh,decode_row:lh,split_cell:lE,decode_cell:On,decode_range:El,format_cell:ps,sheet_add_aoa:Mv,sheet_add_json:Ty,sheet_add_dom:_y,aoa_to_sheet:bl,json_to_sheet:Wj,table_to_sheet:Sy,table_to_book:dj,sheet_to_csv:Cy,sheet_to_txt:Uj,sheet_to_json:Jf,sheet_to_html:fj,sheet_to_formulae:$j,sheet_to_row_object_array:Jf,sheet_get_cell:Po,book_new:_h,book_append_sheet:Sh,book_set_sheet_visibility:Vj,cell_set_number_format:Gj,cell_set_hyperlink:Ny,cell_set_internal_link:Kj,cell_add_comment:Xj,sheet_set_array_formula:Yj,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Qj(e){const t=String(e||"").trim().toLowerCase();if(!t)return NaN;const r=/^(\d+(?:\.\d+)?)\s*h(?:\s*(\d+(?:\.\d+)?)\s*min)?$/i.exec(t);if(r){const a=parseFloat(r[1]),s=r[2]?parseFloat(r[2]):0;return a*60+s}const n=/^(\d+(?:\.\d+)?)\s*min$/i.exec(t);return n?parseFloat(n[1]):/^0\s*h$/.test(t)?0:NaN}function Zj(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=t.replace(",","."),n=Number(r);return Number.isFinite(n)?n:null}return null}const qj={id:"clariostar-xlsx",label:"BMG CLARIOstar (.xlsx)",description:'Excel export: sheet "Table All Cycles"; headers: Well/Content/Raw Data (600) with time row below',fileExtensions:[".xlsx"],detect:(e,t)=>t.toLowerCase().endsWith(".xlsx"),parse:async(e,t)=>{try{if(!(e instanceof ArrayBuffer))return{ok:!1,error:"Expected binary Excel (ArrayBuffer) content for .xlsx"};const r=Yf(e,{type:"array"}),n=r.SheetNames.includes("Table All Cycles")?"Table All Cycles":r.SheetNames[0],a=r.Sheets[n];if(!a)return{ok:!1,error:"Worksheet not found in workbook"};const s=Jj.sheet_to_json(a,{header:1,raw:!0});let i=-1,l=[];for(let g=0;g<s.length;g++){const E=s[g]||[],A=String(E[0]??"").trim(),z=String(E[1]??"").trim();if(A==="Well"&&z==="Content"){const b=[];for(let S=2;S<E.length;S++)String(E[S]??"")==="Raw Data (600)"&&b.push(S);if(b.length>=2){i=g,l=b;break}}}if(i<0)return{ok:!1,error:"CLARIOstar format not detected: missing 'Well/Content/Raw Data (600)' header row"};const o=s[i+1]||[],u=[];for(const g of l){const E=String(o[g]??"").trim(),A=Qj(E);isNaN(A)?u.push(NaN):u.push(A)}if(u.every(g=>isNaN(g)))return{ok:!1,error:"No time labels parsed under 'Raw Data (600)'"};const f=i+2,d=ml(),p="Plate-1",h="OD600",m=[],x=new Set;let v=0;for(let g=f;g<s.length;g++){const E=s[g]||[],A=String(E[0]??"").trim();if(!/^([A-H])\d{2}$/.test(A)||!G1(A[0]+String(parseInt(A.slice(1),10))))break;for(let z=0;z<l.length;z++){const b=l[z],S=u[z];if(isNaN(S))continue;const _=E[b];if(_==null||_==="")continue;const T=Zj(_);if(T===null)continue;const D=A[0]+String(parseInt(A.slice(1),10)),M=`${D}|${S}`;if(x.has(M)){v++;continue}x.add(M),m.push({runId:d,plateId:p,sourceFile:t,well:D,timeSeconds:S*60,timeLabel:`${S} min`,measurementType:h,value:T})}}if(m.sort((g,E)=>g.well.localeCompare(E.well)||g.timeSeconds-E.timeSeconds),m.length===0)return{ok:!1,error:"No data rows parsed (no numeric OD600 values under valid wells)"};const y={runId:d,plateId:p,sourceFile:t,measurementType:h,createdAt:new Date().toISOString(),parserId:"clariostar-xlsx",rows:m},w=[];return v>0&&w.push(`Dropped ${v} duplicate (well,time) entries`),{ok:!0,dataset:y,warnings:w.length?w:void 0}}catch(r){return{ok:!1,error:"Failed to parse CLARIOstar .xlsx: "+((r==null?void 0:r.message)||String(r))}}}},Ay=/^plate information/i,jy=/^results for/i,Fy=/^saturated for/i,My=/^measurement time/i;function e3(e){const t=[",",";","	"],r=e.split(/\r?\n/).slice(0,50),n=t.map(i=>r.reduce((l,o)=>l+(o.split(i).length-1),0)),a=Math.max(...n),s=n.findIndex(i=>i===a);return t[s]||","}function Vs(e,t){const r=e.split(t);for(;r.length&&r[r.length-1]==="";)r.pop();return r.map(n=>n.trim())}function t3(e){if(e==null)return NaN;const t=e.replace(",",".").trim();if(!t.length)return NaN;const r=Number(t);return Number.isFinite(r)?r:NaN}function r3(e){const t=e.replace(",",".").trim();if(!t)return NaN;const r=/^(\d+):(\d{2}):(\d{2}(?:\.\d+)?)$/.exec(t);if(r){const[s,i,l,o]=r;return Number(i)*3600+Number(l)*60+Number(o)}const n=/^(\d+):(\d{2}(?:\.\d+)?)$/.exec(t);if(n){const[s,i,l]=n;return Number(i)*60+Number(l)}const a=Number(t);return Number.isFinite(a)?a:NaN}function Eh(e){const t=e.trim().toLowerCase();return t.length===0||jy.test(t)||Fy.test(t)||My.test(t)||Ay.test(t)||t.startsWith("background information")||t.startsWith("basic assay information")||t.startsWith("protocol:")||t.startsWith("plate type:")}function n3(e,t,r){var o;const n=[];let a=-1;for(let u=t+1;u<e.length;u++)if(e[u].trim()){a=u;break}if(a<0)return{entries:n,last:t};const i=Vs(e[a],r).slice(1).map(u=>Number.parseInt(u.replace(/^0+/,"")||"0",10));let l=a;for(let u=a+1;u<e.length;u++){const f=e[u],d=f.trim();if(!d)continue;if(Eh(d)&&!/^[A-H]/i.test(d)){l=u-1;break}const p=Vs(f,r);if(!p.length)continue;const h=(o=p[0])==null?void 0:o.trim();if(!/^[A-Ha-h]$/.test(h)){l=u-1;break}for(let m=0;m<i.length;m++){const x=i[m];if(!Number.isFinite(x)||x<1||x>12)continue;const v=`${h.toUpperCase()}${x}`,y=p[m+1]??"",w=y===""?NaN:t3(y);n.push({well:v,meas:x,value:w})}l=u}return{entries:n,last:l}}function a3(e,t,r){var l;const n={};let a=-1;for(let o=t+1;o<e.length;o++)if(e[o].trim()){a=o;break}if(a<0)return n;const i=Vs(e[a],r).slice(1).map(o=>Number.parseInt(o.replace(/^0+/,"")||"0",10));for(let o=a+1;o<e.length;o++){const u=e[o],f=u.trim();if(!f)continue;if(Eh(f)&&!/^[A-H]/i.test(f))break;const d=Vs(u,r),p=(l=d[0])==null?void 0:l.trim();if(!/^[A-Ha-h]$/.test(p))break;for(let h=0;h<i.length;h++){const m=i[h];if(!Number.isFinite(m)||m<1||m>12)continue;const x=`${p.toUpperCase()}${m}`,v=d[h+1]??"";n[x]=v.toUpperCase()==="SAT"}}return n}function s3(e,t,r){var o;const n={};let a=-1;for(let u=t+1;u<e.length;u++)if(e[u].trim()){a=u;break}if(a<0)return{map:n,last:t};const i=Vs(e[a],r).slice(1).map(u=>Number.parseInt(u.replace(/^0+/,"")||"0",10));let l=a;for(let u=a+1;u<e.length;u++){const f=e[u],d=f.trim();if(!d)continue;if(Eh(d)&&!/^[A-H]/i.test(d)){l=u-1;break}const p=Vs(f,r),h=(o=p[0])==null?void 0:o.trim();if(!/^[A-Ha-h]$/.test(h)){l=u-1;break}for(let m=0;m<i.length;m++){const x=i[m];if(!Number.isFinite(x)||x<1||x>12)continue;const v=`${h.toUpperCase()}${x}`,y=p[m+1]??"";n[v]||(n[v]={}),n[v][x]={label:y,seconds:y===""?NaN:r3(y)}}l=u}return{map:n,last:l}}const i3={id:"plate-info-txt",label:"Plate TXT (Plate information blocks)",description:"Tekstowy export z sekcjami Plate information / Results / Measurement time (OD600)",fileExtensions:[".txt",".csv"],detect:(e,t)=>{const r=e.toLowerCase();return(t.toLowerCase().endsWith(".txt")||t.toLowerCase().endsWith(".csv"))&&r.includes("plate information")&&r.includes("measurement time")&&r.includes("results for")},parse:async(e,t)=>{const r=String(e),n=e3(r),a=r.split(/\r?\n/).map(h=>h.trimEnd()),s=[];for(let h=0;h<a.length;h++)Ay.test(a[h])&&s.push(h);if(!s.length)return{ok:!1,error:'Nie znaleziono sekcji "Plate information" w pliku TXT'};const i=ml();let l="Plate-1";const o="OD600",u=[];let f=0;const d=[];for(let h=0;h<s.length;h++){const m=s[h],x=s[h+1]??a.length,v=a.slice(m,x);let y="",w="";for(let G=1;G<v.length;G++)if(v[G].trim()){y=v[G];for(let Y=G+1;Y<v.length;Y++)if(v[Y].trim()){w=v[Y];break}break}const g=y?Vs(y,n):[],E=w?Vs(w,n):[],A=g.findIndex(G=>G.toLowerCase()==="kinetics"),z=g.findIndex(G=>G.toLowerCase()==="plate");z>=0&&E[z]&&(l=`Plate-${E[z]}`);const b=A>=0?E[A]??"":"",S=b?Number(b):NaN,_=[],T={},D={};let M=0;for(;M<v.length;){const G=v[M];if(jy.test(G)){const{entries:Y,last:J}=n3(v,M,n);_.push(...Y),M=Math.max(M+1,J+1);continue}if(Fy.test(G)){const Y=a3(v,M,n);Object.assign(T,Y),M+=1;continue}if(My.test(G)){const{map:Y,last:J}=s3(v,M,n);Object.assign(D,Y),M=Math.max(M+1,J+1);continue}M+=1}_.forEach(({well:G,meas:Y,value:J})=>{var re;const Q=((re=D[G])==null?void 0:re[Y])??null,X=Q?Q.seconds:NaN,ee=(Q==null?void 0:Q.label)||(Number.isNaN(S)?void 0:`Kinetics ${S}`),F=T[G]===!0;if(!Number.isFinite(J)||!Number.isFinite(X)){f+=1;return}const le={runId:i,plateId:l,sourceFile:t,well:G,timeSeconds:X,timeLabel:ee,measurementType:o,value:J};F&&(le.value=J),u.push(le)})}return f&&d.push(`Pominito ${f} punktw z niefinicznymi wartociami czasu lub OD (parser plate-info-txt).`),u.length?(u.sort((h,m)=>{const x=h.well.localeCompare(m.well,void 0,{numeric:!0});return x!==0?x:(h.timeSeconds||0)-(m.timeSeconds||0)}),{ok:!0,dataset:{runId:i,plateId:l,sourceFile:t,measurementType:o,createdAt:new Date().toISOString(),parserId:"plate-info-txt",rows:u},warnings:d.length?d:void 0}):{ok:!1,error:"Nie udao si wycign danych OD z pliku TXT"}}},l3=[i3,qj,G_,X_];function o3(e,t){for(const r of l3)try{if(r.detect(e,t))return r}catch{}return null}const O0={};function il(e){const t=/^\s*([A-Ha-h])\s*0*([1-9]|1[0-2])\s*$/.exec(String(e??"").trim());if(!t)return null;const r=t[1].toUpperCase(),n=Number.parseInt(t[2],10);return Number.isFinite(n)?`${r}${n}`:null}function Ry(e){if(typeof e!="string")return null;const t=e.trim();return/^#?[0-9A-Fa-f]{6}$/.test(t)?t.startsWith("#")?t:`#${t}`:null}function Iy(e){if(typeof e=="number"&&Number.isFinite(e))return Math.max(0,Math.min(100,Math.round(e)));if(typeof e=="string"&&e.trim().length){const t=Number(e);if(Number.isFinite(t))return Math.max(0,Math.min(100,Math.round(t)))}return null}function c3(e){if(!e||e.type&&e.type!=="mapping")throw new Error("Invalid mapping JSON");let t=Array.isArray(e.samples)?e.samples:[];!t.length&&e.samples&&typeof e.samples=="object"&&!Array.isArray(e.samples)&&(t=Array.isArray(e.samples.items)?e.samples.items:[]);let r=Array.isArray(e.assignments)?e.assignments:Array.isArray(e.wells)?e.wells:[];!r.length&&e.assignments&&typeof e.assignments=="object"&&!Array.isArray(e.assignments)&&(r=Object.entries(e.assignments).map(([o,u])=>({well:o,sample:u})));const n=[],a={},s={},i={},l=[];for(const o of t){const u=typeof o=="string"||typeof o=="number"?String(o).trim():o==null?void 0:o.name,f=u?String(u).trim():"";if(f&&!l.includes(f)&&l.push(f),!f)continue;const d=Ry((o==null?void 0:o.color)??(o==null?void 0:o.Color)??(o==null?void 0:o.colour)??(o==null?void 0:o.Colour));d&&(s[f]=d);const p=Iy((o==null?void 0:o.saturation)??(o==null?void 0:o.Saturation));p!==null&&(i[f]=p);const h=(o==null?void 0:o.wells)??(o==null?void 0:o.Wells),m=[];if(Array.isArray(h))for(const x of h)typeof x!="string"&&typeof x!="number"||m.push(String(x));else typeof h=="string"&&m.push(...h.split(/[,\s]+/));m.length&&n.push({sample:f,wells:m})}!r.length&&n.length&&(r=n);for(const o of r){const u=(o==null?void 0:o.sample)??(o==null?void 0:o.Sample)??(o==null?void 0:o.name),f=u?String(u).trim():"";if(!f)continue;const d=Array.isArray(o==null?void 0:o.wells)?o.wells:(o==null?void 0:o.wells)??(o==null?void 0:o.Wells),p=[];if(Array.isArray(d))for(const h of d)typeof h!="string"&&typeof h!="number"||p.push(String(h));else typeof d=="string"&&p.push(...d.split(/[,\s]+/));if(p.length)for(const h of p){const m=il(h);m&&(a[m]=f)}else{const h=il((o==null?void 0:o.well)??(o==null?void 0:o.Well));if(!h)continue;a[h]=f}l.includes(f)||l.push(f)}return{assignments:a,samplesOrdered:l,colorBySample:s,satBySample:i}}function zy(e){const t={};if(e.assignments&&typeof e.assignments=="object")for(const[u,f]of Object.entries(e.assignments)){const d=f?String(f).trim():"";if(!d)continue;const h=il(String(u))??(typeof u=="string"?u.trim():String(u).trim());h&&(t[h]=d)}const r={...e.sampleColors??{}},n={...e.sampleSaturations??{}},a=[],s=u=>{const f=u.trim();!f||a.includes(f)||a.push(f)},i=Array.isArray(e.samples)?e.samples:[];for(const u of i){if(typeof u=="string"||typeof u=="number"){s(String(u));continue}const f=u!=null&&u.name?String(u.name).trim():"";f&&s(f);const d=Ry((u==null?void 0:u.color)??(u==null?void 0:u.Color)??(u==null?void 0:u.colour)??(u==null?void 0:u.Colour));d&&f&&(r[f]=d);const p=Iy((u==null?void 0:u.saturation)??(u==null?void 0:u.Saturation));p!==null&&f&&(n[f]=p);const h=(u==null?void 0:u.wells)??(u==null?void 0:u.Wells);if(Array.isArray(h))for(const m of h){if(typeof m!="string"&&typeof m!="number")continue;const x=il(String(m));!x||!f||(t[x]=f)}else if(typeof h=="string")for(const m of h.split(/[,\s]+/)){if(!m)continue;const x=il(m);!x||!f||(t[x]=f)}}if(!a.length&&Object.keys(t).length)for(const u of Object.values(t))a.includes(u)||a.push(u);const l=a.length?a:i.filter(u=>typeof u=="string");return{...e,createdAt:e.createdAt??new Date().toISOString(),assignments:t,samples:l.length?l:Object.values(t),sampleColors:Object.keys(r).length?r:e.sampleColors,sampleSaturations:Object.keys(n).length?n:e.sampleSaturations}}function u3(e){const t=[],r=[],n={};if(!e||!Array.isArray(e.assignments))throw new Error("Invalid assignments JSON (missing assignments array)");for(const a of e.assignments){if(!a||!a.mapping||!a.dataset)continue;const s=a.mapping;if(!(s!=null&&s.id))continue;const i=zy(s),l=a.dataset.meta??{},o=Array.isArray(a.dataset.rows)?a.dataset.rows:[];if(!o.length)continue;const u=new Set;for(const v of o)Object.keys(v||{}).forEach(y=>{y.startsWith("val_")&&u.add(y)});u.size||u.add("val_od600");const f=String(l.runId||i.id||`import-${Date.now()}`),d=String(l.sourceFile||"import.json"),p=String(l.plateId||"Plate-1"),h=String(l.createdAt||new Date().toISOString()),m=l.parserId||"import-json",x=Object.keys(i.assignments??{}).length||(Array.isArray(i.samples)?i.samples.reduce((v,y)=>v+(Array.isArray(y==null?void 0:y.wells)?y.wells.length:0),0):0);for(const v of Array.from(u)){const y=v.slice(4).toUpperCase(),w=u.size>1?`${f}::${y}`:f,g=[];for(const A of o){const z=il((A==null?void 0:A.well)??(A==null?void 0:A.Well)??(A==null?void 0:A.WELL)??(A==null?void 0:A.w)??"");if(!z)continue;const b=(A==null?void 0:A.time_min)??(A==null?void 0:A.timeMin)??(A==null?void 0:A.timeMinutes)??(A==null?void 0:A.time),S=typeof b=="number"?b:Number(b);if(!Number.isFinite(S))continue;const _=A==null?void 0:A[v];if(_==null||_==="")continue;const T=Number(_);Number.isFinite(T)&&g.push({runId:w,plateId:p,sourceFile:d,well:z,timeSeconds:S*60,timeLabel:(A==null?void 0:A.timeLabel)??`${S} min`,measurementType:y,value:T})}if(!g.length)continue;const E=new Set(g.map(A=>A.well)).size;x&&x!==E&&console.warn(`[ASSIGNMENTS IMPORT] Well count mismatch for run "${d}": mapping has ${x} wells, dataset has ${E}.`),t.push({runId:w,plateId:p,sourceFile:d,measurementType:y,createdAt:h,parserId:m,rows:g}),n[w]=i.id}r.push(i)}return{datasets:t,mappings:r,pairs:n}}function f3(e){if(!e||typeof e!="object")throw new Error("Invalid analysis JSON");const t=e.dataset,r=e.mapping?zy(e.mapping):void 0,n=e.excluded,a=e.sampleBlanks;return{dataset:t,mapping:r,excluded:n,sampleBlanks:a,analysis:e}}async function P0(e,t,r){const n=!!(O0!=null&&O0.VITE_UNKNOWN_FILE_ENDPOINT),a=`Brak obsugi tego formatu.

Plik: ${e.name} (${e.type||"unknown"}, ${e.size} B)

${t}

`+(n?`Moesz wysa plik, aby doda obsug formatu.
`:`Tryb lokalny: brak skonfigurowanego endpointu wysyki, plik nie zostanie przesany.
`)+`Jeli dane s wraliwe, utwrz plik w tym samym formacie z danymi fikcyjnymi i wgraj go zamiast oryginau.

Czy chcesz kontynuowa?`;if(!(typeof window<"u"&&typeof window.confirm=="function"))throw new Error(t);if(!window.confirm(a))throw new Error(t);if(!n)throw new Error(`${t} (tryb lokalny: brak wysyki)`);try{const l=await H_(e,{source:r,message:t}),o=l.issueUrl||l.pullRequestUrl;throw new Error(o?`${t} Zgoszenie utworzone: ${o}`:`${t} Zgoszenie wysane.`)}catch(l){throw new Error(`${t} (wysyka nieudana: ${(l==null?void 0:l.message)||l})`)}}async function d3(e){var a;const t=e.name.toLowerCase();if(t.endsWith(".csv")||t.endsWith(".xlsx")||t.endsWith(".txt")){const s=t.endsWith(".xlsx"),i=s?"":await e.text(),l=o3(i,e.name);l||await P0(e,"Brak dopasowania parsera (CSV/XLSX). Dodaj nowy parser lub przelij prbk.","setup-import");const o=s?await e.arrayBuffer():i,u=await l.parse(o,e.name);if(!u.ok||!u.dataset){const p=u.ok?"Nie udalo sie sparsowac pliku":u.error;throw new Error(p)}const{upsertDatasets:f,setPlotsSelectedRunId:d}=Ze.getState();return f([u.dataset]),d(u.dataset.runId),{kind:"dataset",runId:u.dataset.runId,measurementType:u.dataset.measurementType,fileName:e.name,warnings:u.warnings}}const r=await e.text();let n;try{n=JSON.parse(r)}catch{await P0(e,"Unsupported file format (invalid JSON)","setup-import")}if((n==null?void 0:n.type)==="mapping"||Array.isArray(n==null?void 0:n.samples)||Array.isArray(n==null?void 0:n.sampleList)){const s=c3(n),{createMapping:i,updateMappingAssignments:l,setSampleColor:o,setSampleSaturation:u}=Ze.getState(),f=s.samplesOrdered.length?s.samplesOrdered:Array.from(new Set(Object.values(s.assignments))).sort((h,m)=>h.localeCompare(m,void 0,{numeric:!0}));if(!f.length)throw new Error("Mapping JSON does not contain any sample assignments");const d=typeof n.name=="string"&&n.name.trim().length?n.name.trim():e.name.replace(/\.[^/.]+$/,"")||`Imported mapping ${new Date().toLocaleTimeString()}`,p=i(d,f);return l(p,s.assignments),Object.entries(s.colorBySample).forEach(([h,m])=>o(p,h,m)),Object.entries(s.satBySample).forEach(([h,m])=>u(p,h,m)),{kind:"mapping",mappingId:p,mappingName:d}}if(n&&Array.isArray(n.assignments)){const{datasets:s,mappings:i,pairs:l}=u3(n);if(!s.length&&!i.length)throw new Error("Assignments file did not contain usable data");const o=Ze.getState(),{upsertDatasets:u,upsertMappings:f,setDatasetMappings:d,setPlotsSelectedRunId:p,setActiveTab:h,createSampleList:m,updateSampleList:x,setActiveSampleList:v,setActiveMapping:y,sampleLists:w}=o;if(s.length&&u(s),i.length){f(i);const g=new Set(Object.keys(w));let E=null;i.forEach((A,z)=>{if(!Array.isArray(A.samples)||A.samples.length===0)return;const b=A.name&&A.name.trim().length?A.name.trim():`Imported mapping ${z+1}`;let S=b;if(!w[S]&&g.has(S)){let _=2;for(;g.has(`${b} (${_})`);)_+=1;S=`${b} (${_})`}g.add(S),w[S]?x(S,A.samples):m(S,A.samples),E||(E=S)}),E&&v(E),i.length&&y(i[0].id)}if(Object.keys(l).length){d(l);const g=Object.keys(l)[0];g&&p(g)}return h("samplesMapping"),{kind:"assignments",datasetRunIds:Object.keys(l),mappingIds:Array.from(new Set(Object.values(l))),pairs:l}}if(n&&n.meta&&(n.dataset||n.mapping||n.summary)){const{dataset:s,mapping:i,excluded:l,sampleBlanks:o,analysis:u}=f3(n),{upsertDatasets:f,upsertMappings:d,setDatasetMappings:p,setPlotsSelectedRunId:h,setActiveTab:m,setInteractiveAnalysis:x}=Ze.getState();s&&f([s]),i&&d([i]),s!=null&&s.runId&&(i!=null&&i.id)&&p({[s.runId]:i.id});const v=(s==null?void 0:s.runId)??((a=n.meta)==null?void 0:a.runId)??null;return v&&(h(v),m("plots")),x(u),{kind:"analysis",runId:v,mappingId:(i==null?void 0:i.id)??null,excluded:l,sampleBlanks:o,analysis:u}}return await P0(e,"Unsupported file format","setup-import")}function h3(e,t){switch(e.kind){case"mapping":return`Mapping "${e.mappingName}" imported from ${t}`;case"assignments":return`Assignments imported (${e.datasetRunIds.length} dataset(s)) from ${t}`;case"analysis":return`Analysis data imported${e.runId?` for ${e.runId}`:""} from ${t}`;case"dataset":return`Dataset imported (${e.measurementType}) from ${t}`;default:return`Imported ${t}`}}function p3(){const[e,t]=k.useState(null),[r,n]=k.useState({}),[a,s]=k.useState(!1),[i,l]=k.useState(null),u=Ze(b=>b.language)==="pl",f=k.useRef(null),d=k.useRef(null),p=k.useRef(null),h=k.useRef(null),m="growthcurves.analyser@gmail.com",x="Unsupported file format",v=k.useCallback(()=>{const b=h.current;if(!b||typeof window>"u")return;const S=document.querySelector(".topbar"),_=S?S.getBoundingClientRect().height+12:12,T=window.scrollY+b.getBoundingClientRect().top-_;window.scrollTo({top:Math.max(T,0),behavior:"smooth"})},[]),y=k.useCallback(()=>{if(typeof window>"u")return;const b=document.documentElement&&document.documentElement.scrollHeight||document.body.scrollHeight||0;window.scrollTo({top:b,behavior:"smooth"})},[]),w=k.useCallback((b,S)=>{var _;try{if((_=navigator==null?void 0:navigator.clipboard)!=null&&_.writeText)navigator.clipboard.writeText(b);else{const T=document.createElement("textarea");T.value=b,document.body.appendChild(T),T.select(),document.execCommand("copy"),document.body.removeChild(T)}l(u?`${S} skopiowano`:`${S} copied`)}catch{l(u?"Nie udao si skopiowa":"Copy failed")}finally{setTimeout(()=>l(null),2e3)}},[u]),g=k.useCallback(async b=>{try{const S=await d3(b);return t(h3(S,b.name)),!0}catch(S){return t(`[ERR] ${(S==null?void 0:S.message)??String(S)}`),!1}},[]),E=k.useCallback(async b=>{await g(b)&&y()},[g,y]),A=u?"Importuj dane":"Import data",z=k.useCallback(async b=>{await g(b)&&v()},[g,v]);return c.jsxs("div",{className:"setup-page",children:[c.jsxs("div",{className:"panel setup-hero",children:[c.jsxs("div",{className:"panel-heading with-help",children:[c.jsxs("div",{children:[c.jsx("div",{className:"eyebrow",children:"Setup"}),c.jsx("h2",{children:u?"Przygotuj dane":"Prepare data"}),c.jsx("p",{className:"small",children:u?"Wgraj swj plik wejciowy i utwrz list prbek, nastpnie przypisz prby do odpowiednich dokw. Utworzysz w ten sposb plik przypisania w formacie JSON (.assignment.json). Jeli ju wczeniej utworzye plik przypisania, moesz go zaimportowa poniej.":"Upload your input file and create a sample list, then assign samples to the appropriate wells. This way you will create an assignment file in JSON format (.assignment.json). If you have already created an assignment file before, you can import it below."})]}),c.jsx("button",{ref:f,className:"help-btn",type:"button",onClick:()=>n(b=>({...b,setup:!b.setup})),children:"?"})]}),c.jsx(Qr,{anchorRef:f,open:!!r.setup,children:u?"W tej karcie dane z rnych formatw wejcowych s konwertowane do ujednoliconego formatu, a nastpnie przypisywane do prbek na podstawie mapowania. Na kocu generowany jest plik przypisania (.assignment.json) do dalszej analizy.":"In this tab, data from various input formats are converted to a unified format and then assigned to samples based on the mapping. Finally, an assignment file (.assignment.json) is generated for further analysis."})]}),a&&c.jsx("div",{className:"unsupported-banner",role:"alert",children:c.jsxs("div",{className:"unsupported-banner__body",children:[c.jsxs("div",{className:"unsupported-banner__text",children:[c.jsx("strong",{children:u?"Plik nieobsugiwany?":"Unsupported file?"}),c.jsxs("p",{className:"small",style:{marginTop:6},children:[u?"Jeli twj plik nie jest jeszcze obsugiwany przez program, przelij go prosz na adres":"If your file is not supported yet, please send it to"," ",c.jsx("button",{type:"button",className:"link-btn",onClick:()=>w(m,"Email"),children:m})," ",u?"w temacie maila wpisujc:":"and use subject:"," ",c.jsx("button",{type:"button",className:"link-btn",onClick:()=>w(x,u?"Temat":"Subject"),children:x}),"."," ",u?"Jeeli dane w twoim pliku s wraliwe lub sam plik jest zbyt duy do przesania, przygotuj prosz plik uproszczony, zostawiajc dane z przynajmniej dwch punktw czasowych. (kliknij aby skopiowa adres lub temat maila).":"If your data are sensitive or the file is too large, please prepare a simplified file keeping at least two time points (click to copy email or subject)."]}),i&&c.jsx("div",{className:"small",children:i})]}),c.jsx("button",{className:"btn ghost",type:"button",onClick:()=>s(!1),"aria-label":"Close unsupported file banner",children:""})]})}),c.jsxs("div",{className:"setup-grid",children:[c.jsxs("div",{className:"panel-row full-span",children:[c.jsxs("div",{className:"panel panel-landing",children:[c.jsxs("div",{className:"panel-heading with-help",children:[c.jsxs("div",{children:[c.jsxs("h3",{children:[" ",u?"Importuj assignment":"Import assignment"]}),c.jsx("p",{className:"small",children:u?c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Jeli ju wczeniej"})," przypisae prby do dokw i przekonwertowae dane, zaimportuj plik assignment (.json) tutaj."]}):c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"If you have already"})," assigned samples to wells and converted data, import the assignment (.json) file here."]})})]}),c.jsx("button",{ref:d,className:"help-btn",type:"button",onClick:()=>n(b=>({...b,import:!b.import})),children:"?"})]}),c.jsx(Qr,{anchorRef:d,open:!!r.import,children:u?"Zaaduj tylko pliki assignment (.json) zapisane wczeniej. Surowe dane wrzucaj w kolejnym panelu.":"Load only assignment (.json) files saved earlier. Put raw measurements into the next panel."}),c.jsxs("div",{className:"row",style:{gap:8,flexWrap:"wrap",alignItems:"center"},children:[c.jsxs("label",{className:"btn basic-btn",style:{cursor:"pointer"},children:[u?"Importuj .json":"Import .json",c.jsx("input",{type:"file",accept:".json,application/json",style:{display:"none"},onChange:b=>{var _;const S=(_=b.target.files)==null?void 0:_[0];S&&E(S),b.currentTarget.value=""}})]}),e&&c.jsx("div",{className:"small",children:e})]})]}),c.jsxs("div",{className:"panel panel-soft",children:[c.jsxs("div",{className:"panel-heading with-help",children:[c.jsxs("div",{children:[c.jsxs("h3",{children:[" ",u?"Importuj dane pomiarowe":"Import data"]}),c.jsx("p",{className:"small",children:u?"Dodaj pliki z danymi pomiarowymi. Program przekonwertuje je do formatu wewntrznego, na ktrym bazuje dalsza analiza.":"Add raw measurement files. The app will convert them to the internal format used for further analysis."})]}),c.jsx("div",{style:{display:"flex",gap:8,alignItems:"center"},children:c.jsx("button",{ref:p,className:"help-btn",type:"button",onClick:()=>n(b=>({...b,importData:!b.importData})),children:"?"})})]}),c.jsx(Qr,{anchorRef:p,open:!!r.importData,children:u?"Wybierz plik z danymi na ktrych chcesz pracowa.":"Select the file with the data you want to work on."}),c.jsxs("div",{className:"row",style:{gap:8,flexWrap:"wrap",alignItems:"center"},children:[c.jsxs("label",{className:"btn basic-btn",style:{cursor:"pointer"},onClick:v,children:[A,c.jsx("input",{type:"file",accept:".csv,.txt,.xlsx,.json,text/csv,text/plain,application/json,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",style:{display:"none"},onChange:b=>{var _;const S=(_=b.target.files)==null?void 0:_[0];S&&z(S),b.currentTarget.value=""}})]}),c.jsx("button",{className:"btn basic-btn",type:"button",onClick:()=>s(b=>!b),children:u?"Plik nieobsugiwany?":"Your file is not supported?"}),e&&c.jsx("div",{className:"small",children:e})]})]})]}),c.jsx(P_,{}),c.jsx("div",{className:"full-span",children:c.jsx("div",{ref:h,children:c.jsx(z_,{onMappingImported:y})})})]}),c.jsx(W_,{})]})}function ia({title:e,helpContent:t,children:r,className:n="",contentClassName:a="",actions:s}){const[i,l]=k.useState(!1),o=k.useRef(null);return c.jsxs("div",{className:`panel ${n}`.trim(),children:[c.jsxs("div",{className:"panel-heading with-help panel-heading--centered",children:[c.jsx("h3",{className:"panel-heading__title panel-heading__title--flush",children:e}),c.jsxs("div",{className:"panel-heading__actions",children:[s,c.jsx("button",{ref:o,className:"help-btn circle",type:"button",onClick:()=>l(u=>!u),"aria-label":"Toggle help",children:"?"})]})]}),c.jsx(Qr,{anchorRef:o,open:i,children:t}),c.jsx("div",{className:a,children:r})]})}const sx="#000000",ix=.25;function Cu({series:e,bands:t,xBands:r,title:n,xLabel:a,yLabel:s,height:i=320,fontScale:l=1,legendMode:o="inline-top",highlightedNames:u=[],emphasizeSeriesNames:f=[],emphasizeStrokeWidth:d=3.2,onLegendItemEnter:p,onLegendItemLeave:h,onLegendItemClick:m,titlePosition:x="top",aspect:v,minHeight:y=320,maxHeight:w=700,maxVh:g=.65,groupOrder:E,stdMode:A="area",enableZoom:z=!0,onRequestTitleEdit:b,onRequestXLabelEdit:S,onRequestYLabelEdit:_,onSvgRef:T,pointMarkers:D="none",selectedPointIds:M,onPointClick:G,pointMarkerRadius:Y=4,pointFill:J="solid",defaultViewX:Q,defaultViewY:X,minYLimit:ee,maxYLimit:F,enablePan:le=!0,pointSelectionMode:re="modifier",onPointSelection:j,mode:R="line",scatterSeries:B=[],scatterPointRadius:V,scatterOpacity:te=.9,minPanX:ke,minPanY:_e,resetViewKey:ge,enableDoubleClickReset:ye=!0,legendEntries:Ee=[],showLegend:C=!1,legendTitle:we,legendScale:he=1}){const Ce=k.useRef(null),[Ae,be]=k.useState({width:800,height:800}),[qe,Ie]=k.useState(typeof window<"u"?window.innerHeight:800),ht=k.useRef(null);k.useLayoutEffect(()=>{const se=Ce.current;if(!se)return;const Me=()=>{be({width:se.clientWidth||800,height:se.clientHeight||800})},Oe=new ResizeObserver(Me);Oe.observe(se),Me();const nt=()=>{Ie(window.innerHeight),Me()};return window.addEventListener("resize",nt),()=>{Oe.disconnect(),window.removeEventListener("resize",nt)}},[]);const yt=Ae.width,Pt=Ae.height>0?Ae.height:Number.POSITIVE_INFINITY,Fe=v?Math.round(yt/v):i,vt=Math.round(qe*g),jt=Number.isFinite(Pt)&&Pt>0,ft=Math.max(y,Math.min(w,Math.min(Fe,vt))),kt=jt?Math.min(w,Pt):ft,Se={top:(x==="top"?44:24)*l,right:16,bottom:(x==="bottom"?56:44)*l,left:Math.max(56,56*l)},ot=Math.max(10,yt-Se.left-Se.right),Xe=Math.max(10,kt-Se.top-Se.bottom),Rt=B.flatMap(se=>se.points.map(Me=>Me.x)),q=B.flatMap(se=>se.points.map(Me=>Me.y)),oe=[...e.flatMap(se=>se.points.map(Me=>Me.x)),...Rt],pe=[...e.flatMap(se=>se.points.map(Me=>Me.y)),...q,...(t==null?void 0:t.flatMap(se=>se.points.flatMap(Me=>[Me.low,Me.high])))??[]],He=oe.length?Math.min(...oe):0,st=oe.length?Math.max(...oe):1,_t=Math.min(ke??He,He),Lt=Math.max(1,st-He),xr=Number.isFinite(He-_t)&&He-_t>0?He-_t:Lt*.25,Qe=st+xr;let rt=pe.length?Math.min(...pe):0,je=pe.length?Math.max(...pe):1;if(pe.length){const se=je-rt,Me=.12,Oe=se>0?se*Me:Math.max(Math.abs(je),Math.abs(rt),1)*Me;je+=Oe,se===0&&(rt-=Oe*.25)}const[Be,Ve]=k.useState([He,st]),[Kt,St]=k.useState([rt,je]),yr=k.useMemo(()=>!M||!M.length?new Set:new Set(M),[M?M.join(""):""]),Tt=ee??rt;let at=Math.min(_e??Tt,Tt),rr=F??je;at<rr||(rr=at+1e-6);const er=Q?Q.join("|"):"",hr=X?X.join("|"):"",pr=k.useRef(Symbol("init"));k.useEffect(()=>{if(typeof ge<"u"){if(pr.current===ge)return;pr.current=ge}const Me=(et,gt,Dt)=>{const Nt=Math.min(Math.max(gt,et[0]),Dt),it=et[1]??et[0],Ft=Math.min(Math.max(Nt,it),Dt);return Nt===Ft?[Nt,Ft+1e-6]:[Nt,Ft]},Oe=Q?Me(Q,_t,Qe):[He,st],nt=X?Me(X,at,rr):[rt,je];Ve(Oe),St(nt)},[ge,He,st,rt,je,e.length,er,hr,at,rr,_t,Qe]);const Ht=Be[0],Ot=Be[1],N=Kt[0],P=Kt[1],O=Ot-Ht||1,I=P-N||1,W=C?(Ee??[]).filter(se=>!se.hidden):[],[H,ce]=k.useState(null),ve=k.useRef(null),Z=Math.max(.5,he||1)*l,fe=180*Z,de=Math.max(fe,ot),Re=we?18*Z:0,Ge=we?18*Z:0,Je=12*Z,Ue=Math.min(360*Z,Math.max(200*Z,ot*.4)),U=Math.max(60*Z,((H==null?void 0:H.width)??Ue)-Je*2-36*Z),ae=7*Z,me=k.useMemo(()=>W.map(se=>{var nt;const Me=(((nt=se.label)==null?void 0:nt.length)??1)||1,Oe=Math.max(1,Math.ceil(Me*ae/Math.max(80*Z,U)));return Math.max(18*Z,Oe*14*Z+4*Z)}),[W,ae,U,Z]),Te=k.useMemo(()=>me.reduce((se,Me)=>se+Me,0),[me]),Ye=Je*2+Re+Ge+Te,wt=k.useCallback(se=>{const Me=fe,Oe=de,nt=Math.min(Math.max(Me,se.width),Oe),et=Math.max(60*l,Ye||60*l),gt=Math.max(et,Xe),Dt=Math.min(Math.max(et,se.height),gt),Nt=Se.left+4,it=Se.top+4,Ft=Se.left+ot-nt-4,Ut=Se.top+Xe-Dt-4;return{x:Math.min(Math.max(Nt,se.x),Ft),y:Math.min(Math.max(it,se.y),Ut),width:nt,height:Dt}},[Xe,ot,de,fe,Ye,Se.left,Se.top,l]);k.useEffect(()=>{if(!C||W.length===0){ce(Me=>Me&&null);return}const se=wt({x:Se.left+ot-Ue-12,y:Se.top+12,width:Ue,height:Ye});ce(Me=>Me&&Me.x===se.x&&Me.y===se.y&&Me.width===se.width&&Me.height===se.height?Me:se)},[C,W.length,wt,ot,Se.left,Se.top,Ue,Ye]);const We=se=>Se.left+(se-Ht)/O*ot,ze=se=>Se.top+Xe-(se-N)/I*Xe;function ct(se){return se.length?se.map((Oe,nt)=>`${nt?"L":"M"} ${We(Oe.x).toFixed(2)} ${ze(Oe.y).toFixed(2)}`).join(" "):""}function ie(se){if(!se.length)return"";const Me=se.map((nt,et)=>`${et?"L":"M"} ${We(nt.x).toFixed(2)} ${ze(nt.high).toFixed(2)}`).join(" "),Oe=se.slice().reverse().map((nt,et)=>`${et?"L":""} ${We(nt.x).toFixed(2)} ${ze(nt.low).toFixed(2)}`).join(" ");return`${Me} ${Oe} Z`}const $e=Array.from({length:6},(se,Me)=>Ht+O*Me/5),Ct=Array.from({length:6},(se,Me)=>N+I*Me/5);function Mt(se){if(!Number.isFinite(se)||se<=0)return 0;const Me=Math.max(Math.abs(se)/5,Number.EPSILON),Oe=Math.max(0,Math.ceil(-Math.log10(Me)));return Math.min(Oe,6)}const Vt=(se,Me)=>{if(!Number.isFinite(se))return"";const Oe=Math.min(Math.max(Me,0),8);return se.toFixed(Oe)},Et=Mt(O),Bt=Mt(I);function gr(se){return Ht+(se-Se.left)/ot*O}function Gr(se){return P-(se-Se.top)/Xe*I}k.useEffect(()=>{if(!z)return;const se=et=>{var $t,Zt;const gt=(Zt=($t=ht.current)==null?void 0:$t.getBoundingClientRect)==null?void 0:Zt.call($t);if(!gt)return;const Dt=et.clientX-gt.left,Nt=et.clientY-gt.top;if(!(Dt>=Se.left&&Dt<=Se.left+ot&&Nt>=Se.top&&Nt<=Se.top+Xe))return;et.preventDefault(),et.stopPropagation();const Ft=gr(Dt),Ut=Gr(Nt),Jt=(qt,kr,Pr)=>Math.max(kr,Math.min(Pr,qt));if(et.shiftKey&&!et.ctrlKey){const qt=et.deltaY*O*.0015;let kr=Jt(Ht+qt,_t,Qe-O),Pr=kr+O;Ve([kr,Pr])}else{const qt=Math.exp(et.deltaY*.0015),kr=Math.max((st-He)/1e6,Math.min((st-He)*1.1,O*qt)),Pr=Math.max((je-rt)/1e6,Math.min((je-rt)*1.1,I*qt)),$r=Ft-(Ft-Ht)*(kr/O),Mr=Ft+(Ot-Ft)*(kr/O),Hn=Ut-(Ut-N)*(Pr/I),un=Ut+(P-Ut)*(Pr/I);let Nr=Jt($r,_t,Qe-1e-12),qn=Jt(Mr,Nr+1e-12,Qe),Vn=Jt(Hn,at,rr-1e-12),Ai=Jt(un,Vn+1e-12,rr);Ve([Nr,qn]),St([Vn,Ai])}},Me={passive:!1,capture:!0},Oe=Ce.current,nt=ht.current;return Oe==null||Oe.addEventListener("wheel",se,Me),nt==null||nt.addEventListener("wheel",se,Me),()=>{Oe==null||Oe.removeEventListener("wheel",se,Me),nt==null||nt.removeEventListener("wheel",se,Me)}},[z,Se.left,Se.top,ot,Xe,O,I,Ht,Ot,N,P,He,st,rt,je,_t,Qe,at,rr]);function vn(){Ve([He,st]),St([rt,je])}const K=k.useRef(null),[xe,Ne]=k.useState(!1),Pe=k.useRef("none"),mt=k.useRef(null),[De,pt]=k.useState(null),bt=4,xt=k.useRef(null),cr=28,wr=(se,Me)=>({x:Math.max(Se.left,Math.min(Se.left+ot,se)),y:Math.max(Se.top,Math.min(Se.top+Xe,Me))}),yn=(se,Me,Oe)=>{Pe.current=se==="x"?"axis-scale-x":"axis-scale-y",xt.current={axis:se,startClientX:Me,startClientY:Oe,range:se==="x"?[Ht,Ot]:[N,P]}};function Wn(se){var Jt,nr;const Me=(nr=(Jt=ht.current)==null?void 0:Jt.getBoundingClientRect)==null?void 0:nr.call(Jt);if(!Me)return;const Oe=se.clientX-Me.left,nt=se.clientY-Me.top,et=Oe>=Se.left&&Oe<=Se.left+ot&&nt>=Se.top&&nt<=Se.top+Xe,gt=Oe>=Se.left&&Oe<=Se.left+ot&&nt>=Se.top+Xe&&nt<=Se.top+Xe+cr,Dt=nt>=Se.top&&nt<=Se.top+Xe&&Oe>=Se.left-cr&&Oe<=Se.left;if(gt){yn("x",se.clientX,se.clientY),se.preventDefault();return}if(Dt){yn("y",se.clientX,se.clientY),se.preventDefault();return}if(!et)return;const{x:Nt,y:it}=wr(Oe,nt),Ft=se.metaKey||se.ctrlKey||se.altKey||se.shiftKey;if(!!j&&(re==="immediate"||Ft)){Pe.current="select",mt.current={px:Nt,py:it},pt({x0:Nt,y0:it,x1:Nt,y1:it}),se.preventDefault();return}le&&(Pe.current="pan",K.current={sx:se.clientX,sy:se.clientY,vx:[Ht,Ot],vy:[N,P]},Ne(!0),se.preventDefault())}function nn(se){var et,gt;const Me=(gt=(et=ht.current)==null?void 0:et.getBoundingClientRect)==null?void 0:gt.call(et);if(!Me)return;const Oe=se.clientX-Me.left,nt=se.clientY-Me.top;if(ve.current&&H){const{mode:Dt,startX:Nt,startY:it,box:Ft}=ve.current,Ut=se.clientX-Nt,Jt=se.clientY-it;ce(wt(Dt==="drag"?{...Ft,x:Ft.x+Ut,y:Ft.y+Jt}:{...Ft,width:Ft.width+Ut,height:Ft.height+Jt})),se.preventDefault();return}if((Pe.current==="axis-scale-x"||Pe.current==="axis-scale-y")&&xt.current){const Dt=xt.current.axis,Nt=Dt==="x"?{min:_t,max:Qe,fullSpan:Math.max(1e-6,st-He)}:{min:at,max:rr,fullSpan:Math.max(1e-6,je-rt)},it=Dt==="x"?ot:Xe;if(it<=0)return;const Ut=(Dt==="x"?se.clientX-xt.current.startClientX:xt.current.startClientY-se.clientY)/Math.max(it,24),Jt=Math.exp(Ut),nr=xt.current.range;let Zt=Math.max(1e-6,nr[1]-nr[0])*Jt;const qt=Math.max(Nt.fullSpan/1e6,1e-6),kr=Math.max(qt,Nt.max-Nt.min);Zt=Math.min(Math.max(Zt,qt),kr);const Pr=(nr[0]+nr[1])/2;let $r=Pr-Zt/2,Mr=Pr+Zt/2;if($r<Nt.min){const Hn=Nt.min-$r;$r+=Hn,Mr+=Hn}if(Mr>Nt.max){const Hn=Mr-Nt.max;$r-=Hn,Mr-=Hn}$r=Math.max(Nt.min,$r),Mr=Math.min(Nt.max,Mr),Mr>$r||(Mr=$r+qt),Dt==="x"?Ve([$r,Mr]):St([$r,Mr]),se.preventDefault();return}if(Pe.current==="select"){if(!mt.current)return;const{x:Dt,y:Nt}=wr(Oe,nt);pt({x0:mt.current.px,y0:mt.current.py,x1:Dt,y1:Nt}),se.preventDefault();return}if(Pe.current==="pan"&&K.current){const Dt=se.clientX-K.current.sx,Nt=se.clientY-K.current.sy,it=K.current.vx[1]-K.current.vx[0],Ft=K.current.vy[1]-K.current.vy[0],Ut=-(Dt/ot)*it,Jt=Nt/Xe*Ft,nr=(Pr,$r,Mr)=>Math.max($r,Math.min(Mr,Pr));let $t=nr(K.current.vx[0]+Ut,_t,Qe-it),Zt=$t+it,qt=nr(K.current.vy[0]+Jt,at,rr-Ft),kr=qt+Ft;Ve([$t,Zt]),St([qt,kr])}}function sr(se){if(!De){mt.current=null,pt(null),Pe.current="none";return}const Me=Math.max(Se.left,Math.min(De.x0,De.x1)),Oe=Math.min(Se.left+ot,Math.max(De.x0,De.x1)),nt=Math.max(Se.top,Math.min(De.y0,De.y1)),et=Math.min(Se.top+Xe,Math.max(De.y0,De.y1)),gt=Math.abs(Oe-Me),Dt=Math.abs(et-nt);if(mt.current=null,pt(null),Pe.current="none",gt<bt&&Dt<bt)return;const Nt=[];if(e.forEach((it,Ft)=>{it.points.forEach((Ut,Jt)=>{const nr=We(Ut.x),$t=ze(Ut.y);nr>=Me&&nr<=Oe&&$t>=nt&&$t<=et&&Nt.push({seriesName:it.name,seriesIndex:Ft,pointIndex:Jt,point:Ut})})}),Nt.length){const it=se??{clientX:0,clientY:0};j==null||j({points:Nt,event:it})}}function mr(){ve.current=null,mt.current=null,pt(null),xt.current=null,Pe.current="none"}function da(se){ve.current=null,Pe.current==="select"?sr(se):Pe.current==="pan"?(K.current=null,Ne(!1),Pe.current="none"):(Pe.current==="axis-scale-x"||Pe.current==="axis-scale-y")&&(xt.current=null,Pe.current="none")}const Js=se=>{if(!Number.isFinite(se))return"";const Me=Math.abs(se);return Me>=1e3?se.toFixed(0):Me>=10?se.toFixed(2):se.toFixed(3)},[gs,vs]=k.useState(null);function Ni(se,Me){var it,Ft;const Oe=(Ft=(it=ht.current)==null?void 0:it.getBoundingClientRect)==null?void 0:Ft.call(it);if(!Oe)return vs(null);const nt=se-Oe.left,et=Me-Oe.top;if(nt<Se.left||nt>Se.left+ot||et<Se.top||et>Se.top+Xe){vs(null);return}let gt=null;for(const Ut of e)for(const Jt of Ut.points){const nr=We(Jt.x),$t=ze(Jt.y),Zt=Math.hypot(nr-nt,$t-et);(!gt||Zt<gt.d)&&(gt={d:Zt,label:Ut.name,point:Jt})}const Dt=gt&&gt.d<32,Nt=[];if(Dt&&(gt!=null&&gt.label)&&Nt.push(gt.label),r&&r.length){const Ut=gr(nt),Jt=r.filter(nr=>Ut>=Math.min(nr.start,nr.end)&&Ut<=Math.max(nr.start,nr.end));if(Jt.length===1){const nr=Jt[0],$t=nr.phase!==void 0?String(nr.phase):void 0;$t&&Nt.push(`phase ${$t}`)}}if(Dt&&(gt!=null&&gt.point)){const Ut=Js(gt.point.x),Jt=Js(gt.point.y),nr=a||"X",$t=s||"Y";Nt.push(`${nr}: ${Ut}`),Nt.push(`${$t}: ${Jt}`)}Nt.length?vs({x:se,y:Me,lines:Nt}):vs(null)}return c.jsxs("div",{ref:Ce,style:{position:"relative",width:"100%",height:"100%",maxWidth:"100%",overflow:"hidden",overscrollBehavior:"none"},children:[c.jsxs("svg",{width:yt,height:kt,role:"img",ref:se=>{ht.current=se,T&&T(se)},onDoubleClick:ye?vn:void 0,onMouseDown:Wn,onMouseMove:se=>{nn(se),Ni(se.clientX,se.clientY)},onMouseUp:da,onMouseLeave:()=>{mr(),vs(null),K.current=null,Ne(!1),Pe.current="none"},children:[c.jsxs("defs",{children:[c.jsx("marker",{id:"axis-arrow",viewBox:"0 0 8 8",refX:"7",refY:"4",markerWidth:"8",markerHeight:"8",orient:"auto-start-reverse",children:c.jsx("path",{d:"M0,0 L8,4 L0,8 Z",fill:"#555"})}),c.jsx("clipPath",{id:"plot-clip",children:c.jsx("rect",{x:Se.left,y:Se.top,width:ot,height:Xe})})]}),r&&r.length>0&&c.jsx("g",{clipPath:"url(#plot-clip)",children:r.map((se,Me)=>{const Oe=We(se.start),nt=We(se.end),et=Math.max(0,nt-Oe);return c.jsx("rect",{x:Math.min(Oe,nt),y:Se.top,width:et,height:Xe,fill:se.color,opacity:se.opacity??.12},Me)})}),n&&x==="top"&&c.jsx("text",{x:yt/2,y:22*l,textAnchor:"middle",fontSize:15*l,fontWeight:600,fill:"#111",style:{cursor:"text"},onDoubleClick:b,children:n}),c.jsx("line",{x1:Se.left,y1:Se.top+Xe,x2:Se.left,y2:Se.top,stroke:"#555",markerEnd:"url(#axis-arrow)"}),c.jsx("line",{x1:Se.left,y1:Se.top+Xe,x2:Se.left+ot,y2:Se.top+Xe,stroke:"#555",markerEnd:"url(#axis-arrow)"}),$e.map((se,Me)=>{const Oe=Me===0,nt=Me===$e.length-1,et=nt?"end":Oe?"start":"middle",gt=nt?-4*l:Oe?4*l:0;return c.jsxs("g",{children:[c.jsx("line",{x1:We(se),y1:Se.top,x2:We(se),y2:Se.top+Xe,stroke:"#999",strokeDasharray:"3,4"}),c.jsx("text",{x:We(se),y:Se.top+Xe+14*l,textAnchor:et,fontSize:11*l,fill:"#111",dx:gt,children:Vt(se,Et)})]},Me)}),Ct.map((se,Me)=>c.jsxs("g",{children:[c.jsx("line",{x1:Se.left,y1:ze(se),x2:Se.left+ot,y2:ze(se),stroke:"#999",strokeDasharray:"3,4"}),c.jsx("text",{x:Se.left-8,y:ze(se)+4,textAnchor:"end",fontSize:11*l,fill:"#111",children:Vt(se,Bt)})]},Me)),c.jsxs("g",{clipPath:"url(#plot-clip)",children:[R==="line"&&t&&t.map((se,Me)=>{if(!se.points.length)return null;const Oe=A==="none"?se.mode??"none":se.mode??A;if(Oe==="none")return null;const nt=se.color;return Oe==="area"?c.jsx("path",{d:ie(se.points),fill:nt,stroke:"none",opacity:.35},`band-${Me}`):c.jsx("g",{stroke:nt,strokeWidth:1,opacity:.6,children:se.points.map((et,gt)=>c.jsxs("g",{children:[c.jsx("line",{x1:We(et.x),y1:ze(et.low),x2:We(et.x),y2:ze(et.high)}),c.jsx("line",{x1:We(et.x)-4,y1:ze(et.low),x2:We(et.x)+4,y2:ze(et.low)}),c.jsx("line",{x1:We(et.x)-4,y1:ze(et.high),x2:We(et.x)+4,y2:ze(et.high)})]},gt))},`err-${Me}`)}),R==="line"&&e.map((se,Me)=>{const Oe=u.length?u.includes(se.name):!0,nt=u.length>0&&!Oe,gt=f.includes(se.name)?d:Oe?2.6:2;return c.jsx("path",{d:ct(se.points),fill:"none",stroke:se.color,strokeWidth:gt,opacity:nt?.25:1},Me)})]}),(R==="scatter"||D!=="none")&&c.jsx("g",{clipPath:"url(#plot-clip)",children:e.map((se,Me)=>se.points.map((Oe,nt)=>{if(!Number.isFinite(Oe.x)||!Number.isFinite(Oe.y))return null;const et=Oe.id??`${se.name}-${nt}`,gt=yr.has(et),Dt=Math.max(1.5,gt?Y+1.5:Y),Nt=se.color??"#2563eb",it=Oe.meta??{},Ft=!!it.excluded,Ut=typeof it.strokeColor=="string"?it.strokeColor:Nt,Jt=typeof it.strokeWidth=="number"?it.strokeWidth:1,nr=typeof it.fillColor=="string"?it.fillColor:J==="outline"?"#fff":Nt,$t=typeof it.fillOpacity=="number"?it.fillOpacity:1,Zt=typeof it.selectionStrokeColor=="string"?it.selectionStrokeColor:sx,qt=typeof it.selectionFillColor=="string"?it.selectionFillColor:"#fff",kr=typeof it.selectionHaloColor=="string"?it.selectionHaloColor:Zt,Pr=typeof it.selectionHaloOpacity=="number"?it.selectionHaloOpacity:ix,$r=gt?Zt:Ut,Mr=gt?qt:nr,Hn=gt?1:$t,un=gt?Jt+1:Jt,Nr="#9ca3af",qn=Math.max(Dt+3,Dt*1.8);return c.jsxs("g",{children:[gt&&c.jsx("circle",{cx:We(Oe.x),cy:ze(Oe.y),r:qn,fill:kr,fillOpacity:Pr,stroke:kr,strokeOpacity:Math.min(1,Pr+.2),strokeWidth:1,pointerEvents:"none"}),Ft&&c.jsx("circle",{cx:We(Oe.x),cy:ze(Oe.y),r:Dt+2,fill:"none",stroke:Nr,strokeWidth:2,opacity:.8,pointerEvents:"none"}),c.jsx("circle",{cx:We(Oe.x),cy:ze(Oe.y),r:Dt,fill:Mr,fillOpacity:Hn,stroke:$r,strokeWidth:un,onClick:Vn=>{Vn.stopPropagation(),G==null||G({seriesName:se.name,seriesIndex:Me,pointIndex:nt,point:Oe,event:Vn})},style:{cursor:G?"pointer":"default"}}),Ft&&c.jsxs("g",{children:[c.jsx("line",{x1:We(Oe.x)-4.5,y1:ze(Oe.y)-4.5,x2:We(Oe.x)+4.5,y2:ze(Oe.y)+4.5,stroke:Zt,strokeWidth:1.6,pointerEvents:"none"}),c.jsx("line",{x1:We(Oe.x)+4.5,y1:ze(Oe.y)-4.5,x2:We(Oe.x)-4.5,y2:ze(Oe.y)+4.5,stroke:Zt,strokeWidth:1.6,pointerEvents:"none"})]})]},`pt-${Me}-${nt}`)}))}),B.length>0&&c.jsx("g",{clipPath:"url(#plot-clip)",children:B.map((se,Me)=>se.points.map((Oe,nt)=>{if(!Number.isFinite(Oe.x)||!Number.isFinite(Oe.y))return null;const et=Oe.id??`${se.name}-scatter-${nt}`,gt=yr.has(et),Dt=Math.max(1.2,gt?(V??Y)+1.2:V??Y),Nt=se.color??"#2563eb",it=Oe.meta??{},Ft=it.shape??"circle",Ut=typeof it.strokeColor=="string"?it.strokeColor:Nt,Jt=typeof it.strokeWidth=="number"?it.strokeWidth:.8,nr=typeof it.fillColor=="string"?it.fillColor:J==="outline"?"#fff":Nt,$t=typeof it.fillOpacity=="number"?it.fillOpacity:te,Zt=typeof it.selectionStrokeColor=="string"?it.selectionStrokeColor:sx,qt=typeof it.selectionFillColor=="string"?it.selectionFillColor:"#fff",kr=typeof it.selectionHaloColor=="string"?it.selectionHaloColor:Zt,Pr=typeof it.selectionHaloOpacity=="number"?it.selectionHaloOpacity:ix,$r=gt?Zt:Ut,Mr=gt?qt:nr,Hn=gt?1:$t,un=gt?Jt+.8:Jt,Nr=Math.max(Dt+2.4,Dt*1.6),qn=typeof it.dashHalfWidth=="number"?it.dashHalfWidth:6;return c.jsx("g",{children:Ft==="dash"?c.jsxs(c.Fragment,{children:[gt&&c.jsx("line",{x1:We(Oe.x)-qn-2,x2:We(Oe.x)+qn+2,y1:ze(Oe.y),y2:ze(Oe.y),stroke:kr,strokeWidth:un+2.4,strokeOpacity:Pr,pointerEvents:"none"}),c.jsx("line",{x1:We(Oe.x)-qn,x2:We(Oe.x)+qn,y1:ze(Oe.y),y2:ze(Oe.y),stroke:$r,strokeWidth:un+1,strokeLinecap:"round",onClick:G?Vn=>G({seriesName:se.name,seriesIndex:e.length+Me,pointIndex:nt,point:Oe,event:Vn}):void 0})]}):c.jsxs(c.Fragment,{children:[gt&&c.jsx("circle",{cx:We(Oe.x),cy:ze(Oe.y),r:Nr,fill:kr,fillOpacity:Pr,stroke:kr,strokeOpacity:Math.min(1,Pr+.2),strokeWidth:.9,pointerEvents:"none"}),c.jsx("circle",{cx:We(Oe.x),cy:ze(Oe.y),r:Dt,fill:Mr,fillOpacity:Hn,stroke:$r,strokeWidth:un,onClick:G?Vn=>G({seriesName:se.name,seriesIndex:e.length+Me,pointIndex:nt,point:Oe,event:Vn}):void 0})]})},`scatter-${Me}-${nt}`)}))}),W.length>0&&H&&(()=>{const se="#0f172a",Me=H.width,Oe=H.height,nt=Je+Re+Ge;return c.jsxs("g",{transform:`translate(${H.x}, ${H.y})`,children:[c.jsx("rect",{x:0,y:0,width:Me,height:Oe,rx:10*l,fill:"rgba(248,250,252,0.94)",stroke:"rgba(148,163,184,0.9)",strokeWidth:1,cursor:"move",onMouseDown:et=>{et.preventDefault(),et.stopPropagation(),ve.current={mode:"drag",startX:et.clientX,startY:et.clientY,box:H},Pe.current="none"}}),we&&c.jsx("text",{x:Je,y:Je+Re-4*Z,fontSize:13*Z,fontWeight:700,fill:se,children:we}),(()=>{let et=nt;return W.map((gt,Dt)=>{const it=me[Dt]??18*Z,Ft=Je,Ut=et+it/2-4*Z,Jt=Ft+28*Z,nr=et,$t=Math.max(60,Me-Jt-Je);return et+=it,c.jsxs("g",{children:[gt.kind==="excluded"?c.jsxs("g",{children:[c.jsx("circle",{cx:Ft+10*Z,cy:Ut,r:8*Z,fill:"#fff",stroke:"#111",strokeWidth:1.8*Z}),c.jsx("circle",{cx:Ft+10*Z,cy:Ut,r:11*Z,fill:"none",stroke:"#9ca3af",strokeWidth:2*Z,opacity:.8}),c.jsx("line",{x1:Ft+4*Z,y1:Ut-6*Z,x2:Ft+16*Z,y2:Ut+6*Z,stroke:"#111",strokeWidth:2*Z}),c.jsx("line",{x1:Ft+16*Z,y1:Ut-6*Z,x2:Ft+4*Z,y2:Ut+6*Z,stroke:"#111",strokeWidth:2*Z})]}):c.jsxs("g",{children:[c.jsx("line",{x1:Ft,y1:Ut,x2:Ft+20*Z,y2:Ut,stroke:gt.color,strokeWidth:2.4*Z}),c.jsx("circle",{cx:Ft+10*Z,cy:Ut,r:4.4*Z,fill:gt.color,stroke:"rgba(15,23,42,0.7)",strokeWidth:.8*Z})]}),c.jsx("foreignObject",{x:Jt,y:nr,width:$t,height:it,children:c.jsx("div",{style:{fontSize:`${12*Z}px`,fontWeight:600,color:se,lineHeight:1.2,wordBreak:"break-word",whiteSpace:"normal"},children:gt.label})})]},gt.id)})})(),c.jsx("rect",{x:Me-16*l,y:Oe-16*l,width:14*l,height:14*l,fill:"rgba(0,0,0,0.08)",stroke:"rgba(0,0,0,0.25)",strokeWidth:.8*l,rx:3*l,cursor:"nwse-resize",onMouseDown:et=>{et.preventDefault(),et.stopPropagation(),ve.current={mode:"resize",startX:et.clientX,startY:et.clientY,box:H},Pe.current="none"}})]},"legend-overlay")})(),De&&(()=>{const se=Math.max(Se.left,Math.min(De.x0,De.x1)),Me=Math.min(Se.left+ot,Math.max(De.x0,De.x1)),Oe=Math.max(Se.top,Math.min(De.y0,De.y1)),nt=Math.min(Se.top+Xe,Math.max(De.y0,De.y1)),et=Math.max(0,Me-se),gt=Math.max(0,nt-Oe);return et<=0||gt<=0?null:c.jsx("rect",{x:se,y:Oe,width:et,height:gt,fill:"rgba(59,130,246,0.15)",stroke:"#2563eb",strokeDasharray:"4 2"})})(),a&&c.jsx("text",{x:Se.left+ot/2,y:Se.top+Xe+32*l,textAnchor:"middle",fontSize:12*l,fill:"#111",style:{cursor:"text"},onDoubleClick:S,children:a}),s&&c.jsx("text",{x:16,y:Se.top+Xe/2,transform:`rotate(-90, 16, ${Se.top+Xe/2})`,textAnchor:"middle",fontSize:12*l,fill:"#111",style:{cursor:"text"},onDoubleClick:_,children:s}),n&&x==="bottom"&&c.jsx("text",{x:Se.left+ot/2,y:Se.top+Xe+40*l,textAnchor:"middle",fontSize:15*l,fontWeight:600,fill:"#111",style:{cursor:"text"},onDoubleClick:b,children:n}),o==="inline-top"&&e.length>0&&c.jsx("g",{children:e.slice(0,8).map((se,Me)=>c.jsxs("g",{children:[c.jsx("rect",{x:Se.left+Me*(110*l),y:Se.top-16*l,width:10*l,height:10*l,fill:se.color}),c.jsx("text",{x:Se.left+14*l+Me*(110*l),y:Se.top-8*l,fontSize:11*l,fill:"#111",children:se.name})]},Me))})]}),gs&&c.jsx("div",{style:{position:"fixed",left:gs.x+10,top:gs.y+10,background:"rgba(0,0,0,.75)",color:"#fff",padding:"2px 6px",borderRadius:4,fontSize:12,pointerEvents:"none",whiteSpace:"pre"},children:gs.lines.map((se,Me)=>c.jsx("div",{children:se},Me))}),o==="table-below"&&e.length>0&&(()=>{const se=new Map;for(const $t of e){const Zt=$t.name.match(/^(.*?)\s+(r\d+.*)$/i),qt=(Zt?Zt[1]:$t.name).trim(),kr=Zt?Zt[2]:"";se.has(qt)||se.set(qt,{sample:qt,items:[]}),se.get(qt).items.push({name:$t.name,color:$t.color,rep:kr||$t.name})}let Me=Array.from(se.values());if(E&&E.length){const $t=new Map(E.map((Zt,qt)=>[Zt,qt]));Me.sort((Zt,qt)=>($t.get(Zt.sample)??1e9)-($t.get(qt.sample)??1e9)||Zt.sample.localeCompare(qt.sample,void 0,{numeric:!0}))}else Me.sort(($t,Zt)=>$t.sample.localeCompare(Zt.sample,void 0,{numeric:!0}));let Oe=0,nt=0,et=0;for(const $t of Me){Oe=Math.max(Oe,$t.sample.length),et=Math.max(et,$t.items.length);for(const Zt of $t.items)nt=Math.max(nt,Zt.rep.length)}const gt=8.5*l,Dt=Oe?(Oe+4)*gt:0,Nt=nt?(nt+4)*gt:0,it=et?et*46*l:0,Ft=130*l,Ut=360*l,Jt=Math.max(Dt,Nt,it),nr=Math.round(Math.max(Ft,Math.min(Ut,Jt||Ft)));return c.jsx("div",{style:{marginTop:8,display:"grid",gridTemplateColumns:`repeat(auto-fit, minmax(${nr}px, 1fr))`,gap:10,width:"100%"},children:Me.map(($t,Zt)=>c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:6},children:[c.jsx("strong",{style:{fontSize:`${12*l}px`},children:$t.sample}),c.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:$t.items.sort((qt,kr)=>qt.rep.localeCompare(kr.rep,void 0,{numeric:!0})).map((qt,kr)=>{const Pr=u.includes(qt.name);return c.jsxs("button",{onMouseEnter:()=>p&&p(qt.name),onMouseLeave:()=>h&&h(),onClick:()=>m&&m(qt.name),style:{display:"inline-flex",alignItems:"center",gap:6,border:"1px solid rgba(0,0,0,.15)",background:Pr?"rgba(0,0,0,.06)":"white",borderRadius:6,padding:"2px 6px",cursor:"pointer"},title:qt.name,children:[c.jsx("span",{style:{width:12,height:12,background:qt.color,display:"inline-block",borderRadius:2}}),c.jsx("span",{style:{fontSize:`${11*l}px`},children:qt.rep})]},kr)})})]},Zt))})})()]})}const m3=16/9;function Qf({heading:e,helpContent:t,series:r,chartTitle:n,xLabel:a,yLabel:s,fontScale:i,chartRef:l,highlightedNames:o,selectedPointIds:u,resetViewKey:f,minPanX:d,minPanY:p,actions:h,height:m=360,className:x="",fullscreen:v=!1,legendEntries:y,showLegend:w,legendTitle:g,legendScale:E,onPointToggle:A,onPointSelection:z,pointMarkers:b="none",pointMarkerRadius:S=3,mode:_="scatter",pointSelectionMode:T="modifier"}){const D=v?Math.max(m,900):m;return c.jsx(ia,{title:e,helpContent:t,className:`chart-card ${x} ${v?"chart-card--fullscreen":""}`.trim(),contentClassName:"chart-card__body",actions:h,children:c.jsx("div",{ref:l,className:"chart-card__canvas",children:c.jsx(Cu,{series:r,title:n,xLabel:a,yLabel:s,height:D,aspect:m3,minHeight:320,maxHeight:v?1800:640,fontScale:i,legendMode:"none",highlightedNames:o,mode:_,pointMarkers:b,pointMarkerRadius:S,selectedPointIds:u,pointSelectionMode:T,onPointClick:({point:M})=>{A&&M.meta&&A(M.meta)},onPointSelection:({points:M})=>{if(!z)return;const G=M.map(Y=>Y.point.meta).filter(Y=>!!Y);G.length&&z(G)},pointFill:"solid",minPanX:d,minPanY:p,resetViewKey:f,scatterSeries:[],scatterPointRadius:3,scatterOpacity:1,enableDoubleClickReset:!1,legendEntries:y,showLegend:w,legendTitle:g,legendScale:E})})})}function x3({fontScale:e,setFontScale:t,title:r,setTitle:n,xLabel:a,setXLabel:s,yLabel:i,setYLabel:l,onResetView:o,onExportPng:u,onCopyPng:f,onToggleLegend:d,legendOpen:p,isPl:h,legendPanel:m}){const x=h?"Moesz dowolnie zmieni tytu wykresu, nazwy osi, wielko elementw wykresu i in. Moesz pokaza lub ukry legend. Reset przywraca domylny zoom i pozycj wykresu.":"You can customize the chart title, axis labels, text size, and more. You can show or hide the legend. Reset restores the default zoom and position of the chart.";return c.jsxs(ia,{title:"Plot Controls",helpContent:x,className:"panel-soft control-panel",children:[c.jsxs("div",{className:"control-grid",children:[c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:h?"Tytu wykresu":"Chart title"})}),c.jsx("input",{className:"field-input",value:r,onChange:v=>n(v.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:h?"O X":"X axis"})}),c.jsx("input",{className:"field-input",value:a,onChange:v=>s(v.target.value)})]}),c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:h?"O Y":"Y axis"})}),c.jsx("input",{className:"field-input",value:i,onChange:v=>l(v.target.value)})]})]}),c.jsxs("div",{className:"control-row",children:[c.jsxs("div",{className:"btn-pair",children:[c.jsx("button",{className:"btn",onClick:()=>t(v=>Math.max(.6,+(v-.1).toFixed(1))),title:h?"Mniejsza czcionka":"Smaller text",children:"A-"}),c.jsx("button",{className:"btn",onClick:()=>t(v=>Math.min(2,+(v+.1).toFixed(1))),title:h?"Wieksza czcionka":"Larger text",children:"A+"})]}),c.jsxs("div",{className:"control-actions control-actions--tight",children:[c.jsx("button",{type:"button",className:"btn",onClick:u,children:h?"Eksportuj PNG":"Export PNG"}),c.jsx("button",{type:"button",className:"btn",onClick:f,children:h?"Kopiuj PNG":"Copy PNG"}),c.jsxs("label",{className:`parameters-toggle ${p?"is-on":""}`,title:p?h?"Ukryj legend":"Hide legend":h?"Poka legend":"Show legend",children:[c.jsx("input",{type:"checkbox",checked:p,onChange:d,"aria-pressed":p}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:p?h?"Ukryj legend":"Hide legend":h?"Legenda":"Legend"})]}),c.jsx("button",{type:"button",className:"btn basic-btn",onClick:o,children:h?"Reset widoku":"Reset view"})]})]}),m]})}function Tc({label:e,value:t,onChange:r,min:n,max:a,step:s,helpContent:i}){const[l,o]=k.useState(!1),u=k.useRef(null);return c.jsxs("label",{className:"field",children:[c.jsxs("div",{className:"field-label-row",children:[c.jsx("span",{children:e}),c.jsx("button",{ref:u,type:"button",className:"field-help-btn",onClick:()=>o(f=>!f),"aria-label":`${e} help`,children:"?"}),c.jsx(Qr,{anchorRef:u,open:l,children:i})]}),c.jsx("input",{type:"number",value:t,min:n,max:a,step:s,className:"field-input auto-exclusion-input",onChange:f=>r(Number(f.target.value))})]})}function g3({lowestPointCount:e,onLowestPointCountChange:t,outlierThreshold:r,onOutlierThresholdChange:n,outlierWindowMinutes:a,onOutlierWindowMinutesChange:s,outlierWindowPercent:i,onOutlierWindowPercentChange:l,onRerunAutoExclusion:o,onExportCurated:u,isPl:f}){const d=f?"Program stara si znale poziom bazowy: przed 45 minut pomiaru wybierana jest grupa kolejnych punktw o wskazanej licznoci ze wskazan tolerancj. Jeeli moliwe byo ustalenie poziomu bazowego, wykluczane s wszystkie punkty przed nim. Nastpnie w kolejnym, wskazanym przedziale punktw sprawdzana jest monotoniczno ich wartoci z uwzgldnieniem tolerancji spadku. Dostosuj parametry automatycznego wykluczania: dugo bazy, tolerancj bazy, tolerancj monotoniczn oraz okno czasowe dla kontroli monotonicznoci.":"The system attempts to find a baseline level: before 45 minutes into the measurement, a group of consecutive points of the specified count within the specified tolerance is selected. If a baseline level could be established, all points before it are excluded. Then, within the specified window of points, their monotonicity is checked with the allowed drop tolerance. Adjust the automatic exclusion parameters: baseline run length, baseline tolerance, monotonic tolerance, and time window for monotonicity check.",p=f?"Liczba kolejnych punktw przed 45 minut, ktre program prbuje uzna za poziom bazowy.":"Number of consecutive points before 45 minutes that the system tries to identify as the baseline.",h=f?"Odchylenie dopuszczalne od poziomu bazowego, mierzony w jendostkach OD600 (OD). Wiksza warto = wiksza tolerancja w wyznaczaniu poziomu bazowego.":"Allowed deviation from the baseline level, measured in OD600 units (OD). Higher values mean more tolerance in establishing the baseline.",m=f?"Wielko przedziau czasowego w ktrym program wyklucza punkty tak aby krzywa bya niemalejca. 0 = brak sprawdzania monotonicznoci.":"Size of the time window in which the system excludes points to ensure the curve is non-decreasing. 0 = no monotonicity check.",x=f?"Maksymalny spadek (OD) dopuszczony w trakcie monotonicznego odcinka. Wiksza warto = mniej wyklucze.":"Maximum drop (OD) allowed while enforcing monotonicity. Higher values mean fewer exclusions.";return c.jsxs(ia,{title:f?"Automatyczne wykluczanie":"Automatic exclusion",helpContent:d,className:"panel-soft control-panel auto-exclusion-panel",children:[c.jsx("p",{className:"isSmall",children:f?"Program stara si wykluczy dane na pocztku kadej z krzywych, tak aby zachowana bya ich monotoniczno. Liczba bakterii nie powinna male w czasie. Dostosuj parametry automatycznego wykluczania i ponownie uruchom krok, jeeli wykluczenia nie s satysfakcjonujce. Program prbuje pozby si szumu z pocztku pomiarw, kiedy za zmienno danych odpowiadaj w wikszym stopniu czynniki techniczne ni biologiczne. Prbuje te pozby si niespodziewanych spadkw OD600 podczas wzrostu hodowli do wskazanego pomiaru (wahania OD w pniejszych fazach wzrostu s znacznie czstrze, a wykluczanie tych danych nie wpywa na kolejne etapy analizy). Wyklucza mona te rcznie, klikajc punkty na wykresie. Wykluczy ca prb lub replikat mona w panelu 'Prby i replikaty'.":"The system has attempted to exclude data at the beginning of each curve to maintain monotonicity. Bacterial counts should not decrease over time. Adjust the automatic exclusion parameters and re-run the step if the exclusions are unsatisfactory. The system tries to eliminate noise from the start of measurements, where variability is more due to technical than biological factors. It also attempts to remove unexpected drops in OD600 during culture growth up to the specified measurement (OD fluctuations in later growth phases are more frequent, and excluding these data does not affect subsequent analysis steps). You can also exclude points manually by clicking on them in the chart. To exclude an entire sample or replicate, use the 'Samples and Replicates' panel."}),c.jsxs("div",{className:"control-grid",children:[c.jsx(Tc,{label:f?"Wielko poziomu bazowego (n)":"Baseline length (n)",value:e,min:1,max:50,onChange:v=>t(Math.max(1,Math.min(50,Math.floor(v)||1))),helpContent:p}),c.jsx(Tc,{label:f?"Tolerancja poziomu bazowego (OD600)":"Baseline tolerance (OD600)",value:r,min:0,step:1e-4,onChange:v=>n(Math.max(0,v||0)),helpContent:h}),c.jsx(Tc,{label:f?"Zakres sprawdzania monotonicznoci (min)":"Monotonicity check window (min)",value:a,min:0,onChange:v=>s(Math.max(0,Number.isFinite(v)?v:0)),helpContent:m}),c.jsx(Tc,{label:f?"Tolerancja sprawdzania monotonicznoci (OD600)":"Monotonicity tolerance (OD600)",value:i,min:0,step:1e-4,onChange:v=>l(Math.max(0,v||0)),helpContent:x})]}),c.jsxs("div",{className:"control-actions",children:[c.jsx("button",{type:"button",className:"btn basic-btn",onClick:o,children:f?"Przelicz wykluczanie":"Re-run exclusion"}),c.jsx("button",{type:"button",className:"btn basic-btn",onClick:u,children:f?"Eksportuj curated data":"Export curated data"})]})]})}function v3({fontScale:e,setFontScale:t,title:r,setTitle:n,xLabel:a,setXLabel:s,yLabel:i,setYLabel:l,pointsSeries:o,chartRef:u,highlightedNames:f,orderedSamples:d,sampleReplicates:p,selectedKeys:h,onToggleKey:m,onToggleSample:x,highlighted:v,setHighlighted:y,sampleColors:w,varyReplicateColor:g,allKeys:E,onToggleAll:A,replicateExclusionState:z,sampleExclusionState:b,onSetReplicateExcluded:S,onSetSampleExcluded:_,replicateSelectionContainerComponent:T,lowestPointCount:D,onLowestPointCountChange:M,outlierThreshold:G,onOutlierThresholdChange:Y,outlierWindowMinutes:J,onOutlierWindowMinutesChange:Q,outlierWindowPercent:X,onOutlierWindowPercentChange:ee,onRerunAutoExclusion:F,selectedPointIds:le,onChartPointToggle:re,onChartSelection:j,minPanX:R,minPanY:B,resetViewKey:V,onResetView:te,onExportCurated:ke,onSendToBlankCorrection:_e}){const ge=T,Ee=Ze(je=>je.language)==="pl",[C,we]=k.useState(!1),[he,Ce]=k.useState(!0),[Ae,be]=k.useState(!1),[qe,Ie]=k.useState([]),[ht,yt]=k.useState(1),[Pt,Fe]=k.useState(Ee?"Legenda":"Legend"),vt=k.useRef(null),[jt,ft]=k.useState(!1),[kt,Se]=k.useState(!1),ot=k.useMemo(()=>o.map(je=>`${je.name}:${je.color}`).join("|"),[o]);k.useEffect(()=>{Ie(je=>{const Be=new Map(je.map(Tt=>[Tt.id,Tt])),Ve=[];o.forEach(Tt=>{const at=Be.get(Tt.name);Ve.push({id:Tt.name,label:(at==null?void 0:at.label)??Tt.name,color:Tt.color,hidden:(at==null?void 0:at.hidden)??!1,kind:"series"})});const Kt="__excluded__",St=Be.get(Kt),yr=(St==null?void 0:St.label)??(Ee?"Wykluczone z analizy":"Excluded from analysis");return Ve.push({id:Kt,label:yr,color:(St==null?void 0:St.color)??"#9ca3af",hidden:(St==null?void 0:St.hidden)??!1,kind:"excluded"}),Ve})},[ot,Ee]),k.useEffect(()=>{Fe(je=>je&&je!=="Legenda"&&je!=="Legend"?je:Ee?"Legenda":"Legend")},[Ee]),k.useEffect(()=>{if(!C)return;const je=Be=>{Be.key==="Escape"?(Be.preventDefault(),we(!1)):(Be.key==="r"||Be.key==="R")&&(Be.preventDefault(),te())};return window.addEventListener("keydown",je),()=>window.removeEventListener("keydown",je)},[C,te]),k.useEffect(()=>{const je=Be=>{const Ve=Be.target;Ve&&(Ve.tagName==="INPUT"||Ve.tagName==="TEXTAREA"||Ve.tagName==="SELECT"||Ve.isContentEditable)||(Be.key==="r"||Be.key==="R")&&(Be.preventDefault(),te())};return window.addEventListener("keydown",je,{capture:!0}),()=>window.removeEventListener("keydown",je,{capture:!0})},[te]);const Xe=k.useCallback((je,Be)=>{Ie(Ve=>Ve.map(Kt=>Kt.id===je?{...Kt,label:Be}:Kt))},[]),Rt=k.useCallback(je=>{Ie(Be=>Be.map(Ve=>Ve.id===je?{...Ve,hidden:!Ve.hidden}:Ve))},[]),q=k.useCallback(()=>{const je=u.current;return je?je.querySelector("svg"):null},[u]),oe=k.useCallback(je=>(je||"raw-data-plot").replace(/[^a-z0-9_-]+/gi,"-")||"raw-data-plot",[]),pe=k.useCallback(async()=>{var er;const je=q();if(!je)return null;const Ve=new XMLSerializer().serializeToString(je),Kt=new Blob([Ve],{type:"image/svg+xml;charset=utf-8"}),St=URL.createObjectURL(Kt),yr=je.getBoundingClientRect(),Tt=(er=je.viewBox)==null?void 0:er.baseVal,at=Math.max(1,Math.round((Tt==null?void 0:Tt.width)||yr.width||1200)),rr=Math.max(1,Math.round((Tt==null?void 0:Tt.height)||yr.height||600));return await new Promise((hr,pr)=>{const Ht=new Image;Ht.onload=()=>{try{const Ot=document.createElement("canvas");Ot.width=at,Ot.height=rr;const N=Ot.getContext("2d");if(!N){pr(new Error("Canvas context unavailable"));return}N.drawImage(Ht,0,0,at,rr),Ot.toBlob(P=>{P?hr(P):pr(new Error("PNG generation failed"))},"image/png")}finally{URL.revokeObjectURL(St)}},Ht.onerror=()=>{URL.revokeObjectURL(St),pr(new Error("SVG render error"))},Ht.src=St})},[q]),He=k.useCallback(async()=>{const je=await pe();if(!je)return;const Be=oe(r||"raw-data-plot"),Ve=URL.createObjectURL(je),Kt=document.createElement("a");Kt.href=Ve,Kt.download=`${Be}.png`,Kt.click(),URL.revokeObjectURL(Ve)},[pe,oe,r]),st=k.useCallback(async()=>{const je=await pe();if(!je)return;if(typeof ClipboardItem<"u"&&navigator.clipboard&&"write"in navigator.clipboard)try{await navigator.clipboard.write([new ClipboardItem({"image/png":je})]);return}catch{}const Be=URL.createObjectURL(je),Ve=document.createElement("a");Ve.href=Be,Ve.download=`${oe(r||"raw-data-plot")}.png`,Ve.click(),URL.revokeObjectURL(Be)},[pe,oe,r]),_t=Ae?c.jsxs("div",{className:"legend-editor panel-soft",children:[c.jsxs("div",{className:"legend-editor__header",children:[c.jsxs("div",{children:[c.jsx("div",{className:"legend-editor__title",children:Pt||(Ee?"Legenda":"Legend")}),c.jsx("div",{className:"legend-editor__subtitle",children:Ee?"Ukryj lub zmien nazwy elementow legendy. Zmiany nie wykluczaja serii z wykresu.":"Hide or rename legend entries. Changes do not remove series from the chart."}),c.jsxs("label",{className:"field legend-editor__title-field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:Ee?"Tytul legendy":"Legend title"})}),c.jsx("input",{className:"field-input",value:Pt,onChange:je=>Fe(je.target.value),placeholder:Ee?"Legenda":"Legend"})]})]}),c.jsxs("div",{className:"legend-editor__font",children:[c.jsx("span",{children:Ee?"Rozmiar legendy":"Legend text"}),c.jsxs("div",{className:"btn-pair",children:[c.jsx("button",{type:"button",className:"btn",onClick:()=>yt(je=>Math.max(.6,+(je-.1).toFixed(1))),children:"A-"}),c.jsx("button",{type:"button",className:"btn",onClick:()=>yt(je=>Math.min(2,+(je+.1).toFixed(1))),children:"A+"})]})]})]}),c.jsx("div",{className:"legend-editor__list",children:qe.map(je=>c.jsxs("div",{className:"legend-editor__row",children:[c.jsxs("label",{className:"legend-editor__checkbox",children:[c.jsx("input",{type:"checkbox",checked:!je.hidden,onChange:()=>Rt(je.id)}),c.jsx("span",{children:Ee?"Pokaz":"Show"})]}),c.jsx("div",{className:`legend-editor__swatch ${je.kind==="excluded"?"legend-editor__swatch--excluded":""}`.trim(),style:je.kind==="excluded"?void 0:{"--legend-swatch-color":je.color},children:je.kind==="excluded"&&c.jsxs("svg",{viewBox:"0 0 24 24",width:"18",height:"18","aria-hidden":!0,focusable:"false",children:[c.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"#ffffff",stroke:"#111111",strokeWidth:"2"}),c.jsx("circle",{cx:"12",cy:"12",r:"11",fill:"none",stroke:"#9ca3af",strokeWidth:"2",opacity:"0.8"}),c.jsx("line",{x1:"7",y1:"7",x2:"17",y2:"17",stroke:"#111111",strokeWidth:"2"}),c.jsx("line",{x1:"17",y1:"7",x2:"7",y2:"17",stroke:"#111111",strokeWidth:"2"})]})}),c.jsx("input",{className:"legend-editor__input",value:je.label,onChange:Be=>Xe(je.id,Be.target.value)})]},je.id))})]}):null,Lt=k.useCallback(()=>c.jsx(x3,{fontScale:e,setFontScale:t,title:r,setTitle:n,xLabel:a,setXLabel:s,yLabel:i,setYLabel:l,onResetView:te,onExportPng:He,onCopyPng:st,onToggleLegend:()=>be(je=>!je),legendOpen:Ae,legendPanel:_t,isPl:Ee}),[e,t,r,n,a,s,i,l,te,He,st,Ee,Ae,_t,be]),xr=Ee?"Kliklnij R lub przycisk 'Reset widoku' aby przywrci domylny widok. Moesz przesuwa wykres lub go powiksza/zmniejsza za pomoc touchpada lub scrolla na myszy. Przytrzymanie i przecignicie mysz na osiach liczbowych zmieni 'rozdzielczo' wykresu. Przytrzymujc shift i przecigajc mysz po wykresie zaznaczysz/odznaczysz wiele punktw na raz.":"Click R or the 'Reset view' button to restore the default view. You can pan the chart or zoom in/out using a trackpad or mouse scroll. Holding and dragging on the numeric axes will change the chart's 'resolution'. Holding shift and dragging on the chart will select/deselect multiple points at once.",Qe=C&&(he||kt),rt=Qe?"chart-card--with-controls":"";return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"raw-data-layout",children:[c.jsx(g3,{lowestPointCount:D,onLowestPointCountChange:M,outlierThreshold:G,onOutlierThresholdChange:Y,outlierWindowMinutes:J,onOutlierWindowMinutesChange:Q,outlierWindowPercent:X,onOutlierWindowPercentChange:ee,onRerunAutoExclusion:F,onExportCurated:ke,isPl:Ee}),!C&&Lt(),C&&(he||kt)&&c.jsx("div",{className:"plot-controls-float",children:c.jsxs("div",{className:"plot-controls-float__body",children:[he&&Lt(),kt&&c.jsx("div",{className:"plot-controls-float__replicates",children:c.jsx(ge,{orderedSamples:d,sampleReplicates:p,selectedKeys:h,onToggleKey:m,onToggleSample:x,highlighted:v,setHighlighted:y,sampleColors:w,varyReplicateColor:g,allKeys:E,onToggleAll:A,replicateExclusionState:z,sampleExclusionState:b,onSetReplicateExcluded:S,onSetSampleExcluded:_})})]})}),c.jsxs("div",{className:`raw-data-chart-grid ${Qe?"raw-data-chart-grid--with-overlay":""}`.trim(),children:[!C&&c.jsx(ge,{orderedSamples:d,sampleReplicates:p,selectedKeys:h,onToggleKey:m,onToggleSample:x,highlighted:v,setHighlighted:y,sampleColors:w,varyReplicateColor:g,allKeys:E,onToggleAll:A,replicateExclusionState:z,sampleExclusionState:b,onSetReplicateExcluded:S,onSetSampleExcluded:_}),c.jsx(Qf,{heading:Ee?"Wykres surowych danych":"Raw data plot",helpContent:xr,series:o,chartTitle:r,xLabel:a,yLabel:i,fontScale:e,chartRef:u,highlightedNames:f,selectedPointIds:le,resetViewKey:V,minPanX:R,minPanY:B,height:C?620:380,fullscreen:C,className:rt,legendEntries:qe,showLegend:Ae,legendTitle:Pt||(Ee?"Legenda":"Legend"),legendScale:ht,actions:c.jsxs("div",{className:"btn-pair btn-pair--wrap",children:[C&&c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",className:"btn basic-btn",onClick:()=>Ce(je=>!je),"aria-pressed":he,children:he?Ee?"Ukryj Plot Controls":"Hide Plot Controls":Ee?"Poka Plot Controls":"Show Plot Controls"}),c.jsx("button",{type:"button",className:"btn basic-btn",onClick:()=>Se(je=>!je),"aria-pressed":kt,children:kt?Ee?"Ukryj Panel Prb i Replikatw":"Hide Samples & Replicates":Ee?"Poka Panel Prb i Replikatw":"Show Samples & Replicates"})]}),c.jsx("button",{type:"button",className:`btn ${C?"primary":""}`,onClick:()=>we(je=>!je),"aria-pressed":C,children:C?Ee?"Zamknij pelny ekran":"Exit fullscreen":Ee?"Peny ekran":"Fullscreen"})]}),onPointToggle:re,onPointSelection:j})]})]}),c.jsx("div",{className:"panel panel-soft raw-data-blank-cta",children:c.jsxs("div",{className:"raw-data-blank-cta__inner",children:[c.jsxs("div",{className:"btn-pair btn-pair--wide",children:[c.jsx("button",{type:"button",className:"btn primary",onClick:_e,children:Ee?"Wylij do wyznaczenia blank":"Send to blank correction"}),c.jsx("button",{type:"button",className:"help-btn circle",ref:vt,onClick:()=>ft(je=>!je),"aria-label":Ee?"Pomoc: Blank Correction":"Help: Blank Correction",children:"?"})]}),c.jsx(Qr,{anchorRef:vt,open:jt,children:Ee?"Wysya dane wraz z adnotacjami o ich wykluczeniu z analizy do kolejnego etapu - wyznaczania blank. W panelu na samej grze tej strony moesz wyekportowa (pobra) dane wraz z tymi adnotacjami aby mc skontrolowa dziaanie programu.":"Sends the data along with annotations about their exclusion from analysis to the next step - blank determination. In the panel at the very top of this page, you can export (download) the data along with these annotations to review the system's performance."})]})})]})}const y3=[{id:"default",label:"Domyslny kontener wykresw zbiorczych (containers/combined/CombinedPlotsContainerDefault.tsx)",filePath:"src/modules/plots_viewer/containers/combined/CombinedPlotsContainerDefault.tsx",Component:v3}];function w3({orderedSamples:e,sampleReplicates:t,selectedKeys:r,onToggleKey:n,onToggleSample:a,highlighted:s,setHighlighted:i,sampleColors:l,varyReplicateColor:o,allKeys:u,onToggleAll:f,replicateExclusionState:d,sampleExclusionState:p,onSetReplicateExcluded:h,onSetSampleExcluded:m}){const x=Ze(R=>R.language),v=Ze(R=>R.activeTab),y=x==="pl",w=k.useRef(null),[g,E]=k.useState(!1),[A,z]=k.useState(null),b=k.useRef(!1),S=k.useRef(""),_=k.useRef({}),T=k.useMemo(()=>{const R=[];return e.forEach(B=>{(t[B]??[]).forEach(te=>{R.push(`${B}|${te.replicate}`)})}),R},[e,t]),D=k.useMemo(()=>T.join("|"),[T]),M=k.useMemo(()=>r.slice().sort().join("|"),[r]),G=k.useCallback(R=>{if(z(R),!R)return;const[B,V]=R.split("|"),te=Number(V);B&&Number.isFinite(te)&&i([`${B} R${te}`])},[i]);k.useEffect(()=>{S.current!==D&&(S.current=D,b.current=!1,G(T[0]??null))},[T,D,G]),k.useEffect(()=>{T.length&&(A||G(T[0]),!b.current&&r.length===0&&(n(T[0]),G(T[0]),b.current=!0))},[A,n,T,r,G]),k.useEffect(()=>{if(A&&T.includes(A)||!T.length)return;const R=r.find(B=>T.includes(B))??T[0];G(R)},[A,T,M,G]),k.useEffect(()=>{r.length>0&&(b.current=!0)},[r.length]),k.useEffect(()=>{v!=="plots"&&E(!1)},[v]);const Y=k.useCallback(R=>(t[R]??[]).map(B=>`${R}|${B.replicate}`),[t]),J=k.useCallback(R=>{const B=new Set(r);B.forEach(V=>{R.has(V)||n(V)}),R.forEach(V=>{B.has(V)||n(V)})},[n,r]),Q=k.useCallback((R,B)=>{if(!T.length)return null;const V=T.indexOf(R),ke=((V===-1?B===1?-1:0:V)+B+T.length)%T.length;return T[ke]??null},[T]),X=k.useCallback((R,B)=>{var te;if(!e.length)return null;const V=Math.max(0,e.indexOf(R));for(let ke=1;ke<=e.length;ke+=1){const _e=(V+B*ke+e.length)%e.length,ge=e[_e];if((((te=t[ge])==null?void 0:te.length)??0)>0)return ge}return null},[e,t]),ee=k.useCallback((R,B)=>{if(!T.length)return;const V=r.find(ge=>T.includes(ge))??T[0],te=(A&&T.includes(A)?A:V)??null;if(!te)return;const ke=new Set;if(r.length===0&&!B){ke.add(te),J(ke),G(te);return}if(B){const ge=te.split("|")[0],ye=X(ge,R)??ge,Ee=Y(ye);if(!Ee.length)return;ke.add(Ee[0]),J(ke),G(Ee[0]);return}const _e=Q(te,R);_e&&(ke.add(_e),J(ke),G(_e))},[A,J,Q,X,Y,n,T,e,r,G]);k.useEffect(()=>{const R=B=>{const V=B.target;V&&(V.tagName==="INPUT"||V.tagName==="TEXTAREA"||V.tagName==="SELECT"||V.isContentEditable)||B.key!=="ArrowDown"&&B.key!=="ArrowUp"||(B.preventDefault(),ee(B.key==="ArrowDown"?1:-1,B.shiftKey))};if(v==="plots")return window.addEventListener("keydown",R,{capture:!0}),()=>window.removeEventListener("keydown",R,{capture:!0})},[v,ee]),k.useEffect(()=>{const R=A?A.split("|")[0]:null;if(!R)return;const B=_.current[R];B&&B.scrollIntoView&&B.scrollIntoView({block:"nearest"})},[A]);const F=k.useCallback(R=>{R.key!=="ArrowDown"&&R.key!=="ArrowUp"||(R.preventDefault(),ee(R.key==="ArrowDown"?1:-1,R.shiftKey))},[ee]),le=k.useCallback(()=>{r.length&&(r.forEach(R=>n(R)),G(null),i([]))},[n,r,G,i]),re=y?"Kliknij przycisk wykresu aby uwidoczni krzyw danego replikatu na wyrkresie. Uyj strzaek gra/d na klawiaturze aby zrobi pokaza kolejny replikat. Kliknij przycisk analizy aby wykluczy/anulowa wykluczenie caego replikatu. Klikaj w punkty na wykresie aby wykluczy/anulowa ich wykluczenie z dalszej analizy.":"Click the plot button to show a replicate's curve on the plot. Use the up/down arrow keys to navigate through replicates. Click the analysis button to exclude/include entire replicates from analysis. Click points on the plot to exclude/include them from further analysis.",j=k.useMemo(()=>{const R=[];for(const B of e){const V=t[B]??[];if(!V.length)continue;const te=l[B]??"#60a5fa",ke=p[B]??"none",_e=ke==="all",ge=V.map(he=>`${B}|${he.replicate}`),ye=ge.filter(he=>r.includes(he)).length,Ee=ye===ge.length&&ge.length>0,C=ye>0&&ye<ge.length,we=ke==="partial";R.push(c.jsxs("div",{className:`replicate-card ${_e?"is-excluded":""}`,onClick:()=>{a(B),G(ge[0])},ref:he=>{he&&(_.current[B]=he)},children:[c.jsxs("div",{className:"replicate-card__top",onClick:he=>{he.stopPropagation(),a(B),G(ge[0])},children:[c.jsxs("div",{className:"replicate-card__identity",children:[c.jsx("span",{className:"replicate-card__dot",style:{background:te}}),c.jsxs("div",{children:[c.jsx("div",{className:"replicate-card__name",children:B}),c.jsx("div",{className:"replicate-card__meta",children:y?`${V.length} replikat${V.length===1?"":"y"}  ${ye} na wykresie`:`${V.length} replicate${V.length===1?"":"s"}  ${ye} on chart`})]})]}),c.jsxs("div",{className:"replicate-card__toggles",children:[c.jsxs("button",{type:"button",className:`state-pill state-pill--plot ${Ee?"is-on":""} ${C?"is-partial":""}`,title:Ee?y?"Ukryj replikaty tej prby":"Hide all replicates in this sample":y?"Poka replikaty tej prby":"Show all replicates in this sample",onClick:he=>{he.stopPropagation(),a(B),G(ge[0])},"aria-pressed":Ee,children:[" ",Ee?"":C?"~":""]}),c.jsxs("button",{type:"button",className:`state-pill state-pill--analysis ${_e?"":"is-on"} ${we?"is-partial":""}`,title:_e?y?"Przywr prb do analizy":"Include sample in analysis":y?"Wycz prb z analizy":"Exclude sample from analysis",onClick:he=>{he.stopPropagation(),m(B,!_e),G(ge[0])},"aria-pressed":!_e,children:[" ",_e?"":""]})]})]}),c.jsx("div",{className:"replicate-card__list",onKeyDown:F,children:V.map(he=>{const Ce=`${B}|${he.replicate}`,Ae=r.includes(Ce),be=(d[Ce]??"none")==="all",qe=s.includes(`${B} R${he.replicate}`);return`${he.replicate}${he.well.toUpperCase()}`,c.jsxs("div",{className:`replicate-row ${A===Ce?"is-focused":""} ${be?"is-excluded":""} ${qe?"is-highlighted":""}`,onClick:Ie=>{Ie.stopPropagation(),n(Ce),G(Ce)},tabIndex:0,onKeyDown:Ie=>{Ie.key==="Enter"||Ie.key===" "?(Ie.preventDefault(),n(Ce),G(Ce)):F(Ie)},children:[c.jsxs("div",{className:"replicate-row__label",onMouseEnter:()=>i([`${B} R${he.replicate}`]),onFocus:()=>i([`${B} R${he.replicate}`]),onMouseLeave:()=>i([]),onBlur:()=>i([]),children:[c.jsxs("span",{className:"replicate-row__badge",style:{color:o(te,he.replicate),borderColor:o(te,he.replicate)},children:["R",he.replicate]}),c.jsx("span",{className:"replicate-row__name",children:he.well.toUpperCase()})]}),c.jsx("button",{type:"button",className:`state-pill state-pill--plot ${Ae?"is-on":""}`,onClick:Ie=>{Ie.stopPropagation(),n(Ce),G(Ce)},"aria-pressed":Ae,title:Ae?y?"Ukryj krzyw na wykresie":"Hide curve on chart":y?"Poka krzyw na wykresie":"Show curve on chart",children:Ae?"":""}),c.jsx("button",{type:"button",className:`state-pill state-pill--analysis ${be?"":"is-on"}`,onClick:Ie=>{Ie.stopPropagation(),h(B,he.replicate,!be),G(Ce)},"aria-pressed":!be,title:be?y?"Przywr replikat do analizy":"Include replicate in analysis":y?"Wycz replikat z analizy":"Exclude replicate from analysis",children:be?"":""})]},Ce)})})]},B))}return R.length||R.push(c.jsx("div",{className:"small",children:y?"Brak replikatw do wywietlenia.":"No replicates assigned."},"empty")),R},[A,F,s,y,h,m,n,a,e,d,l,p,t,r,i,o]);return c.jsxs("div",{className:"replicate-panel",children:[c.jsx("button",{ref:w,type:"button",className:"help-btn circle replicate-panel__help-btn","aria-expanded":g,"aria-label":y?"Poka pomoc":"Toggle help",onClick:()=>E(R=>!R),onMouseEnter:()=>E(!0),onFocus:()=>E(!0),onMouseLeave:()=>E(!1),onBlur:()=>E(!1),children:"?"}),c.jsxs("div",{className:"replicate-panel__header",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"replicate-panel__title",children:y?"Prby i replikaty":"Samples and replicates"}),c.jsx("p",{className:"replicate-panel__description",children:y?"Wyklucz dane z dalszej analizy.":"Exclude data from further analysis."})]}),c.jsx("div",{className:"replicate-panel__actions",children:c.jsx("button",{className:"btn",onClick:le,disabled:!r.length,title:y?"Odznacz wszystkie":"Deselect all",children:y?"Odznacz wszystkie":"Deselect all"})})]}),c.jsx(Qr,{anchorRef:w,open:g,children:re}),c.jsxs("div",{className:"replicate-panel__legend",children:[c.jsx("span",{className:"replicate-panel__legend-label",children:y?"Prba":"Sample"}),c.jsxs("div",{className:"replicate-panel__legend-pills",children:[c.jsx("span",{children:y?"Wykres":"Plot"}),c.jsx("span",{children:y?"Analiza":"Analysis"})]})]}),c.jsx("div",{className:"replicate-panel__list",onKeyDown:F,children:j})]})}const k3=[{id:"default",label:"Panel wyboru replik domyslny (containers/replicate_selection/ReplicateSelectionContainerDefault.tsx)",filePath:"src/modules/plots_viewer/containers/replicate_selection/ReplicateSelectionContainerDefault.tsx",Component:w3}];function Zf(e){const t=e.cloneNode(!1),r=window.getComputedStyle(e),n=Array.from(r).map(a=>`${a}:${r.getPropertyValue(a)};`).join("");return n&&t.setAttribute("style",n),e instanceof SVGElement&&!t.getAttribute("xmlns")&&t.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.childNodes.forEach(a=>{a.nodeType===Node.ELEMENT_NODE?t.appendChild(Zf(a)):a.nodeType===Node.TEXT_NODE&&t.appendChild(a.cloneNode(!0))}),t}async function Ly(e,t){var h;if(typeof window>"u")return null;const r=(h=e.getBoundingClientRect)==null?void 0:h.call(e),n=Math.max(1,Math.round((r==null?void 0:r.width)||0)),a=Math.max(1,Math.round((r==null?void 0:r.height)||0));if(!n||!a)return null;const s=(t==null?void 0:t.scale)??Math.min(3,Math.max(1.5,window.devicePixelRatio||2));if(e instanceof SVGSVGElement){const m=Zf(e);m.setAttribute("xmlns","http://www.w3.org/2000/svg"),m.setAttribute("width",`${n*s}`),m.setAttribute("height",`${a*s}`),m.getAttribute("viewBox")||m.setAttribute("viewBox",`0 0 ${n} ${a}`);const v=new XMLSerializer().serializeToString(m),y=new Blob([v],{type:"image/svg+xml;charset=utf-8"}),w=URL.createObjectURL(y);return await new Promise(g=>{const E=new Image;E.onload=()=>{try{const A=document.createElement("canvas");A.width=Math.max(1,Math.round(n*s)),A.height=Math.max(1,Math.round(a*s));const z=A.getContext("2d");if(!z){g(null);return}const b=(t==null?void 0:t.background)??"#ffffff";b!=="transparent"&&(z.fillStyle=b,z.fillRect(0,0,A.width,A.height)),z.drawImage(E,0,0,A.width,A.height),A.toBlob(S=>g(S),"image/png")}finally{URL.revokeObjectURL(w)}},E.onerror=()=>{URL.revokeObjectURL(w),g(null)},E.src=w})}const i=Zf(e),l=document.createElement("div");l.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),l.style.margin="0",l.style.padding="0",l.style.width=`${n}px`,l.style.height=`${a}px`,l.appendChild(i);const u=new XMLSerializer().serializeToString(l),f=`<svg xmlns="http://www.w3.org/2000/svg" width="${n*s}" height="${a*s}" viewBox="0 0 ${n} ${a}"><foreignObject width="100%" height="100%">${u}</foreignObject></svg>`,d=new Blob([f],{type:"image/svg+xml;charset=utf-8"}),p=URL.createObjectURL(d);return await new Promise(m=>{const x=new Image;x.crossOrigin="anonymous",x.decoding="async",x.onload=()=>{try{const v=document.createElement("canvas");v.width=Math.max(1,Math.round(n*s)),v.height=Math.max(1,Math.round(a*s));const y=v.getContext("2d");if(!y){m(null);return}const w=(t==null?void 0:t.background)??"#ffffff";w!=="transparent"&&(y.fillStyle=w,y.fillRect(0,0,v.width,v.height)),y.drawImage(x,0,0,v.width,v.height),v.toBlob(g=>m(g),"image/png")}finally{URL.revokeObjectURL(p)}},x.onerror=()=>{URL.revokeObjectURL(p),m(null)},x.src=p})}function vl(e,t){const r=document.createElement("a"),n=URL.createObjectURL(e);r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}function La(e){return e.replace(/[^a-zA-Z0-9._-]+/g,"_")}const Oy=45,Py=.001,lx=.001,_3=3,ox=400,S3=0;function yl(e,t){const r=Number(Number(t??0).toFixed(6));return`${e}|${r}`}function E3(e){if(!e.length)return 0;const t=e.slice().sort((n,a)=>n-a),r=Math.floor(t.length/2);return t.length%2===1?t[r]:(t[r-1]+t[r])/2}function b3(e,t){if(!e.length)return{baselineIndices:[],baselineLevel:null,preExcludedIndices:[],monotonicExcludedIndices:[]};const{minConsecutive:r,tolerance:n,monotonicTimeMax:a,monotonicTolerance:s}=t,i=e.map(Q=>Q.x),l=e.map(Q=>Q.value),o=i.map((Q,X)=>({time:Q,index:X})).filter(({time:Q})=>Q<=Oy).map(({index:Q})=>Q);if(o.length<r)return{baselineIndices:[],baselineLevel:null,preExcludedIndices:[],monotonicExcludedIndices:[]};const u=o.map(Q=>l[Q]),f=Math.min(...u),d=new Map;if(o.forEach(Q=>{const X=l[Q],ee=Math.floor((X-f)/Py);d.has(ee)||d.set(ee,[]),d.get(ee).push(Q)}),!d.size)return{baselineIndices:[],baselineLevel:null,preExcludedIndices:[],monotonicExcludedIndices:[]};let p=[];d.forEach(Q=>{Q.length>p.length&&(p=Q)});const h=p.map(Q=>l[Q]),m=E3(h),x=o.filter(Q=>Math.abs(l[Q]-m)<=n).sort((Q,X)=>Q-X);if(!x.length)return{baselineIndices:[],baselineLevel:m,preExcludedIndices:[],monotonicExcludedIndices:[]};const v=[];let y=[x[0]];for(let Q=1;Q<x.length;Q+=1){const X=x[Q];X===y[y.length-1]+1?y.push(X):(v.push(y),y=[X])}v.push(y);const w=v.filter(Q=>Q.length>=r),g=(w.length?w.reduce((Q,X)=>X.length>Q.length?X:Q):x).slice(),E=[];if(g.length){const Q=Math.min(...g);o.forEach(X=>{X<Q&&Math.abs(l[X]-m)>n&&E.push(X)})}if(!g.length)return{baselineIndices:g,baselineLevel:m,preExcludedIndices:E,monotonicExcludedIndices:[]};const A=new Set(E),z=a>0?a:Number.POSITIVE_INFINITY,b=Math.min(...g),S=[];for(let Q=b;Q<e.length;Q+=1)if(!A.has(Q)){if(i[Q]>z)break;S.push(Q)}if(S.length<=1)return{baselineIndices:g,baselineLevel:m,preExcludedIndices:E,monotonicExcludedIndices:[]};const _=S.map(Q=>l[Q]),T=new Array(_.length).fill(1),D=new Array(_.length).fill(-1);let M=0;for(let Q=0;Q<_.length;Q+=1){for(let X=0;X<Q;X+=1)_[X]<=_[Q]+s&&T[X]+1>T[Q]&&(T[Q]=T[X]+1,D[Q]=X);T[Q]>T[M]&&(M=Q)}let G=M;const Y=new Set;for(;G!=null&&G>=0;)Y.add(S[G]),G=D[G];const J=[];return S.forEach(Q=>{Y.has(Q)||J.push(Q)}),{baselineIndices:g,baselineLevel:m,preExcludedIndices:E,monotonicExcludedIndices:J}}function C3(e,t){if(t<=1)return e;const{h:r,s:n,l:a}=ri(e),s=(t-1)%4;return s===1?Ds(r,Math.min(100,n+5),Math.min(100,a+8)):s===2?Ds(r,Math.max(0,n-5),Math.max(0,a-8)):Ds((r+10)%360,n,a)}function T3(){const e=Ze(U=>U.datasets),t=Ze(U=>U.datasetMapping??{}),r=Ze(U=>U.mappings),n=Ze(U=>U.activeTab),a=Ze(U=>U.plotsSelectedRunId),s=Ze(U=>U.rawDataPointOverrides),i=Ze(U=>U.rawDataSettings),l=Ze(U=>U.autoRun),o=Ze(U=>U.setRawDataPointOverride),u=Ze(U=>U.setRawDataSettings),f=Ze(U=>U.resetRawDataPointOverrides);Ze(U=>U.setSampleColor);const d=Ze(U=>U.setDatasetMappings),p=Ze(U=>U.setActiveTab),h=Ze(U=>U.setPlotsSelectedRunId),m=Ze(U=>U.setBlankCorrectionAssignments),x=Ze(U=>U.setAutoRun),v=k.useMemo(()=>Object.values(e).sort((U,ae)=>(U.sourceFile||U.runId).localeCompare(ae.sourceFile||ae.runId,void 0,{numeric:!0})),[e]),[y,w]=k.useState("");k.useEffect(()=>{if(!y&&v.length){const U=v.find(ae=>!!t[ae.runId])??v[0];w(U.runId)}},[v.map(U=>U.runId).join(""),Object.entries(t).map(([U,ae])=>`${U}:${ae}`).join(""),y]),k.useEffect(()=>{a&&w(a)},[a]);const g=k.useMemo(()=>v.find(U=>U.runId===y)??null,[v,y]),E=k.useMemo(()=>{if(!g)return null;const U=t[g.runId];return U?r[U]??null:null},[g==null?void 0:g.runId,t,r]),z=Ze(U=>U.language)==="pl",b=k.useMemo(()=>{if(!E)return{};const U={};return Object.entries(E.assignments??{}).forEach(([ae,me])=>{const Te=zr(ae);Te&&(U[Te]=me??"")}),U},[E]),S=k.useMemo(()=>Object.entries(b).map(([U,ae])=>`${U}:${ae??""}`).sort().join("|"),[b]),_=k.useMemo(()=>E?{...E,assignments:b}:null,[E,S]),T=k.useMemo(()=>{const U={};if(!g)return U;const ae=Array.from(new Set(g.rows.map(ze=>zr(ze.well)).filter(ze=>!!ze))),me=Object.keys(b),Te=Array.from(new Set([...ae,...me])).filter(Boolean).sort((ze,ct)=>ze.localeCompare(ct,void 0,{numeric:!0})),wt=Object.values(b).some(ze=>!!(ze&&ze.trim()))?b:Object.fromEntries(Te.map(ze=>[ze,ze])),We={};return Te.forEach(ze=>{const ct=(wt[ze]??"").trim()||ze;We[ct]||(We[ct]=[]),We[ct].push(ze)}),Object.entries(We).forEach(([ze,ct])=>{ct.sort((ie,$e)=>ie.localeCompare($e,void 0,{numeric:!0})),U[ze]=ct.map((ie,$e)=>({well:ie,replicate:$e+1}))}),U},[g==null?void 0:g.runId,S]),D=k.useMemo(()=>Object.entries(T).map(([U,ae])=>`${U}:${ae.map(me=>`${me.well}:${me.replicate}`).join(",")}`).sort().join("|"),[T]),M=k.useMemo(()=>{const U={};return Object.entries(T).forEach(([ae,me])=>{me.forEach(({well:Te})=>{U[Te.toUpperCase()]=ae})}),U},[D]),G=k.useMemo(()=>{const U={};return Object.values(T).forEach(ae=>{ae.forEach(({well:me,replicate:Te})=>{U[me.toUpperCase()]=Te})}),U},[D]),Y=k.useMemo(()=>{const U=new Map,ae=new Map;if(!g)return{pointsByRep:U,pointById:ae,minX:null,maxX:null,minY:null,maxY:null};const me=g.rows.slice().sort((ze,ct)=>(ze.timeSeconds??0)-(ct.timeSeconds??0));let Te=null,Ye=null,wt=null,We=null;for(const ze of me){const ct=zr(ze.well);if(!ct)continue;const ie=ct.toUpperCase(),$e=M[ie]??ct;if(!$e)continue;const Ct=G[ie]??1,Mt=Number(ze.timeSeconds??0)||0,Vt=Number.isFinite(Mt)?Mt/60:0,Et=Number(ze.value??0),Bt=yl(ie,Mt),gr={id:Bt,sample:$e,replicate:Ct,well:ie,timeSeconds:Mt,value:Et,x:Vt},Gr=`${$e}|${Ct}`;U.has(Gr)||U.set(Gr,[]),U.get(Gr).push(gr),ae.set(Bt,gr),Number.isFinite(Vt)&&(Te=Te==null?Vt:Math.min(Te,Vt),Ye=Ye==null?Vt:Math.max(Ye,Vt)),Number.isFinite(Et)&&(wt=wt==null?Et:Math.min(wt,Et),We=We==null?Et:Math.max(We,Et))}return U.forEach(ze=>ze.sort((ct,ie)=>ct.x-ie.x)),{pointsByRep:U,pointById:ae,minX:Te,maxX:Ye,minY:wt,maxY:We}},[g==null?void 0:g.runId,M,G]),J=(g==null?void 0:g.runId)??"",Q=J?s[J]??{}:{},X=k.useMemo(()=>Object.entries(Q).map(([U,ae])=>`${U}:${ae}`).sort().join("|"),[Q]),ee=Math.max(1,(i==null?void 0:i.lowestPointCount)??_3),F=!0,le=i==null?void 0:i.outlierThreshold,re=Number.isFinite(le)?Math.max(0,Number(le)):lx,j=i==null?void 0:i.outlierWindowMinutes,R=j==null?ox:Math.max(0,j),B=(i==null?void 0:i.outlierWindowPercent)??S3,V=B>1?B/100:Math.max(0,B);k.useEffect(()=>{(i==null?void 0:i.outlierWindowPercent)!=null&&i.outlierWindowPercent>1&&u({outlierWindowPercent:i.outlierWindowPercent/100})},[i==null?void 0:i.outlierWindowPercent,u]);const{baselineSet:te,excludedSet:ke,reasonMap:_e,baselineKey:ge,excludedKey:ye,reasonKey:Ee}=k.useMemo(()=>{const U=new Set,ae=new Set,me=new Map,Te=(We,ze)=>{me.has(We)||me.set(We,[]),me.get(We).push(ze)};Y.pointsByRep.forEach(We=>{if(!We.length)return;const{baselineIndices:ze,preExcludedIndices:ct,monotonicExcludedIndices:ie}=b3(We,{minConsecutive:ee,tolerance:re||lx,monotonicTimeMax:R>0?R:ox,monotonicTolerance:V});ze.forEach($e=>U.add(We[$e].id)),ct.forEach($e=>{const Ct=We[$e].id;ae.add(Ct),Te(Ct,"pre_baseline_spike")}),ie.forEach($e=>{const Ct=We[$e].id;ae.add(Ct),Te(Ct,"non_monotonic_segment")})});const Ye=We=>Array.from(We).sort().join("|"),wt=Array.from(me.entries()).map(([We,ze])=>`${We}:${[...ze].sort().join(",")}`).sort().join("|");return{baselineSet:U,excludedSet:ae,reasonMap:me,baselineKey:Ye(U),excludedKey:Ye(ae),reasonKey:wt}},[Y,ee,re,R,V]),C=k.useMemo(()=>{const U=new Set;return Object.entries(Q).forEach(([ae,me])=>{me==="exclude"&&U.add(ae)}),U},[X]),we=k.useMemo(()=>{const U=new Set(ke);return C.forEach(ae=>U.add(ae)),Object.entries(Q).forEach(([ae,me])=>{me==="exclude"&&U.add(ae),me==="include"&&U.delete(ae)}),U},[ye,C,X]),he=k.useMemo(()=>{const U=new Map,ae=(me,Te)=>{U.has(me)||U.set(me,[]),U.get(me).push(Te)};return _e.forEach((me,Te)=>{U.set(Te,[...me])}),C.forEach(me=>ae(me,"manual_exclude")),Object.entries(Q).forEach(([me,Te])=>{Te==="include"&&ae(me,"manual_include")}),U},[Ee,C,X]),Ce=k.useMemo(()=>Array.from(we).sort().join("|"),[we]),Ae=k.useMemo(()=>Array.from(we),[Ce]),be=k.useMemo(()=>{const U={};return Y.pointsByRep.forEach((ae,me)=>{if(!ae.length){U[me]="none";return}let Te=0;ae.forEach(Ye=>{we.has(Ye.id)&&(Te+=1)}),Te===0?U[me]="none":Te===ae.length?U[me]="all":U[me]="partial"}),U},[Y,Ce]),qe=k.useMemo(()=>{const U=new Map;Y.pointsByRep.forEach((me,Te)=>{const[Ye]=Te.split("|");U.has(Ye)||U.set(Ye,{total:0,excluded:0});const wt=U.get(Ye);wt.total+=me.length,me.forEach(We=>{we.has(We.id)&&(wt.excluded+=1)})});const ae={};return Object.keys(T).forEach(me=>{const Te=U.get(me);!Te||Te.total===0||Te.excluded===0?ae[me]="none":Te.excluded>=Te.total?ae[me]="all":ae[me]="partial"}),ae},[Y,Ce,D]),Ie=k.useMemo(()=>{if(Y.minX==null||Y.maxX==null)return;const U=Math.max(1,Y.maxX-Y.minX);return Y.minX-U*.5},[Y.minX,Y.maxX]),ht=k.useMemo(()=>{if(Y.minY==null||Y.maxY==null)return;const U=Math.max(1,Y.maxY-Y.minY);return Y.minY-U*.5},[Y.minY,Y.maxY]),yt=k.useCallback((U,ae)=>{if(!J)return;const me=ke.has(U.id),Te=Q[U.id];if((Te?Te==="exclude":me)===ae)return;let wt=null;ae===me?wt=null:wt=ae?"exclude":"include",o(J,U.id,wt)},[J,ye,X,o]),Pt=k.useCallback(U=>{if(!J)return;const ae=ke.has(U.id),me=Q[U.id];yt(U,!(me?me==="exclude":ae))},[J,ye,X,Q,yt]),Fe=k.useCallback(U=>{U.forEach(ae=>yt(ae,!0))},[yt]),vt=k.useCallback((U,ae,me)=>{const Te=`${U}|${ae}`,Ye=Y.pointsByRep.get(Te);Ye!=null&&Ye.length&&(me?Ye.forEach(wt=>yt(wt,me)):Ye.forEach(wt=>o(J,wt.id,null)))},[J,Y,yt,o]),jt=k.useCallback((U,ae)=>{Y.pointsByRep.forEach((me,Te)=>{me.length&&Te.startsWith(`${U}|`)&&(ae?me.forEach(Ye=>yt(Ye,ae)):me.forEach(Ye=>o(J,Ye.id,null)))})},[J,Y,yt,o]),ft=k.useCallback(()=>{J&&f(J)},[J,f]),kt=k.useCallback(()=>{if(!g||!_)return;const U=X1(g,_);if(!U)return;const ae=new Date().toISOString(),me=U.dataset.rows.map(ze=>{const ct=Number((ze.time_min*60).toFixed(6)),ie=yl(ze.well,ct),$e=we.has(ie),Ct=he.get(ie)??[];return!$e&&!Ct.length?ze:{...ze,curation:{excluded:$e,reasons:Ct}}}),Te=[];we.forEach(ze=>{const ct=Y.pointById.get(ze);ct&&Te.push({id:ze,sample:ct.sample,replicate:ct.replicate,well:ct.well,timeSeconds:ct.timeSeconds,timeMinutes:+(ct.timeSeconds/60).toFixed(4),value:ct.value,reasons:he.get(ze)??[]})}),Te.sort((ze,ct)=>{const ie=String(ze.sample||"").localeCompare(String(ct.sample||""),void 0,{numeric:!0});if(ie!==0)return ie;const $e=String(ze.well||"").localeCompare(String(ct.well||""),void 0,{numeric:!0});return $e!==0?$e:Number(ze.timeSeconds??0)-Number(ct.timeSeconds??0)});const Ye={...U,dataset:{...U.dataset,rows:me,curatedAt:ae,curation:{generatedAt:ae,reviewer:"raw_data_check",settings:{baselineMinConsecutive:ee,baselineTolerance:re,baselinePreWindowMinutes:Oy,baselineBinWidth:Py,removePreBaselineSpikes:F,monotonicWindowMinutes:R,monotonicTolerance:V},excludedCount:Te.length,excludedPoints:Te}}},wt={version:5,createdAt:ae,curated:!0,assignments:[Ye]},We=La(`${g.sourceFile||g.runId||"dataset"}-curated-data.json`);return{payload:wt,filename:We}},[g==null?void 0:g.runId,g==null?void 0:g.sourceFile,_,Ce,Y.pointById,he,ee,F,re,R,V]),Se=k.useCallback(()=>{const U=kt();if(!U)return;const ae=JSON.stringify(U.payload,null,2);vl(new Blob([ae],{type:"application/json;charset=utf-8"}),U.filename),m(U.payload.assignments??null)},[kt,m]),ot=k.useCallback(()=>{const U=kt();U&&(m(U.payload.assignments??null),p("interactive"),typeof window<"u"&&typeof window.scrollTo=="function"&&requestAnimationFrame(()=>window.scrollTo({top:0,behavior:"auto"})))},[kt,m,p]);k.useEffect(()=>{if(!l||l.stage!=="toBlank")return;if(!l.runId){x({stage:"error",error:"Missing dataset for fast-track run."});return}if(y!==l.runId){w(l.runId),h(l.runId);return}if(!v.find(me=>me.runId===l.runId)){x({stage:"error",error:"Dataset not found for fast-track run."});return}const ae=l.mappingId;if(ae){if(t[l.runId]!==ae){r[ae]?d({[l.runId]:ae}):x({stage:"error",error:"Mapping not found for fast-track run."});return}if(!E||E.id!==ae)return}else if(!E){x({stage:"error",error:"Select a mapping before fast-track run."});return}ot(),x({stage:"blankQueued",error:null})},[l,v,t,ot,r,E,y,x,d,h]);const[Xe,Rt]=k.useState(""),[q,oe]=k.useState(""),[pe,He]=k.useState(""),[st,_t]=k.useState(1),[Lt,xr]=k.useState(0);k.useEffect(()=>{g&&(Rt(`${g.sourceFile} - Combined`),oe("Time (min)"),He(g.measurementType||"Value"))},[g==null?void 0:g.runId]),k.useEffect(()=>{xr(U=>U+1)},[g==null?void 0:g.runId,E==null?void 0:E.id]);const Qe=k.useMemo(()=>{const U=new Set,ae=[],me=(E==null?void 0:E.samples)??[];for(const Te of me)T[Te]&&!U.has(Te)&&(U.add(Te),ae.push(Te));for(const Te of Object.keys(T))U.has(Te)||(U.add(Te),ae.push(Te));return ae},[E==null?void 0:E.samples,T]),rt=k.useMemo(()=>Qe.join(""),[Qe]),je=k.useMemo(()=>{const U=new Map;return Qe.forEach((ae,me)=>U.set(ae,me)),U},[rt]),Be=k.useMemo(()=>Object.entries(T).flatMap(([U,ae])=>ae.map(({replicate:me})=>`${U}|${me}`)),[T]),Ve=k.useMemo(()=>Qe.flatMap(U=>(T[U]??[]).map(ae=>`${U}|${ae.replicate}`)),[rt,D]),Kt=k.useMemo(()=>Ve.join(""),[Ve]),St=k.useMemo(()=>{if(!Qe.length)return[];const U=Qe[0];return(T[U]??[]).map(({replicate:me})=>`${U}|${me}`)},[rt,D]),yr=k.useMemo(()=>{const U=[];return Y.pointsByRep.forEach((ae,me)=>{if(!ae.length)return;const[Te]=me.split("|");Te&&U.push(Te)}),Array.from(new Set(U)).sort((ae,me)=>ae.localeCompare(me,void 0,{numeric:!0})).join("|")},[Y]),Tt=k.useMemo(()=>{if(!yr)return[];const U=yr.split("|"),ae=Qe.find(Te=>U.includes(Te))??U[0]??null;return ae?(T[ae]??[]).map(({replicate:Te})=>`${ae}|${Te}`):[]},[yr,rt,D]),[at,rr]=k.useState([]),er=k.useMemo(()=>at.slice().sort().join("|"),[at]);k.useEffect(()=>{const U=Tt.length?Tt:St.length?St:Be,ae=U.length?[U[0]]:[];rr(ae)},[g==null?void 0:g.runId,E==null?void 0:E.id,Tt.join(""),St.join(""),Be.join("")]);const hr=k.useMemo(()=>{if(!g)return[];const U=[];return Array.from(Y.pointsByRep.keys()).sort((me,Te)=>{const[Ye,wt]=me.split("|"),[We,ze]=Te.split("|"),ct=je.get(Ye)??Number.MAX_SAFE_INTEGER,ie=je.get(We)??Number.MAX_SAFE_INTEGER;return ct!==ie?ct-ie:Number(wt)-Number(ze)}).forEach(me=>{var ct;if(!at.includes(me))return;const[Te,Ye]=me.split("|"),wt=Number(Ye)||1,We=((ct=E==null?void 0:E.sampleColors)==null?void 0:ct[Te])??"#60a5fa",ze=Y.pointsByRep.get(me)??[];ze.length&&U.push({name:`${Te} R${wt}`,color:We,points:ze.map(ie=>{const $e=we.has(ie.id),Ct=$e?"#000000":We,Mt=$e?1.8:1,Vt=$e?"#ffffff":We,Et=$e?.3:1;return{x:ie.x,y:ie.value,id:ie.id,meta:{id:ie.id,sample:ie.sample,replicate:ie.replicate,well:ie.well,timeSeconds:ie.timeSeconds,value:ie.value,excluded:$e,strokeColor:Ct,strokeWidth:Mt,fillColor:Vt,fillOpacity:Et}}})})}),U},[g==null?void 0:g.runId,Y,at.join(""),E==null?void 0:E.sampleColors,Ce,rt,je,ge]),pr=k.useMemo(()=>{const U=new Map;return Object.entries(T).forEach(([ae,me])=>{me.forEach(Te=>{U.set(`${ae} R${Te.replicate}`,`${ae}|${Te.replicate}`)})}),U},[D]),[Ht,Ot]=k.useState([]),N=k.useRef(null),P=k.useCallback(U=>(T[U]??[]).map(({replicate:ae})=>`${U}|${ae}`),[D]),O=k.useCallback((U,ae)=>{var Te;if(!Qe.length)return null;const me=Math.max(0,Qe.indexOf(U));for(let Ye=1;Ye<=Qe.length;Ye+=1){const wt=(me+ae*Ye+Qe.length)%Qe.length,We=Qe[wt];if((((Te=T[We])==null?void 0:Te.length)??0)>0)return We}return null},[rt,D]),I=k.useCallback((U,ae)=>{if(!Ve.length)return null;const me=Ve.indexOf(U),Ye=((me===-1?ae===1?-1:0:me)+ae+Ve.length)%Ve.length;return Ve[Ye]??null},[Kt]),W=k.useCallback((U,ae)=>{if(!Ve.length)return;let me=N.current;if((!me||!Ve.includes(me))&&(me=at.find(ct=>Ve.includes(ct))??Ve[0]),!me)return;if(at.length===0&&!ae){N.current=me,rr([me]);const[ct,ie]=me.split("|"),$e=Number(ie)||1;Ot([`${ct} R${$e}`]);return}const Te=[];if(ae){const ct=me.split("|")[0],ie=O(ct,U)??ct,$e=P(ie);if(!$e.length)return;Te.push($e[0])}else{const ct=I(me,U);if(!ct)return;Te.push(ct)}const Ye=Te[0];N.current=Ye,rr(Te);const[wt,We]=Ye.split("|"),ze=Number(We)||1;Ot([`${wt} R${ze}`])},[I,O,P,Kt,er]);k.useEffect(()=>{if(!Ve.length){N.current=null;return}const U=at.find(ae=>Ve.includes(ae))??Ve[0];N.current=U??null},[Kt,er]),k.useEffect(()=>{const U=ae=>{const me=ae.target;if(!(me&&(me.tagName==="INPUT"||me.tagName==="TEXTAREA"||me.tagName==="SELECT"||me.isContentEditable))&&n==="plots"){if(ae.key==="ArrowDown"||ae.key==="ArrowUp"){ae.preventDefault(),W(ae.key==="ArrowDown"?1:-1,ae.shiftKey);return}if(ae.key==="r"||ae.key==="R"){ae.preventDefault(),Z();return}}};return window.addEventListener("keydown",U,!0),()=>window.removeEventListener("keydown",U,!0)},[n,W]);const H=k.useCallback(U=>{rr(ae=>{let me;if(ae.includes(U))me=ae.filter(Te=>Te!==U);else{const Te=new Set([...ae,U]);me=Be.filter(Ye=>Te.has(Ye))}return Ot(Te=>Te.filter(Ye=>{const wt=pr.get(Ye);return!wt||me.includes(wt)})),me})},[Be,pr]),ce=k.useCallback(()=>{rr(U=>U.length===Be.length?(Ot([]),[]):(Ot([]),Be))},[Be]),ve=k.useCallback(U=>{const ae=T[U]??[];if(!ae.length)return;const me=ae.map(({replicate:Te})=>`${U}|${Te}`);rr(Te=>{const Ye=new Set(Te);me.some(ze=>!Ye.has(ze))?me.forEach(ze=>Ye.add(ze)):me.forEach(ze=>Ye.delete(ze));const We=Be.filter(ze=>Ye.has(ze));return Ot(ze=>ze.filter(ct=>{const ie=pr.get(ct);return!ie||We.includes(ie)})),We})},[D,Be,pr]),Z=k.useCallback(()=>{xr(U=>U+1)},[]);k.useEffect(()=>{Ot(U=>U.filter(ae=>{const me=pr.get(ae);return!me||at.includes(me)}))},[at,pr]),k.useEffect(()=>{Ot([])},[g==null?void 0:g.runId,E==null?void 0:E.id]);const fe=(E==null?void 0:E.sampleColors)??{},de=k.useRef(null),Re=y3[0],Ge=k3[0],Je=Re.Component,Ue=Ge.Component;return c.jsxs("div",{className:"raw-data-page",children:[c.jsx("div",{className:"panel panel-landing raw-data-info",children:c.jsx("div",{className:"panel-heading panel-heading--centered",children:c.jsxs("div",{children:[c.jsx("div",{className:"eyebrow",children:z?"Dane surowe":"Raw Data"}),c.jsx("h2",{className:"info-card__title",children:z?"Kontrola Danych":"Data Control Module"}),c.jsx("p",{className:"small info-card__description",children:z?"Sprawd czy w prbie bez bakterii nie doszo do wzrostu. Porwnaj wszystkie replikaty danej prby. Wyklucz z analizy 'outliery'-dane ktre znacznie odstaj od reszty i nie odzwierciedlaj wzrostu bakterii. Jest to wane zwaszcza na pocztku krzywej - w kolejnych krokach bdzie ustalany blank oraz faza logarytmiczna. Moesz wykluczy z dalszej analizy cae replikaty lub pojedyncz punkty. Niektre punkty ju zostay wykluczone automatycznie zgodnie z parametrami poniej.":"Check that there is no growth in the control sample. Compare all replicates of a given sample. Exclude 'outliers' - data points that significantly deviate from the rest and do not reflect bacterial growth. This is especially important at the beginning of the curve - in subsequent steps, the blank and logarithmic phase will be determined. You can exclude entire replicates or individual points from further analysis. Some points have already been automatically excluded according to the parameters below."})]})})}),!g||!E?c.jsx("div",{className:"panel panel-soft raw-data-empty",children:z?"Brak aktywnego zestawu danych lub mapowania. Wroc do Setup i pobierz assignment.":"No active dataset or mapping. Return to Setup and download an assignment first."}):c.jsx(Je,{fontScale:st,setFontScale:_t,title:Xe,setTitle:Rt,xLabel:q,setXLabel:oe,yLabel:pe,setYLabel:He,pointsSeries:hr,chartRef:de,highlightedNames:Ht,orderedSamples:Qe,sampleReplicates:T,selectedKeys:at,onToggleKey:H,onToggleSample:ve,highlighted:Ht,setHighlighted:Ot,sampleColors:fe,varyReplicateColor:C3,allKeys:Be,onToggleAll:ce,replicateExclusionState:be,sampleExclusionState:qe,onSetReplicateExcluded:vt,onSetSampleExcluded:jt,replicateSelectionContainerComponent:Ue,lowestPointCount:ee,onLowestPointCountChange:U=>u({lowestPointCount:U}),outlierThreshold:re,onOutlierThresholdChange:U=>u({outlierThreshold:U}),outlierWindowMinutes:R,onOutlierWindowMinutesChange:U=>u({outlierWindowMinutes:U}),outlierWindowPercent:V,onOutlierWindowPercentChange:U=>u({outlierWindowPercent:U}),onRerunAutoExclusion:ft,selectedPointIds:Ae,onChartPointToggle:Pt,onChartSelection:Fe,minPanX:Ie,minPanY:ht,resetViewKey:`${(g==null?void 0:g.runId)??""}|${(E==null?void 0:E.id)??""}|${Lt}`,onResetView:Z,onExportCurated:Se,onSendToBlankCorrection:ot})]})}const cx="#f59e0b",Oi="#2563eb";function Hc(e,t){if(t<=1)return e;const r=e.startsWith("#")?e.slice(1):e,n=parseInt(r,16),a=n>>16&255,s=n>>8&255,i=n&255,l=d=>Math.min(255,Math.max(0,d)),o=[[12,16,18],[-10,-6,-8],[14,10,6]],u=o[(t-2)%o.length];return`#${[l(a+u[0]),l(s+u[1]),l(i+u[2])].map(d=>d.toString(16).padStart(2,"0")).join("")}`}function Tn(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"&&e.trim()!==""){const t=Number(e);if(Number.isFinite(t))return t}return null}function Tu(e){const t=Tn(e==null?void 0:e.time_min)??Tn(e==null?void 0:e.timeMinutes)??Tn(e==null?void 0:e.time_minutes);if(t!=null)return t;const r=Tn(e==null?void 0:e.time_seconds)??Tn(e==null?void 0:e.timeSeconds)??null;return r!=null?r/60:0}function Dy(e){var n,a,s;if(!((a=(n=e==null?void 0:e.dataset)==null?void 0:n.rows)!=null&&a.length))return null;const t=(s=e.dataset.meta)==null?void 0:s.measurementType;if(typeof t=="string"&&t.trim().length){const i=`val_${t.trim().toLowerCase()}`;if(e.dataset.rows.some(o=>Tn(o==null?void 0:o[i])!=null))return i}const r=e.dataset.rows.find(i=>i&&Object.keys(i).some(l=>l.startsWith("val_")&&Tn(i[l])!=null));if(r){const i=Object.keys(r).find(l=>l.startsWith("val_")&&Tn(r[l])!=null)??null;if(i)return i}return e.dataset.rows.some(i=>Tn(i==null?void 0:i.value)!=null)?"value":null}function By(e,t){const r=new Map;e.forEach(a=>{const s=zr(a==null?void 0:a.well);if(!s)return;const i=Tn(a==null?void 0:a[t]);if(i==null)return;const l=Tu(a),o=Number((l*60).toFixed(6)),u=yl(s,o);r.has(s)||r.set(s,[]),r.get(s).push({time:l,value:i,id:u})});const n=new Map;return r.forEach((a,s)=>{a.sort((o,u)=>o.time-u.time);const i=a[0];if(!i)return;const l=new Set;l.add(i.id);for(let o=1;o<a.length;o+=1){const u=a[o];if(Math.abs(u.value-i.value)<1e-9)l.add(u.id);else break}n.set(s,{value:i.value,ids:l})}),n}function Uy(e,t,r){const n=new Map;if(!e)return n;const a=new Map;return t.forEach(s=>{const i=zr(s==null?void 0:s.well),l=Tn(s==null?void 0:s[r]);if(!i||l==null)return;const o=Tu(s),u=Number((o*60).toFixed(6)),f=yl(i,u);a.set(f,{well:i,value:l})}),Object.entries(e).forEach(([s,i])=>{if(!(i!=null&&i.size))return;const l=[];if(i.forEach(u=>{const f=a.get(u);f&&f.well===s&&l.push(f.value)}),!l.length)return;const o=l.reduce((u,f)=>u+f,0)/l.length;n.set(s,{value:Number(o.toFixed(6)),ids:new Set(i)})}),n}function N3(e,t,r){var p,h;if(!((h=(p=e==null?void 0:e.dataset)==null?void 0:p.rows)!=null&&h.length))return{entry:e,missingWells:[]};const n=Dy(e);if(!n)return{entry:e,missingWells:[]};const a=e.dataset.rows.filter(m=>{var x;return!((x=m==null?void 0:m.curation)!=null&&x.excluded)}),s=By(a,n),i=Uy(r,a,n),l=new Map(s);i.forEach((m,x)=>l.set(x,{value:m.value,ids:new Set(m.ids)}));const o=`${n}_blank_corrected`,u=e.dataset.rows.map(m=>{const x=zr(m==null?void 0:m.well),v=Tn(m==null?void 0:m[n]);if(!x||v==null)return m;const y=l.get(x);if(!y)return m;const w=Number((v-y.value).toFixed(6));return{...m,[o]:w}}),d=Array.from(new Set(e.dataset.rows.map(m=>zr(m==null?void 0:m.well)).filter(m=>!!m))).filter(m=>!l.has(m));return{entry:{...e,dataset:{...e.dataset,rows:u,blankedAt:t,blankCorrection:{appliedAt:t,measurementKey:n,blankKey:o,blanks:Array.from(l.entries()).map(([m,x])=>({well:m,value:x.value}))}}},missingWells:d}}function Nc({title:e,chartTitle:t,setChartTitle:r,xLabel:n,setXLabel:a,yLabel:s,setYLabel:i,fontScale:l,setFontScale:o,onResetView:u,onExportPng:f,onCopyPng:d,onToggleLegend:p,legendOpen:h,legendPanel:m,isPl:x,disabled:v}){const y=x?"Steruj tytuem, osiami, rozmiarem czcionki i eksportem wykresu Blank Check. Reset przywraca domylny widok.":"Adjust chart title, axes, text size, and export controls for Blank Check chart. Reset restores the default view.";return c.jsxs(ia,{title:e||"Plot Controls",helpContent:y,className:"panel-soft control-panel",children:[c.jsxs("div",{className:"control-grid",children:[c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:x?"Tytu wykresu":"Chart title"})}),c.jsx("input",{className:"field-input",value:t,onChange:w=>r(w.target.value),disabled:v})]}),c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:x?"O X":"X axis"})}),c.jsx("input",{className:"field-input",value:n,onChange:w=>a(w.target.value),disabled:v})]}),c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:x?"O Y":"Y axis"})}),c.jsx("input",{className:"field-input",value:s,onChange:w=>i(w.target.value),disabled:v})]})]}),c.jsxs("div",{className:"control-row",children:[c.jsxs("div",{className:"btn-pair",children:[c.jsx("button",{className:"btn",onClick:()=>o(w=>Math.max(.6,+(w-.1).toFixed(1))),title:x?"Mniejsza czcionka":"Smaller text",disabled:v,children:"A-"}),c.jsx("button",{className:"btn",onClick:()=>o(w=>Math.min(2,+(w+.1).toFixed(1))),title:x?"Wiksza czcionka":"Larger text",disabled:v,children:"A+"})]}),c.jsxs("div",{className:"control-actions control-actions--tight",children:[c.jsx("button",{type:"button",className:"btn",onClick:f,disabled:v,children:x?"Eksportuj PNG":"Export PNG"}),c.jsx("button",{type:"button",className:"btn",onClick:d,disabled:v,children:x?"Kopiuj PNG":"Copy PNG"}),c.jsxs("label",{className:`parameters-toggle ${h?"is-on":""}`,title:h?x?"Ukryj legend":"Hide legend":x?"Poka legend":"Show legend",children:[c.jsx("input",{type:"checkbox",checked:h,onChange:p,disabled:v,"aria-pressed":h}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:h?x?"Ukryj legend":"Hide legend":x?"Legenda":"Legend"})]}),c.jsx("button",{type:"button",className:"btn basic-btn",onClick:u,disabled:v,children:x?"Reset widoku":"Reset view"})]})]}),m]})}function ux({orderedSamples:e,sampleReplicates:t,selectedKeys:r,onToggleKey:n,onToggleSample:a,highlighted:s,setHighlighted:i,sampleColors:l,isPl:o}){const u=Ze(Y=>Y.activeTab),f=k.useRef(null),[d,p]=k.useState(!1),[h,m]=k.useState(null),x=k.useRef(!1),v=k.useRef(""),y=k.useRef({}),w=k.useMemo(()=>{const Y=[];return e.forEach(J=>{(t[J]??[]).forEach(X=>Y.push(`${J}|${X.replicate}`))}),Y},[e,t]),g=k.useMemo(()=>w.join("|"),[w]),E=k.useCallback(Y=>{if(m(Y),!Y)return;const[J,Q]=Y.split("|"),X=Number(Q);J&&Number.isFinite(X)&&i([`${J} R${X}`])},[i]);k.useEffect(()=>{v.current!==g&&(v.current=g,x.current=!1,E(w[0]??null))},[g,w,E]),k.useEffect(()=>{w.length&&(h||E(w[0]),!x.current&&r.length===0&&(n(w[0]),E(w[0]),x.current=!0))},[h,n,w,r,E]),k.useEffect(()=>{r.length>0&&(x.current=!0)},[r.length]),k.useEffect(()=>{u!=="interactive"&&p(!1)},[u]);const A=k.useCallback(Y=>(t[Y]??[]).map(J=>`${Y}|${J.replicate}`),[t]),z=k.useCallback(Y=>{const J=new Set(r);J.forEach(Q=>{Y.has(Q)||n(Q)}),Y.forEach(Q=>{J.has(Q)||n(Q)})},[n,r]),b=k.useCallback((Y,J)=>{if(!w.length)return null;const Q=w.indexOf(Y),ee=((Q===-1?J===1?-1:0:Q)+J+w.length)%w.length;return w[ee]??null},[w]),S=k.useCallback((Y,J)=>{var X;if(!e.length)return null;const Q=Math.max(0,e.indexOf(Y));for(let ee=1;ee<=e.length;ee+=1){const F=(Q+J*ee+e.length)%e.length,le=e[F];if((((X=t[le])==null?void 0:X.length)??0)>0)return le}return null},[e,t]),_=k.useCallback((Y,J)=>{if(!w.length)return;const Q=r.find(le=>w.includes(le))??w[0],X=(h&&w.includes(h)?h:Q)??null;if(!X)return;if(r.length===0&&!J){z(new Set([X])),E(X);return}const ee=new Set;if(J){const le=X.split("|")[0],re=S(le,Y)??le,j=A(re);if(!j.length)return;ee.add(j[0]),z(ee),E(j[0]);return}const F=b(X,Y);F&&(ee.add(F),z(ee),E(F))},[h,z,b,S,A,n,w,e,r,E]);k.useEffect(()=>{const Y=J=>{const Q=J.target;if(!(Q&&(Q.tagName==="INPUT"||Q.tagName==="TEXTAREA"||Q.tagName==="SELECT"||Q.isContentEditable))&&(J.key==="ArrowDown"||J.key==="ArrowUp")){J.preventDefault(),_(J.key==="ArrowDown"?1:-1,J.shiftKey);return}};if(u==="interactive")return window.addEventListener("keydown",Y,{capture:!0}),()=>window.removeEventListener("keydown",Y,{capture:!0})},[u,_]),k.useEffect(()=>{const Y=h?h.split("|")[0]:null;if(!Y)return;const J=y.current[Y];J&&J.scrollIntoView&&J.scrollIntoView({block:"nearest"})},[h]);const T=k.useCallback(Y=>{Y.key!=="ArrowDown"&&Y.key!=="ArrowUp"||(Y.preventDefault(),_(Y.key==="ArrowDown"?1:-1,Y.shiftKey))},[_]),D=k.useCallback(()=>{r.length&&(r.forEach(Y=>n(Y)),E(null),i([]))},[n,r,E,i]),M=o?"Strzaki gra/d odznaczaj biecy replikat i zaznaczaj kolejny  rwnie w nastpnej prbie. Shift + strzaka przecza ca prb. Panel steruje tylko widocznoci krzywych na wykresie.":"Use Up/Down to deselect the current replicate and move to the next oneeven in the following sample. Shift + arrow toggles the entire sample. This panel only controls chart visibility.",G=k.useMemo(()=>{const Y=[];for(const J of e){const Q=t[J]??[];if(!Q.length)continue;const X=Q.map(j=>`${J}|${j.replicate}`),ee=X.filter(j=>r.includes(j)).length,F=ee===X.length&&X.length>0,le=ee>0&&ee<X.length,re=l.get(J)??Oi;Y.push(c.jsxs("div",{className:"replicate-card",onClick:()=>{a(J),E(X[0]??null)},ref:j=>{j&&(y.current[J]=j)},children:[c.jsxs("div",{className:"replicate-card__top",children:[c.jsxs("div",{className:"replicate-card__identity",children:[c.jsx("span",{className:"replicate-card__dot",style:{"--replicate-dot-color":re}}),c.jsxs("div",{children:[c.jsx("div",{className:"replicate-card__name",children:J}),c.jsx("div",{className:"replicate-card__meta",children:o?`${Q.length} replikat${Q.length===1?"":"y"}  ${ee} na wykresie`:`${Q.length} replicate${Q.length===1?"":"s"}  ${ee} on chart`})]})]}),c.jsx("div",{className:"replicate-card__toggles",children:c.jsxs("button",{type:"button",className:`state-pill state-pill--plot ${F?"is-on":""} ${le?"is-partial":""}`,onClick:j=>{j.stopPropagation(),a(J),E(X[0]??null)},"aria-pressed":F,title:F?o?"Ukryj replikaty tej prby":"Hide all replicates in this sample":o?"Poka replikaty tej prby":"Show all replicates in this sample",children:[" ",F?"":le?"~":""]})})]}),c.jsx("div",{className:"replicate-card__list",onKeyDown:T,children:Q.map(j=>{const R=`${J}|${j.replicate}`,B=r.includes(R),V=s.includes(`${J} R${j.replicate}`);return c.jsxs("div",{className:`replicate-row replicate-row--single-toggle ${h===R?"is-focused":""} ${V?"is-highlighted":""}`,onClick:te=>{te.stopPropagation(),n(R),E(R)},tabIndex:0,onKeyDown:te=>{te.key==="Enter"||te.key===" "?(te.preventDefault(),n(R),E(R)):T(te)},children:[c.jsxs("div",{className:"replicate-row__label",onMouseEnter:()=>i([`${J} R${j.replicate}`]),onFocus:()=>i([`${J} R${j.replicate}`]),onMouseLeave:()=>i([]),onBlur:()=>i([]),children:[c.jsxs("span",{className:"replicate-row__badge",style:{"--replicate-badge-color":Hc(re,j.replicate)},children:["R",j.replicate]}),c.jsx("span",{className:"replicate-row__name",children:j.well.toUpperCase()})]}),c.jsx("button",{type:"button",className:`state-pill state-pill--plot ${B?"is-on":""}`,onClick:te=>{te.stopPropagation(),n(R),E(R)},"aria-pressed":B,title:B?o?"Ukryj krzyw na wykresie":"Hide curve on chart":o?"Poka krzyw na wykresie":"Show curve on chart",children:B?"":""})]},R)})})]},J))}return Y.length||Y.push(c.jsx("div",{className:"small",children:o?"Brak replikatw do wywietlenia.":"No replicates assigned."},"empty")),Y},[h,s,o,n,a,e,t,r,i,l]);return c.jsxs("div",{className:"replicate-panel replicate-panel--single-toggle",children:[c.jsx("button",{ref:f,type:"button",className:"help-btn circle replicate-panel__help-btn","aria-expanded":d,"aria-label":o?"Poka pomoc":"Toggle help",onClick:()=>p(Y=>!Y),onMouseEnter:()=>p(!0),onFocus:()=>p(!0),onMouseLeave:()=>p(!1),onBlur:()=>p(!1),children:"?"}),c.jsxs("div",{className:"replicate-panel__header",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"replicate-panel__title",children:o?"Probki i replikaty":"Samples & Replicates"}),c.jsx("p",{className:"replicate-panel__description",children:o?"Kliknij nazw, aby pokaza lub ukry krzyw. Kolumna po prawej steruje widocznoci na wykresach.":"Click a name to show or hide the curve. The right column controls plot visibility."})]}),c.jsx("div",{className:"replicate-panel__actions",children:c.jsx("button",{className:"btn",onClick:D,disabled:!r.length,title:o?"Odznacz wszystkie":"Deselect all",children:o?"Wyczy":"Clear"})})]}),c.jsx(Qr,{anchorRef:f,open:d,children:M}),d&&c.jsx("div",{className:"help-banner",children:M}),c.jsxs("div",{className:"replicate-panel__legend",children:[c.jsx("span",{className:"replicate-panel__legend-label",children:o?"Prba":"Sample"}),c.jsx("div",{className:"replicate-panel__legend-pills",children:c.jsx("span",{children:o?"Wykres":"Plot"})})]}),c.jsx("div",{className:"replicate-panel__list",onKeyDown:T,children:G})]})}function A3(){var Gr,vn;const e=Ze(K=>K.blankCorrectionAssignments),t=Ze(K=>K.autoRun),r=Ze(K=>K.setAutoRun),n=Ze(K=>K.setCurvesSmoothingAssignments),a=Ze(K=>K.activeTab),s=Ze(K=>K.setActiveTab),i=k.useRef(null),o=Ze(K=>K.language)==="pl",[u,f]=k.useState([]),[d,p]=k.useState(0),[h,m]=k.useState([]),[x,v]=k.useState([]),[y,w]=k.useState(""),[g,E]=k.useState(""),[A,z]=k.useState(!1),[b,S]=k.useState(""),[_,T]=k.useState(""),[D,M]=k.useState("Blank Correction Check"),[G,Y]=k.useState(""),[J,Q]=k.useState(""),[X,ee]=k.useState(""),[F,le]=k.useState(1),[re,j]=k.useState(0),[R,B]=k.useState(null),[V,te]=k.useState(!0),[ke,_e]=k.useState(!1),[ge,ye]=k.useState({}),[Ee,C]=k.useState([]),[we,he]=k.useState(1),[Ce,Ae]=k.useState(o?"Legenda":"Legend"),[be,qe]=k.useState(!1),[Ie,ht]=k.useState(!1),[yt,Pt]=k.useState(!1),[Fe,vt]=k.useState(!1),[jt,ft]=k.useState(!1),[kt,Se]=k.useState(()=>{if(typeof window>"u")return new Set;try{const K=window.localStorage.getItem("bgca_blank_lag_warning_seen");if(!K)return new Set;const xe=JSON.parse(K);if(Array.isArray(xe))return new Set(xe.filter(Ne=>typeof Ne=="string"))}catch{}return new Set}),ot=k.useRef(null),Xe=k.useRef(null),Rt=k.useRef(null),q=k.useRef(null),oe=k.useRef(null);k.useRef(null);const pe=u[d]??null,He=k.useMemo(()=>Dy(pe),[pe]),st=((vn=(Gr=pe==null?void 0:pe.dataset)==null?void 0:Gr.meta)==null?void 0:vn.measurementType)??"OD600",_t=k.useCallback((K,xe)=>{var Pe;const Ne=(Pe=K==null?void 0:K.dataset)==null?void 0:Pe.meta;return(Ne==null?void 0:Ne.runId)||(Ne==null?void 0:Ne.sourceFile)||`entry-${xe}`},[]),Lt=k.useMemo(()=>_t(pe,d),[pe,d,_t]),xr=ge[Lt]??{};k.useEffect(()=>{Y(K=>K||(o?"Czas (min)":"Time (min)")),Q(K=>K||`${st} (raw)`),ee(K=>K||`${st} (blank-corrected)`),Ae(K=>K&&K!=="Legenda"&&K!=="Legend"?K:o?"Legenda":"Legend")},[o,st]),k.useEffect(()=>{if(!R)return;const K=xe=>{xe.key==="Escape"&&(xe.preventDefault(),B(null))};return window.addEventListener("keydown",K),()=>window.removeEventListener("keydown",K)},[R]);const Qe=k.useMemo(()=>{var Ne,Pe,mt;const K=((Ne=pe==null?void 0:pe.mapping)==null?void 0:Ne.samples)??[];if(K.length)return K.slice().sort((De,pt)=>((De==null?void 0:De.order)??Number.MAX_SAFE_INTEGER)-((pt==null?void 0:pt.order)??Number.MAX_SAFE_INTEGER)).map(De=>De.name).filter(De=>!!De);const xe=new Set;return(mt=(Pe=pe==null?void 0:pe.dataset)==null?void 0:Pe.rows)==null||mt.forEach(De=>{const pt=typeof(De==null?void 0:De.sample)=="string"?De.sample.trim():"";pt&&xe.add(pt)}),Array.from(xe).sort((De,pt)=>De.localeCompare(pt,void 0,{numeric:!0}))},[pe]),rt=k.useMemo(()=>Qe.join(""),[Qe]),je=k.useMemo(()=>{var Ne;const K=new Map,xe=((Ne=pe==null?void 0:pe.mapping)==null?void 0:Ne.samples)??[];if(xe.length){const Pe=ls(Math.max(xe.length,1));xe.forEach((mt,De)=>{const pt=mt.name;if(!pt)return;const bt=typeof mt.color=="string"&&mt.color.trim()?mt.color:null;K.set(pt,bt??Pe[De%Pe.length]??Oi)})}else if(Qe.length){const Pe=ls(Math.max(Qe.length,1));Qe.forEach((mt,De)=>{K.set(mt,Pe[De%Pe.length]??Oi)})}return K},[pe,rt]),{sampleReplicates:Be,replicateLookup:Ve}=k.useMemo(()=>{var Pe,mt;const K={},xe=new Map;return(((Pe=pe==null?void 0:pe.mapping)==null?void 0:Pe.samples)??[]).forEach(De=>{const pt=De.name;if(!pt)return;const bt=[];(De.wells??[]).forEach((xt,cr)=>{const wr=zr(xt);if(!wr)return;const yn=cr+1;bt.push({replicate:yn,well:wr}),xe.set(wr,yn)}),bt.length&&(K[pt]=bt)}),(((mt=pe==null?void 0:pe.dataset)==null?void 0:mt.rows)??[]).forEach(De=>{const pt=zr(De==null?void 0:De.well);if(!pt)return;const bt=(typeof(De==null?void 0:De.sample)=="string"?De.sample.trim():"")||pt,xt=Tn(De==null?void 0:De.replicate)??xe.get(pt)??1;K[bt]||(K[bt]=[]),K[bt].some(cr=>cr.replicate===xt)||(K[bt].push({replicate:xt,well:pt}),K[bt].sort((cr,wr)=>cr.replicate-wr.replicate)),xe.has(pt)||xe.set(pt,xt)}),{sampleReplicates:K,replicateLookup:xe}},[pe]),Kt=k.useMemo(()=>Object.entries(Be).map(([K,xe])=>`${K}:${xe.map(Ne=>Ne.replicate).join(",")}`).sort().join("|"),[Be]),St=k.useMemo(()=>{var K,xe;return(xe=(K=pe==null?void 0:pe.dataset)==null?void 0:K.rows)!=null&&xe.length?pe.dataset.rows.filter(Ne=>{var Pe;return!((Pe=Ne==null?void 0:Ne.curation)!=null&&Pe.excluded)}):[]},[pe]),yr=k.useMemo(()=>{const K=new Map;return He&&St.forEach(xe=>{const Ne=zr(xe==null?void 0:xe.well),Pe=Tn(xe==null?void 0:xe[He]);if(!Ne||Pe==null)return;const mt=Tu(xe),De=Number((mt*60).toFixed(6)),pt=yl(Ne,De);K.set(pt,{well:Ne,value:Pe})}),K},[St,He]),Tt=k.useMemo(()=>He?Uy(xr,St,He):new Map,[St,xr,He]),at=k.useMemo(()=>{if(!He)return new Map;const K=By(St,He);return Tt.forEach((xe,Ne)=>K.set(Ne,{value:xe.value,ids:new Set(xe.ids)})),K},[St,Tt,He]),rr=k.useMemo(()=>{var K;if(!pe||!He)return!1;for(const xe of at.values())if((((K=xe==null?void 0:xe.ids)==null?void 0:K.size)??0)<3)return!0;return!1},[pe,He,at]);k.useMemo(()=>{const K=new Set;return Object.values(xr).forEach(xe=>{xe==null||xe.forEach(Ne=>K.add(Ne))}),Array.from(K)},[xr]);const er=k.useCallback(K=>{K.length&&ye(xe=>{const Ne=xe[Lt]??{},Pe={};Object.entries(Ne).forEach(([De,pt])=>{Pe[De]=new Set(pt)}),K.forEach(De=>{const pt=yr.get(De);if(!pt)return;const bt=pt.well,xt=new Set(Pe[bt]??[]);xt.has(De)?xt.delete(De):xt.add(De),xt.size?Pe[bt]=xt:delete Pe[bt]});const mt={...xe};return Object.keys(Pe).length?mt[Lt]=Pe:delete mt[Lt],mt})},[Lt,yr]),hr=k.useCallback(K=>er([K.id]),[er]),pr=k.useCallback(K=>er(K.map(xe=>xe.id)),[er]),Ht=k.useMemo(()=>{const K=new Map;return!pe||!He||(St.forEach(xe=>{const Ne=zr(xe==null?void 0:xe.well);if(!Ne)return;const Pe=(typeof(xe==null?void 0:xe.sample)=="string"?xe.sample.trim():"")||Ne,mt=Tn(xe==null?void 0:xe.replicate)??Ve.get(Ne)??1,De=Tn(xe==null?void 0:xe[He]);if(De==null)return;const pt=Tu(xe),bt=Number((pt*60).toFixed(6)),xt=yl(Ne,bt),cr=at.get(Ne)??null,wr=cr?cr.ids.has(xt):!1,yn=cr&&cr.value!=null?Number((De-cr.value).toFixed(6)):null,Wn=`${Pe}|${mt}`;K.has(Wn)||K.set(Wn,[]),K.get(Wn).push({x:pt,meta:{id:xt,sample:Pe,replicate:mt,well:Ne,timeMinutes:pt,rawValue:De,blankCorrectedValue:yn,isBlank:wr}})}),K.forEach(xe=>xe.sort((Ne,Pe)=>Ne.x-Pe.x))),K},[pe,He,St,at,Ve]),Ot=k.useMemo(()=>{const K=[];return Object.entries(Be).forEach(([xe,Ne])=>{Ne.forEach(Pe=>K.push(`${xe}|${Pe.replicate}`))}),K},[Kt]),N=k.useMemo(()=>Array.from(Ht.keys()).sort(),[Ht]),P=k.useMemo(()=>N.join("|"),[N]),O=k.useMemo(()=>{const K=Qe[0];if(K){const xe=Be[K]??[];if(xe.length)return`${K}|${xe[0].replicate}`}return Ot[0]??null},[Ot,Qe,Be,Kt]),I=k.useMemo(()=>h.slice().sort().join("|"),[h]),W=k.useMemo(()=>Array.from(Ht.keys()).sort().join("|"),[Ht]);k.useEffect(()=>{C(K=>{const xe=new Map(K.map(Pe=>[Pe.id,Pe])),Ne=[];return h.forEach(Pe=>{if(!Ht.get(Pe))return;const[De,pt]=Pe.split("|"),bt=Number(pt)||1,xt=je.get(De)??Oi,cr=Hc(xt,bt),wr=xe.get(Pe);Ne.push({id:Pe,label:(wr==null?void 0:wr.label)??`${De} R${bt}`,color:cr,hidden:(wr==null?void 0:wr.hidden)??!1})}),Ne})},[I,W,je]),k.useEffect(()=>{if(!Ot.length){m([]);return}m(K=>{const xe=K.filter(Ne=>N.includes(Ne));return xe.length?xe:N.length?[N[0]]:O&&Ot.includes(O)?[O]:Ot.length?[Ot[0]]:[]})},[d,rt,Kt,Ot,O,P]);const H=k.useMemo(()=>new Map(Ee.map(K=>[K.id,!!K.hidden])),[Ee]),ce=k.useMemo(()=>{const K=[];return Ht.forEach((xe,Ne)=>{if(!h.includes(Ne)||H.get(Ne))return;const[Pe,mt]=Ne.split("|"),De=Number(mt)||1,pt=je.get(Pe)??Oi,bt=Hc(pt,De);K.push({name:`${Pe} R${De}`,color:bt,points:xe.map(xt=>({x:xt.x,y:xt.meta.rawValue,id:xt.meta.id,meta:{...xt.meta,strokeColor:xt.meta.isBlank?cx:bt,strokeWidth:xt.meta.isBlank?2.2:1,fillColor:bt}}))})}),K},[Ht,h,je,H]),ve=k.useMemo(()=>{if(!A)return[];const K=[];return Ht.forEach((xe,Ne)=>{if(!h.includes(Ne)||H.get(Ne))return;const[Pe,mt]=Ne.split("|"),De=Number(mt)||1,pt=je.get(Pe)??Oi,bt=Hc(pt,De);K.push({name:`${Pe} R${De}`,color:bt,points:xe.map(xt=>({x:xt.x,y:xt.meta.blankCorrectedValue??xt.meta.rawValue,id:`blanked|${xt.meta.id}`,meta:{...xt.meta,strokeColor:xt.meta.isBlank?cx:bt,strokeWidth:xt.meta.isBlank?2.2:1,fillColor:bt}}))})}),K},[A,Ht,h,je,H]),Z=k.useCallback(K=>{m(xe=>xe.includes(K)?xe.filter(Ne=>Ne!==K):[...xe,K])},[]),fe=k.useCallback(K=>{const xe=Be[K];if(!(xe!=null&&xe.length))return;const Ne=xe.map(Pe=>`${K}|${Pe.replicate}`);m(Pe=>{if(Ne.every(pt=>Pe.includes(pt)))return Pe.filter(pt=>!Ne.includes(pt));const De=new Set(Pe);return Ne.forEach(pt=>De.add(pt)),Array.from(De)})},[Be]),de=k.useCallback(async K=>{if(!(K!=null&&K.length))return;const xe=K[0];try{const Ne=await xe.text(),Pe=JSON.parse(Ne),mt=Array.isArray(Pe==null?void 0:Pe.assignments)?Pe.assignments:[];if(!mt.length){f([]),w(o?"[WARN] Wybrany plik nie zawiera assignmentw.":"[WARN] Selected file does not contain assignments."),E(xe.name),z(!1),n(null),S(""),T("");return}f(mt),p(0),E(xe.name),w(`[OK] ${xe.name}  ${mt.length} assignment${mt.length>1?"s":""}`),z(!1),n(null),S(""),T("")}catch(Ne){w(`[ERR] ${o?"Bd odczytu pliku: ":"Could not read file: "}${(Ne==null?void 0:Ne.message)??String(Ne)}`)}},[o,n]),Re=k.useCallback(K=>{const xe=Number(K.target.value);Number.isFinite(xe)&&(p(xe),j(Ne=>Ne+1))},[]),Ge=k.useMemo(()=>e!=null&&e.length?e.map(K=>{var xe,Ne;return((Ne=(xe=K==null?void 0:K.dataset)==null?void 0:xe.meta)==null?void 0:Ne.runId)??""}).join("|"):"",[e]);k.useEffect(()=>{var Ne,Pe;if(!(e!=null&&e.length))return;f(e),p(0);const K=(Pe=(Ne=e[0])==null?void 0:Ne.dataset)==null?void 0:Pe.meta,xe=(K==null?void 0:K.sourceFile)||(K==null?void 0:K.runId)||"assignment";E(`[auto] ${xe}`),w(`[AUTO] Dane z Karty Kontrola Danych (${e.length} assignment${e.length>1?"s":""}).`),z(!1),S(""),T(""),n(null)},[Ge]);const Je=k.useCallback(()=>{var xt,cr;if(!u.length){w("[WARN] Brak danych do korekty blank.");return}const K=new Date().toISOString(),xe=[],Ne=[];u.forEach((wr,yn)=>{var mr;const Wn=ge[_t(wr,yn)]??void 0,{entry:nn,missingWells:sr}=N3(wr,K,Wn);if(xe.push(nn),sr.length){const da=(mr=nn==null?void 0:nn.dataset)==null?void 0:mr.meta,Js=(da==null?void 0:da.sourceFile)||(da==null?void 0:da.runId)||`assignment-${yn}`;Ne.push(`${Js}: ${sr.slice(0,6).join(", ")}${sr.length>6?` +${sr.length-6} kolejne`:""}`)}});const Pe={version:5,createdAt:K,blanked:!0,assignments:xe},mt=(cr=(xt=xe[0])==null?void 0:xt.dataset)==null?void 0:cr.meta,De=(mt==null?void 0:mt.sourceFile)||(mt==null?void 0:mt.runId)||g||"assignment",pt=La(`${De}-blanked.json`),bt=JSON.stringify(Pe,null,2);z(!0),n(xe),S(bt),T(pt),Ne.length?w(`[WARN] Korekta blank zakoczona (${xe.length} assignment${xe.length>1?"s":""}), ale nie znaleziono punktw bazowych dla: ${Ne.join("; ")}.`):w(`[OK] Zastosowano korekt blank (${xe.length} assignment${xe.length>1?"s":""}).`)},[u,g,n,ge,_t]),Ue=k.useCallback(()=>{if(Je(),typeof window>"u"||typeof document>"u")return;const K=oe.current??i.current??null;requestAnimationFrame(()=>{K&&typeof K.scrollIntoView=="function"?K.scrollIntoView({behavior:"smooth",block:"center"}):window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"})})},[Je,oe,i]);k.useCallback(()=>{!b||!_||vl(new Blob([b],{type:"application/json;charset=utf-8"}),_)},[b,_]),k.useEffect(()=>{!t||t.stage!=="blankQueued"||u.length&&(Je(),r({stage:"loessQueued",error:null}),s("compiler"))},[t,u.length,Je,s,r]),k.useEffect(()=>{const K=xe=>{const Ne=xe.target;Ne&&(Ne.tagName==="INPUT"||Ne.tagName==="TEXTAREA"||Ne.tagName==="SELECT"||Ne.isContentEditable)||(xe.key==="r"||xe.key==="R")&&(xe.preventDefault(),j(Pe=>Pe+1))};return window.addEventListener("keydown",K,{capture:!0}),()=>window.removeEventListener("keydown",K,{capture:!0})},[]),k.useEffect(()=>{if(!R)return;const K=xe=>{(xe.key==="r"||xe.key==="R")&&(xe.preventDefault(),j(Ne=>Ne+1))};return window.addEventListener("keydown",K,{capture:!0}),()=>window.removeEventListener("keydown",K,{capture:!0})},[R]),k.useEffect(()=>{if(typeof document>"u")return;const K=document.body.style.overflow;return R&&(document.body.style.overflow="hidden"),()=>{document.body.style.overflow=K}},[R]);const U=o?"Sprawd czy program poprawnie wytypowa dane na blank. Jeeli nie - popraw manualnie.":"Check that the program has correctly identified the blank data. If not - adjust manually.",ae=G||(o?"Czas (min)":"Time (min)"),me=J||`${st} (raw)`,Te=X||`${st} (blank-corrected)`,Ye=!!R&&(V||ke);k.useEffect(()=>{typeof window>"u"||window.localStorage.setItem("bgca_blank_lag_warning_seen",JSON.stringify(Array.from(kt)))},[kt]),k.useEffect(()=>{if(a!=="interactive"||!rr||!Lt){ft(!1);return}!kt.has(Lt)&&!jt&&(ft(!0),Se(K=>{const xe=new Set(K);return xe.add(Lt),xe}))},[a,Lt,rr,kt,jt]);const wt=k.useCallback(K=>{const xe=K.current;return xe?xe.querySelector("svg"):null},[]),We=k.useCallback(K=>(K||"blank-check-plot").replace(/[^a-z0-9_-]+/gi,"-")||"blank-check-plot",[]),ze=k.useCallback(async K=>{var wr;const xe=wt(K);if(!xe)return null;const Pe=new XMLSerializer().serializeToString(xe),mt=new Blob([Pe],{type:"image/svg+xml;charset=utf-8"}),De=URL.createObjectURL(mt),pt=xe.getBoundingClientRect(),bt=(wr=xe.viewBox)==null?void 0:wr.baseVal,xt=Math.max(1,Math.round((bt==null?void 0:bt.width)||pt.width||1200)),cr=Math.max(1,Math.round((bt==null?void 0:bt.height)||pt.height||600));return await new Promise(yn=>{const Wn=new Image;Wn.onload=()=>{try{const nn=document.createElement("canvas");nn.width=xt,nn.height=cr;const sr=nn.getContext("2d");if(!sr){yn(null);return}sr.drawImage(Wn,0,0,xt,cr),nn.toBlob(mr=>yn(mr),"image/png")}finally{URL.revokeObjectURL(De)}},Wn.onerror=()=>{URL.revokeObjectURL(De),yn(null)},Wn.src=De})},[wt]),ct=k.useCallback(async(K,xe)=>{const Ne=await ze(K);if(!Ne)return;const Pe=`${We(xe)}.png`,mt=URL.createObjectURL(Ne),De=document.createElement("a");De.href=mt,De.download=Pe,De.click(),URL.revokeObjectURL(mt)},[ze,We]),ie=k.useCallback(async(K,xe)=>{const Ne=await ze(K);if(!Ne)return;if(typeof ClipboardItem<"u"&&navigator.clipboard&&"write"in navigator.clipboard)try{await navigator.clipboard.write([new ClipboardItem({"image/png":Ne})]);return}catch{}const Pe=`${We(xe)}.png`,mt=URL.createObjectURL(Ne),De=document.createElement("a");De.href=mt,De.download=Pe,De.click(),URL.revokeObjectURL(mt)},[ze,We]),$e=k.useCallback((K,xe)=>{C(Ne=>Ne.map(Pe=>Pe.id===K?{...Pe,label:xe}:Pe))},[]),Ct=k.useCallback(K=>{C(xe=>xe.map(Ne=>Ne.id===K?{...Ne,hidden:!Ne.hidden}:Ne))},[]),Mt=k.useMemo(()=>!be&&!Ie?null:c.jsxs("div",{className:"legend-editor panel-soft",children:[c.jsxs("div",{className:"legend-editor__header",children:[c.jsxs("div",{children:[c.jsx("div",{className:"legend-editor__title",children:Ce||(o?"Legenda":"Legend")}),c.jsx("div",{className:"legend-editor__subtitle",children:o?"Ukryj lub zmien nazwy wpisow legendy. Ukrycie nie usuwa serii z danych.":"Hide or rename legend entries. Hiding does not remove data from analysis."}),c.jsxs("label",{className:"field legend-editor__title-field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:o?"Tytul legendy":"Legend title"})}),c.jsx("input",{className:"field-input",value:Ce,onChange:K=>Ae(K.target.value),placeholder:o?"Legenda":"Legend"})]})]}),c.jsxs("div",{className:"legend-editor__font",children:[c.jsx("span",{children:o?"Rozmiar legendy":"Legend text"}),c.jsxs("div",{className:"btn-pair",children:[c.jsx("button",{type:"button",className:"btn",onClick:()=>he(K=>Math.max(.6,+(K-.1).toFixed(1))),children:"A-"}),c.jsx("button",{type:"button",className:"btn",onClick:()=>he(K=>Math.min(2,+(K+.1).toFixed(1))),children:"A+"})]})]})]}),c.jsx("div",{className:"legend-editor__list",children:Ee.map(K=>c.jsxs("div",{className:"legend-editor__row",children:[c.jsxs("label",{className:"legend-editor__checkbox",children:[c.jsx("input",{type:"checkbox",checked:!K.hidden,onChange:()=>Ct(K.id)}),c.jsx("span",{children:o?"Poka":"Show"})]}),c.jsx("span",{className:"legend-editor__swatch",style:{"--legend-swatch-color":K.color}}),c.jsx("input",{className:"legend-editor__input",value:K.label,onChange:xe=>$e(K.id,xe.target.value)})]},K.id))})]}),[$e,Ct,o,Ee,Ie,be]),Vt=o?"Korekcja blank jest bardzo istotna do wyznaczania fazy logarytminczej. Kolejne dane pomiarowe po korekcie mog si rni o rzd wielkoci w porwnaniu do danych surowych, zwaszcza na pocztku wzrostu: Rznica midzy 0,151 a 0,161 nie przekracza rzdu wielkoci, natomiast rznica midzy 0,001 a 0,011 ju tak.":"Blank correction is critical for accurate determination of the log phase. Post-correction measurements can differ by an order of magnitude compared to raw data, especially at the beginning of growth: The difference between 0.151 and 0.161 is not an order of magnitude, but the difference between 0.001 and 0.011 is.",Et=o?"Uruchamia korekte blank dla wszystkich dokw i zapisuje kopie danych do kolejnego kroku.":"Runs blank correction for all wells and saves a copy of the data for the next step.",Bt=k.useMemo(()=>`${d}|${He||"none"}|${rt}`,[d,He,rt]),gr=k.useRef(null);return k.useEffect(()=>{Bt!==gr.current&&(j(K=>K+1),gr.current=Bt)},[Bt]),k.useEffect(()=>{A&&i.current&&i.current.scrollIntoView({behavior:"smooth",block:"start"})},[A]),c.jsxs("div",{className:"blank-page",children:[c.jsxs("div",{className:"panel panel-landing blank-info",children:[c.jsxs("div",{className:"panel-heading with-help panel-heading--centered",children:[c.jsxs("div",{children:[c.jsx("div",{className:"eyebrow",children:o?"Korekcja blank":"Blank correction"}),c.jsx("h2",{className:"info-card__title",children:o?"Przeprowadzenie korekty blank":"Performing blank correction"})]}),c.jsx("button",{ref:Rt,className:"help-btn circle",type:"button",onClick:()=>Pt(K=>!K),"aria-label":o?"Pomoc: Blank Correction":"Help: Blank Correction",children:"?"})]}),c.jsx(Qr,{anchorRef:Rt,open:yt,children:Vt}),c.jsxs("div",{className:"blank-info__body",children:[c.jsx("p",{className:"small info-card__description",children:o?"Sprawd czy program wybra wartoci blank poprawnie, po ewentualnych poprawkach przeprowad korekt o wartoci blank i przejd do nastpnego kroku.":"Check that the app selected blank values correctly, make any adjustments if needed, then apply the blank correction and proceed to the next step."}),c.jsx("p",{className:"small info-card__description",children:o?"Zmienno wartoci pomidzy dokami pyki jest znaczca, blank powinno ustala si osobno dla kadego doka. Program stara si wybra wartoci sprzed wzrostu hodowli. Jeeli niemoliwe jest znalezienie takich wartoci, sugerowane jest wiksze rozcieczenie hodowli w kolejnym powtrzeniu eksperymentu.":"Well-to-well variation can be substantial, so the blank should be determined separately for each well. The app tries to pick measurements taken before growth starts. If no such values are found, consider using a higher dilution in your next experiment."}),c.jsx("p",{className:"small info-card__description",children:o?"Na pierwszym wykresie sprawd, czy program dobrze wytypowa prby jako blank (zota obwdka). Jeeli to potrzebne dokonaj rcznych poprawek. Na drugim wykresie zobaczysz dane po korekcie blank. Upewnij si, e wartoci po korekcie s sensowne (np. nie ma ujemnych wartoci). Jeeli wszystko wyglda dobrze, kliknij przycisk aby zastosowa korekt i przej dalej.":"On the first chart, check that the app correctly identified blank points (gold outline). Make manual adjustments if needed. The second chart shows data after blank correction. Ensure that the post-correction values make sense (e.g., no negative values). If everything looks good, click the button to apply the correction and proceed."})]})]}),jt&&c.jsx("div",{className:"unsupported-banner",role:"alert",children:c.jsxs("div",{className:"unsupported-banner__body",children:[c.jsx("button",{type:"button",className:"unsupported-banner__close",onClick:()=>ft(!1),"aria-label":o?"Zamknij ostrzeenie":"Dismiss warning",children:""}),c.jsxs("div",{className:"unsupported-banner__text",children:[c.jsx("strong",{children:o?"Niektre repliki maj zbyt krtki lag":"Some replicates have an insufficient lag phase"}),c.jsx("p",{className:"small",style:{marginTop:6},children:o?"Niektre z replikatw nie maj wystarczajco dugiej fazy lag. Moe to oznacza, e rzeczywista faza log zaczyna si wczeniej, wic obliczone w kolejnych krokach biologiczne parametry mog nie odpowiada rzeczywistoci. Jeeli zaley Ci tylko na przegldaniu krzywych, kontynuuj. Jeeli zaley Ci na poprawnym rozpoznaniu parametrw takich jak maksymalna szybko wzrostu, w kolejnym dowiadczeniu bardziej rozciecz hodowle przed rozpoczciem pomiarw.":"Some replicates do not have a sufficiently long lag phase. This may mean the true log phase starts earlier, so biological parameters computed in later steps may not reflect reality. If you only need to view curves, continue. If you need accurate parameters such as maximum growth rate, use a higher dilution before measurements in the next experiment."})]})]})}),c.jsxs("div",{className:"panel panel-soft blank-loader",children:[c.jsx("div",{className:"panel-heading",children:c.jsxs("div",{children:[c.jsx("h3",{children:o?"Wybr pliku":"Curated / assignment file"}),c.jsx("p",{className:"small",children:o?"Po prawej moesz wybra jeden z dostpnych plikw z danymi. Opcjonalnie moesz te zaimportowa wczeniej przygotowany plik, ju z adnotacjami ktre dane s wykluczone z analizy.":"On the right, you can select one of the available data files. Optionally, you can also import a previously prepared file, already annotated with which data points are excluded from analysis."})]})}),c.jsxs("div",{className:"blank-loader__grid",children:[c.jsx("div",{children:c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:o?"Importuj (opcjonalnie)":"Import (optional)"})}),c.jsxs("div",{className:"file-upload",children:[c.jsx("input",{id:"blank-file-input",className:"file-upload__input",type:"file",accept:".json",onChange:K=>de(K.target.files),"aria-label":o?"Wybierz plik z danymi (opcjonalnie)":"Choose a data file (optional)"}),c.jsx("label",{className:"btn",htmlFor:"blank-file-input",children:o?"Wybierz plik":"Choose file"}),c.jsx("span",{className:"file-upload__name",children:g?c.jsxs(c.Fragment,{children:[o?"Wczytano: ":"Loaded: ",c.jsx("strong",{children:g})]}):o?"Nie wybrano pliku":"No file chosen"})]})]})}),c.jsx("div",{children:c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:o?"Na bazie pliku:":"Based on file:"})}),c.jsxs("select",{className:"field-input",value:d,onChange:Re,disabled:!u.length,children:[!u.length&&c.jsx("option",{value:0,children:o?"(brak danych)":"(no data loaded)"}),u.map((K,xe)=>{var mt;const Ne=(mt=K==null?void 0:K.dataset)==null?void 0:mt.meta,Pe=(Ne==null?void 0:Ne.sourceFile)||(Ne==null?void 0:Ne.runId)||`assignment-${xe+1}`;return c.jsxs("option",{value:xe,children:[xe+1,". ",Pe]},`${Pe}-${xe}`)})]}),c.jsx("div",{className:"small field-note",children:o?"Dane z Karty Kontrola Danych aduj si automatycznie. Moesz te wczyta zapisany plik.":"Data from the Data Control Module flows in automatically; you can also load a saved file."})]})})]}),y&&c.jsx("div",{className:"small blank-loader__status",children:y})]}),!pe&&c.jsx("div",{className:"empty-state panel-soft blank-empty",children:"Wczytaj dane z poprzedniego kroku, aby przejrzec blanki."}),pe&&!He&&c.jsxs("div",{className:"empty-state panel-soft blank-empty",children:["Nie udalo sie zidentyfikowac kolumny z wartosciami pomiarowymi. Upewnij sie, ze dane zawieraja pola typu ",c.jsx("code",{children:"val_od600"}),"."]}),pe&&He&&c.jsxs(c.Fragment,{children:[R&&(V||ke)&&c.jsx("div",{className:"plot-controls-float",children:c.jsxs("div",{className:"plot-controls-float__body",children:[V&&(R==="raw"?c.jsx(Nc,{title:o?"Plot Controls (przed korekta)":"Plot Controls (Before blank correction)",chartTitle:D,setChartTitle:M,xLabel:G,setXLabel:Y,yLabel:me,setYLabel:Q,fontScale:F,setFontScale:le,onResetView:()=>j(K=>K+1),onExportPng:()=>ct(ot,D||(o?"Przed-korekta":"before-blank")),onCopyPng:()=>ie(ot,D||(o?"Przed-korekta":"before-blank")),onToggleLegend:()=>qe(K=>!K),legendOpen:be,legendPanel:Mt,isPl:o,disabled:!ce.length}):c.jsx(Nc,{title:o?"Plot Controls (po korekcie)":"Plot Controls (After blank correction)",chartTitle:D,setChartTitle:M,xLabel:G,setXLabel:Y,yLabel:Te,setYLabel:ee,fontScale:F,setFontScale:le,onResetView:()=>j(K=>K+1),onExportPng:()=>ct(Xe,D||(o?"Po-korekcie":"after-blank")),onCopyPng:()=>ie(Xe,D||(o?"Po-korekcie":"after-blank")),onToggleLegend:()=>ht(K=>!K),legendOpen:Ie,legendPanel:Mt,isPl:o,disabled:!ve.length})),ke&&c.jsx("div",{className:"plot-controls-float__replicates",children:c.jsx(ux,{orderedSamples:Qe,sampleReplicates:Be,selectedKeys:h,onToggleKey:Z,onToggleSample:fe,highlighted:x,setHighlighted:v,sampleColors:je,isPl:o})})]})}),c.jsxs("div",{className:`blank-layout ${R?"blank-layout--single":""}`.trim(),children:[!R&&c.jsx("div",{className:"blank-legend",children:c.jsx(ux,{orderedSamples:Qe,sampleReplicates:Be,selectedKeys:h,onToggleKey:Z,onToggleSample:fe,highlighted:x,setHighlighted:v,sampleColors:je,isPl:o})}),c.jsxs("div",{className:"blank-main",children:[!R&&c.jsx(Nc,{title:o?"Plot Controls (przed korekta)":"Plot Controls (Before blank correction)",chartTitle:D,setChartTitle:M,xLabel:G,setXLabel:Y,yLabel:me,setYLabel:Q,fontScale:F,setFontScale:le,onResetView:()=>j(K=>K+1),onExportPng:()=>ct(ot,D||(o?"Przed-korekta":"before-blank")),onCopyPng:()=>ie(ot,D||(o?"Przed-korekta":"before-blank")),onToggleLegend:()=>qe(K=>!K),legendOpen:be,legendPanel:Mt,isPl:o,disabled:!ce.length}),c.jsx(Qf,{heading:o?"Przed korekt blank":"Before blank correction",helpContent:U,series:ce,chartTitle:D||(o?"Przed korekt blank":"Before blank correction"),xLabel:ae,yLabel:me,fontScale:F,chartRef:ot,highlightedNames:x,selectedPointIds:[],resetViewKey:`${re}-raw`,minPanX:Number.NEGATIVE_INFINITY,minPanY:Number.NEGATIVE_INFINITY,height:R==="raw"?620:380,fullscreen:R==="raw",className:R==="raw"&&Ye?"chart-card--with-controls":"",pointMarkers:"all",pointMarkerRadius:3,pointSelectionMode:"modifier",onPointToggle:K=>hr(K),onPointSelection:K=>pr(K),legendEntries:Ee,showLegend:be,legendTitle:Ce||(o?"Legenda":"Legend"),legendScale:we,actions:c.jsxs("div",{className:"btn-pair btn-pair--wrap",children:[R==="raw"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",className:"btn basic-btn",onClick:()=>te(K=>!K),"aria-pressed":V,children:V?o?"Ukryj Plot Controls":"Hide Plot Controls":o?"Poka Plot Controls":"Show Plot Controls"}),c.jsx("button",{type:"button",className:"btn basic-btn",onClick:()=>_e(K=>!K),"aria-pressed":ke,children:ke?o?"Ukryj Panel Prb i Replikatw":"Hide Samples & Replicates":o?"Poka Panel Prb i Replikatw":"Show Samples & Replicates"})]}),c.jsx("button",{type:"button",className:`btn ${R==="raw"?"primary":""}`,onClick:()=>B(K=>K==="raw"?null:"raw"),children:R==="raw"?o?"Zamknij pelny ekran":"Exit fullscreen":o?"Peny ekran":"Fullscreen"})]})}),c.jsx("div",{className:"panel panel-soft blank-action-panel",children:c.jsxs("div",{className:"raw-data-blank-cta__inner",children:[c.jsxs("div",{className:"btn-pair btn-pair--wide",children:[c.jsx("button",{type:"button",className:"btn primary",onClick:Ue,disabled:!u.length,children:o?"Przeprowad korekt blank":"Apply Blank Correction"}),c.jsx("button",{type:"button",className:"help-btn circle",ref:q,onClick:()=>vt(K=>!K),"aria-label":o?"Pomoc: Blank Correction":"Help: Blank Correction",children:"?"})]}),c.jsx(Qr,{anchorRef:q,open:Fe,children:Et})]})}),A&&c.jsxs("div",{ref:i,className:"blank-after",children:[!R&&c.jsx(Nc,{title:o?"Plot Controls (po korekcie)":"Plot Controls (After blank correction)",chartTitle:D,setChartTitle:M,xLabel:G,setXLabel:Y,yLabel:Te,setYLabel:ee,fontScale:F,setFontScale:le,onResetView:()=>j(K=>K+1),onExportPng:()=>ct(Xe,D||(o?"Po-korekcie":"after-blank")),onCopyPng:()=>ie(Xe,D||(o?"Po-korekcie":"after-blank")),onToggleLegend:()=>ht(K=>!K),legendOpen:Ie,legendPanel:Mt,isPl:o,disabled:!ve.length}),c.jsx(Qf,{heading:o?"Po korekcie blank":"After blank correction",helpContent:U,series:ve,chartTitle:D||(o?"Po korekcie blank":"After blank correction"),xLabel:ae,yLabel:Te,fontScale:F,chartRef:Xe,highlightedNames:x,selectedPointIds:[],resetViewKey:`${re}-blank`,minPanX:Number.NEGATIVE_INFINITY,minPanY:Number.NEGATIVE_INFINITY,height:R==="blank"?620:380,fullscreen:R==="blank",className:R==="blank"&&Ye?"chart-card--with-controls":"",pointMarkers:"all",pointMarkerRadius:3,pointSelectionMode:"modifier",legendEntries:Ee,showLegend:Ie,legendTitle:Ce||(o?"Legenda":"Legend"),legendScale:we,actions:c.jsxs("div",{className:"btn-pair btn-pair--wrap",children:[R==="blank"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",className:"btn basic-btn",onClick:()=>te(K=>!K),"aria-pressed":V,children:V?o?"Ukryj Plot Controls":"Hide Plot Controls":o?"Poka Plot Controls":"Show Plot Controls"}),c.jsx("button",{type:"button",className:"btn basic-btn",onClick:()=>_e(K=>!K),"aria-pressed":ke,children:ke?o?"Ukryj Panel Prb i Replikatw":"Hide Samples & Replicates":o?"Poka Panel Prb i Replikatw":"Show Samples & Replicates"})]}),c.jsx("button",{type:"button",className:`btn ${R==="blank"?"primary":""}`,onClick:()=>B(K=>K==="blank"?null:"blank"),children:R==="blank"?o?"Zamknij peny ekran":"Exit fullscreen":o?"Peny ekran":"Fullscreen"})]})}),c.jsx("div",{className:"panel panel-soft raw-data-blank-cta",children:c.jsxs("div",{className:"raw-data-blank-cta__inner",children:[c.jsxs("div",{className:"btn-pair btn-pair--wide",children:[c.jsx("button",{type:"button",className:"btn primary",ref:oe,onClick:()=>{s("compiler"),typeof window<"u"&&window.scrollTo({top:0,behavior:"smooth"})},children:o?"Przejd do wygadzania krzywych":"Go to Curves Smoothing"}),c.jsx("button",{type:"button",className:"help-btn circle",ref:q,onClick:()=>vt(K=>!K),"aria-label":o?"Pomoc: Blank Correction":"Help: Blank Correction",children:"?"})]}),c.jsx(Qr,{anchorRef:q,open:Fe,children:o?"Kliknicie przycisku przesya dane do moduu wygadzajcego krzywe i wyszukujcego faz logarytmiczn.":"Clicking the button sends data to the smoothing module that also finds the logarithmic phase."})]})})]})]})]})]})]})}const qf=1e-12;function j3(e,t,r){if(!(t>1))return 1;const n=e<1?Math.max(e,.01)*t:e,a=Math.max(r,Math.min(t,Math.round(n)));return Math.max(r,a)}function F3(e){if(!e.length)return 0;const t=[...e].sort((n,a)=>n-a),r=Math.floor(t.length/2);return t.length%2===0?(t[r-1]+t[r])/2:t[r]}function M3(e,t){const r=t.length,n=e.map((a,s)=>[...a,t[s]]);for(let a=0;a<r;a+=1){let s=a;for(let l=a+1;l<r;l+=1)Math.abs(n[l][a])>Math.abs(n[s][a])&&(s=l);const i=n[s][a];if(Math.abs(i)<qf)return null;if(s!==a){const l=n[a];n[a]=n[s],n[s]=l}for(let l=a;l<=r;l+=1)n[a][l]/=i;for(let l=0;l<r;l+=1){if(l===a)continue;const o=n[l][a];if(!(Math.abs(o)<qf))for(let u=a;u<=r;u+=1)n[l][u]-=o*n[a][u]}}return n.map(a=>a[r])}function R3(e,t,r){let n=0,a=0;return t.forEach((s,i)=>{const l=r[i];l>0&&(n+=l,a+=l*e[s].y)}),n>0?a/n:e[t[Math.floor(t.length/2)]].y}function I3(e,t,r){if(r<=t)return Array.from({length:r},(i,l)=>l);let n=Math.max(0,e-Math.floor((t-1)/2)),a=n+t-1;a>=r&&(a=r-1,n=Math.max(0,a-t+1));const s=[];for(let i=n;i<=a;i+=1)s.push(i);return s}function z3(e,t,r,n,a){const s=n+1,i=Array.from({length:s},()=>new Array(s).fill(0)),l=new Array(s).fill(0);let o=0;if(t.forEach((f,d)=>{const p=r[d];if(!(p>0))return;o+=p;const h=e[f].x-a,m=new Array(s).fill(1);for(let x=1;x<s;x+=1)m[x]=m[x-1]*h;for(let x=0;x<s;x+=1){for(let v=0;v<s;v+=1)i[x][v]+=p*m[x]*m[v];l[x]+=p*m[x]*e[f].y}}),!(o>0))return null;const u=M3(i,l);return!u||!Number.isFinite(u[0])?null:u[0]}function L3(e,t){const n=e.filter(p=>Number.isFinite(p.x)&&Number.isFinite(p.y)).map(p=>({x:Number(p.x),y:Number(p.y)})).sort((p,h)=>p.x-h.x),a=n.length;if(a<=1)return{points:n.slice(),diagnostics:{residuals:new Array(a).fill(0),robustnessWeights:new Array(a).fill(1),windowSize:a}};const s=t.degree??2,i=Math.max(t.minWindowSize??s+1,s+1),l=j3(t.span,a,i),o=Math.max(1,t.robustIters??2);let u=new Array(a).fill(1),f=new Array(a).fill(0),d=new Array(a).fill(0);for(let p=0;p<o;p+=1){for(let v=0;v<a;v+=1){const y=I3(v,l,a),w=n[v].x;let g=0;const E=y.map(b=>{const S=Math.abs(n[b].x-w);return S>g&&(g=S),S});g>0||(g=1);const A=y.map((b,S)=>{const _=E[S]/g,T=Math.pow(1-Math.pow(_,3),3);return Math.max(0,T)*u[b]}),z=z3(n,y,A,s,w)??R3(n,y,A);f[v]=z}if(d=n.map((v,y)=>v.y-f[y]),p===o-1)break;const h=d.map(v=>Math.abs(v)),m=F3(h);if(m<qf){u=new Array(a).fill(1);continue}const x=6*m;u=h.map(v=>{const y=v/x;if(y>=1)return 0;const w=1-y*y;return w*w})}return{points:n.map((p,h)=>({x:p.x,y:f[h]})),diagnostics:{residuals:d,robustnessWeights:u,windowSize:l}}}const ta={windowSize:20,r2Min:.98,odMin:.001,fracKMax:.9,muRelMin:.5,muRelMax:1.05},O3=ta;function P3(e){const t=e.filter(a=>Number.isFinite(a));if(!t.length)return null;const r=[...t].sort((a,s)=>a-s),n=Math.floor(r.length/2);return r.length%2===0?(r[n-1]+r[n])/2:r[n]}function D3(e,t){const r=e.length;if(r<2)return null;const n=e.reduce((p,h)=>p+h,0)/r,a=t.reduce((p,h)=>p+h,0)/r;let s=0,i=0;for(let p=0;p<r;p+=1){const h=e[p]-n,m=t[p]-a;s+=h*h,i+=h*m}if(s===0)return null;const l=i/s,o=a-l*n,u=t.reduce((p,h)=>p+(h-a)**2,0),f=e.reduce((p,h,m)=>{const x=l*h+o,v=t[m]-x;return p+v*v},0),d=u===0?1:1-f/u;return{slope:l,intercept:o,r2:d}}function Ol(){return{indices:[],muMax:null,muMean:null,kEstimate:null,startTime:null,endTime:null}}function B3(e,t={}){const{windowSize:r,r2Min:n,odMin:a,fracKMax:s,muRelMin:i,muRelMax:l}={...O3,...t};if(!e.length)return Ol();const o=Math.max(2,Math.round(r)),u=e.map(T=>(T==null?void 0:T.x)??Number.NaN),f=e.map(T=>(T==null?void 0:T.y)??Number.NaN);if(u.some(T=>!Number.isFinite(T))||f.some(T=>!Number.isFinite(T)))return Ol();const d=[];for(let T=0;T<f.length;T+=1)f[T]>=a&&d.push(T);if(d.length<o+1)return Ol();const h=(d.length>=5?d.slice(-5):[...d]).map(T=>f[T]),m=P3(h);if(!m||!(m>0))return Ol();const x=[];for(let T=0;T<=d.length-o;T+=1){const D=d.slice(T,T+o),M=D.map(X=>f[X]),G=D.map(X=>u[X]);if(Math.max(...M)/m>=s||M.some(X=>X<=0))continue;const J=M.map(X=>Math.log(X)),Q=D3(G,J);Q&&(Q.slope<=0||Q.r2<n||x.push({start:D[0],end:D[D.length-1],slope:Q.slope,r2:Q.r2}))}if(!x.length)return{...Ol(),kEstimate:m};const v=Math.max(...x.map(T=>T.slope));let y=x.filter(T=>T.slope>=i*v&&T.slope<=l*v);y.length||(y=[x.reduce((D,M)=>M.slope>D.slope?M:D)]);const w=new Array(e.length).fill(!1);y.forEach(T=>{for(let D=T.start;D<=T.end;D+=1)w[D]=!0});const g=[];let E=[];if(w.forEach((T,D)=>{T?E.push(D):E.length&&(g.push(E),E=[])}),E.length&&g.push(E),!g.length)return{indices:[],muMax:v,muMean:null,kEstimate:m,startTime:null,endTime:null};const A=g.reduce((T,D)=>D.length>T.length?D:T,g[0]),z=y.filter(T=>!(T.end<A[0]||T.start>A[A.length-1])).map(T=>T.slope),b=z.length&&v!=null?z.reduce((T,D)=>T+D,0)/z.length:v,S=Number.isFinite(u[A[0]])?u[A[0]]:null,_=Number.isFinite(u[A[A.length-1]])?u[A[A.length-1]]:null;return{indices:A,muMax:v,muMean:b,kEstimate:m,startTime:S,endTime:_}}function Na({label:e,help:t,children:r,maxWidth:n=200}){const[a,s]=k.useState(!1),i=k.useRef(null);return c.jsxs("label",{className:"field",style:{maxWidth:n},children:[c.jsxs("div",{className:"field-label-row",children:[c.jsx("span",{children:e}),c.jsx("button",{ref:i,type:"button",className:"field-help-btn",onClick:()=>s(l=>!l),"aria-label":`${e} help`,children:"?"}),c.jsx(Qr,{anchorRef:i,open:a,children:t})]}),r]})}function fx({title:e,helpContent:t,chartTitle:r,onChartTitleChange:n,xLabel:a,onXLabelChange:s,yLabel:i,onYLabelChange:l,fontScale:o,onFontScaleChange:u,legendOpen:f,onToggleLegend:d,legendPanel:p,onExportPng:h,onCopyPng:m,onResetView:x,isPl:v,disabled:y,extraActions:w}){return c.jsxs(ia,{title:e,helpContent:t,className:"panel-soft control-panel",children:[c.jsxs("div",{className:"control-grid",children:[c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:v?"Tytul wykresu":"Chart title"})}),c.jsx("input",{className:"field-input",value:r,onChange:g=>n(g.target.value),disabled:y})]}),c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:v?"Os X":"X axis"})}),c.jsx("input",{className:"field-input",value:a,onChange:g=>s(g.target.value),disabled:y})]}),c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:v?"Os Y":"Y axis"})}),c.jsx("input",{className:"field-input",value:i,onChange:g=>l(g.target.value),disabled:y})]})]}),c.jsxs("div",{className:"control-row",children:[c.jsxs("div",{className:"btn-pair",children:[c.jsx("button",{className:"btn",onClick:()=>u(g=>Math.max(.6,+(g-.1).toFixed(1))),disabled:y,title:v?"Mniejsza czcionka":"Smaller text",children:"A-"}),c.jsx("button",{className:"btn",onClick:()=>u(g=>Math.min(2,+(g+.1).toFixed(1))),disabled:y,title:v?"Wieksza czcionka":"Larger text",children:"A+"})]}),c.jsxs("div",{className:"control-actions control-actions--tight",children:[c.jsx("button",{className:"btn",type:"button",onClick:h,disabled:y,children:v?"Eksportuj PNG":"Export PNG"}),c.jsx("button",{className:"btn",type:"button",onClick:m,disabled:y,children:v?"Kopiuj PNG":"Copy PNG"}),w,c.jsxs("label",{className:`parameters-toggle ${f?"is-on":""}`,title:f?v?"Ukryj legende":"Hide legend":v?"Pokaz legende":"Show legend",children:[c.jsx("input",{type:"checkbox",checked:f,onChange:d,disabled:y,"aria-pressed":f}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:f?v?"Ukryj legende":"Hide legend":v?"Legenda":"Legend"})]}),c.jsx("button",{className:"btn basic-btn",type:"button",onClick:x,disabled:y,"aria-label":v?"Reset widoku":"Reset view",title:v?"Reset widoku":"Reset view",children:v?"Reset widoku":"Reset view"})]})]}),p]})}const dx="#2563eb",$y="60",U3=Number($y)||60;function rs(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"&&e.trim()!==""){const t=Number(e);if(Number.isFinite(t))return t}return null}function $3(e){const t=rs(e.time_min)??rs(e.timeMinutes)??rs(e.time_minutes);if(t!=null)return t;const r=rs(e.time_seconds)??rs(e.timeSeconds);return r!=null?r/60:0}function W3(e){const t=[rs(e.val_od600_blank_corrected),rs(e.val_od600),rs(e.value)];for(const r of t)if(r!=null)return r;return null}function H3(e,t){if(t<=1)return e;const{h:r,s:n,l:a}=ri(e),s=(t-1)%4;return s===1?Ds(r,Math.min(100,n+5),Math.min(100,a+8)):s===2?Ds(r,Math.max(0,n-6),Math.max(0,a-10)):Ds((r+12)%360,n,a)}function D0(e){var u,f,d;if(!((f=(u=e==null?void 0:e.dataset)==null?void 0:u.rows)!=null&&f.length))return[];const t=e.dataset.rows.filter(p=>{var h;return!((h=p==null?void 0:p.curation)!=null&&h.excluded)});if(!t.length)return[];const r=((d=e.mapping)==null?void 0:d.samples)??[],n=ls(Math.max(r.length||1,4)),a=new Map;r.forEach((p,h)=>{const m=p.color??n[h%n.length]??dx;a.set(p.name,m)});const s={};r.forEach(p=>{var h;(h=p.wells)==null||h.forEach((m,x)=>{const v=zr(m);v&&(s[v]=x+1)})});const i=new Map;r.forEach((p,h)=>i.set(p.name,h));const l=new Map;return t.forEach(p=>{const m=(typeof p.sample=="string"?p.sample.trim():"")||zr(p.well)||"Unknown",x=zr(p.well);if(!x)return;const v=$3(p),y=W3(p);if(y==null)return;const w=rs(p.replicate)??s[x]??1;if(!l.has(m)){const A=a.get(m)??n[l.size%n.length]??dx;l.set(m,{sample:m,color:A,wells:[]})}const g=l.get(m);let E=g.wells.find(A=>A.well===x);E||(E={well:x,replicate:Number(w)||1,color:H3(g.color,Number(w)||1),points:[]},g.wells.push(E)),E.points.push({x:v,y,id:`${m}|${x}|${v.toFixed(6)}|${E.points.length}`,meta:{sample:m,well:x,replicate:E.replicate}})}),Array.from(l.values()).map(p=>{p.wells.forEach(m=>m.points.sort((x,v)=>x.x-v.x));const h=p.wells.flatMap(m=>m.points.map(x=>({x:x.x,y:x.y}))).sort((m,x)=>m.x-x.x);return{sample:p.sample,color:p.color,wells:p.wells.sort((m,x)=>{const v=m.replicate-x.replicate;return v!==0?v:m.well.localeCompare(x.well,void 0,{numeric:!0})}),history:[{label:"Raw",points:h}],rawPoints:h}}).sort((p,h)=>{const m=i.has(p.sample)?i.get(p.sample):Number.MAX_SAFE_INTEGER,x=i.has(h.sample)?i.get(h.sample):Number.MAX_SAFE_INTEGER;return m!==x?m-x:p.sample.localeCompare(h.sample,void 0,{numeric:!0})})}function V3(e){var r;if(!((r=e==null?void 0:e.samples)!=null&&r.length))return[];const t=Array.isArray(e.well_curves)?e.well_curves:[];return e.samples.map(n=>{var o,u,f;const a={};t.filter(d=>d.sample===n.sample).forEach(d=>{const p=Array.isArray(d.time_min)?d.time_min:[],h=Array.isArray(d.od600_smoothed)&&d.od600_smoothed||Array.isArray(d.od600_blank_corrected)&&d.od600_blank_corrected||Array.isArray(d.od600_raw)&&d.od600_raw||[],m=Math.min(p.length,h.length),x=[];for(let v=0;v<m;v+=1){const y=Number(p[v]??NaN),w=Number(h[v]??NaN);!Number.isFinite(y)||!Number.isFinite(w)||x.push({x:y,y:w})}a[d.well]={well:d.well,replicate:d.replicate??1,color:n.color,points:x.sort((v,y)=>v.x-y.x)}});let s=[];(o=n.wells)!=null&&o.length?s=n.wells.map(d=>{const p=a[d.well];return p||{well:d.well,replicate:d.replicate??1,color:n.color,points:[]}}):s=Object.values(a);const i=(n.history??[]).map(d=>({label:d.label,points:d.points.map(p=>({x:Number(p.x??0),y:Number(p.y??0)}))})),l=(f=(u=i==null?void 0:i[0])==null?void 0:u.points)!=null&&f.length?i[0].points:Object.values(a).flatMap(d=>d.points).sort((d,p)=>d.x-p.x);return{sample:n.sample,color:n.color,wells:s,history:i,rawPoints:l??[]}})}function Ac(e){if(!(e!=null&&e.length))return{};const t={};return e.forEach(r=>{r!=null&&r.sample&&(t[r.sample]=r)}),t}function jc(e){if(!e||!Number.isFinite(e.start)||!Number.isFinite(e.end)||e.start===e.end)return null;const t=Math.min(e.start,e.end),r=Math.max(e.start,e.end);return{start:t,end:r}}function B0(e){var t,r;return(r=(t=e==null?void 0:e.mapping)==null?void 0:t.samples)!=null&&r.length?e.mapping.samples.filter(n=>{var a;return(((a=n==null?void 0:n.wells)==null?void 0:a.length)??0)>0}).length:0}function G3(e,t,r,n,a,s,i,l){return e.length?{version:1,generatedAt:new Date().toISOString(),source:{file:(t==null?void 0:t.sourceFile)??a??"",runId:(t==null?void 0:t.runId)??"",plateId:(t==null?void 0:t.plateId)??""},smoothing:{span:r,degree:n},sample_curves:s??void 0,well_curves:i??void 0,samples:e.map(o=>({sample:o.sample,color:o.color,wells:o.wells.map(u=>({well:u.well,replicate:u.replicate})),history:o.history.map(u=>({label:u.label,points:u.points.map(f=>({x:f.x,y:f.y}))}))})),logPhases:l}:null}function K3(e){return e.map(t=>{var n,a;const r=(n=t.history)==null?void 0:n[t.history.length-1];return(a=r==null?void 0:r.points)!=null&&a.length?{sample:t.sample,time_min:r.points.map(s=>Number(s.x??0)),od600_smoothed_vals:r.points.map(s=>Number(s.y??0))}:null}).filter(t=>!!t)}function X3(e){return e.flatMap(t=>(t.wells??[]).map(r=>{const n=(r.points??[]).map(s=>Number(s.x??0)),a=(r.points??[]).map(s=>Number(s.y??0));return{sample:t.sample,well:r.well,replicate:r.replicate,time_min:n,od600_blank_corrected:a}}))}function Y3(e){if(!(e!=null&&e.length))return;const t=e.map(r=>({t_min:Number(r.t_min),od600:Number(r.od600)})).filter(r=>Number.isFinite(r.t_min)&&Number.isFinite(r.od600));return t.length?t:void 0}function J3(e){return{...e,points:Y3(e.points)}}function zi(e,t,r=!1){const n=Number(e);return Number.isFinite(n)?r?n>=0?n:t:n>0?n:t:t}function U0(e,t,r,n,a,s=!0){const i=new Set(t);if(!i.size)return{};const l={};return e.forEach(o=>{var p,h;if(!i.has(o.sample))return;const u=a==null?void 0:a[o.sample];if(s&&(u!=null&&u.manual))return;const f=(p=o.history)==null?void 0:p[o.history.length-1];if(!((h=f==null?void 0:f.points)!=null&&h.length)){l[o.sample]=null;return}const d=B3(f.points,n);if(!d.indices.length||d.startTime==null||d.endTime==null){l[o.sample]=null;return}l[o.sample]={sample:o.sample,start:d.startTime,end:d.endTime,createdAt:r,manual:!1}}),l}function Q3(){var Mh,Rh,Ih,zh,Lh;const e=Ze(L=>L.curvesSmoothingAssignments),t=Ze(L=>L.curvesSmoothingSmoothed),r=Ze(L=>L.setCurvesSmoothingSmoothed),n=Ze(L=>L.setActiveTab),a=Ze(L=>L.autoRun),s=Ze(L=>L.setAutoRun),i=Ze(L=>L.language==="pl"),[l,o]=k.useState([]),[u,f]=k.useState(0),[d,p]=k.useState([]),[h,m]=k.useState([]),[x,v]=k.useState($y),[y,w]=k.useState(1),[g,E]=k.useState(3),[A,z]=k.useState("pointwise"),[b,S]=k.useState(3),[_,T]=k.useState(1e-4),[D,M]=k.useState(""),[G,Y]=k.useState(""),[J,Q]=k.useState(!0),[X,ee]=k.useState(!0),[F,le]=k.useState(0),[re,j]=k.useState(0),[R,B]=k.useState("Curves smoothing"),[V,te]=k.useState("Time (min)"),[ke,_e]=k.useState("OD600 (blank-corrected)"),[ge,ye]=k.useState(1),[Ee,C]=k.useState("Log phase preview"),[we,he]=k.useState("Time (min)"),[Ce,Ae]=k.useState("ln(OD600)"),[be,qe]=k.useState(1),[Ie,ht]=k.useState(null),[yt,Pt]=k.useState(!0),[Fe,vt]=k.useState(!1),[jt,ft]=k.useState(!1),[kt,Se]=k.useState(!1),[ot,Xe]=k.useState(!1),[Rt,q]=k.useState([]),[oe,pe]=k.useState([]),[He,st]=k.useState(1),[_t,Lt]=k.useState(1),[xr,Qe]=k.useState("Legenda"),[rt,je]=k.useState("Legenda"),Be=k.useRef(null),Ve=k.useRef(null),[Kt,St]=k.useState(void 0),yr=k.useRef(null),Tt=k.useRef(null),at=k.useRef(null),rr=k.useRef(null),[er,hr]=k.useState(()=>{var L;return Ac((L=t==null?void 0:t.smoothed)==null?void 0:L.logPhases)}),[pr,Ht]=k.useState(null),[Ot,N]=k.useState(!1),[P,O]=k.useState((t==null?void 0:t.smoothed)??null),[I,W]=k.useState(null),[H,ce]=k.useState(null),[ve,Z]=k.useState(String(ta.windowSize)),[fe,de]=k.useState(String(ta.r2Min)),[Re,Ge]=k.useState(String(ta.odMin)),[Je,Ue]=k.useState(String(ta.fracKMax)),[U,ae]=k.useState(String(ta.muRelMin)),[me,Te]=k.useState(String(ta.muRelMax)),[Ye,wt]=k.useState(null),[We,ze]=k.useState(!1),ct=k.useRef(null),[ie,$e]=k.useState(!1),Ct=i?"Kliknij na prb lub uyj strzalek gra/d na klawiaturze, aby nawigowa. Moesz wybra faz log rcznie uywajc Shift.":"Click a sample or use Up/Down arrows to navigate. You can select the log phase manually using Shift.",Mt=k.useCallback(()=>{at.current!==null&&cancelAnimationFrame(at.current),at.current=requestAnimationFrame(()=>{const L=yr.current,ne=Tt.current;if(!L||!ne){St(void 0),at.current=null;return}const ue=L.getBoundingClientRect().top+window.scrollY,Le=ne.getBoundingClientRect().bottom+window.scrollY;if(!Number.isFinite(ue)||!Number.isFinite(Le)||Le<=ue){St(void 0),at.current=null;return}const lt=Math.max(Le-ue,240),ut=Math.round(lt);St(tt=>tt===ut?tt:ut),at.current=null})},[]);k.useEffect(()=>()=>{at.current!==null&&(cancelAnimationFrame(at.current),at.current=null)},[]);const Vt=k.useCallback(L=>{const ne=Object.entries(L);ne.length&&hr(ue=>{let Le=!1;const lt={...ue};return ne.forEach(([ut,tt])=>{tt?(lt[ut]=tt,Le=!0):lt[ut]&&(delete lt[ut],Le=!0)}),Le?lt:ue})},[hr]),Et=l[u]??null,Bt=k.useMemo(()=>{var ue,Le,lt;if(!Et)return"none";const L=(ue=Et.dataset)==null?void 0:ue.meta,ne=((lt=(Le=Et.dataset)==null?void 0:Le.rows)==null?void 0:lt.length)??0;return`${(L==null?void 0:L.runId)??""}|${(L==null?void 0:L.sourceFile)??""}|${(L==null?void 0:L.createdAt)??""}|${ne}`},[Et]);k.useEffect(()=>{le(L=>L+1)},[Bt]),k.useEffect(()=>{if(!Ie)return;const L=ne=>{ne.key==="Escape"&&(ne.preventDefault(),ht(null))};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[Ie]),k.useEffect(()=>{const L=ne=>{var lt;const ue=ne.target,Le=(lt=ue==null?void 0:ue.tagName)==null?void 0:lt.toLowerCase();Le&&["input","textarea","select"].includes(Le)||ue!=null&&ue.isContentEditable||ne.metaKey||ne.ctrlKey||ne.altKey||(ne.key==="r"||ne.key==="R")&&(ne.preventDefault(),le(ut=>ut+1),j(ut=>ut+1))};return window.addEventListener("keydown",L,{capture:!0}),()=>window.removeEventListener("keydown",L,{capture:!0})},[]),k.useEffect(()=>{if(!Ie)return;const L=ne=>{var lt;const ue=ne.target,Le=(lt=ue==null?void 0:ue.tagName)==null?void 0:lt.toLowerCase();Le&&["input","textarea","select"].includes(Le)||ue!=null&&ue.isContentEditable||ne.metaKey||ne.ctrlKey||ne.altKey||(ne.key==="r"||ne.key==="R")&&(ne.preventDefault(),le(ut=>ut+1),j(ut=>ut+1))};return window.addEventListener("keydown",L,{capture:!0}),()=>window.removeEventListener("keydown",L,{capture:!0})},[Ie]);const gr=k.useCallback((L,ne)=>La(L||ne)||La(ne)||"chart",[]),Gr=k.useCallback(async L=>{if(typeof window>"u")return null;const ne=L.current;if(!ne)return null;try{const Le=ne.querySelector("svg")??ne;return await Ly(Le,{scale:Math.min(3,Math.max(1.5,window.devicePixelRatio||2))})}catch(ue){return console.error("PNG export error",ue),M("[ERR] Eksport PNG nie powiodl sie."),null}},[M]),vn=k.useCallback(async(L,ne)=>{const ue=await Gr(L);if(!ue){M("[ERR] Nie udalo sie przygotowac PNG (sprobuj ponownie).");return}const Le=`${gr(ne,"chart")}.png`,lt=URL.createObjectURL(ue),ut=document.createElement("a");ut.href=lt,ut.download=Le,document.body.appendChild(ut),ut.click(),ut.remove(),URL.revokeObjectURL(lt)},[Gr,gr,M]),K=k.useCallback(async(L,ne)=>{const ue=await Gr(L);if(!ue){M("[ERR] Nie udalo sie skopiowac PNG (sprobuj ponownie).");return}if(typeof ClipboardItem<"u"&&navigator.clipboard&&"write"in navigator.clipboard)try{await navigator.clipboard.write([new ClipboardItem({"image/png":ue})]);return}catch{}const Le=`${gr(ne,"chart")}.png`,lt=URL.createObjectURL(ue),ut=document.createElement("a");ut.href=lt,ut.download=Le,document.body.appendChild(ut),ut.click(),ut.remove(),URL.revokeObjectURL(lt)},[Gr,gr,M]),xe=k.useMemo(()=>!e||!e.length?"":e.map(L=>{var ne,ue,Le,lt;return`${((ue=(ne=L==null?void 0:L.dataset)==null?void 0:ne.meta)==null?void 0:ue.runId)??"na"}|${((lt=(Le=L==null?void 0:L.dataset)==null?void 0:Le.rows)==null?void 0:lt.length)??0}|${B0(L)??0}`}).join("||"),[e]),Ne=((Mh=Et==null?void 0:Et.mapping)==null?void 0:Mh.samples)??[],Pe=((Rh=t==null?void 0:t.smoothed)==null?void 0:Rh.logPhases)??[],mt=Pe.length?Pe.map(L=>`${L.sample}:${L.start}:${L.end}`).join("|"):"",De=(Ih=Et==null?void 0:Et.dataset)==null?void 0:Ih.meta;`${(De==null?void 0:De.runId)??""}${(De==null?void 0:De.sourceFile)??""}${(De==null?void 0:De.plateId)??""}`;const pt=k.useMemo(()=>Object.entries(er).map(([L,ne])=>`${L}:${ne.start}:${ne.end}`).sort().join("|"),[er]),bt=k.useMemo(()=>Object.values(er),[pt]),xt=k.useMemo(()=>K3(d),[d]),cr=k.useMemo(()=>X3(d),[d]),wr=k.useCallback(L=>{var ut;if(!L)return null;const ne=(ut=L.logPhases)!=null&&ut.length?L.logPhases.map(tt=>J3(tt)):void 0,ue=Et&&Et.dataset?{...Et,dataset:{...Et.dataset,sample_curves:xt,well_curves:cr,log_phases:ne}}:null,Le=l.length&&(xt.length||cr.length||((ne==null?void 0:ne.length)??0))?l.map((tt,Gt)=>!(tt!=null&&tt.dataset)||Gt!==u?tt:{...tt,dataset:{...tt.dataset,sample_curves:xt,well_curves:cr,log_phases:ne}}):l,lt=Le.length?{version:(I==null?void 0:I.version)??5,createdAt:(I==null?void 0:I.createdAt)??new Date().toISOString(),blanked:(I==null?void 0:I.blanked)??!0,assignments:Le}:L;return{smoothed:L,assignment:ue,rawPayload:lt,blankedInfo:I??void 0,filename:G}},[Et,u,l,I,G,xt,cr]);k.useEffect(()=>{if(!d.length){O(null),r(null);return}const L=G3(d,De,x,y,G,xt,cr,bt.length?bt:void 0);if(!L){O(null),r(null);return}O(L);const ne=wr(L);r(ne)},[Et,u,De,l,I,d,y,G,bt,wr,xt,cr,r,x]);const yn=k.useMemo(()=>Ne.map(L=>{var ne;return`${(L==null?void 0:L.name)??""}|${((ne=L==null?void 0:L.wells)==null?void 0:ne.length)??0}`}).join(""),[Ne]),Wn=k.useMemo(()=>h.join(""),[h]),nn=k.useMemo(()=>{const L=Math.max(2,Math.round(zi(ve,ta.windowSize))),ne=zi(fe,ta.r2Min,!0),ue=zi(Re,ta.odMin),Le=zi(Je,ta.fracKMax,!0),lt=zi(U,ta.muRelMin),ut=zi(me,ta.muRelMax),tt=Math.min(.9999,Math.max(.1,ne)),Gt=Math.min(.95,Math.max(.05,Le)),At=Math.max(.1,lt),Qt=Math.max(At+.001,ut);return{windowSize:L,r2Min:tt,odMin:ue,fracKMax:Gt,muRelMin:At,muRelMax:Qt}},[ve,fe,Re,Je,U,me]),sr=k.useMemo(()=>{if(!h.length)return"";const L=new Set(d.map(ue=>ue.sample));return h.find(ue=>L.has(ue))??""},[d,Wn]);k.useEffect(()=>{if(!t){hr({});return}hr(Ac(Pe))},[mt]),k.useEffect(()=>{if(!sr){Ht(null),N(!1);return}const L=er[sr];L?(Ht({start:L.start,end:L.end}),N(!1)):(Ht(null),N(!1))},[sr,pt]),k.useEffect(()=>{if(!sr||!Ot)return;const L=jc(pr);L&&(hr(ne=>{const ue=ne[sr];return ue&&Math.abs(ue.start-L.start)<1e-9&&Math.abs(ue.end-L.end)<1e-9&&ue.manual?ne:{...ne,[sr]:{sample:sr,start:L.start,end:L.end,createdAt:(ue==null?void 0:ue.createdAt)??new Date().toISOString(),manual:!0}}}),N(!1))},[pr,Ot,sr,hr]);const mr=k.useMemo(()=>d.find(L=>L.sample===sr)??null,[d,sr]),da=((zh=mr==null?void 0:mr.history)==null?void 0:zh[mr.history.length-1])??null,Js=(((Lh=mr==null?void 0:mr.history)==null?void 0:Lh.length)??0)>1,gs=jc(pr??(sr?er[sr]??null:null)),vs=gs?[{start:gs.start,end:gs.end,color:"#facc15",opacity:.2}]:void 0,Ni=k.useMemo(()=>!mr||!da||!Js?[]:[{name:`${mr.sample} LOESS`,color:mr.color,points:da.points.map((L,ne)=>({x:L.x,y:Math.log(Math.max(1e-6,L.y)),id:`${mr.sample}|loess|${ne}`}))}],[mr,da,Js]),se=k.useMemo(()=>mr?[{name:`${mr.sample} raw`,color:mr.color,points:mr.rawPoints.map((L,ne)=>({x:L.x,y:Math.log(Math.max(1e-6,L.y)),id:`${mr.sample}|raw|${ne}`}))}]:[],[mr]),Me=k.useMemo(()=>[...Ni,...se],[Ni,se]),Oe=k.useMemo(()=>Me.map(L=>`${L.name}:${L.color}`).join("|"),[Me]),nt=k.useMemo(()=>Object.keys(er??{}).length,[er]);k.useEffect(()=>{pe(L=>{const ne=new Map(L.map(ue=>[ue.id,ue]));return Me.map(ue=>{const Le=ne.get(ue.name);return{id:ue.name,label:(Le==null?void 0:Le.label)??ue.name,color:ue.color,hidden:(Le==null?void 0:Le.hidden)??!1,kind:"series"}})})},[Oe,Me]);const et=k.useCallback((L,ne)=>{pe(ue=>ue.map(Le=>Le.id===L?{...Le,label:ne}:Le))},[]),gt=k.useCallback(L=>{pe(ne=>ne.map(ue=>ue.id===L?{...ue,hidden:!ue.hidden}:ue))},[]),Dt=k.useMemo(()=>new Set(oe.filter(L=>L.hidden).map(L=>L.id)),[oe]),Nt=k.useMemo(()=>Ni.filter(L=>!Dt.has(L.name)),[Ni,Dt]),it=k.useMemo(()=>X?se.filter(L=>!Dt.has(L.name)):[],[se,X,Dt]),Ft=k.useCallback(({points:L})=>{if(!(L!=null&&L.length))return;const ne=L.map(ue=>{var Le;return(Le=ue.point)==null?void 0:Le.x}).filter(ue=>Number.isFinite(ue));ne.length&&(Ht({start:Math.min(...ne),end:Math.max(...ne)}),N(!0))},[]),Ut=k.useCallback(()=>{if(!sr)return;const L=jc(pr);L&&(hr(ne=>({...ne,[sr]:{sample:sr,start:L.start,end:L.end,createdAt:new Date().toISOString(),manual:!0}})),N(!1))},[pr,sr]),Jt=k.useCallback(()=>{sr&&(hr(L=>{if(!L[sr])return L;const ne={...L};return delete ne[sr],ne}),Ht(null),N(!1))},[sr]),nr=!!(sr&&jc(pr)),$t=!!(sr&&er[sr]),Zt=k.useCallback(()=>{if(!d.length){M("[WARN] Brak danych do ponownego wykrycia fazy log.");return}const L=new Date().toISOString(),ne=U0(d,d.map(Le=>Le.sample),L,nn,er,!1);Vt(ne),N(!1);const ue=Object.values(ne).filter(Boolean).length;M(`[OK] Przeliczono faz log dla ${ue}/${d.length} prb.`)},[Vt,d,nn,er]),qt=k.useCallback(()=>{var Qt,ir,Xt;if(!P){M("[WARN] Brak danych smoothed do eksportu.");return}if(!(Et!=null&&Et.dataset)){M("[WARN] Brak danych blankowanych do eksportu fazy log.");return}const L=((Qt=P.source)==null?void 0:Qt.file)||((ir=P.source)==null?void 0:ir.runId)||G||"curves",ue=`${La(L.replace(/\.[^/.]+$/,"")||"curves")}-log-phases.json`,Le=bt.map(zt=>{var wn,ys;const ur=P.samples.find(Gn=>Gn.sample===zt.sample),Sr=(wn=ur==null?void 0:ur.history)==null?void 0:wn[ur.history.length-1],Rn=Math.min(zt.start,zt.end),Wr=Math.max(zt.start,zt.end),qa=((ys=Sr==null?void 0:Sr.points)==null?void 0:ys.filter(Gn=>Number.isFinite(Gn.x)&&Number.isFinite(Gn.y)&&Gn.x>=Rn&&Gn.x<=Wr).map(Gn=>({t_min:Number(Gn.x),od600:Number(Gn.y)})))??[];return qa.length?{...zt,points:qa}:{...zt,points:void 0}}),lt=((Xt=Et.dataset.rows)==null?void 0:Xt.map(zt=>{var Sr;if(!((Sr=zt==null?void 0:zt.curation)!=null&&Sr.excluded))return zt;const ur={...zt};return Object.prototype.hasOwnProperty.call(ur,"val_od600_blank_corrected")&&delete ur.val_od600_blank_corrected,ur}))??Et.dataset.rows,ut={...Et.dataset,rows:lt,sample_curves:xt,log_phases:Le.length?Le.map(zt=>({...zt})):void 0},tt=l.map((zt,ur)=>!zt||ur!==u?zt:{...zt,dataset:ut}),Gt={version:(I==null?void 0:I.version)??5,createdAt:(I==null?void 0:I.createdAt)??new Date().toISOString(),blanked:(I==null?void 0:I.blanked)??!0,assignments:tt,logPhases:Le.length?Le:void 0},At=new Blob([JSON.stringify(Gt,null,2)],{type:"application/json;charset=utf-8"});vl(At,ue),M(`[FILE] Wyeksportowano ${ue}`)},[Et,u,l,I,G,bt,er,xt,P]),kr=k.useCallback(()=>{var ue;const L=wr(P);if(!L){M("[WARN] Brak wygadzonych danych do przesania do Parameters.");return}r(L),n("parameters");const ne=Array.isArray((ue=L.rawPayload)==null?void 0:ue.assignments)?L.rawPayload.assignments.length:0;M(`[OK] Przekazano dane do Parameters (${ne} assignment).`)},[wr,n,r,P]),Pr=k.useCallback(async L=>{var ue,Le;if(!(L!=null&&L.length))return;const ne=L[0];try{const lt=await ne.text(),ut=JSON.parse(lt);if(!((ue=ut.assignments)!=null&&ue.length)){o([]),p([]),m([]),M("[WARN] Wskazany plik nie zawiera danych blankowanych."),Y(ne.name),W(null);return}W({version:ut.version,createdAt:ut.createdAt,blanked:ut.blanked??!0}),o(ut.assignments),f(0),Y(ne.name);const tt=D0(ut.assignments[0]);p(tt);const Gt=((Le=tt[0])==null?void 0:Le.sample)??null;m(Gt?[Gt]:[]),wt(Gt),hr({}),Ht(null);const At=B0(ut.assignments[0]);M(`[OK] Wczytano ${ne.name} (${ut.assignments.length} assignment${ut.assignments.length>1?"s":""}). Prby z danymi: ${tt.length}/${At}.`)}catch(lt){console.error(lt),M(`[ERR] Nie udao si wczyta pliku: ${(lt==null?void 0:lt.message)??String(lt)}`)}},[]);k.useEffect(()=>{var ut,tt,Gt;if(!e||!e.length)return;o(e),f(0);const L=D0(e[0]);p(L);const ne=((ut=L[0])==null?void 0:ut.sample)??null;m(ne?[ne]:[]),wt(ne),hr(Ac(Pe)),Ht(null),W(null);const ue=(Gt=(tt=e[0])==null?void 0:tt.dataset)==null?void 0:Gt.meta,Le=(ue==null?void 0:ue.sourceFile)||(ue==null?void 0:ue.runId)||"assignment";Y(`[auto] ${Le}`);const lt=B0(e[0]);M(i?`[AUTO] Dane z Blank Correction (${L.length}/${lt||L.length} prb).`:`[AUTO] Data from Blank Correction (${L.length}/${lt||L.length} samples).`)},[xe]),k.useEffect(()=>{var Le,lt,ut,tt,Gt;if(d.length||!((lt=(Le=t==null?void 0:t.smoothed)==null?void 0:Le.samples)!=null&&lt.length))return;const L=V3(t.smoothed);if(!L.length)return;p(L);const ne=((ut=L[0])==null?void 0:ut.sample)??null;m(ne?[ne]:[]),wt(ne),hr(Ac(t.smoothed.logPhases)),Ht(null),v(String(((tt=t.smoothed.smoothing)==null?void 0:tt.span)??x)),w(((Gt=t.smoothed.smoothing)==null?void 0:Gt.degree)??y);const ue=t.filename||t.smoothed.source.file||t.smoothed.source.runId;ue&&Y(ue)},[d.length,t,x,y]);const $r=k.useCallback(L=>{var Le;if(!l[L])return;f(L);const ne=D0(l[L]);p(ne);const ue=((Le=ne[0])==null?void 0:Le.sample)??null;m(ue?[ue]:[]),wt(ue)},[l]),Mr=k.useCallback(L=>{m(ne=>ne.length===1&&ne[0]===L?[]:[L]),wt(ne=>ne===L?null:L),le(ne=>ne+1),j(ne=>ne+1)},[]),Hn=k.useCallback(L=>{L&&(m([L]),wt(L),le(ne=>ne+1),j(ne=>ne+1))},[]),un=k.useMemo(()=>d.filter(L=>h.includes(L.sample)),[d,h]);k.useMemo(()=>new Map(d.map(L=>[L.sample,L.color])),[d]);const Nr=k.useMemo(()=>d.map(L=>L.sample),[d]),qn=k.useCallback(L=>{if(!Nr.length)return;const ne=(h[0]&&Nr.includes(h[0])?h[0]:Nr[0])??Nr[0],ue=(Ye&&Nr.includes(Ye)?Ye:ne)??Nr[0],lt=(Math.max(0,Nr.indexOf(ue))+L+Nr.length)%Nr.length,ut=Nr[lt];Hn(ut)},[Ye,Nr,Hn,h]);k.useEffect(()=>{const L=ne=>{const ue=ne.target;if(!(ue&&(ue.tagName==="INPUT"||ue.tagName==="TEXTAREA"||ue.tagName==="SELECT"||ue.isContentEditable))&&(ne.key==="ArrowDown"||ne.key==="ArrowUp")){ne.preventDefault(),qn(ne.key==="ArrowDown"?1:-1);return}};return window.addEventListener("keydown",L,{capture:!0}),()=>window.removeEventListener("keydown",L,{capture:!0})},[qn]),k.useEffect(()=>{if(!d.length){wt(null);return}(!Ye||!Nr.includes(Ye))&&wt(Nr[0]??null)},[Ye,Nr]);const Vn=k.useMemo(()=>un.flatMap(L=>{if(L.history.length<=1)return[];const ne=L.history[L.history.length-1];return[{name:`${L.sample}  ${ne.label}`,color:L.color,points:ne.points.map(ue=>({x:ue.x,y:ue.y}))}]}),[un]),Ai=k.useMemo(()=>un.flatMap(L=>L.wells.map(ne=>({name:`${L.sample} ${ne.well}`,color:ne.color,points:ne.points}))),[un]);k.useEffect(()=>{Ye&&(h.includes(Ye)||(m([Ye]),le(L=>L+1),j(L=>L+1)))},[Ye,h,m]);const Jo=k.useMemo(()=>{const L=[...Vn];return J&&Ai.forEach(ne=>L.push(ne)),L},[J,Vn,Ai]),Gy=k.useMemo(()=>Jo.map(L=>`${L.name}:${L.color}`).join("|"),[Jo]);k.useEffect(()=>{q(L=>{const ne=new Map(L.map(ue=>[ue.id,ue]));return Jo.map(ue=>{const Le=ne.get(ue.name);return{id:ue.name,label:(Le==null?void 0:Le.label)??ue.name,color:ue.color,hidden:(Le==null?void 0:Le.hidden)??!1,kind:"series"}})})},[Gy,Jo]);const Ky=k.useCallback((L,ne)=>{q(ue=>ue.map(Le=>Le.id===L?{...Le,label:ne}:Le))},[]),Xy=k.useCallback(L=>{q(ne=>ne.map(ue=>ue.id===L?{...ue,hidden:!ue.hidden}:ue))},[]),Qo=k.useMemo(()=>new Set(Rt.filter(L=>L.hidden).map(L=>L.id)),[Rt]),Yy=k.useMemo(()=>Vn.filter(L=>!Qo.has(L.name)),[Vn,Qo]),Jy=k.useMemo(()=>J?Ai.filter(L=>!Qo.has(L.name)):[],[Ai,J,Qo]),an=d.length>0;h.length>0;const Qy=un.some(L=>L.history.length>1);k.useLayoutEffect(()=>{Mt()},[Mt,an,mr,Ie,yt,d.length,Nr.length,kt,ot,ge,be]),k.useEffect(()=>{const L=()=>Mt();return L(),window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[Mt]),k.useEffect(()=>{const L=Tt.current;if(!L||typeof ResizeObserver>"u"){Mt();return}const ne=new ResizeObserver(()=>Mt());return ne.observe(L),Mt(),()=>ne.disconnect()},[Mt,an,mr]);const Qs=k.useMemo(()=>{const L=Ne.filter(ue=>{var Le;return(((Le=ue==null?void 0:ue.wells)==null?void 0:Le.length)??0)>0}).map(ue=>{var Le;return(Le=ue==null?void 0:ue.name)==null?void 0:Le.trim()}).filter(ue=>!!ue);if(!L.length)return[];const ne=new Set(d.map(ue=>ue.sample));return L.filter(ue=>!ne.has(ue))},[d,yn]),Cl=k.useCallback((L,ne)=>{if(!(L!=null&&L.length))return null;const ue=Math.max(1,b),Le=Math.max(1,Math.round(g));let lt=null,ut=null;for(let tt=0;tt<ue;tt+=1){const Gt=L3(L,{span:ne,degree:y,robustIters:Le});if(ut=Gt,lt&&Gt.points.length===lt.length&&Gt.points.reduce((Qt,ir,Xt)=>{const zt=lt?lt[Xt]:null;return zt?Math.max(Qt,Math.abs(ir.y-zt.y)):Qt},0)<=_)return{result:Gt,loops:tt+1,converged:!0};lt=Gt.points.map(At=>({x:At.x,y:At.y}))}return ut?{result:ut,loops:ue,converged:!1}:null},[_,y,b,g]),Ju=k.useMemo(()=>{if(A==="none")return[];const L=tt=>{if(tt<=1)return 1;let Gt=1;for(let At=2;At<=tt;At+=1)Gt*=At;return Gt},ne=tt=>{if(!Number.isFinite(tt)||tt<=0)return[];const Gt=[],At=(ir,Xt,zt)=>{if(ir===tt-1){Gt.push([...zt,Xt]);return}for(let ur=0;ur<=Xt;ur+=1)At(ir+1,Xt-ur,[...zt,ur])};At(0,tt,[]);const Qt=Math.pow(tt,tt);return Gt.map(ir=>{var ur;const Xt=((ur=ir==null?void 0:ir.reduce)==null?void 0:ur.call(ir,(Sr,Rn)=>Sr*L(Rn),1))??1,zt=L(tt)/Xt/Qt;return{counts:ir,weight:zt}})},ue=(tt,Gt,At)=>{var ur;if(!tt.length)return NaN;const Qt=tt.map((Sr,Rn)=>({v:Sr,w:Gt[Rn]??0})).filter(Sr=>Number.isFinite(Sr.v)&&Sr.w>0).sort((Sr,Rn)=>Sr.v-Rn.v);if(!Qt.length)return NaN;const ir=Qt.reduce((Sr,Rn)=>Sr+Rn.w,0);if(!(ir>0))return((ur=Qt[Math.floor(At/100*Qt.length)])==null?void 0:ur.v)??NaN;const Xt=At/100*ir;let zt=0;for(const Sr of Qt)if(zt+=Sr.w,zt>=Xt)return Sr.v;return Qt[Qt.length-1].v},Le=(tt,Gt)=>{if(!tt.length)return Gt.map(()=>NaN);const At=[...tt].sort((Qt,ir)=>Qt.x-ir.x);return Gt.map(Qt=>{if(Qt<=At[0].x)return At[0].y;if(Qt>=At[At.length-1].x)return At[At.length-1].y;for(let ir=0;ir<At.length-1;ir+=1){const Xt=At[ir],zt=At[ir+1];if(Qt>=Xt.x&&Qt<=zt.x){const ur=(Qt-Xt.x)/(zt.x-Xt.x);return Xt.y*(1-ur)+zt.y*ur}}return At[At.length-1].y})},lt=Number(x)||U3;return un.map(tt=>{var ys,Gn;const Gt=tt.wells??[],At=Gt.length;if(At<2)return null;const Qt=Array.from(new Set(Gt.flatMap(_r=>_r.points.map(Ar=>Number(Ar.x??0))).filter(_r=>Number.isFinite(_r)))).sort((_r,Ar)=>_r-Ar);if(!Qt.length)return null;const ir=Cl(tt.rawPoints,lt);if(!((Gn=(ys=ir==null?void 0:ir.result)==null?void 0:ys.points)!=null&&Gn.length))return null;const Xt=Le(ir.result.points,Qt),zt=ne(At);if(!zt.length)return null;const ur=Qt.map(()=>[]),Sr=Qt.map(()=>[]),Rn=[],Wr=[];zt.forEach(({counts:_r,weight:Ar})=>{var ha,Fi;if(!(Ar>0))return;const Rr=Array.isArray(_r)?[..._r]:[];for(;Rr.length<At;)Rr.push(0);if(!Rr.length||Rr.every(Zs=>!Zs))return;const ea=[];if(Rr.forEach((Zs,Mi)=>{var Oh;const Zu=((Oh=Gt[Mi])==null?void 0:Oh.points)??[],vw=Math.max(0,Number(Zs)||0);for(let Ph=0;Ph<vw;Ph+=1)Zu.forEach(Dh=>{ea.push({x:Number(Dh.x??0),y:Number(Dh.y??0)})})}),!ea.length)return;const Ua=Cl(ea,lt);if(!((Fi=(ha=Ua==null?void 0:Ua.result)==null?void 0:ha.points)!=null&&Fi.length))return;const ji=Le(Ua.result.points,Qt);ji.forEach((Zs,Mi)=>{ur[Mi].push(Zs),Sr[Mi].push(Ar)});const qo=ji.reduce((Zs,Mi,Zu)=>Math.max(Zs,Math.abs(Mi-(Xt[Zu]??0))),0);Rn.push(qo),Wr.push(Ar)});let qa=[];if(A==="pointwise")qa=Qt.map((_r,Ar)=>{const Rr=ur[Ar],ea=Sr[Ar];if(!Rr.length)return{x:_r,low:Xt[Ar]??NaN,high:Xt[Ar]??NaN};const Ua=ue(Rr,ea,2.5),ji=ue(Rr,ea,97.5);return{x:_r,low:Ua,high:ji}});else{const _r=ue(Rn,Wr,95);qa=Qt.map((Ar,Rr)=>({x:Ar,low:(Xt[Rr]??0)-_r,high:(Xt[Rr]??0)+_r}))}let wn=qa.filter(_r=>Number.isFinite(_r.low)&&Number.isFinite(_r.high)&&Number.isFinite(_r.x));if(!wn.length){const _r=Gt.map(Ar=>Le(Ar.points??[],Qt));_r.length>=2&&(wn=Qt.map((Ar,Rr)=>{const ea=_r.map(ha=>ha==null?void 0:ha[Rr]).filter(ha=>Number.isFinite(ha));if(ea.length<2)return null;const Ua=ea.reduce((ha,Fi)=>ha+Fi,0)/ea.length,ji=ea.length>1?ea.reduce((ha,Fi)=>ha+(Fi-Ua)**2,0)/(ea.length-1):0,qo=Math.sqrt(Math.max(0,ji));return{x:Ar,low:Ua-qo,high:Ua+qo}}).filter(Ar=>!!Ar))}return wn.length||(wn=Qt.map((_r,Ar)=>{const Rr=Xt[Ar];return Number.isFinite(Rr)?{x:_r,low:Rr,high:Rr}:null}).filter(_r=>!!_r)),wn.length?{name:tt.sample,color:tt.color,points:wn}:null}).filter(tt=>!!tt)},[A,un,Cl,x]),bh=k.useMemo(()=>A==="none"||!an?"":un.some(ne=>{var ue;return(((ue=ne.wells)==null?void 0:ue.length)??0)>=2})?Ju.length?"":"Brak danych do pasma (sprawd punkty lub span). Jeeli pasmo si nie pojawia, uywam fallbacku SD.":"Pasma wymagaj dokw/replikatw w prbie.",[A,an,un,Ju.length]),Tl=k.useCallback(async L=>{var ne,ue;ze(!0),ce(0);try{if(await new Promise(Wr=>setTimeout(Wr,16)),!d.length){M("[WARN] Wczytaj najpierw plik .blanked.json.");return}const Le=L==="all"?d.map(Wr=>Wr.sample):h;if(!Le.length){M("[WARN] Zaznacz co najmniej jedna probe.");return}const lt=Number(x);if(!Number.isFinite(lt)||lt<=0){M("[ERR] Podaj poprawny rozmiar okna (liczba dodatnia).");return}let ut=0,tt=0;const Gt=new Set(Le),At=new Set,Qt=new Date().toISOString(),ir=Le.length||1,Xt=[];for(const Wr of d){if(!Gt.has(Wr.sample)){Xt.push(Wr);continue}const qa=(ne=Wr.rawPoints)!=null&&ne.length?Wr.rawPoints:((ue=Wr.history[0])==null?void 0:ue.points)??[];if(!qa.length){Xt.push(Wr);continue}const wn=Cl(qa,lt);if(!wn){Xt.push(Wr);continue}const ys=wn.result;ut+=1,At.add(Wr.sample),tt+=wn.loops;const Gn=wn.loops>1?` (passes: ${wn.loops}${wn.converged?" ":""})`:"",_r={label:`LOESS span ${lt}${Gn}`,points:ys.points.map(Rr=>({x:Rr.x,y:Rr.y})),diagnostics:ys.diagnostics},Ar=Wr.history.length?[...Wr.history]:Wr.history;Xt.push({...Wr,history:[...Ar,_r]}),ce(Math.min(100,Math.round(ut/ir*100))),await new Promise(Rr=>setTimeout(Rr,0))}if(!ut){M("[INFO] Brak punktw do wygadzania (za mao danych?).");return}const zt=U0(Xt,At,Qt,nn,er,!0);p(Xt),Vt(zt);const ur=(tt/Math.max(1,ut)).toFixed(2),Sr=Object.values(zt).filter(Boolean).length,Rn=At.size?i?` Auto faza log: ${Sr}/${At.size} prbek.`:` Auto log phase: ${Sr}/${At.size} samples.`:"";M(i?`[OK] Zastosowano LOESS dla ${ut} prb (rednio ${ur} przej).${Rn}`:`[OK] Applied LOESS for ${ut} samples (avg ${ur} passes).${Rn}`),ce(100)}finally{ze(!1),setTimeout(()=>ce(null),500)}},[Vt,d,i,nn,er,Cl,h,x]);k.useEffect(()=>{We||!an||d.some(ne=>{var ue;return(((ue=ne.history)==null?void 0:ue.length)??0)>1})||Tl("all")},[Tl,d,an,We]);const Zy=k.useCallback(()=>{if(!h.length){M("[WARN] Wybierz prb, aby cofn wygadzanie.");return}let L=0;const ne=new Set(h),ue=new Set,Le=new Date().toISOString(),lt=d.map(At=>!ne.has(At.sample)||At.history.length<=1?At:(L+=1,ue.add(At.sample),{...At,history:At.history.slice(0,-1)}));if(!L){M("[INFO] Brak wczeniejszej wersji krzywej dla wybranych prb.");return}const ut=U0(lt,ue,Le,nn,er,!0);p(lt),Vt(ut);const tt=Object.values(ut).filter(Boolean).length,Gt=ue.size?` Auto log phase: ${tt}/${ue.size} samples.`:"";M(`[OK] Przywrcono poprzedni stan dla ${L} prb.${Gt}`)},[Vt,d,nn,er,h]);k.useEffect(()=>{!a||a.stage!=="loessQueued"||!l.length||!d.length||We||(async()=>await Tl("all"))()},[Tl,l.length,a,d.length,We]),k.useEffect(()=>{!a||a.stage!=="loessQueued"||We||nt!==0&&s({stage:"waitingParameters",error:null})},[a,We,nt,s]),k.useEffect(()=>{!a||a.stage!=="waitingParameters"||We||!P||!(P!=null&&P.logPhases&&Object.keys(P.logPhases).length||nt>0)||(kr(),s({stage:"done",error:null}))},[a,kr,We,s,P,nt]);const qy=k.useCallback(()=>{var At,Qt,ir;if(!(Et!=null&&Et.dataset)){M("[WARN] Brak danych blankowanych do eksportu.");return}if(!xt.length){M("[WARN] Brak wygadzonych krzywych do eksportu.");return}const L=((At=Et.dataset.rows)==null?void 0:At.map(Xt=>{var ur;if(!((ur=Xt==null?void 0:Xt.curation)!=null&&ur.excluded))return Xt;const zt={...Xt};return Object.prototype.hasOwnProperty.call(zt,"val_od600_blank_corrected")&&delete zt.val_od600_blank_corrected,zt}))??Et.dataset.rows,ne={...Et.dataset,rows:L,sample_curves:xt,well_curves:cr},ue=l.map((Xt,zt)=>!Xt||zt!==u?Xt:{...Xt,dataset:ne}),Le={version:(I==null?void 0:I.version)??5,createdAt:(I==null?void 0:I.createdAt)??new Date().toISOString(),blanked:(I==null?void 0:I.blanked)??!0,assignments:ue},lt=((Qt=Et.dataset.meta)==null?void 0:Qt.sourceFile)||((ir=Et.dataset.meta)==null?void 0:ir.runId)||G||"assignment",tt=`${La(lt.replace(/\.[^/.]+$/,"")||"assignment")}-smoothed.json`,Gt=new Blob([JSON.stringify(Le,null,2)],{type:"application/json;charset=utf-8"});vl(Gt,tt),M(`[FILE] Wyeksportowano ${tt}`)},[Et,u,l,I,G,xt,cr]),ew=i?"W przyszoci zostanie dodanych wicej algorytmw wygadzania. Ten etap jest kluczowy dla uzyskania niektrych z biologicznych parametrw wzrostu, do ktrych bdziesz mia dostp w nastpnej karcie.":"More smoothing algorithms will be added in the future. This step is crucial for obtaining some of the biological growth parameters that you will have access to in the next tab.",tw=i?"W rnych okolicznociach inne algorytmy wygadzania mog by bardziej odpowiednie. Inne algorytmy oraz zalecenia ich uycia zostan dodane w przyszoci. Dla dobrego dopasowania polecam zmniejszy wielko okna (span) i zwikszy liczb iteracji odpornych na odchylenia (robust). Lokalny model liniowy zdaje si dziaa lepiej ni paraboliczny dla krzywych, ktre sprawdzaem.":"In different circumstances, other smoothing algorithms may be more appropriate. Other algorithms and recommendations for their use will be added in the future. For a good fit, I recommend decreasing the window size (span) and increasing the number of robust iterations. The local linear model seems to work better than the parabolic one for the curves I have tested.",Zo=i?"Steruj tytulem, osiami i skala czcionki. Reset przywraca domyslny zoom/pan.":"Control title, axes, and font scale. Reset restores the default zoom/pan.",rw=i?"Wykres wygadzonych krzywych z zoom/pan, legenda i eksportem PNG. Pelny ekran daje wicej miejsca na analize.":"Smoothed curves chart with zoom/pan, legend, and PNG export. Fullscreen gives more room to analyze.",nw=i?"Podgld fazy log aktywnej prby; zaznacz zakres, uywaj legendy i eksportu, by udostpnia widok.":"Log-phase preview of the active sample; mark the range, use legend and export to share the view.",aw=i?"Automatyczne wykrywanie fazy log dla niektrych krzywych moe by trudne. Upewnij si, e twoje krzywe maj faz lag  wykresy nie zaczynaj si od trwajcej ju fazy logarytmicznej. Sprawd wykres i oce, czy faza log w ogle moe zosta wyodrbniona. Jeeli algorytm nie wykrywa fazy log tam, gdzie j widzisz, moesz rcznie zaznaczy zakres na wykresach poniej.":"Automatic log-phase detection for some curves can be challenging. Ensure that your curves have a lag phase - the plots do not start in an ongoing logarithmic phase. Check the chart and assess whether the log phase can be extracted at all. If the algorithm does not detect the log phase where you see it, you can manually mark the range on the charts below.",Ch=i?"Sprawd czy wygadzona krzywa jest dobrze dopasowana do danych i czy fazy log s poprawnie wykryte.":"Check if the smoothed curve is well-fitted to the data and if log phases are correctly detected.",sw=i?"Warto pomidzy 0-1 oznacza procent punktw w oknie; liczba cakowita to dugosc okna w punktach.":"A value between 0-1 is the fraction of points in the window; an integer is the window length in points.",iw=i?"Stopien lokalnego wielomianu: 1 = linia, 2 = parabola.":"Degree of the local polynomial: 1 = line, 2 = parabola.",lw=i?"Liczba iteracji odpornych na odchylenia w trakcie wygadzania.":"Number of robust iterations during smoothing.",ow=i?"Maksymalna liczba kolejnych przebiegw wygadzania.":"Maximum number of successive smoothing re-runs.",cw=i?"Prg zatrzymania: maksymalne |dy| pomiedzy przebiegami.":"Stop threshold: maximum |dy| between iterations.",uw=i?"Liczba punktw w oknie regresji liniowej podczas automatycznego wykrywania.":"Number of points in the linear regression window used for auto-detection.",fw=i?"Minimalny wspczynnik R wymagany dla dopasowania okna.":"Minimum R required for the window fit.",dw=i?"Dolny prg OD; poniej niego punkty s pomijane przy wykrywaniu fazy log.":"Lower OD threshold; points below are skipped during log-phase detection.",hw=i?"Maksymalny udzia fragmentw plateau; odcina wartoci powyej tego progu.":"Maximum share of plateau segments; cuts off values above this threshold.",pw=i?"Dolna granica /max (tempo wzrostu) akceptowalna dla fazy log.":"Lower bound of /max (growth rate) acceptable for log phase.",mw=i?"Grna granica /max; odcina fragmenty o nachyleniu wyszym ni podane  w wikszoci krzywych moesz pomin.":"Upper bound of /max; cuts off segments with a slope higher than given; can be skipped for most curves.",Th=kt?c.jsxs("div",{className:"legend-editor panel-soft",children:[c.jsxs("div",{className:"legend-editor__header",children:[c.jsxs("div",{children:[c.jsx("div",{className:"legend-editor__title",children:xr||"Legenda"}),c.jsx("div",{className:"legend-editor__subtitle",children:"Ukryj lub zmien nazwy elementow legendy. Ukrycie nie usuwa serii z wykresu."}),c.jsxs("label",{className:"field",style:{marginTop:6},children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:"Tytul legendy"})}),c.jsx("input",{className:"field-input",value:xr,onChange:L=>Qe(L.target.value),placeholder:"Legenda"})]})]}),c.jsxs("div",{className:"legend-editor__font",children:[c.jsx("span",{children:"Rozmiar legendy"}),c.jsxs("div",{className:"btn-pair",children:[c.jsx("button",{type:"button",className:"btn",onClick:()=>st(L=>Math.max(.6,+(L-.1).toFixed(1))),children:"A-"}),c.jsx("button",{type:"button",className:"btn",onClick:()=>st(L=>Math.min(2,+(L+.1).toFixed(1))),children:"A+"})]})]})]}),c.jsx("div",{className:"legend-editor__list",children:Rt.map(L=>c.jsxs("div",{className:"legend-editor__row",children:[c.jsxs("label",{className:"legend-editor__checkbox",children:[c.jsx("input",{type:"checkbox",checked:!L.hidden,onChange:()=>Xy(L.id)}),c.jsx("span",{children:"Pokaz"})]}),c.jsx("div",{className:"legend-editor__swatch",style:{background:L.color,borderColor:"transparent"}}),c.jsx("input",{className:"legend-editor__input",value:L.label,onChange:ne=>Ky(L.id,ne.target.value)})]},L.id))})]}):null,Nh=ot?c.jsxs("div",{className:"legend-editor panel-soft",children:[c.jsxs("div",{className:"legend-editor__header",children:[c.jsxs("div",{children:[c.jsx("div",{className:"legend-editor__title",children:rt||"Legenda"}),c.jsx("div",{className:"legend-editor__subtitle",children:"Ukryj lub zmien nazwy elementow legendy. Ukrycie nie usuwa serii z wykresu."}),c.jsxs("label",{className:"field",style:{marginTop:6},children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:"Tytul legendy"})}),c.jsx("input",{className:"field-input",value:rt,onChange:L=>je(L.target.value),placeholder:"Legenda"})]})]}),c.jsxs("div",{className:"legend-editor__font",children:[c.jsx("span",{children:"Rozmiar legendy"}),c.jsxs("div",{className:"btn-pair",children:[c.jsx("button",{type:"button",className:"btn",onClick:()=>Lt(L=>Math.max(.6,+(L-.1).toFixed(1))),children:"A-"}),c.jsx("button",{type:"button",className:"btn",onClick:()=>Lt(L=>Math.min(2,+(L+.1).toFixed(1))),children:"A+"})]})]})]}),c.jsx("div",{className:"legend-editor__list",children:oe.map(L=>c.jsxs("div",{className:"legend-editor__row",children:[c.jsxs("label",{className:"legend-editor__checkbox",children:[c.jsx("input",{type:"checkbox",checked:!L.hidden,onChange:()=>gt(L.id)}),c.jsx("span",{children:"Pokaz"})]}),c.jsx("div",{className:"legend-editor__swatch",style:{background:L.color,borderColor:"transparent"}}),c.jsx("input",{className:"legend-editor__input",value:L.label,onChange:ne=>et(L.id,ne.target.value)})]},L.id))})]}):null,Ah=k.useCallback(()=>c.jsx(fx,{title:i?"Sterowanie wykresem w skali OD600":"Plot Controls (OD600 Scale)",helpContent:Zo,chartTitle:R,onChartTitleChange:B,xLabel:V,onXLabelChange:te,yLabel:ke,onYLabelChange:_e,fontScale:ge,onFontScaleChange:ye,legendOpen:kt,onToggleLegend:()=>Se(L=>!L),legendPanel:Th,onExportPng:()=>vn(Be,R||"curves-smoothing"),onCopyPng:()=>K(Be,R||"curves-smoothing"),onResetView:()=>le(L=>L+1),isPl:i,disabled:!an,extraActions:c.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[c.jsxs("label",{className:`parameters-toggle ${J?"is-on":""}`,title:J?i?"Ukryj punkty surowe":"Hide raw points":i?"Pokaz punkty surowe":"Show raw points",children:[c.jsx("input",{type:"checkbox",checked:J,onChange:()=>Q(L=>!L),disabled:!an}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:J?i?"Ukryj punkty surowe":"Hide raw points":i?"Pokaz punkty surowe":"Show raw points"})]}),c.jsxs("label",{className:`parameters-toggle ${A!=="none"?"is-on":""}`,children:[c.jsx("input",{type:"checkbox",checked:A!=="none",onChange:L=>z(L.target.checked?"pointwise":"none"),disabled:!an}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:i?"Przedzial ufnosci":"Bands"})]}),c.jsxs("div",{className:"field small",style:{display:"flex",gap:6,alignItems:"center"},children:[c.jsx("label",{className:"small",children:i?"Typ":"Type"}),c.jsxs("select",{value:A,onChange:L=>z(L.target.value),disabled:!an||A==="none",children:[c.jsx("option",{value:"pointwise",children:i?"Punktowy 95% CI":"Pointwise 95% CI"}),c.jsx("option",{value:"simultaneous",children:i?"95% CI dla krzywej":"Simultaneous 95% band"})]})]})]})}),[Th,kt,R,V,ke,Be,J,A,K,vn,an,Zo,le,ye,Se,Q,z,B,te,_e]),jh=k.useCallback(()=>c.jsx(fx,{title:i?"Sterowanie wykresem w skali logarytmicznej":"Plot Controls (Log Scale)",helpContent:Zo,chartTitle:Ee,onChartTitleChange:C,xLabel:we,onXLabelChange:he,yLabel:Ce,onYLabelChange:Ae,fontScale:be,onFontScaleChange:qe,legendOpen:ot,onToggleLegend:()=>Xe(L=>!L),legendPanel:Nh,onExportPng:()=>vn(Ve,Ee||"log-phase"),onCopyPng:()=>K(Ve,Ee||"log-phase"),onResetView:()=>j(L=>L+1),isPl:i,disabled:!mr,extraActions:c.jsxs("label",{className:`parameters-toggle ${X?"is-on":""}`,title:X?i?"Ukryj punkty surowe":"Hide raw points":i?"Pokaz punkty surowe":"Show raw points",children:[c.jsx("input",{type:"checkbox",checked:X,onChange:()=>ee(L=>!L),disabled:!mr}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:X?i?"Ukryj punkty surowe":"Hide raw points":i?"Pokaz punkty surowe":"Show raw points"})]})}),[mr,K,vn,Ve,Nh,ot,X,Ee,we,Ce,Zo,j,qe,Xe,ee,C,he,Ae]),Qu=k.useCallback((L,ne)=>c.jsxs("div",{ref:L?yr:null,className:"replicate-panel replicate-panel--single-toggle",style:{display:"flex",flexDirection:"column",alignSelf:"stretch",minHeight:0,maxHeight:L?Kt:void 0,...ne},tabIndex:0,children:[c.jsx("button",{ref:ct,type:"button",className:"help-btn circle replicate-panel__help-btn","aria-expanded":ie,"aria-label":i?"Pokaz pomoc":"Toggle help",onClick:()=>$e(ue=>!ue),children:"?"}),c.jsxs("div",{className:"replicate-panel__header",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"replicate-panel__title",children:i?"Prby":"Samples"}),c.jsx("p",{className:"replicate-panel__description",children:Ch})]}),c.jsx("div",{className:"replicate-panel__actions"})]}),c.jsx(Qr,{anchorRef:ct,open:ie,children:Ct}),c.jsxs("div",{className:"replicate-panel__legend",children:[c.jsx("span",{className:"replicate-panel__legend-label",children:i?"Prba":"Sample"}),c.jsxs("div",{className:"replicate-panel__legend-pills",children:[c.jsx("span",{children:i?"Doki":"Wells"}),c.jsx("span",{children:i?"Aktywna":"Active"})]})]}),c.jsx("div",{className:"replicate-panel__list",style:{flex:1,overflowY:"auto",minHeight:0},children:an?Nr.map(ue=>{const Le=d.find(tt=>tt.sample===ue);if(!Le)return null;const lt=h.includes(Le.sample),ut=Ye===Le.sample;return c.jsx("div",{className:`replicate-card replicate-row--single-toggle ${ut?"is-focused":""}`,onClick:()=>{Mr(Le.sample),wt(Le.sample)},tabIndex:0,onKeyDown:tt=>{tt.key==="Enter"||tt.key===" "?(tt.preventDefault(),Mr(Le.sample),wt(Le.sample)):(tt.key==="ArrowDown"||tt.key==="ArrowUp")&&(tt.preventDefault(),qn(tt.key==="ArrowDown"?1:-1))},children:c.jsxs("div",{className:"replicate-card__top",children:[c.jsxs("div",{className:"replicate-card__identity",children:[c.jsx("span",{className:"replicate-card__dot",style:{background:Le.color}}),c.jsxs("div",{children:[c.jsx("div",{className:"replicate-card__name",children:Le.sample}),c.jsxs("div",{className:"replicate-card__meta",children:[i?"Dolki":"Wells",": ",Le.wells.map(tt=>tt.well.toUpperCase()).join(", ")]})]})]}),c.jsx("div",{className:"replicate-card__toggles",children:c.jsx("button",{type:"button",className:`state-pill state-pill--plot ${lt?"is-on":""}`,onClick:tt=>{tt.stopPropagation(),Mr(Le.sample),wt(Le.sample)},"aria-pressed":lt,"aria-label":lt?"Ukryj prb na wykresie":"Poka prb na wykresie",children:lt?"":""})})]})},Le.sample)}):c.jsxs("div",{className:"small",style:{color:"var(--text-muted)"},children:["Brak danych - wczytaj plik ",c.jsx("code",{children:".blanked.json"}),"."]})})]}),[Ye,d,qn,an,i,Nr,Ch,Ct,Kt,h,wt,$e,ie,Mr]),Fh=!!Ie&&(yt||Fe),xw=`chart-card ${Ie==="combined"?"chart-card--fullscreen":""} ${Ie==="combined"&&Fh?"chart-card--with-controls":""}`.trim(),gw=`chart-card ${Ie==="log"?"chart-card--fullscreen":""} ${Ie==="log"&&Fh?"chart-card--with-controls":""}`.trim();return c.jsxs("div",{className:"smoothing-page",style:{display:"flex",flexDirection:"column",gap:16},children:[c.jsxs("div",{className:"panel panel-landing blank-info smoothing-info",children:[c.jsxs("div",{className:"panel-heading with-help panel-heading--centered",children:[c.jsxs("div",{children:[c.jsx("div",{className:"eyebrow",children:i?"Wygadzanie krzywych":"Curves Smoothing"}),c.jsx("h2",{className:"info-card__title",children:i?"Przeprowadzenie wygadzania krzywych":"Performing Curves Smoothing"})]}),c.jsx("button",{ref:rr,className:"help-btn circle",type:"button",onClick:()=>ft(L=>!L),"aria-label":i?"Pomoc: Curves Smoothing":"Help: Curves Smoothing",children:"?"})]}),c.jsx(Qr,{anchorRef:rr,open:jt,children:ew}),c.jsxs("div",{className:"blank-info__body",children:[c.jsx("p",{className:"small info-card__description",children:i?"Istnieje wiele sposobw na wygadzanie krzywych wzrostu bakterii. W tym programie wykorzystywany jest algorytm LOESS. Plik po korekcie blank jest automatycznie wczytany do tej karty, ale mozesz tez wgra inny plik po korekcie blank.":"There are many ways to smooth bacterial growth curves. This app uses the LOESS algorithm. The blank-corrected file is loaded into this card automatically, but you can also upload a different blank-corrected file."}),c.jsx("p",{className:"small info-card__description",children:i?"Poniej znajdziesz domylne parametry, wg ktrych program wygadzi krzywe i wyznaczy logarytmiczne fazy wzrostu dla kadej prby. Aby przeprowadzi wygadzanie i wyznaczanie fazy log kliknij przycisk LOESS. Moesz zmieni parametry i ponownie uruchomi wygadzanie, jeli nie jeste zadowolony z wynikw. Moesz te rcznie zaznacza faz log na wykresach. Po wygadzeniu i oznaczeniu faz log kliknij Dalej, aby przej do ostatecznych krzywych wzrostu i parametrw biologicznych.":"Below you will find the default parameters according to which the app will smooth the curves and determine the logarithmic growth phases for each sample. To perform smoothing and log-phase detection, click the LOESS button. You can change the parameters and rerun the smoothing if you are not satisfied with the results. You can also manually mark the log phase on the charts. After smoothing and marking the log phases, click Next to proceed to the final growth curves and biological parameters."}),c.jsx("p",{className:"small info-card__description",children:i?"Dopasuj parametry wygadzania tak, eby krzywe byy jak najlepiej dopasowane do przebiegu samych punktw pomiarw, zwaszcza na pocztku wygadzone krzywe nie powinny odstawa od punktw na wykresie. Kiedy ju dopasujesz parametry wygadzania, dopasuj parametry wykrywania fazy logarytmicznej.":"Adjust the smoothing parameters so that the curves fit the course of the measurement points from the replicates as well as possible, especially at the beginning the smoothed curves should not deviate from the points on the chart. Once you have adjusted the smoothing parameters, adjust the logarithmic phase detection parameters."})]})]}),c.jsxs("div",{className:"panel panel-soft blank-loader smoothing-loader",children:[c.jsx("div",{className:"panel-heading",children:c.jsxs("div",{children:[c.jsx("h3",{children:i?"Wybr pliku":"File Selection"}),c.jsx("p",{className:"small",children:i?c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Ten krok jest opcjonalny."})," Plik po korekcie blank jest automatycznie wczytany z poprzedniego etapu, ale mozesz tez wgra inny plik po korekcie blank lub zaimportowa przygotowany ",c.jsx("code",{children:".blanked.json"}),"."]}):c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"This step is optional."})," The blank-corrected file is pulled from the previous step, but you can pick another file or import a prepared ",c.jsx("code",{children:".blanked.json"}),"."]})})]})}),Qs.length>0&&c.jsx("div",{className:"small",style:{marginTop:8,padding:"8px 10px",borderRadius:8,border:"1px solid #fbbf24",background:"#fef3c7",color:"#854d0e"},children:i?c.jsxs(c.Fragment,{children:["W pliku znaleziono ",d.length," z"," ",Ne.filter(L=>{var ne;return(((ne=L==null?void 0:L.wells)==null?void 0:ne.length)??0)>0}).length," prb z danymi. Brakujace prbki (sekcja ",c.jsx("code",{children:"dataset.rows"}),"): ",Qs.slice(0,6).join(", "),Qs.length>6?` + ${Qs.length-6} kolejnych`:"",". Wyeksportuj ponownie kompletne ",c.jsx("code",{children:".blanked.json"})," albo uzyj pliku ",c.jsx("code",{children:".assignment.json"}),"."]}):c.jsxs(c.Fragment,{children:["Found ",d.length," of"," ",Ne.filter(L=>{var ne;return(((ne=L==null?void 0:L.wells)==null?void 0:ne.length)??0)>0}).length," samples with data. Missing samples (the ",c.jsx("code",{children:"dataset.rows"})," section): ",Qs.slice(0,6).join(", "),Qs.length>6?` + ${Qs.length-6} more`:"",". Re-export a complete"," ",c.jsx("code",{children:".blanked.json"})," or use an ",c.jsx("code",{children:".assignment.json"})," file."]})}),c.jsxs("div",{className:"blank-loader__grid",children:[c.jsx("div",{children:c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:i?"Importuj (opcjonalnie)":"Import (optional)"})}),c.jsxs("div",{className:"file-upload",children:[c.jsx("input",{id:"smoothing-file-input",className:"file-upload__input",type:"file",accept:".json",onChange:L=>{Pr(L.target.files),L.target&&(L.target.value="")},"aria-label":i?"Wybierz plik po korekcie blank":"Choose a blank-corrected file"}),c.jsx("label",{className:"btn",htmlFor:"smoothing-file-input",children:i?"Wybierz plik":"Choose file"}),c.jsx("span",{className:"file-upload__name",children:G?c.jsxs(c.Fragment,{children:[i?"Wczytano: ":"Loaded: ",c.jsx("strong",{children:G})]}):i?"Nie wybrano pliku":"No file chosen"})]})]})}),c.jsx("div",{children:c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:i?"Na bazie pliku:":"Based on file:"})}),c.jsxs("select",{value:u,onChange:L=>$r(Number(L.target.value)),disabled:!l.length,children:[!l.length&&c.jsx("option",{value:0,children:i?"(brak danych)":"(no data loaded)"}),l.map((L,ne)=>{var lt;const ue=(lt=L.dataset)==null?void 0:lt.meta,Le=(ue==null?void 0:ue.sourceFile)||(ue==null?void 0:ue.runId)||`assignment-${ne+1}`;return c.jsxs("option",{value:ne,children:[ne+1,". ",Le]},ne)})]}),c.jsx("div",{className:"small field-note",children:i?"Dane z poprzedniego kroku aduj si automatycznie; moesz tez wczyta inny zapisany plik.":"Data from the previous step loads automatically; you can also load a saved file."})]})})]}),D&&c.jsx("div",{className:"small blank-loader__status",children:D})]}),c.jsxs(ia,{title:i?"Parametry wygadzania":"Smoothing Controls",helpContent:tw,className:"panel-soft control-panel smoothing-controls",children:[c.jsx("p",{className:"small info-card__description",style:{marginTop:0},children:i?c.jsxs(c.Fragment,{children:["Program wybiera ",c.jsx("strong",{children:"okno"})," o danej wielkoci punktw (span) i dopasowuje lokalnie albo lini, albo parabol (",c.jsx("strong",{children:"model lokalny"}),"), a nastpnie przesuwa okno. Program iteruje ten proces, aby zminimalizowa rnice midzy oryginalnymi i wygadzonymi punktami. Dodatkowo, w kadym przebiegu punkty odstajce otrzymuj mniejsze wagi (",c.jsx("strong",{children:"przejcia robust"}),"), co zwiksza odporno na szumy. Program moe przeprowadzi wygadzanie ",c.jsx("strong",{children:"wielokrotnie"}),", aby osign najlepsze wyniki. Kolejne iteracje s uznane za stabilne, jeeli rnica pomidzy nimi jest mniejsza ni ustawiona",c.jsx("strong",{children:" tolerancja"}),". Uyj przycisku LOESS, aby wygadzi wszystkie krzywe."]}):c.jsxs(c.Fragment,{children:["The app picks a ",c.jsx("strong",{children:"window"})," of a given point size (span) and locally fits either a line or a parabola (",c.jsx("strong",{children:"local model"}),"), then slides the window. The app iterates this process to minimize the difference between original and smoothed points. Additionally, in each pass, outlier points get lower weights (",c.jsx("strong",{children:"robust passes"}),"), increasing noise resistance. The app can perform smoothing",c.jsx("strong",{children:" multiple times"})," to achieve the best results. Subsequent iterations are considered stable if the difference between them is less than the set ",c.jsx("strong",{children:"tolerance"}),". Use the LOESS button to smooth all curves."]})}),c.jsx("p",{className:"small info-card__description",style:{marginTop:0},children:i?"Jeeli zaley Ci jedynie na przegldaniu krzywych wzrostu, bez obliczania parametrw biologicznych, po prostu przejd dalej. Jeeli jednak planujesz analiz parametrw wzrostu, sprawd jeszcze, czy fazy logarytmicznego wzrostu zostay dobrze wykryte.":"If you only care about browsing growth curves without calculating biological parameters, just proceed. However, if you plan to analyze growth parameters, double-check that the logarithmic growth phases have been well detected."}),"        ",c.jsxs("div",{className:"control-grid control-grid--tight smoothing-controls__grid",children:[c.jsx(Na,{label:i?"Okno / span":"Sliding window / span",help:sw,maxWidth:240,children:c.jsx("input",{className:"field-input",type:"text",value:x,onChange:L=>v(L.target.value),placeholder:i?"0.4 lub np. 15":"0.4 or e.g. 15"})}),c.jsx(Na,{label:i?"Model lokalny":"Local model",help:iw,maxWidth:240,children:c.jsxs("select",{className:"field-input",value:y,onChange:L=>w(Number(L.target.value)===2?2:1),children:[c.jsx("option",{value:1,children:i?"Linia (stopien 1)":"Line (degree 1)"}),c.jsx("option",{value:2,children:i?"Parabola (stopien 2)":"Parabola (degree 2)"})]})}),c.jsx(Na,{label:i?"Przejscia robust":"Robust passes",help:lw,maxWidth:240,children:c.jsx("input",{className:"field-input",type:"number",min:1,value:g,onChange:L=>{const ne=Number(L.target.value);E(Number.isFinite(ne)&&ne>=1?Math.round(ne):1)}})}),c.jsx(Na,{label:i?"Maks. powtrze":"Max re-runs",help:ow,maxWidth:240,children:c.jsx("input",{className:"field-input",type:"number",min:1,value:b,onChange:L=>{const ne=Number(L.target.value);S(Number.isFinite(ne)&&ne>=1?Math.round(ne):1)}})}),c.jsx(Na,{label:i?"Tolerancja zbieznosci":"Convergence tol.",help:cw,maxWidth:240,children:c.jsx("input",{className:"field-input",type:"number",min:0,step:1e-4,value:_,onChange:L=>{const ne=Number(L.target.value);T(Number.isFinite(ne)&&ne>0?ne:1e-4)}})})]}),c.jsxs("div",{className:"control-row smoothing-controls__row",children:[c.jsxs("div",{className:"control-actions control-actions--inline smoothing-controls__actions",children:[c.jsx("button",{className:"btn primary",disabled:!d.length||We,onClick:()=>Tl("all"),children:"LOESS"}),c.jsx("button",{className:"btn",disabled:!Qy||We,onClick:Zy,children:i?"Cofnij":"Back"}),c.jsx("button",{className:"btn",disabled:!d.length,onClick:qy,children:i?"Eksportuj wygladzone krzywe":"Export smoothed curves"}),c.jsx("button",{className:"btn primary",disabled:!P,onClick:kr,children:i?"Dalej":"Next"})]}),We&&c.jsxs("div",{className:"loess-progress loess-progress--inline","aria-label":"LOESS in progress",children:[c.jsx("div",{className:"loess-progress__bar",children:c.jsx("div",{className:"loess-progress__fill",style:{width:`${Math.min(100,Math.max(0,H??0))}%`}})}),c.jsxs("span",{className:"small",style:{color:"var(--text-secondary)"},children:[i?"Licze LOESS...":"Running LOESS..."," ",Math.min(100,Math.max(0,H??0)),"%"]})]})]})]}),an&&mr&&c.jsxs(ia,{title:i?"Identyfikacja fazy logarytmicznej":"Log identification controls",helpContent:aw,className:"panel-soft control-panel smoothing-controls log-controls",children:[c.jsx("p",{className:"small info-card__description",style:{marginTop:0},children:i?"Ustaw parametry automatycznego wykrywania fazy logarytmicznej, jeli nie jeste zadowolony z wynikw dla ustawie domylnych. Uyj przyciskw poniej, aby wymusi ponowne wykrycie fazy logarytmicznej. Moesz te rcznie zaznaczy zakres fazy log na wykresie i zapisa go. Jeli potrzebujesz, wyeksportuj zapisane fazy logarytmiczne do pliku .json.":"Adjust the automatic log-phase detection parameters if you are not satisfied with the results for the default settings. Use the buttons below to force re-detection of the log phase. You can also manually mark the log-phase range on the chart and save it. If needed, export the saved log phases to a .json file."}),c.jsx("p",{className:"small info-card__description",style:{marginTop:0},children:i?c.jsxs(c.Fragment,{children:["Program szuka fazy logarytmicznej w przedziale OD od wskazanej ",c.jsx("strong",{children:"wartoci minimalnej"})," do znalezionej wartoci maksymalnej. W tym zakresie, w skali ln(OD), przesuwa ",c.jsx("strong",{children:"okno"})," zadanej wielkoci i liczy regresj liniow. Odsiewane s take punkty zbyt bliskie ",c.jsx("strong",{children:"plateau"}),". Zapamituje okna o dodatnim nachyleniu i znajduje okno o najwikszym nachyleniu. Przedzia zawa tak, aby stosunek nachylenia okna do nachylenia maksymalnego mieci si midzy ",c.jsx("strong",{children:"/max min"})," a",c.jsx("strong",{children:" /max max"}),". Punkty fazy log wybierane s tylko z okien o wspczynniku determinacji R",c.jsx("sup",{children:"2"})," nie mniejszym ni podane ",c.jsx("strong",{children:"R"}),c.jsx("sup",{children:"2"})," ",c.jsx("strong",{children:"min"}),"."]}):c.jsxs(c.Fragment,{children:["The app looks for the log phase in the OD range from the specified ",c.jsx("strong",{children:"minimum value"})," to the detected maximum. Within that range, in ln(OD) scale, it slides a ",c.jsx("strong",{children:"window"})," of the chosen size and fits a linear regression. Points too close to the ",c.jsx("strong",{children:"plateau"})," are discarded. It keeps windows with positive slope and finds the steepest one. The candidate range is then limited to windows whose slope ratio falls between ",c.jsx("strong",{children:"/max min"})," and ",c.jsx("strong",{children:"/max max"}),". Log-phase points are selected only from windows whose determination coefficient R",c.jsx("sup",{children:"2"})," is at least the specified ",c.jsx("strong",{children:"R"}),c.jsx("sup",{children:"2"})," ",c.jsx("strong",{children:"min"}),"."]})}),c.jsxs("div",{className:"control-grid control-grid--tight smoothing-controls__grid log-id-grid log-id-grid--params",children:[c.jsx(Na,{label:"OD min",help:dw,children:c.jsx("input",{className:"field-input",type:"number",min:0,step:.001,value:Re,onChange:L=>Ge(L.target.value)})}),c.jsx(Na,{label:i?"Okno (punkty)":"Window (points)",help:uw,children:c.jsx("input",{className:"field-input",type:"number",min:3,step:1,value:ve,onChange:L=>Z(L.target.value)})}),c.jsx(Na,{label:i?"Maks. udzia plateau":"Plateau frac. max",help:hw,children:c.jsx("input",{className:"field-input",type:"number",min:0,max:1,step:.01,value:Je,onChange:L=>Ue(L.target.value)})}),c.jsx(Na,{label:" / max min",help:pw,children:c.jsx("input",{className:"field-input",type:"number",min:0,step:.01,value:U,onChange:L=>ae(L.target.value)})}),c.jsx(Na,{label:" / max max",help:mw,children:c.jsx("input",{className:"field-input",type:"number",min:0,step:.01,value:me,onChange:L=>Te(L.target.value)})}),c.jsx(Na,{label:"R min",help:fw,children:c.jsx("input",{className:"field-input",type:"number",min:0,max:1,step:.01,value:fe,onChange:L=>de(L.target.value)})})]}),c.jsxs("div",{className:"control-row smoothing-controls__row log-id-actions",children:[c.jsxs("div",{className:"control-actions control-actions--inline smoothing-controls__actions log-id-actions__buttons",children:[c.jsx("button",{className:"btn small",type:"button",onClick:Jt,disabled:!sr||!$t&&!pr,children:i?"Wyczy zaznaczenie":"Clear selection"}),c.jsx("button",{className:"btn small",type:"button",onClick:Zt,disabled:!an,children:i?"Przelicz faz log teraz":"Recalculate log phase now"}),c.jsx("button",{className:"btn small",type:"button",onClick:qt,disabled:!bt.length,children:i?"Eksportuj fazy log (.json)":"Export log phases (.json)"}),c.jsx("button",{className:"btn primary",onClick:Ut,disabled:!nr,children:i?"Zapisz faz log":"Save log phase"})]}),c.jsx("div",{className:"small log-id-hint",children:i?"Parametry wpywaj na automatyczne wykrywanie fazy log przy kadym wygadzaniu (oraz cofniciu).":"Parameters influence automatic log-phase detection after each smoothing (and undo)."})]})]}),c.jsxs("div",{className:"smoothing-grid",children:[!Ie&&c.jsx("div",{className:"smoothing-grid__left",children:Qu(!0)}),c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[Ie==="combined"&&(yt||Fe)&&c.jsx("div",{className:"plot-controls-float",children:c.jsxs("div",{className:"plot-controls-float__body",children:[yt&&Ah(),Fe&&c.jsx("div",{className:"plot-controls-float__replicates",children:Qu(!1,{maxHeight:"calc(100vh - 48px)"})})]})}),Ie!=="combined"&&Ah(),c.jsxs(ia,{title:i?"Wygadzone Krzywe":"Smoothed Curves",helpContent:rw,className:xw,contentClassName:"chart-card__body",actions:c.jsxs("div",{className:"btn-pair btn-pair--wrap",children:[Ie==="combined"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",className:"btn basic-btn",onClick:()=>Pt(L=>!L),"aria-pressed":yt,children:yt?i?"Ukryj Plot Controls":"Hide Plot Controls":i?"Poka Plot Controls":"Show Plot Controls"}),c.jsx("button",{type:"button",className:"btn basic-btn",onClick:()=>vt(L=>!L),"aria-pressed":Fe,children:Fe?i?"Ukryj Panel Prb i replikatw":"Hide Samples & Replicates":i?"Poka Panel Prb i replikatw":"Show Samples & Replicates"})]}),c.jsx("button",{type:"button",className:`btn ${Ie==="combined"?"primary":""}`,onClick:()=>ht(L=>L==="combined"?null:"combined"),children:Ie==="combined"?i?"Zamknij pelny ekran":"Exit fullscreen":i?"Pelny ekran":"Fullscreen"})]}),children:[bh&&c.jsx("div",{className:"small",style:{margin:"6px 0",color:"#92400e",background:"#fef3c7",border:"1px solid #f59e0b",padding:"6px 8px",borderRadius:6},children:bh}),c.jsx("div",{ref:Be,className:"chart-card__canvas",children:an?c.jsx(Cu,{series:Yy,scatterSeries:Jy,scatterPointRadius:3.2,scatterOpacity:.8,pointMarkers:"none",title:R,xLabel:V,yLabel:ke,legendMode:"none",mode:"line",bands:Ju,stdMode:"area",xBands:vs,resetViewKey:F,fontScale:ge,legendEntries:Rt,showLegend:kt,legendTitle:xr||"Legenda",legendScale:He,minPanX:Number.NEGATIVE_INFINITY,minPanY:Number.NEGATIVE_INFINITY,onPointSelection:Ft,pointSelectionMode:"modifier",height:Ie==="combined"?620:380}):c.jsxs("div",{className:"empty-state",style:{minHeight:220},children:["Brak danych. Wczytaj plik .blanked.json z wartociami ",c.jsx("code",{children:"val_od600_blank_corrected"}),"."]})})]}),an&&mr&&c.jsxs(c.Fragment,{children:[Ie==="log"&&(yt||Fe)&&c.jsx("div",{className:"plot-controls-float",children:c.jsxs("div",{className:"plot-controls-float__body",children:[yt&&jh(),Fe&&c.jsx("div",{className:"plot-controls-float__replicates",children:Qu(!1,{maxHeight:"calc(100vh - 48px)"})})]})}),Ie!=="log"&&jh(),c.jsx("div",{ref:Tt,children:c.jsxs(ia,{title:"Log phase chart",helpContent:nw,className:gw,contentClassName:"chart-card__body",actions:c.jsxs("div",{className:"btn-pair btn-pair--wrap",children:[Ie==="log"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",className:"btn basic-btn",onClick:()=>Pt(L=>!L),"aria-pressed":yt,children:yt?i?"Ukryj Plot Controls":"Hide Plot Controls":i?"Poka Plot Controls":"Show Plot Controls"}),c.jsx("button",{type:"button",className:"btn basic-btn",onClick:()=>vt(L=>!L),"aria-pressed":Fe,children:Fe?i?"Ukryj Panel Prb i replikatw":"Hide Samples & Replicates":i?"Poka Panel Prb i replikatw":"Show Samples & Replicates"})]}),c.jsx("button",{type:"button",className:`btn ${Ie==="log"?"primary":""}`,onClick:()=>ht(L=>L==="log"?null:"log"),children:Ie==="log"?i?"Zamknij pelny ekran":"Exit fullscreen":i?"Pelny ekran":"Fullscreen"})]}),children:[c.jsx("div",{ref:Ve,className:"chart-card__canvas",children:c.jsx(Cu,{series:Nt,scatterSeries:it,scatterPointRadius:3,scatterOpacity:.9,title:Ee,xLabel:we,yLabel:Ce,legendMode:"none",xBands:vs,pointMarkers:"none",onPointSelection:Ft,pointSelectionMode:"modifier",enableZoom:!0,enablePan:!0,fontScale:be,resetViewKey:re,legendEntries:oe,showLegend:ot,legendTitle:rt||"Legenda",legendScale:_t,minPanX:Number.NEGATIVE_INFINITY,minPanY:Number.NEGATIVE_INFINITY,height:Ie==="log"?620:380})}),c.jsx("div",{className:"small",style:{marginTop:4},children:"Przytrzymaj klawisz Shift lub Alt i przeciagnij, aby wyznaczyc faze log dla zaznaczonej proby."})]})})]})]})]})]})}const Nu=.05,Wy=2e3,Aa={alpha:Nu,bootstrapIterations:Wy},Hy=1e-6,Fc={1:12.706,2:4.303,3:3.182,4:2.776,5:2.571,6:2.447,7:2.365,8:2.306,9:2.262,10:2.228,11:2.201,12:2.179,13:2.16,14:2.145,15:2.131,16:2.12,17:2.11,18:2.101,19:2.093,20:2.086,21:2.08,22:2.074,23:2.069,24:2.064,25:2.06,26:2.056,27:2.052,28:2.048,29:2.045,30:2.042};function hx(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"&&e.trim()!==""){const t=Number(e);if(Number.isFinite(t))return t}return null}function px(e,t){const r=e.filter(o=>Number.isFinite(o));if(!r.length)return null;const n=[...r].sort((o,u)=>o-u),a=t/100*(n.length-1),s=Math.floor(a),i=Math.ceil(a),l=a-s;return s===i?n[s]:n[s]*(1-l)+n[i]*l}function Z3(e,t){const r=e.length;if(r<2)return null;const n=e.reduce((u,f)=>u+f,0)/r,a=t.reduce((u,f)=>u+f,0)/r;let s=0,i=0;for(let u=0;u<r;u+=1){const f=e[u]-n,d=t[u]-a;s+=f*f,i+=f*d}if(s===0)return null;const l=i/s,o=a-l*n;return{slope:l,intercept:o}}function q3(e,t,r=7){if(!e.length||!t.length||e.length!==t.length)return[];const n=e.length,a=Math.floor(r/2),s=[];for(let i=0;i<n;i+=1){const l=Math.max(0,i-a),o=Math.min(n-1,i+a),u=e.slice(l,o+1),f=t.slice(l,o+1),d=Z3(u,f);s.push({t:e[i],mu:d?d.slope:null})}return s}function eF(e,t){if(e.length!==t.length||e.length<2)return null;let r=0;for(let n=0;n<e.length-1;n+=1){const a=e[n+1]-e[n];r+=.5*(t[n]+t[n+1])*a}return r}function mx(e,t,r){if(e.length!==t.length||e.length<2)return null;for(let n=0;n<t.length-1;n+=1){const a=t[n],s=t[n+1];if(a===s){if(a===r)return e[n];continue}const i=Math.min(a,s),l=Math.max(a,s);if(r<i||r>l)continue;const o=(r-a)/(s-a);return e[n]+o*(e[n+1]-e[n])}return null}function tF(e,t,r){if(e.length!==t.length||!e.length)return null;let n=0,a=Math.abs(t[0]-r);for(let s=1;s<t.length;s+=1){const i=Math.abs(t[s]-r);i<a&&(a=i,n=s)}return e[n]??null}function rF(e){if(!e.length)return null;const t=[...e].sort((n,a)=>n-a),r=Math.floor(t.length/2);return t.length%2===0?(t[r-1]+t[r])/2:t[r]}function nF(e,t,r){if(!e.length||r<=0)return[null,null];const n=e.length,a=[];for(let l=0;l<r;l+=1){let o=0;for(let u=0;u<n;u+=1){const f=Math.floor(Math.random()*n);o+=e[f]??0}a.push(o/n)}a.sort((l,o)=>l-o);const s=Math.floor(t/2*(a.length-1)),i=Math.ceil((1-t/2)*(a.length-1));return[a[s]??null,a[Math.min(i,a.length-1)]??null]}function aF(e,t=Nu){if(!Number.isFinite(e)||e<=0)return 0;const r=Math.abs(t-Nu)<1e-6;if(e>=60)return 1.96;const n=Math.round(e);if(n in Fc)return Fc[n];if(e>30)return 2;const a=Math.floor(e);return a in Fc?Fc[a]:0}function xx(e,t=Nu,r=Wy){const n=e.filter(h=>typeof h=="number"&&Number.isFinite(h)),a=n.length;if(!a)return{mean:null,median:null,sd:null,sem:null,ciLow:null,ciHigh:null,ci:{alpha:t,method:"t",low:null,high:null},ciBootstrap:{alpha:t,method:"bootstrap",low:null,high:null,iterations:r},ci95:[null,null],ci95Bootstrap:[null,null],n:0};const s=n.reduce((h,m)=>h+m,0)/a,i=rF(n);let l=null;if(a>1){const h=n.reduce((m,x)=>m+(x-s)**2,0)/(a-1);l=Math.sqrt(h)}else l=0;const o=l!=null?l/Math.sqrt(a):null,u=o!=null?aF(a-1,t):0,f=o!=null?u*o:null,[d,p]=r>0?nF(n,t,r):[null,null];return{mean:s,median:i,sd:l,sem:o,ciLow:f!=null?s-f:s,ciHigh:f!=null?s+f:s,ci:{alpha:t,method:"t",low:f!=null?s-f:s,high:f!=null?s+f:s},ciBootstrap:{alpha:t,method:"bootstrap",low:d,high:p,iterations:r},ci95:[f!=null?s-f:s,f!=null?s+f:s],ci95Bootstrap:[d,p],n:a}}function sF(e){const t=new Map;e.forEach(a=>{a!=null&&t.set(a,(t.get(a)??0)+1)});let r=null,n=0;return t.forEach((a,s)=>{a>n&&(r=s,n=a)}),r}function Vy(e){return e.toFixed(3).replace(/0+$/,"").replace(/\.$/,"")}function iF(e){var n,a;const t={};if(!(e!=null&&e.dataset))return t;const r=((n=e.dataset)==null?void 0:n.log_phases)??((a=e.dataset)==null?void 0:a.logPhases)??[];return Array.isArray(r)&&r.forEach(s=>{s!=null&&s.sample&&(t[s.sample]=s)}),t}function lF(e){var o;const t=[];if(!(e!=null&&e.dataset))return{series:[],warnings:["Brak dataset w pliku assignment."]};const r=iF(e),n=Array.isArray(e.dataset.well_curves)?e.dataset.well_curves:[],a=Array.isArray((o=e.dataset)==null?void 0:o.sample_curves)?e.dataset.sample_curves:[],s=n.length?n:a,i=n.length>0;if(!s.length)return t.push("Brak krzywych (sample_curves / well_curves) w pliku."),{series:[],warnings:t};const l=s.map((u,f)=>{const d=typeof(u==null?void 0:u.sample)=="string"?u.sample.trim():"";if(!d)return t.push(`Pomijam krzyw nr ${f+1} (brak nazwy prbki).`),null;const p=typeof(u==null?void 0:u.well)=="string"?u.well.trim():i?`${d}-well-${f+1}`:d,h=(u==null?void 0:u.replicate)!=null&&!Number.isNaN(Number(u.replicate))?Number(u.replicate):void 0,m=Array.isArray(u==null?void 0:u.time_min)?u.time_min:[],x=Array.isArray(u==null?void 0:u.od600_smoothed)&&u.od600_smoothed||Array.isArray(u==null?void 0:u.od600_smoothed_vals)&&u.od600_smoothed_vals||Array.isArray(u==null?void 0:u.od600_blank_corrected)&&u.od600_blank_corrected||Array.isArray(u==null?void 0:u.od600_raw)&&u.od600_raw||[],v=Math.min(m.length,x.length),y=[],w=[];for(let E=0;E<v;E+=1){const A=hx(m[E]),z=hx(x[E]);A==null||z==null||(y.push(A),w.push(Math.max(Hy,z)))}if(!y.length||y.length!==w.length)return t.push(`Krzywa ${d}/${p} ma nieprawidow dugo danych.`),null;const g=r[d];return{sample:d,well:p,replicate:h,timesMin:y,values:w,logPhase:g?{startMin:Number(g.start),endMin:Number(g.end)}:void 0}}).filter(u=>!!u);return l.sort((u,f)=>{const d=u.sample.localeCompare(f.sample,void 0,{numeric:!0});if(d!==0)return d;const p=u.well.localeCompare(f.well,void 0,{numeric:!0});return p!==0?p:(u.replicate??0)-(f.replicate??0)}),{series:l,warnings:t}}function oF(e,t){var Q;if(e.timesMin.length<2)return null;const r=e.timesMin.map(X=>X/60),n=e.values.map(X=>Math.max(Hy,X)),a=n.map(X=>Math.log(X)),s=q3(r,a,7),i=e.logPhase?e.logPhase.startMin/60:null,l=e.logPhase?e.logPhase.endMin/60:null,u=s.filter(X=>X.mu!=null&&(!i||!l||X.t>=i&&X.t<=l)).map(X=>X.mu),f=u.length>=5?px(u,95):u.length?Math.max(...u):null,d=f&&f>0?Math.log(2)/f:null,p=f?.1*f:null,h=r[0]??0;let m=null;if(p!=null&&p>0&&s.length)for(let X=0;X<s.length;X+=1){const ee=s.slice(X,X+3);if(ee.length<3)break;if(ee.every(F=>F.mu!=null&&F.mu>=p)){m=(((Q=s[X])==null?void 0:Q.t)??h)-h;break}}const x=s.reduce((X,ee)=>ee.mu!=null&&ee.mu>X.mu?{mu:ee.mu,t:ee.t}:X,{mu:Number.NEGATIVE_INFINITY,t:r[0]??0}),v=Number.isFinite(x.mu)?x.t:null,y=Number.isFinite(x.mu)&&x.mu!==Number.NEGATIVE_INFINITY?x.mu:null,w=v!=null?(()=>{const X=r.findIndex(ee=>Math.abs(ee-v)<1e-9);return X>=0?a[X]:null})():null,g=a.length>=2?a.slice(0,Math.min(3,a.length)).reduce((X,ee)=>X+ee,0)/Math.min(3,a.length):a[0]??null;let E=null;if(y!=null&&y>0&&w!=null&&g!=null){const X=v-(w-g)/y;E=v-X}let A=null,z=null;const S=[{value:m,method:"threshold"},{value:E,method:"tangent"}].filter(X=>X.value!=null&&X.value>=0);if(S.length){const X=S.reduce((ee,F)=>F.value<ee.value?F:ee);A=X.value,z=X.method}else m!=null?(A=m,z="threshold"):E!=null&&(A=E,z="tangent");const _=px(n,95),T=n.length?Math.max(...n):null,D=_!=null?_/2:null;let M=null;D!=null&&(M=mx(r,n,D),M==null&&(M=tF(r,n,D)));const G=eF(r,n),Y={};t.forEach(X=>{const ee=Vy(X);Y[ee]=mx(r,n,X)});const J=i!=null&&l!=null?Math.max(0,l-i):null;return{sample:e.sample,well:e.well,replicate:e.replicate,muMax:f??null,td:d,lambda:A,lambdaMethod:z,kHat:_,odMax:T,tInflection:v,tMid:M,slopeAtInflection:y,auc:G,detection:Y,logStart:i,logEnd:l,tLogDuration:J}}function gx(e){var t,r,n,a,s,i;return{mean:(e==null?void 0:e.mean)??null,median:(e==null?void 0:e.median)??null,sd:(e==null?void 0:e.sd)??null,sem:(e==null?void 0:e.sem)??null,ci95:[((t=e==null?void 0:e.ci)==null?void 0:t.low)??(e==null?void 0:e.ciLow)??null,((r=e==null?void 0:e.ci)==null?void 0:r.high)??(e==null?void 0:e.ciHigh)??null],ci95Bootstrap:e!=null&&e.ciBootstrap||e!=null&&e.ci95Bootstrap?[((n=e==null?void 0:e.ciBootstrap)==null?void 0:n.low)??((a=e==null?void 0:e.ci95Bootstrap)==null?void 0:a[0])??null,((s=e==null?void 0:e.ciBootstrap)==null?void 0:s.high)??((i=e==null?void 0:e.ci95Bootstrap)==null?void 0:i[1])??null]:void 0,n:(e==null?void 0:e.n)??0}}function cF(e,t,r,n=Aa){const a=new Map;e.forEach(o=>{a.has(o.sample)||a.set(o.sample,[]),a.get(o.sample).push(o)});const s=["muMax","td","lambda","kHat","odMax","tInflection","tMid","slopeAtInflection","auc","logStart","logEnd","tLogDuration"],i=[],l=[];return a.forEach((o,u)=>{var y,w,g,E,A,z,b,S,_,T,D,M;const f={},d={};s.forEach(G=>{const Y=o.map(Q=>Q[G]),J=xx(Y,n.alpha,n.bootstrapIterations);f[G]=J,d[G]=gx(J)});const p={},h={},m={};t.forEach(G=>{const Y=Vy(G),J=xx(o.map(Q=>Q.detection[Y]),n.alpha,n.bootstrapIterations);p[Y]=J,m[Y]=J.mean,h[Y]=gx(J)}),f.detection=p;const x=sF(o.map(G=>G.lambdaMethod)),v=r.get(u)??o.length;i.push({sample:u,muMax:((y=f.muMax)==null?void 0:y.mean)??null,td:((w=f.td)==null?void 0:w.mean)??null,lambda:((g=f.lambda)==null?void 0:g.mean)??null,lambdaMethod:x,kHat:((E=f.kHat)==null?void 0:E.mean)??null,odMax:((A=f.odMax)==null?void 0:A.mean)??null,tInflection:((z=f.tInflection)==null?void 0:z.mean)??null,tMid:((b=f.tMid)==null?void 0:b.mean)??null,slopeAtInflection:((S=f.slopeAtInflection)==null?void 0:S.mean)??null,auc:((_=f.auc)==null?void 0:_.mean)??null,detection:m,logStart:((T=f.logStart)==null?void 0:T.mean)??null,logEnd:((D=f.logEnd)==null?void 0:D.mean)??null,tLogDuration:((M=f.tLogDuration)==null?void 0:M.mean)??null,replicates:o.length,replicatesTotal:v,stats:f,ci:{alpha:n.alpha,method:"t",bootstrapIterations:n.bootstrapIterations},wells:o.map(G=>({well:G.well,replicate:G.replicate}))}),l.push({sample:u,nTotal:v,nUsed:o.length,usedWells:o.map(G=>({well:G.well,replicate:G.replicate})),ci:{alpha:n.alpha,method:"t",bootstrapIterations:n.bootstrapIterations},params:d,detection:Object.keys(h).length?h:void 0})}),{summaries:i.sort((o,u)=>o.sample.localeCompare(u.sample,void 0,{numeric:!0})),statsBySample:l.sort((o,u)=>o.sample.localeCompare(u.sample,void 0,{numeric:!0}))}}function uF(e,t=[.05,.1]){var p,h,m,x,v,y,w,g,E,A;const r=[],{series:n,warnings:a}=lF(e);r.push(...a);const s={...Aa};if(!n.length){const z=((h=(p=e==null?void 0:e.dataset)==null?void 0:p.meta)==null?void 0:h.sourceFile)||((x=(m=e==null?void 0:e.dataset)==null?void 0:m.meta)==null?void 0:x.runId)||((v=e==null?void 0:e.meta)==null?void 0:v.sourceFile)||"",b=La((z||"dataset").replace(/\.[^.]+$/,""));return r.length||r.push("Brak danych do oblicze."),{results:[],wellResults:[],paramsByReplicate:[],statsBySample:[],statsConfig:s,warnings:r,sourceLabel:b}}const i=new Map;n.forEach(z=>{i.set(z.sample,(i.get(z.sample)??0)+1)});const l=[];n.forEach(z=>{const b=oF(z,t);if(!b){r.push(`Za mao punktw do oblicze dla ${z.sample}/${z.well}.`);return}l.push(b)});const{summaries:o,statsBySample:u}=cF(l,t,i,s),f=((w=(y=e==null?void 0:e.dataset)==null?void 0:y.meta)==null?void 0:w.sourceFile)||((E=(g=e==null?void 0:e.dataset)==null?void 0:g.meta)==null?void 0:E.runId)||((A=e==null?void 0:e.meta)==null?void 0:A.sourceFile)||"",d=La((f||"dataset").replace(/\.[^.]+$/,""));return{results:o,wellResults:l,paramsByReplicate:l,statsBySample:u,statsConfig:s,warnings:r,sourceLabel:d}}const Pl=[.05,.1],$0=typeof document<"u"?document.createElement("canvas"):null,W0=($0==null?void 0:$0.getContext("2d"))??null,fF='"Inter", "Segoe UI", system-ui, sans-serif',H0={title:"Krzywe LOESS (smoothed)",xLabel:"Czas [min]",yLabel:"OD600 (wygladzona)",fontScale:1,legendVisible:!0,legendScale:1,showMean:!1,showMedian:!1,showSd:!1,showCi:!0};function Ga(e,t=3){return e==null||Number.isNaN(e)?"-":Number.isFinite(e)?Number(e).toFixed(t):"inf"}function V0(e){return e.toFixed(3).replace(/0+$/,"").replace(/\.$/,"")}function dF(e,t){var s;if(!(e!=null&&e.stats))return;const r=e.stats;if(t.startsWith("det-")){const i=t.replace("det-","");return(s=r==null?void 0:r.detection)==null?void 0:s[i]}const a={muMax:"muMax",td:"td",lambda:"lambda",kHat:"kHat",odMax:"odMax",tInflection:"tInflection",tMid:"tMid",slopeInf:"slopeAtInflection",auc:"auc",logStart:"logStart",logEnd:"logEnd",tLogDuration:"tLogDuration"}[t]??t;return r==null?void 0:r[a]}function qs(e,t,r=700,n=fF){if(!e)return{width:0,height:t};if(!W0)return{width:e.length*t*.6,height:t*1.2};W0.font=`${r} ${t}px ${n}`;const a=W0.measureText(e),s=(a.actualBoundingBoxAscent??t*.7)+(a.actualBoundingBoxDescent??t*.3);return{width:a.width,height:s}}function vx(e,t,r=4){if(!e.length||!t.length)return!1;let n=-1/0;for(let a=0;a<e.length;a+=1){const s=(t[a]??0)/2,i=e[a]-s,l=e[a]+s;if(i-r<n)return!0;n=Math.max(n,l+r)}return!1}function yx(e){return Array.isArray(e)?e:e==null?[]:[e]}const hF={1:12.706,2:4.303,3:3.182,4:2.776,5:2.571,6:2.447,7:2.365,8:2.306,9:2.262,10:2.228,11:2.201,12:2.179,13:2.16,14:2.145,15:2.131,16:2.12,17:2.11,18:2.101,19:2.093,20:2.086,21:2.08,22:2.074,23:2.069,24:2.064,25:2.06,26:2.056,27:2.052,28:2.048,29:2.045,30:2.042};function pF(e){return e<=0||Number.isNaN(e)?0:e>=30?1.96:hF[Math.round(e)]??1.96}function mF(e,t){if(!e.length)return NaN;if(t<=e[0].x)return e[0].y;if(t>=e[e.length-1].x)return e[e.length-1].y;for(let r=0;r<e.length-1;r+=1){const n=e[r],a=e[r+1];if(t>=n.x&&t<=a.x){const s=(t-n.x)/Math.max(1e-9,a.x-n.x);return n.y*(1-s)+a.y*s}}return e[e.length-1].y}function xF(e,t){const r=[...e].sort((n,a)=>n.x-a.x);return t.map(n=>mF(r,n))}function gF(e){const t=[];if(!(e!=null&&e.dataset))return{curves:[],warnings:t};const r=e.dataset,n=Array.isArray(r==null?void 0:r.well_curves)?r.well_curves:[],a=Array.isArray(r==null?void 0:r.sample_curves)?r.sample_curves:[],s=n.length?n:a,i=n.length>0;if(!s.length)return t.push("Brak krzywych (well_curves / sample_curves) w pliku assignment."),{curves:[],warnings:t};const l=[];return s.forEach((o,u)=>{const f=typeof(o==null?void 0:o.sample)=="string"?o.sample.trim():"";if(!f){t.push(`Pomijam krzywa nr ${u+1} (brak nazwy probki).`);return}const d=typeof(o==null?void 0:o.well)=="string"?o.well.trim():i?`${f}-well-${u+1}`:f,p=(o==null?void 0:o.replicate)!=null&&!Number.isNaN(Number(o.replicate))?Number(o.replicate):void 0,h=Array.isArray(o==null?void 0:o.time_min)?o.time_min:[],m=Array.isArray(o==null?void 0:o.od600_smoothed)&&o.od600_smoothed||Array.isArray(o==null?void 0:o.od600_smoothed_vals)&&o.od600_smoothed_vals||Array.isArray(o==null?void 0:o.od600_blank_corrected)&&o.od600_blank_corrected||Array.isArray(o==null?void 0:o.od600_raw)&&o.od600_raw||[],x=Math.min(h.length,m.length);if(!x){t.push(`Pomijam ${f}/${d} - brak punktow do wykresu.`);return}const v=[];for(let y=0;y<x;y+=1){const w=Number(h[y]),g=Number(m[y]);!Number.isFinite(w)||!Number.isFinite(g)||v.push({x:w,y:g})}if(v.length<2){t.push(`Pomijam ${f}/${d} - za malo punktow (min 2).`);return}v.sort((y,w)=>y.x-w.x),l.push({sample:f,well:d,replicate:p,points:v})}),{curves:l,warnings:t}}function vF(e){var t,r,n,a,s,i,l;if(Array.isArray(e==null?void 0:e.assignments))return e.assignments;if((t=e==null?void 0:e.dataset)!=null&&t.rows&&(e!=null&&e.mapping))return[e];if(Array.isArray(e==null?void 0:e.rows)){const o={meta:e.meta??((r=e.dataset)==null?void 0:r.meta)??((n=e==null?void 0:e.dataset)==null?void 0:n.meta)??{},rows:e.rows,sample_curves:e.sample_curves,well_curves:e.well_curves,log_phases:e.log_phases??e.logPhases,blankCorrection:e.blankCorrection,blankedAt:e.blankedAt},u=new Set;e.rows.forEach(p=>{const h=typeof(p==null?void 0:p.sample)=="string"?p.sample.trim():"";h&&u.add(h)}),yx(e.sample_curves).forEach(p=>{p!=null&&p.sample&&u.add(p.sample)}),yx(e.well_curves).forEach(p=>{p!=null&&p.sample&&u.add(p.sample)});const f=Array.from(u).sort((p,h)=>p.localeCompare(h,void 0,{numeric:!0}));return[{mapping:{type:"mapping",version:1,id:((a=e.mapping)==null?void 0:a.id)??"auto-mapping",name:((s=e.mapping)==null?void 0:s.name)??"Auto mapping",createdAt:((i=e.mapping)==null?void 0:i.createdAt)??new Date().toISOString(),notes:(l=e.mapping)==null?void 0:l.notes,samples:f.map((p,h)=>({name:p,order:h,color:null,saturation:null,wells:[]}))},dataset:o}]}return[]}function wx(e){var a,s,i,l;if(!(e!=null&&e.dataset))return!1;const t=((a=e.dataset)==null?void 0:a.log_phases)??((s=e.dataset)==null?void 0:s.logPhases);if(Array.isArray(t)&&t.length)return!0;const r=(i=e.dataset)==null?void 0:i.sample_curves;if(Array.isArray(r)&&r.some(o=>{var u;return(o==null?void 0:o.logPhase)||(o==null?void 0:o.log_phase)||((u=o==null?void 0:o.logPhases)==null?void 0:u.length)}))return!0;const n=(l=e.dataset)==null?void 0:l.well_curves;return!!(Array.isArray(n)&&n.length)}function G0(e){return{title:e.label,xLabel:"Samples",yLabel:e.unit?`${e.label} (${e.unit})`:e.label,yMax:"",fontScale:1,legendFontScale:1,sort:"desc",showValues:!1,showSamples:!0,legendVisible:!1,sampleAngle:0,valueAngle:0,sampleLabels:{},legendTitle:"",showSd:!0,showCi:!1,showReplicates:!0}}function yF(e,t){if(t==="none")return e;const r=[...e];return r.sort((n,a)=>{const s=Number.isFinite(n.value)?Number(n.value):null,i=Number.isFinite(a.value)?Number(a.value):null;return s==null&&i==null?0:s==null?1:i==null?-1:t==="asc"?s-i:i-s}),r}function wF({results:e,selectedSamples:t,onToggle:r,onSelectAll:n,onClear:a,sampleColors:s}){const[i,l]=k.useState(!1),o=k.useRef(null),u=k.useMemo(()=>new Set(t),[t]);return c.jsxs("div",{className:"replicate-panel parameters-samples-panel",id:"parameters-samples",children:[c.jsx("button",{ref:o,type:"button",className:"help-btn circle replicate-panel__help-btn",onClick:()=>l(f=>!f),"aria-label":"Samples help",children:"?"}),c.jsx(Qr,{anchorRef:o,open:i,children:"Wybierz, ktore proby maja byc widoczne na wszystkich wykresach parametrow. Zmiany dzialaja globalnie dla tej karty."}),c.jsxs("div",{className:"replicate-panel__header",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"replicate-panel__title",children:"Samples"}),c.jsx("p",{className:"replicate-panel__description",children:"Panel dotyczy wszystkich wykresow. Uzyj go, aby szybko wlaczac/wylaczac probki."})]}),c.jsxs("div",{className:"replicate-panel__actions",children:[c.jsx("button",{className:"btn",onClick:n,disabled:!e.length,children:"Select all"}),c.jsx("button",{className:"btn",onClick:a,disabled:!e.length,children:"Clear"})]})]}),c.jsxs("div",{className:"replicate-panel__legend",children:[c.jsx("span",{className:"replicate-panel__legend-label",children:"Proby"}),c.jsx("div",{className:"replicate-panel__legend-pills",children:c.jsx("span",{children:"Widoczna"})})]}),c.jsxs("div",{className:"replicate-panel__list",onKeyDown:f=>{f.key!=="ArrowDown"&&f.key!=="ArrowUp"||f.preventDefault()},children:[e.map(f=>{const d=u.has(f.sample),p=s.get(f.sample)??"#2563eb";return c.jsx("div",{className:`replicate-card replicate-row--single-toggle ${d?"is-focused":""}`,onClick:()=>r(f.sample),tabIndex:0,onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),r(f.sample))},children:c.jsxs("div",{className:"replicate-card__top",children:[c.jsxs("div",{className:"replicate-card__identity",children:[c.jsx("span",{className:"replicate-card__dot",style:{background:p}}),c.jsx("div",{children:c.jsx("div",{className:"replicate-card__name",children:f.sample})})]}),c.jsx("div",{className:"replicate-card__toggles",children:c.jsx("button",{type:"button",className:`state-pill state-pill--plot ${d?"is-on":""}`,onClick:h=>{h.stopPropagation(),r(f.sample)},"aria-pressed":d,"aria-label":d?"Ukryj probe na wykresach parametrow":"Pokaz probe na wykresach parametrow",children:"?"})})]})},f.sample)}),!e.length&&c.jsx("div",{className:"small",style:{color:"var(--text-muted)"},children:"Brak danych do wyboru."})]})]})}function kx({settings:e,onChange:t,onReset:r,onResetView:n,onExport:a,onCopy:s,legendVisible:i,onToggleLegend:l,showMean:o,showMedian:u,showSd:f,showCi:d,disabled:p}){return c.jsxs(ia,{title:"LOESS - Plot controls",helpContent:"Steruj tytulem i osiami dla zbiorczych krzywych LOESS. Legenda dotyczy probek, a pasmo to 95% CI z replik.",className:"panel-soft control-panel parameters-controls",children:[c.jsxs("div",{className:"control-grid control-grid--tight",children:[c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:"Tytul"})}),c.jsx("input",{className:"field-input",value:e.title,onChange:h=>t({...e,title:h.target.value}),disabled:p})]}),c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:"Os X"})}),c.jsx("input",{className:"field-input",value:e.xLabel,onChange:h=>t({...e,xLabel:h.target.value}),disabled:p})]}),c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:"Os Y"})}),c.jsx("input",{className:"field-input",value:e.yLabel,onChange:h=>t({...e,yLabel:h.target.value}),disabled:p})]})]}),c.jsxs("div",{className:"control-row control-row--tight plot-controls__row",children:[c.jsxs("div",{className:"btn-pair",children:[c.jsx("button",{className:"btn",onClick:()=>t({...e,fontScale:Math.max(.6,+(e.fontScale-.1).toFixed(1))}),disabled:p,title:"Mniejsza czcionka",children:"A-"}),c.jsx("button",{className:"btn",onClick:()=>t({...e,fontScale:Math.min(2,+(e.fontScale+.1).toFixed(1))}),disabled:p,title:"Wieksza czcionka",children:"A+"})]}),c.jsxs("label",{className:`parameters-toggle ${i?"is-on":""}`,title:"Pokaz/ukryj legende",children:[c.jsx("input",{type:"checkbox",checked:i,onChange:l,disabled:p}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:"Legenda"})]}),i&&c.jsxs("div",{className:"legend-editor__font",style:{whiteSpace:"nowrap"},children:[c.jsx("span",{children:"Rozmiar legendy"}),c.jsxs("div",{className:"btn-pair",children:[c.jsx("button",{className:"btn",type:"button",onClick:()=>t({...e,legendScale:Math.max(.6,+(e.legendScale-.1).toFixed(1))}),disabled:p,children:"A-"}),c.jsx("button",{className:"btn",type:"button",onClick:()=>t({...e,legendScale:Math.min(2,+(e.legendScale+.1).toFixed(1))}),disabled:p,children:"A+"})]})]}),c.jsxs("div",{className:"btn-pair",children:[c.jsx("button",{className:"btn",type:"button",onClick:a,disabled:p,children:"Export PNG"}),c.jsx("button",{className:"btn",type:"button",onClick:s,disabled:p,children:"Kopiuj PNG"})]}),c.jsx("button",{className:"btn basic-btn",type:"button",onClick:n,disabled:p,children:"Reset widoku"}),c.jsx("button",{className:"btn",type:"button",onClick:r,disabled:p,children:"Reset ustawien"})]}),c.jsxs("div",{className:"control-row control-row--tight plot-controls__row",children:[c.jsxs("label",{className:`parameters-toggle ${o?"is-on":""}`,children:[c.jsx("input",{type:"checkbox",checked:o,onChange:h=>t({...e,showMean:h.target.checked}),disabled:p}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:"Pokaz srednie (punkty)"})]}),c.jsxs("label",{className:`parameters-toggle ${u?"is-on":""}`,children:[c.jsx("input",{type:"checkbox",checked:u,onChange:h=>t({...e,showMedian:h.target.checked}),disabled:p}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:"Pokaz mediany (linia)"})]}),c.jsxs("label",{className:`parameters-toggle ${f?"is-on":""}`,children:[c.jsx("input",{type:"checkbox",checked:f,onChange:h=>t({...e,showSd:h.target.checked}),disabled:p}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:"Errorbary SD"})]}),c.jsxs("label",{className:`parameters-toggle ${d?"is-on":""}`,children:[c.jsx("input",{type:"checkbox",checked:d,onChange:h=>t({...e,showCi:h.target.checked}),disabled:p}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:"Pasmo CI"})]})]})]})}function kF({param:e,settings:t,onChange:r,onReset:n,onExport:a,onCopy:s,legendVisible:i,onToggleLegend:l,samples:o,sampleColors:u,disabled:f}){const d=o??[],p=u??new Map,h=t.legendFontScale??t.fontScale??1;return c.jsxs(ia,{title:`${e.label} - Plot controls`,helpContent:"Tytul, etykiety osi oraz kolejnosc slupkow sa niezalezne dla kazdego wykresu. Zmiany nie wplywaja na obliczone dane.",className:"panel-soft control-panel parameters-controls",children:[c.jsxs("div",{className:"control-grid control-grid--tight",children:[c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:"Tytul"})}),c.jsx("input",{className:"field-input",value:t.title,onChange:m=>r({...t,title:m.target.value}),disabled:f})]}),c.jsxs("label",{className:"field checkbox-field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:"Pokaz SD"})}),c.jsxs("label",{className:`parameters-toggle ${t.showSd?"is-on":""}`,children:[c.jsx("input",{type:"checkbox",checked:!!t.showSd,onChange:m=>r({...t,showSd:m.target.checked}),disabled:f}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:"SD bands"})]})]}),c.jsxs("label",{className:"field checkbox-field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:"Pokaz 95% CI"})}),c.jsxs("label",{className:`parameters-toggle ${t.showCi?"is-on":""}`,children:[c.jsx("input",{type:"checkbox",checked:!!t.showCi,onChange:m=>r({...t,showCi:m.target.checked}),disabled:f}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:"CI whiskers"})]})]}),c.jsxs("label",{className:"field checkbox-field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:"Pokaz replikaty"})}),c.jsxs("label",{className:`parameters-toggle ${t.showReplicates?"is-on":""}`,children:[c.jsx("input",{type:"checkbox",checked:!!t.showReplicates,onChange:m=>r({...t,showReplicates:m.target.checked}),disabled:f}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:"Punkty replikatw"})]})]}),c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:"Os X"})}),c.jsx("input",{className:"field-input",value:t.xLabel,onChange:m=>r({...t,xLabel:m.target.value}),disabled:f})]}),c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:"Os Y"})}),c.jsx("input",{className:"field-input",value:t.yLabel,onChange:m=>r({...t,yLabel:m.target.value}),disabled:f})]}),c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:"Max Y (opcjonalnie)"})}),c.jsx("input",{className:"field-input",type:"number",placeholder:"auto",value:t.yMax??"",onChange:m=>r({...t,yMax:m.target.value===""?"":Number(m.target.value)}),disabled:f})]}),c.jsxs("label",{className:"field",children:[c.jsx("div",{className:"field-label-row",children:c.jsx("span",{children:"Sortowanie"})}),c.jsxs("select",{value:t.sort,onChange:m=>r({...t,sort:m.target.value}),disabled:f,children:[c.jsx("option",{value:"desc",children:"Malejaco"}),c.jsx("option",{value:"asc",children:"Rosnaco"}),c.jsx("option",{value:"none",children:"Kolejnosc prob"})]})]})]}),c.jsxs("div",{className:"control-row control-row--tight plot-controls__row",children:[c.jsxs("div",{className:"btn-pair",children:[c.jsx("button",{className:"btn",onClick:()=>r({...t,fontScale:Math.max(.6,+(t.fontScale-.1).toFixed(1))}),disabled:f,title:"Mniejsza czcionka",children:"A-"}),c.jsx("button",{className:"btn",onClick:()=>r({...t,fontScale:Math.min(2,+(t.fontScale+.1).toFixed(1))}),disabled:f,title:"Wieksza czcionka",children:"A+"})]}),c.jsxs("div",{className:"control-actions control-actions--inline parameters-controls__actions",children:[c.jsxs("label",{className:`parameters-toggle ${t.showValues?"is-on":""}`,title:"Pokaz wartosci nad slupkami",children:[c.jsx("input",{type:"checkbox",checked:t.showValues,onChange:m=>r({...t,showValues:m.target.checked}),disabled:f}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:"Wartosci nad slupkami"})]}),t.showValues&&c.jsxs("label",{className:`parameters-toggle parameters-toggle--range ${f?"is-disabled":""}`,children:[c.jsxs("div",{className:"parameters-toggle__label",children:[c.jsx("div",{style:{fontWeight:700},children:"Kat wartosci (0-90 deg)"}),c.jsxs("div",{className:"small",style:{color:"var(--text-muted)"},children:[Math.round(t.valueAngle??0)," deg"]})]}),c.jsx("input",{className:"parameters-toggle__range",type:"range",min:0,max:90,step:1,value:t.valueAngle??0,onChange:m=>r({...t,valueAngle:Number(m.target.value)}),disabled:f})]}),c.jsxs("label",{className:`parameters-toggle ${t.showSamples?"is-on":""}`,title:"Pokaz nazwy prob pod slupkami",children:[c.jsx("input",{type:"checkbox",checked:t.showSamples,onChange:m=>r({...t,showSamples:m.target.checked}),disabled:f}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:"Nazwy prob"})]}),t.showSamples&&c.jsxs("label",{className:`parameters-toggle parameters-toggle--range ${f?"is-disabled":""}`,children:[c.jsxs("div",{className:"parameters-toggle__label",children:[c.jsx("div",{style:{fontWeight:700},children:"Kat nazw prob (0-90 deg)"}),c.jsxs("div",{className:"small",style:{color:"var(--text-muted)"},children:[Math.round(t.sampleAngle??0)," deg"]})]}),c.jsx("input",{className:"parameters-toggle__range",type:"range",min:0,max:90,step:1,value:t.sampleAngle??0,onChange:m=>r({...t,sampleAngle:Number(m.target.value)}),disabled:f})]}),c.jsxs("div",{className:"btn-pair",children:[c.jsx("button",{className:`btn legend-toggle ${i?"primary is-active":""}`,type:"button",onClick:l,disabled:f,children:i?"Ukryj legende":"Legenda"}),c.jsx("button",{className:"btn",type:"button",onClick:a,disabled:f,children:"Export PNG"}),c.jsx("button",{className:"btn",type:"button",onClick:s,disabled:f,children:"Kopiuj PNG"})]}),c.jsx("button",{className:"btn",type:"button",onClick:n,disabled:f,children:"Reset"})]})]}),(t.showSamples||t.legendVisible)&&d.length>0&&c.jsxs("div",{className:"legend-editor legend-editor--compact",role:"group","aria-label":"Nazwy na wykresie i w legendzie",children:[c.jsxs("div",{className:"legend-editor__header",children:[c.jsxs("div",{children:[c.jsx("div",{className:"legend-editor__title",children:"Nazwy wykresu i legendy"}),c.jsx("div",{className:"legend-editor__subtitle",children:"Zmiana etykiety dziala tylko wizualnie."})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:12,flexWrap:"wrap"},children:[c.jsxs("div",{style:{minWidth:160},children:[c.jsx("div",{className:"legend-editor__subtitle",style:{marginBottom:4},children:"Tytul legendy"}),c.jsx("input",{className:"legend-editor__input",placeholder:"Legenda",value:t.legendTitle??"",onChange:m=>r({...t,legendTitle:m.target.value}),disabled:f})]}),t.legendVisible&&c.jsxs("div",{className:"legend-editor__font",style:{whiteSpace:"nowrap"},children:[c.jsx("span",{children:"Rozmiar legendy"}),c.jsxs("div",{className:"btn-pair",children:[c.jsx("button",{className:"btn",type:"button",onClick:()=>r({...t,legendFontScale:Math.max(.6,+(h-.1).toFixed(1))}),disabled:f,children:"A-"}),c.jsx("button",{className:"btn",type:"button",onClick:()=>r({...t,legendFontScale:Math.min(2,+(h+.1).toFixed(1))}),disabled:f,children:"A+"})]})]})]})]}),c.jsx("div",{className:"legend-editor__list",children:d.map(m=>{var y;const x=((y=t.sampleLabels)==null?void 0:y[m])??"",v=p.get(m)??"#2563eb";return c.jsxs("div",{className:"legend-editor__row",children:[c.jsx("div",{className:"legend-editor__swatch","aria-hidden":!0,style:{background:v},children:c.jsx("span",{style:{fontSize:11,fontWeight:700,color:"#fff",textShadow:"0 0 2px rgba(0,0,0,0.45)"},children:"#"})}),c.jsx("div",{className:"legend-editor__checkbox","aria-hidden":!0,children:c.jsx("span",{children:m})}),c.jsx("input",{className:"legend-editor__input",placeholder:m,value:x,onChange:w=>r({...t,sampleLabels:{...t.sampleLabels??{},[m]:w.target.value}}),disabled:f})]},m)})})]})]})}function _F({param:e,data:t,settings:r,sampleColors:n,chartId:a,chartRef:s,fullscreen:i,onToggleFullscreen:l,showControls:o,onToggleControls:u}){const f=k.useRef(null),d=t.flatMap(ie=>{var Ct;const $e=[];return ie.value!=null&&Number.isFinite(Number(ie.value))&&$e.push(Number(ie.value)),((Ct=ie.spread)==null?void 0:Ct.sd)!=null&&ie.value!=null&&$e.push(Math.max(0,Number(ie.value)-ie.spread.sd),Number(ie.value)+ie.spread.sd),(ie.replicates??[]).forEach(Mt=>{(Mt==null?void 0:Mt.value)!=null&&Number.isFinite(Mt.value)&&$e.push(Number(Mt.value))}),$e}),p=d.length?Math.min(0,...d):0,h=d.length?Math.max(...d):1,m=Math.max(1e-6,h-p),x=0,v=typeof r.yMax=="number"&&Number.isFinite(r.yMax)?r.yMax:null,y=h>0?Math.max(h*.08,m*.08):0,w=v??h+y,g=Math.max(w,h||1),E=Math.max(1e-6,g-x),A=6,z=E/A,b=x,S=x+z*A,_=Math.max(1e-6,S-b),T=k.useMemo(()=>{const ie=[];for(let $e=0;$e<=A;$e+=1){const Ct=x+z*$e;ie.push(Number(Ct.toPrecision(6)))}return ie},[x,A,z]),D=t.map(ie=>{var $e,Ct;return((Ct=($e=r.sampleLabels)==null?void 0:$e[ie.sample])==null?void 0:Ct.trim())||ie.sample}),M=k.useMemo(()=>t.map((ie,$e)=>({id:ie.sample,label:D[$e]??ie.sample,color:n.get(ie.sample)??"#2563eb"})),[t,D,n]),G=Math.max(t.length,1),[Y,J]=k.useState(null),Q=k.useRef(null),X=`${a}-title`,[ee,F]=k.useState({width:960,height:520});k.useEffect(()=>{var Bt;if(!r.legendVisible||Y)return;const ie=(Bt=f.current)==null?void 0:Bt.getBoundingClientRect(),$e=(ie==null?void 0:ie.width)??640,Ct=Math.min(360,Math.max(220,$e*.42)),Mt=160,Vt=Math.max(0,((ie==null?void 0:ie.width)??Ct)-Ct-8),Et=Math.max(0,((ie==null?void 0:ie.height)??Mt)-Mt-8);J({x:Math.max(8,Math.min($e-Ct-12,Vt)),y:Math.max(8,Math.min(18,Et)),width:Ct,height:Mt})},[Y,r.legendVisible]);const le=k.useCallback((ie,$e,Ct,Mt)=>{const Vt=Bt=>{var De;const gr=Q.current;if(!gr)return;const Gr=Bt.clientX-gr.startX,vn=Bt.clientY-gr.startY,K=(De=f.current)==null?void 0:De.getBoundingClientRect(),xe=Math.max(160,(K==null?void 0:K.width)??$e.width),Ne=Math.max(120,(K==null?void 0:K.height)??$e.height),Pe=Math.max(0,((K==null?void 0:K.width)??$e.width)-(gr.box.width??$e.width)-8),mt=Math.max(0,((K==null?void 0:K.height)??$e.height)-(gr.box.height??$e.height)-8);if(ie==="drag"){const pt=Math.min(Math.max(8,gr.box.x+Gr),Pe),bt=Math.min(Math.max(8,gr.box.y+vn),mt);J(xt=>({...xt??gr.box,x:pt,y:bt}))}else{const pt=Math.min(Math.max(140,gr.box.width+Gr),xe),bt=Math.min(Math.max(100,gr.box.height+vn),Ne);J(xt=>({...xt??gr.box,width:pt,height:bt}))}},Et=()=>{Q.current=null,window.removeEventListener("mousemove",Vt),window.removeEventListener("mouseup",Et)};Q.current={mode:ie,startX:Ct,startY:Mt,box:$e},window.addEventListener("mousemove",Vt),window.addEventListener("mouseup",Et)},[]),re=k.useCallback(ie=>$e=>{var Vt;$e.preventDefault(),$e.stopPropagation();const Ct=(Vt=f.current)==null?void 0:Vt.getBoundingClientRect(),Mt=Y??{x:12,y:12,width:Math.min(360,Math.max(220,((Ct==null?void 0:Ct.width)??640)*.42)),height:160};J(Et=>Et??Mt),le(ie,Mt,$e.clientX,$e.clientY)},[le,Y]);k.useEffect(()=>{const ie=f.current;if(!ie||typeof ResizeObserver>"u")return;const $e=new ResizeObserver(Ct=>{var Vt;const Mt=(Vt=Ct[0])==null?void 0:Vt.contentRect;Mt&&F({width:Math.max(320,Mt.width),height:Math.max(360,Mt.height)})});return $e.observe(ie),()=>$e.disconnect()},[t.length]);const j=Math.max(ee.width,320),R=Math.max(ee.height,360),B=Math.max(13,14*r.fontScale),V=Math.max(11,12*r.fontScale),te=Math.max(11,12*r.fontScale),ke=Math.max(10,11*r.fontScale),_e=Math.max(12,13*r.fontScale),ge=T.map(ie=>Ga(ie,2)),ye=Math.max(26,...ge.map(ie=>qs(ie,ke).width)),Ee=r.yLabel||e.label,C=r.yLabel?qs(Ee,_e):{height:0},we=ye+28,he=r.yLabel?C.height+10:0,Ce=Math.max(70,we+he),Ae=26,be=Math.max(120,j-Ce-Ae),qe=G>1?Math.min(22,Math.max(8,be/G*.18)):12,Ie=Math.max(12,Math.min(160,(be-qe*(G-1))/G)),ht=Ie*G+qe*Math.max(0,G-1),yt=Ce+Math.max(0,(be-ht)/2),Pt=t.map((ie,$e)=>yt+$e*(Ie+qe)+Ie/2),Fe=r.showSamples?D.map(ie=>qs(ie,V).width):[],vt=r.showSamples?qs("Hg",V).height:0,jt=t.map(ie=>Ga(ie.value)),ft=r.showValues?jt.map(ie=>qs(ie,te).width):[],kt=qs("Hg",te).height;ft.length&&Math.max(...ft);const Se=Math.min(90,Math.max(0,r.sampleAngle??0)),ot=Se===0&&r.showSamples&&vx(Pt,Fe,6),Xe=Se===0?ot?90:0:Se,Rt=Xe*Math.PI/180,q=r.showSamples&&Fe.length?Fe.map(ie=>ie*Math.sin(Rt)+vt*Math.cos(Rt)):[],oe=Math.min(90,Math.max(0,r.valueAngle??0)),He=oe===0&&r.showValues&&vx(Pt,ft,6)?90:oe,st=He*Math.PI/180,_t=r.showValues&&ft.length?ft.map(ie=>ie*Math.sin(st)+kt*Math.cos(st)):[],Lt=r.showValues&&He>0,xr=r.xLabel?Math.max(18,14*r.fontScale+8):14,Qe=r.showSamples&&q.length?Math.max(...q,vt*1.3):0,rt=r.showValues?Lt?_t.length?Math.max(..._t,kt*1.2):kt*1.2:te*1.6:0,je=16+B*1.6+rt,Be=18+Qe+xr,Ve=Math.max(R,je+Be+160),Kt=Math.max(120,Ve-je-Be),St=Ce,Tt=j-Ae-St,at=je+Kt,rr=Math.max(B+6,18),er=Ve-10,hr=Math.max(10,Ce-we-6),pr=Math.max(.6,Math.min(2,r.legendFontScale??r.fontScale??1)),Ht=(r.legendTitle??"").trim()||"Legenda",Ot=2,N=Math.max(11.5,12*pr),P=Math.max(10,11*pr),O=N+1,I=Math.max(11,P+2),W=4,H=Math.max(W,ee.width-16),ce=M.length?Math.max(...M.map(ie=>qs(ie.label??"",P).width)):0,ve=Math.max(52,ce+22),Z=Math.max(1,Math.floor((H-Ot*2)/ve)||1),fe=Math.min(Z,Math.max(1,M.length)),de=Ot*2+fe*ve,Re=(Y==null?void 0:Y.width)??de,Ge=Math.max(W,Math.min(H,Re)),Je=Math.max(1,Math.floor((Ge-Ot*2)/ve)||1),Ue=Math.max(1,Math.ceil(M.length/Je)),ae=Ot*2+O+Ue*I+12,me=Y==null?void 0:Y.height,Te=me&&me>ae?ae:me??ae,Ye=Math.max(ae,Te),wt=Math.max(8,Math.min((Y==null?void 0:Y.x)??12,Math.max(0,ee.width-Ge-8))),We=Math.max(8,Math.min((Y==null?void 0:Y.y)??12,Math.max(0,ee.height-Ye-8))),ze=ie=>{const $e=(ie-b)/(_||1),Ct=Math.max(0,Math.min(1,$e));return at-Ct*Kt},ct=t.map((ie,$e)=>{var De,pt;const Ct=D[$e]??ie.sample,Mt=n.get(ie.sample)??"#2563eb",Vt=ie.value!=null&&Number.isFinite(ie.value)?Number(ie.value):null,Et=yt+$e*(Ie+qe),Bt=ie.spread,gr=(Bt==null?void 0:Bt.sd)!=null&&Vt!=null?ze(Math.max(b,Vt-Bt.sd)):null,Gr=(Bt==null?void 0:Bt.sd)!=null&&Vt!=null?ze(Vt+Bt.sd):null,vn=((De=Bt==null?void 0:Bt.ci)==null?void 0:De.low)!=null?ze(Math.max(b,Bt.ci.low)):(Bt==null?void 0:Bt.ciLow)!=null?ze(Math.max(b,Bt.ciLow)):null,K=((pt=Bt==null?void 0:Bt.ci)==null?void 0:pt.high)!=null?ze(Bt.ci.high):(Bt==null?void 0:Bt.ciHigh)!=null?ze(Bt.ciHigh):null,xe=(ie.replicates??[]).filter(bt=>bt.value!=null&&Number.isFinite(bt.value)),Ne=Math.min(Ie*.6,24),Pe=xe.map((bt,xt)=>{const cr=xe.length>1?(xt-(xe.length-1)/2)/Math.max(1,xe.length-1)*Ne:0;return{x:Et+Ie/2+cr,y:ze(Number(bt.value)),well:bt.well,replicate:bt.replicate}}),mt=Vt!=null?ze(Vt):null;return{entry:ie,sampleLabel:Ct,color:Mt,numeric:Vt,valueText:jt[$e],x:Et,center:Et+Ie/2,spread:Bt,sdLow:gr,sdHigh:Gr,ciLow:vn,ciHigh:K,replicates:Pe,meanY:mt}});return c.jsx(ia,{title:r.title||e.label,helpContent:"Wykres kropkowy: punkty to replikaty, gruba kropka to srednia, a kreski pokazuja SD (opcjonalnie CI).",className:`chart-card parameter-chart-card ${i?"chart-card--fullscreen":""} ${i&&o?"chart-card--with-controls":""}`,contentClassName:"chart-card__body",actions:c.jsxs("div",{className:"btn-pair",style:{flexWrap:"wrap"},children:[i&&c.jsxs("label",{className:`parameters-toggle ${o?"is-on":""}`,title:o?"Ukryj Plot Controls":"Pokaz Plot Controls",style:{marginRight:8},children:[c.jsx("input",{type:"checkbox",checked:o,onChange:u}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:o?"Ukryj Plot Controls":"Pokaz Plot Controls"})]}),c.jsx("button",{type:"button",className:`btn ${i?"primary":""}`,onClick:l,children:i?"Zamknij pelny ekran":"Fullscreen"})]}),children:c.jsx("div",{id:a,className:"chart-card__canvas parameter-chart__canvas",ref:s,"data-chart-id":a,children:t.length?c.jsx("div",{className:"parameter-chart",style:{"--param-font-scale":r.fontScale},"aria-label":`${e.label} dot plot`,ref:f,children:c.jsxs("svg",{className:"parameter-chart__svg",role:"img","aria-labelledby":X,viewBox:`0 0 ${j} ${Ve}`,children:[c.jsx("title",{id:X,children:r.title||e.label}),c.jsx("text",{className:"parameter-chart__title",x:j/2,y:rr,textAnchor:"middle",fontSize:B,fontWeight:800,children:r.title||e.label}),T.map(ie=>{const $e=at-(ie-b)/(_||1)*Kt;return c.jsxs("g",{children:[c.jsx("line",{className:"parameter-chart__grid-line",x1:St,x2:St+Tt,y1:$e,y2:$e}),c.jsx("text",{className:"parameter-chart__tick-label",x:Ce-12,y:$e+4,textAnchor:"end",fontSize:ke,fontWeight:700,children:Ga(ie,2)})]},ie)}),c.jsx("line",{className:"parameter-chart__axis",x1:St,x2:St,y1:at,y2:je-8}),c.jsx("polygon",{className:"parameter-chart__axis-arrow",points:`${St},${je-10} ${St-6},${je} ${St+6},${je}`}),c.jsx("line",{className:"parameter-chart__axis",x1:St,x2:St+Tt,y1:at,y2:at}),r.yLabel&&c.jsx("text",{className:"parameter-chart__y-label",x:hr,y:je+Kt/2,textAnchor:"middle",transform:`rotate(-90 ${hr} ${je+Kt/2})`,fontSize:_e,fontWeight:700,children:r.yLabel}),ct.map(ie=>{var $e;return c.jsxs("g",{children:[c.jsx("title",{children:`${ie.sampleLabel}: ${ie.valueText}`}),ie.sdLow!=null&&ie.sdHigh!=null&&c.jsxs("g",{stroke:ie.color,strokeWidth:2.5,opacity:.9,children:[c.jsx("line",{x1:ie.center,y1:ie.sdLow,x2:ie.center,y2:ie.sdHigh}),c.jsx("line",{x1:ie.center-Ie*.18,y1:ie.sdLow,x2:ie.center+Ie*.18,y2:ie.sdLow}),c.jsx("line",{x1:ie.center-Ie*.18,y1:ie.sdHigh,x2:ie.center+Ie*.18,y2:ie.sdHigh})]}),r.showCi&&ie.ciLow!=null&&ie.ciHigh!=null&&c.jsx("g",{stroke:ie.color,strokeWidth:2,opacity:.6,children:c.jsx("line",{x1:ie.center,y1:ie.ciLow,x2:ie.center,y2:ie.ciHigh,strokeDasharray:"4 4"})}),($e=ie.replicates)!=null&&$e.length?c.jsx("g",{fill:ie.color,opacity:.85,children:ie.replicates.map((Ct,Mt)=>c.jsx("circle",{cx:Ct.x,cy:Ct.y,r:Math.max(3,Ie*.05),stroke:"#fff",strokeWidth:1,children:c.jsx("title",{children:`${ie.entry.sample} | ${Ct.well??"well?"} | R${Ct.replicate??Mt+1}`})},`${ie.entry.sample}-rep-${Mt}`))}):null,ie.meanY!=null&&c.jsx("line",{x1:ie.center-Ie*.25,x2:ie.center+Ie*.25,y1:ie.meanY,y2:ie.meanY,stroke:ie.color,strokeWidth:3,strokeLinecap:"round"}),r.showValues&&ie.meanY!=null&&(Lt?c.jsx("text",{className:"parameter-chart__value",fontSize:te,fontWeight:700,transform:`translate(${ie.center} ${Math.max(B+4,ie.meanY-10)}) rotate(${He})`,textAnchor:"end",dominantBaseline:"central",children:ie.valueText}):c.jsx("text",{className:"parameter-chart__value",x:ie.center,y:Math.max(B+4,ie.meanY-10),textAnchor:"middle",dominantBaseline:"auto",fontSize:te,fontWeight:700,children:ie.valueText})),r.showSamples&&(Xe>0?c.jsx("text",{className:"parameter-chart__sample",fontSize:V,fontWeight:700,transform:`translate(${ie.center} ${at+6}) rotate(${Xe})`,textAnchor:"start",dominantBaseline:"hanging",children:ie.sampleLabel}):c.jsx("text",{className:"parameter-chart__sample",x:ie.center,y:at+V+6,textAnchor:"middle",dominantBaseline:"hanging",fontSize:V,fontWeight:700,children:ie.sampleLabel}))]},ie.entry.sample)}),r.xLabel&&c.jsx("text",{className:"parameter-chart__x-label",x:St+Tt/2,y:er,textAnchor:"middle",fontSize:Math.max(12,13*r.fontScale),fontWeight:700,children:r.xLabel||"Samples"}),r.legendVisible&&M.length>0&&c.jsxs("g",{className:"parameter-chart__legend-svg",transform:`translate(${wt}, ${We})`,onMouseDown:ie=>ie.stopPropagation(),children:[c.jsx("rect",{className:"parameter-chart__legend-rect",width:Ge,height:Ye,rx:10,onMouseDown:re("drag")}),c.jsx("text",{className:"parameter-chart__legend-title",x:Ot+4,y:Ot+N,fontSize:N,fontWeight:800,children:Ht}),(()=>{const ie=Ot,$e=Ot+O,Ct=Math.max(52,(Ge-ie*2)/Je),Mt=I;return M.map((Vt,Et)=>{const Bt=Et%Je,gr=Math.floor(Et/Je),Gr=ie+Bt*Ct,vn=$e+gr*Mt;return c.jsxs("g",{transform:`translate(${Gr}, ${vn})`,children:[c.jsx("rect",{className:"parameter-chart__legend-swatch",x:0,y:3,width:8,height:8,rx:3,style:{fill:Vt.color}}),c.jsx("text",{className:"parameter-chart__legend-label",x:14,y:Math.max(P+1,11),fontSize:P,fontWeight:700,children:Vt.label})]},Vt.id)})})(),c.jsx("rect",{className:"parameter-chart__legend-resize parameter-chart__legend-resize--svg",x:Ge-14,y:Ye-14,width:12,height:12,rx:3,onMouseDown:re("resize")})]})]})}):c.jsx("div",{className:"empty-state",style:{width:"100%",minHeight:160},children:"Brak danych dla zaznaczonych probek."})})})}function SF(){const e=Ze(q=>q.curvesSmoothingSmoothed),t=Ze(q=>q.activeTab),[r,n]=k.useState([]),[a,s]=k.useState(0),[i,l]=k.useState([]),[o,u]=k.useState([]),[f,d]=k.useState([]),[p,h]=k.useState(Aa),[m,x]=k.useState([]),[v,y]=k.useState(""),[w,g]=k.useState(""),[E,A]=k.useState("dataset"),[z,b]=k.useState(!1),[S,_]=k.useState([]),[T,D]=k.useState({}),[M,G]=k.useState({...H0}),[Y,J]=k.useState(0),[Q,X]=k.useState(!1),ee=k.useRef({}),[F,le]=k.useState(null),[re,j]=k.useState(!0),R=r[a]??null,B=k.useMemo(()=>{var pe;const q=new Map,oe=((pe=R==null?void 0:R.mapping)==null?void 0:pe.samples)??[];if(oe.length){const He=ls(Math.max(oe.length,1));oe.forEach((st,_t)=>{if(!(st!=null&&st.name))return;const Lt=typeof st.color=="string"&&st.color?st.color:He[_t%He.length];Lt&&q.set(st.name,Lt)})}if(!q.size&&i.length){const He=ls(Math.max(i.length,1));i.forEach((st,_t)=>{q.set(st.sample,He[_t%He.length])})}return q},[R,i]),V=k.useMemo(()=>{const q=new Set,oe=[];return i.forEach(pe=>{q.has(pe.sample)||(q.add(pe.sample),oe.push(pe.sample))}),oe},[i]),te=k.useMemo(()=>V.join(""),[V]),ke=k.useRef(null),_e=k.useMemo(()=>{const q=[{id:"muMax",label:"muMax",unit:"1/h",getter:oe=>oe.muMax},{id:"td",label:"Td (doubling time)",unit:"h",getter:oe=>oe.td},{id:"lambda",label:"? (lag time)",unit:"h",getter:oe=>oe.lambda},{id:"kHat",label:"K (nosnosc)",unit:"OD",getter:oe=>oe.kHat},{id:"odMax",label:"OD max",unit:"OD",getter:oe=>oe.odMax},{id:"tInflection",label:"t_inf (przegiecie)",unit:"h",getter:oe=>oe.tInflection},{id:"tMid",label:"t_mid (K/2)",unit:"h",getter:oe=>oe.tMid},{id:"slopeInf",label:"Nachylenie w przegieciu",unit:"1/h",getter:oe=>oe.slopeAtInflection},{id:"auc",label:"AUC",unit:"OD*h",getter:oe=>oe.auc}];return Pl.forEach(oe=>{const pe=V0(oe);q.push({id:`det-${pe}`,label:`Detection @${pe}`,unit:"h",getter:He=>He.detection[pe]})}),q},[]),ge=k.useCallback(q=>oe=>{ee.current[q]=oe},[]);k.useEffect(()=>{if(!(typeof document>"u")&&F){const q=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=q}}},[F]),k.useEffect(()=>{F||j(!0)},[F]),k.useEffect(()=>{const q=oe=>{const pe=oe.target;pe&&(pe.tagName==="INPUT"||pe.tagName==="TEXTAREA"||pe.tagName==="SELECT"||pe.isContentEditable)||oe.key!=="r"&&oe.key!=="R"||(J(He=>He+1),D(He=>{const st={};return Object.entries(He).forEach(([_t,Lt])=>{st[_t]={...Lt}}),st}))};return window.addEventListener("keydown",q,{capture:!0}),()=>window.removeEventListener("keydown",q,{capture:!0})},[]);const ye=k.useCallback(async q=>{if(typeof window>"u")return null;const oe=ee.current[q];if(!oe)return null;try{const He=oe.querySelector(".parameter-chart__svg")??oe;return await Ly(He,{scale:Math.min(3,Math.max(1.5,window.devicePixelRatio||2)),background:"#ffffff"})}catch(pe){return console.error("PNG export error",pe),y("[ERR] Eksport PNG nie powiodl sie."),null}},[y]),Ee=k.useCallback(async(q,oe)=>{const pe=await ye(q);if(!pe){y("[ERR] Nie udalo sie przygotowac PNG (sprobuj ponownie).");return}const He=La(oe||"parameter-chart"),st=URL.createObjectURL(pe),_t=document.createElement("a");_t.href=st,_t.download=`${He}.png`,document.body.appendChild(_t),_t.click(),_t.remove(),URL.revokeObjectURL(st)},[ye,y]),C=k.useCallback(async(q,oe)=>{const pe=await ye(q);if(!pe){y("[ERR] Nie udalo sie przygotowac PNG (sprobuj ponownie).");return}if(typeof ClipboardItem<"u"&&navigator.clipboard&&"write"in navigator.clipboard)try{await navigator.clipboard.write([new ClipboardItem({"image/png":pe})]);return}catch{}const He=La(oe||"parameter-chart"),st=URL.createObjectURL(pe),_t=document.createElement("a");_t.href=st,_t.download=`${He}.png`,document.body.appendChild(_t),_t.click(),_t.remove(),URL.revokeObjectURL(st)},[ye,y]),we=k.useMemo(()=>i.map(q=>q.sample).join("|"),[i]);k.useEffect(()=>{if(!i.length){_([]);return}_(q=>{const oe=i.map(He=>He.sample);if(!q.length)return[...oe];const pe=q.filter(He=>oe.includes(He));return pe.length?pe:[...oe]})},[we,i]),k.useEffect(()=>{D(q=>{let oe=!1;const pe={...q};return _e.forEach(He=>{pe[He.id]||(pe[He.id]=G0(He),oe=!0)}),Object.keys(pe).forEach(He=>{_e.find(st=>st.id===He)||(delete pe[He],oe=!0)}),oe?pe:q})},[_e]);const he=k.useCallback((q,oe)=>{if(!q){l([]),u([]),d([]),h(Aa),x([]),y("");return}const{results:pe,warnings:He,sourceLabel:st,wellResults:_t,paramsByReplicate:Lt,statsBySample:xr,statsConfig:Qe}=uF(q,Pl);l(pe),u(Lt||_t||[]),d(xr||[]),h(Qe||Aa),x(He),A(st||oe),y(pe.length?`[OK] Przeliczono parametry dla ${pe.length} probek.`:"[WARN] Brak wynikow do wyswietlenia.")},[]);k.useEffect(()=>{if(!R){l([]),u([]),d([]),h(Aa),x([]),y("");return}he(R,w||"dataset")},[R,w,he]),k.useEffect(()=>{var pe;const q=(pe=e==null?void 0:e.rawPayload)==null?void 0:pe.assignments;if(!q||!Array.isArray(q)||!q.length){b(!1);return}const oe=q.some(He=>wx(He));b(oe),oe&&(n(q),s(0),g(e!=null&&e.filename?`[auto] ${e.filename}`:"[auto] smoothing"),y("[AUTO] Dane z Curves Smoothing zostaly zaladowane (z log phase)."))},[e]);const Ce=k.useCallback(async q=>{if(!(q!=null&&q.length))return;const oe=q[0];try{const pe=await oe.text(),He=JSON.parse(pe),st=vF(He);if(!st.length){n([]),s(0),l([]),u([]),d([]),h(Aa),x([`[WARN] Plik ${oe.name} nie zawiera danych assignment.`]),y(`[WARN] Nie udalo sie odczytac assignmentow z ${oe.name}.`);return}const _t=st.some(Lt=>wx(Lt));if(b(_t),!_t){n([]),s(0),l([]),u([]),d([]),h(Aa),x([`[WARN] Plik ${oe.name} nie zawiera danych z log phase/smoothing.`]),y(`[WARN] Brak wygladzonych danych z identyfikacja fazy log w ${oe.name}.`);return}n(st),s(0),g(oe.name),y(`[OK] Wczytano ${oe.name} (${st.length} assignment).`)}catch(pe){console.error(pe),d([]),h(Aa),y(`[ERR] Nie udalo sie odczytac pliku: ${(pe==null?void 0:pe.message)??String(pe)}`)}},[]),Ae=k.useCallback(q=>{if(!i.length)return;const oe=La((w||E||"dataset").replace(/\.[^.]+$/,""));if(q==="json"){const Qe={alpha:(p==null?void 0:p.alpha)??Aa.alpha,method:"t",bootstrapIterations:(p==null?void 0:p.bootstrapIterations)??Aa.bootstrapIterations,bootstrapMethod:"percentile"},rt={generatedAt:new Date().toISOString(),source:w||E||"dataset",thresholds:Pl,results:i,wellResults:o,paramsByReplicate:o,params_by_replicate:o,statsBySample:f,stats_by_sample:f,ci:Qe,statsConfig:Qe},je=new Blob([JSON.stringify(rt,null,2)],{type:"application/json;charset=utf-8"});vl(je,`${oe}.results.json`),y(`[FILE] Zapisano ${oe}.results.json`);return}const pe=Qe=>Qe==null||Number.isNaN(Qe)?"":Number(Qe).toFixed(6),He=["muMax","td","lambda","kHat","odMax","tInflection","tMid","slopeAtInflection","auc","logStart","logEnd","tLogDuration"],Lt=[[...["sample","replicates","replicates_total",...He.flatMap(Qe=>[`${Qe}`,`${Qe}_median`,`${Qe}_sd`,`${Qe}_sem`,`${Qe}_ciLow`,`${Qe}_ciHigh`,`${Qe}_ciBootLow`,`${Qe}_ciBootHigh`]),...Pl.flatMap(Qe=>{const rt=V0(Qe);return[`det_${rt}`,`det_${rt}_median`,`det_${rt}_sd`,`det_${rt}_sem`,`det_${rt}_ciLow`,`det_${rt}_ciHigh`,`det_${rt}_ciBootLow`,`det_${rt}_ciBootHigh`]})],"lambdaMethod"].join(",")];i.forEach(Qe=>{const rt=[Qe.sample,Qe.replicates??"",Qe.replicatesTotal??Qe.replicates??""];He.forEach(je=>{var Kt,St,yr,Tt,at;const Be=(Kt=Qe.stats)==null?void 0:Kt[je],Ve=Qe[je];rt.push(pe(Ve)),rt.push(pe(Be==null?void 0:Be.median)),rt.push(pe(Be==null?void 0:Be.sd)),rt.push(pe(Be==null?void 0:Be.sem)),rt.push(pe(Be==null?void 0:Be.ciLow)),rt.push(pe(Be==null?void 0:Be.ciHigh)),rt.push(pe(((St=Be==null?void 0:Be.ciBootstrap)==null?void 0:St.low)??((yr=Be==null?void 0:Be.ci95Bootstrap)==null?void 0:yr[0]))),rt.push(pe(((Tt=Be==null?void 0:Be.ciBootstrap)==null?void 0:Tt.high)??((at=Be==null?void 0:Be.ci95Bootstrap)==null?void 0:at[1])))}),Pl.forEach(je=>{var St,yr,Tt,at,rr,er;const Be=V0(je),Ve=(yr=(St=Qe.stats)==null?void 0:St.detection)==null?void 0:yr[Be],Kt=Qe.detection[Be];rt.push(pe(Kt)),rt.push(pe(Ve==null?void 0:Ve.median)),rt.push(pe(Ve==null?void 0:Ve.sd)),rt.push(pe(Ve==null?void 0:Ve.sem)),rt.push(pe(Ve==null?void 0:Ve.ciLow)),rt.push(pe(Ve==null?void 0:Ve.ciHigh)),rt.push(pe(((Tt=Ve==null?void 0:Ve.ciBootstrap)==null?void 0:Tt.low)??((at=Ve==null?void 0:Ve.ci95Bootstrap)==null?void 0:at[0]))),rt.push(pe(((rr=Ve==null?void 0:Ve.ciBootstrap)==null?void 0:rr.high)??((er=Ve==null?void 0:Ve.ci95Bootstrap)==null?void 0:er[1])))}),rt.push(Qe.lambdaMethod??""),Lt.push(rt.map(je=>String(je)).join(","))});const xr=new Blob([Lt.join(`
`)],{type:"text/csv;charset=utf-8"});vl(xr,`${oe}.results.csv`),y(`[FILE] Zapisano ${oe}.results.csv`)},[i,o,w,E]),be=k.useCallback(q=>{_(oe=>{const pe=new Set(oe);return pe.has(q)?pe.delete(q):pe.add(q),Array.from(pe)})},[]),qe=k.useCallback(()=>{_(i.map(q=>q.sample))},[i]),Ie=k.useCallback(()=>_([]),[]);k.useEffect(()=>{S.length===1&&(ke.current=S[0]??null)},[S]);const ht=k.useCallback((q,oe)=>{if(!V.length)return null;const pe=q?V.indexOf(q):-1,st=((pe===-1?oe===1?-1:0:pe)+oe+V.length)%V.length;return V[st]??null},[te]),yt=k.useCallback(q=>{const oe=ke.current??S[0]??V[0]??null;if(!oe)return;const pe=ht(oe,q);pe&&(_([pe]),ke.current=pe)},[ht,te,S]);k.useEffect(()=>{const q=oe=>{const pe=oe.target;pe&&(pe.tagName==="INPUT"||pe.tagName==="TEXTAREA"||pe.tagName==="SELECT"||pe.isContentEditable)||oe.key!=="ArrowDown"&&oe.key!=="ArrowUp"||t==="parameters"&&(oe.preventDefault(),yt(oe.key==="ArrowDown"?1:-1))};return window.addEventListener("keydown",q,{capture:!0}),()=>window.removeEventListener("keydown",q,{capture:!0})},[t,yt]);const Pt=k.useMemo(()=>{if(!S.length)return[];const q=new Set(S);return i.filter(oe=>q.has(oe.sample))},[i,S]),Fe=k.useMemo(()=>{const q=S.length===0,oe=[];if(!R)return{series:[],ciBands:[],sdBands:[],medianScatter:[],meanScatter:[],warnings:oe,selectionEmpty:q,hasReplicates:!1};const{curves:pe,warnings:He}=gF(R);if(oe.push(...He),q)return{series:[],ciBands:[],sdBands:[],medianScatter:[],meanScatter:[],warnings:oe,selectionEmpty:!0,hasReplicates:!1};if(!pe.length)return oe.push("Brak danych do narysowania LOESS."),{series:[],ciBands:[],sdBands:[],medianScatter:[],meanScatter:[],warnings:oe,selectionEmpty:!1,hasReplicates:!1};const st=new Set(S),_t=pe.filter(Tt=>st.has(Tt.sample));if(!_t.length)return oe.push("Brak krzywych LOESS dla zaznaczonych probek."),{series:[],ciBands:[],sdBands:[],medianScatter:[],meanScatter:[],warnings:oe,selectionEmpty:!1,hasReplicates:!1};const Lt=new Map;_t.forEach(Tt=>{const at=Lt.get(Tt.sample)??[];at.push(Tt),Lt.set(Tt.sample,at)});const xr=ls(Math.max(Lt.size,_t.length,1));let Qe=0;const rt=[],je=[],Be=[],Ve=[],Kt=[];let St=!1;Lt.forEach((Tt,at)=>{if(!Tt.length)return;Tt.length>=2&&(St=!0);const rr=Array.from(new Set(Tt.flatMap(P=>P.points.map(O=>O.x)))).sort((P,O)=>P-O);if(!rr.length)return;const er=Tt.map(P=>xF(P.points,rr)),hr=[],pr=[],Ht=[],Ot=[];if(rr.forEach((P,O)=>{const I=er.map(de=>de[O]).filter(de=>Number.isFinite(de));if(!I.length)return;const W=I.reduce((de,Re)=>de+Re,0)/I.length,H=[...I].sort((de,Re)=>de-Re),ce=Math.floor(H.length/2),ve=H.length%2===0?(H[ce-1]+H[ce])/2:H[ce],Z=I.length>1?Math.sqrt(I.reduce((de,Re)=>de+(Re-W)**2,0)/(I.length-1)):0,fe=I.length>1?pF(I.length-1)*(Z/Math.sqrt(I.length)):0;hr.push({x:P,y:W}),pr.push({x:P,y:ve}),Ht.push({x:P,low:W-Z,high:W+Z}),Ot.push({x:P,low:W-fe,high:W+fe})}),!hr.length)return;const N=B.get(at)??xr[Qe%xr.length];if(Qe+=1,rt.push({name:at,color:N,points:hr}),pr.length&&Ve.push({name:`${at} (median)`,color:N,points:pr.map((P,O)=>({...P,id:`${at}-median-${O}`,meta:{shape:"dash"}}))}),Kt.push({name:`${at} (mean)`,color:N,points:hr.map((P,O)=>({...P,id:`${at}-mean-${O}`,meta:{shape:"dash"}}))}),Ot.length)je.push({name:at,color:N,points:Ot}),Be.push({name:at,color:N,points:Ht});else if(Tt.length<2){oe.push(`Tylko jedna krzywa dla ${at} - pasmo CI = linia.`);const P=hr.map(O=>({x:O.x,low:O.y,high:O.y}));je.push({name:at,color:N,points:P}),Be.push({name:at,color:N,points:P})}});const yr=Array.from(new Set(oe));return{series:rt,ciBands:je,sdBands:Be,medianScatter:Ve,meanScatter:Kt,warnings:yr,selectionEmpty:!1,hasReplicates:St}},[R,S,B]),vt=k.useMemo(()=>[{id:"parameters-summary",label:"Podsumowanie"},{id:"parameters-loess",label:"Krzywe LOESS"},..._e.map(q=>({id:`param-${q.id}`,label:q.label}))],[_e]),jt="parameters-loess",ft="parameters-loess-chart",kt=k.useCallback(q=>{const oe=document.getElementById(q);oe&&(oe.scrollIntoView({behavior:"smooth",block:"start"}),X(!1))},[]),Se=!z,ot=F===ft,Xe=Fe.selectionEmpty||Fe.series.length===0,Rt=k.useMemo(()=>{const q=[];return M.showCi&&q.push(...Fe.ciBands.map(oe=>({...oe,mode:"area"}))),M.showSd&&q.push(...Fe.sdBands.map(oe=>({...oe,mode:"errorbars"}))),q},[M.showCi,M.showSd,Fe.ciBands,Fe.sdBands]);return c.jsxs("div",{className:"panel parameters-page",onKeyDown:q=>{if(q.key!=="ArrowDown"&&q.key!=="ArrowUp")return;const oe=q.target;oe&&(oe.tagName==="INPUT"||oe.tagName==="TEXTAREA"||oe.tagName==="SELECT"||oe.isContentEditable)||(q.preventDefault(),yt(q.key==="ArrowDown"?1:-1))},tabIndex:0,children:[c.jsx("h2",{children:"Parameters"}),c.jsxs("div",{className:"small",children:["Parametry dostepne tylko po wygladzaniu i identyfikacji fazy log. Wczytaj plik ",c.jsx("code",{children:".smoothed.json"})," z log phases lub uzyj Curves Smoothing."]}),Se&&c.jsx("div",{className:"empty-state",style:{marginTop:12},children:"Najpierw wykonaj Curves Smoothing + Log Phase Identification (albo wgraj plik smoothed z log phase)."}),c.jsxs("div",{className:"row",style:{gap:12,marginTop:12,flexWrap:"wrap",opacity:Se?.5:1,pointerEvents:Se?"none":"auto"},children:[c.jsxs("div",{className:"col",style:{minWidth:240},children:[c.jsx("label",{className:"small",children:"Plik zrodlowy"}),c.jsx("input",{type:"file",accept:".json",onChange:q=>Ce(q.target.files)}),w&&c.jsxs("div",{className:"small",style:{marginTop:4},children:["Aktywny plik: ",w]})]}),c.jsxs("div",{className:"col",style:{minWidth:220},children:[c.jsx("label",{className:"small",children:"Assignment"}),c.jsxs("select",{value:a,onChange:q=>s(Number(q.target.value)),disabled:!r.length,children:[!r.length&&c.jsx("option",{children:"(brak danych)"}),r.map((q,oe)=>{var st;const pe=(st=q==null?void 0:q.dataset)==null?void 0:st.meta,He=(pe==null?void 0:pe.sourceFile)||(pe==null?void 0:pe.runId)||`assignment-${oe+1}`;return c.jsxs("option",{value:oe,children:[oe+1,". ",He]},He)})]})]}),c.jsxs("div",{className:"col",style:{minWidth:220},children:[c.jsx("label",{className:"small",children:""}),c.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[c.jsx("button",{className:"btn",onClick:()=>he(R,w),disabled:!R,children:"Przelicz parametry"}),c.jsx("button",{className:"btn",onClick:()=>Ae("json"),disabled:!i.length,children:"Export .results.json"}),c.jsx("button",{className:"btn",onClick:()=>Ae("csv"),disabled:!i.length,children:"Export .results.csv"})]})]})]}),v&&c.jsx("div",{className:"small",style:{marginTop:8},children:v}),m.length>0&&c.jsx("div",{className:"small",style:{marginTop:8,color:"#92400e",background:"#fef3c7",border:"1px solid #f59e0b",padding:"8px 10px",borderRadius:6},children:m.map((q,oe)=>c.jsx("div",{children:q},oe))}),!i.length&&c.jsx("div",{className:"empty-state",style:{marginTop:16},children:"Wczytaj dane, aby zobaczyc parametry."}),i.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"panel",style:{marginTop:16},id:"parameters-summary",children:[c.jsx("h3",{children:"Podsumowanie"}),c.jsxs("table",{className:"table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Sample"}),c.jsx("th",{children:"Rep"}),c.jsx("th",{children:"muMax [1/h]"}),c.jsx("th",{children:"Td [h]"}),c.jsx("th",{children:"? [h]"}),c.jsx("th",{children:"K (95%)"}),c.jsx("th",{children:"OD max"}),c.jsx("th",{children:"t_inf [h]"}),c.jsx("th",{children:"AUC"})]})}),c.jsx("tbody",{children:i.map(q=>c.jsxs("tr",{children:[c.jsx("td",{children:q.sample}),c.jsx("td",{children:q.replicates??"-"}),c.jsx("td",{children:Ga(q.muMax)}),c.jsx("td",{children:Ga(q.td)}),c.jsx("td",{children:Ga(q.lambda)}),c.jsx("td",{children:Ga(q.kHat)}),c.jsx("td",{children:Ga(q.odMax)}),c.jsx("td",{children:Ga(q.tInflection)}),c.jsx("td",{children:Ga(q.auc)})]},q.sample))})]})]}),c.jsxs("div",{className:"parameters-layout",children:[c.jsx("div",{className:"parameters-left",children:c.jsx(wF,{results:i,selectedSamples:S,onToggle:be,onSelectAll:qe,onClear:Ie,sampleColors:B})}),c.jsxs("div",{className:"parameters-main",children:[c.jsxs("div",{className:"parameter-section",id:jt,children:[!ot&&c.jsx(kx,{settings:M,onChange:q=>G(q),onReset:()=>{G({...H0}),J(q=>q+1)},onResetView:()=>J(q=>q+1),onExport:()=>Ee(ft,M.title||"loess-curves"),onCopy:()=>C(ft,M.title||"loess-curves"),legendVisible:!!M.legendVisible,onToggleLegend:()=>G(q=>({...q,legendVisible:!q.legendVisible})),showMean:!!M.showMean,showMedian:!!M.showMedian,showSd:!!M.showSd,showCi:!!M.showCi,disabled:Xe}),ot&&re&&c.jsx("div",{className:"plot-controls-float",children:c.jsx(kx,{settings:M,onChange:q=>G(q),onReset:()=>{G({...H0}),J(q=>q+1)},onResetView:()=>J(q=>q+1),onExport:()=>Ee(ft,M.title||"loess-curves"),onCopy:()=>C(ft,M.title||"loess-curves"),legendVisible:!!M.legendVisible,onToggleLegend:()=>G(q=>({...q,legendVisible:!q.legendVisible})),showMean:!!M.showMean,showMedian:!!M.showMedian,showSd:!!M.showSd,showCi:!!M.showCi,disabled:Xe})}),c.jsxs(ia,{title:"Krzywe LOESS (smoothed)",helpContent:"Krzywe LOESS po wygladzaniu wraz z 95% CI liczonym z replik. Uzyj panelu Samples (po lewej), aby filtrowac probki.",className:`chart-card parameter-chart-card ${ot?"chart-card--fullscreen":""} ${ot&&re?"chart-card--with-controls":""}`,contentClassName:"chart-card__body",actions:c.jsxs("div",{className:"btn-pair",style:{flexWrap:"wrap"},children:[ot&&c.jsxs("label",{className:`parameters-toggle ${re?"is-on":""}`,title:re?"Ukryj Plot Controls":"Pokaz Plot Controls",style:{marginRight:8},children:[c.jsx("input",{type:"checkbox",checked:re,onChange:()=>j(q=>!q)}),c.jsx("span",{className:"parameters-toggle__slider","aria-hidden":!0}),c.jsx("span",{className:"parameters-toggle__label",children:re?"Ukryj Plot Controls":"Pokaz Plot Controls"})]}),c.jsx("button",{type:"button",className:`btn ${ot?"primary":""}`,onClick:()=>le(q=>q===ft?null:ft),children:ot?"Zamknij pelny ekran":"Fullscreen"})]}),children:[Fe.warnings.length>0&&c.jsx("div",{className:"small",style:{marginBottom:8,color:"#92400e"},children:Fe.warnings.map((q,oe)=>c.jsx("div",{children:q},oe))}),!Fe.hasReplicates&&!Xe&&c.jsx("div",{className:"small",style:{marginBottom:8,color:"#92400e"},children:"Pasmo CI bazuje na pojedynczej krzywej - dodaj wiecej replik, aby uzyskac pelny przedzial."}),c.jsx("div",{id:ft,className:"chart-card__canvas",ref:ge(ft),"data-chart-id":ft,children:Fe.selectionEmpty?c.jsx("div",{className:"empty-state",style:{minHeight:220},children:"Zaznacz probki w panelu Samples, aby narysowac LOESS."}):Fe.series.length?c.jsx(Cu,{series:Fe.series,bands:Rt,scatterSeries:[...M.showMean?Fe.meanScatter:[],...M.showMedian?Fe.medianScatter:[]],title:M.title,xLabel:M.xLabel,yLabel:M.yLabel,fontScale:M.fontScale,legendMode:"table-below",showLegend:M.legendVisible,legendScale:M.legendScale,aspect:1.8,stdMode:"none",resetViewKey:Y,minPanX:Number.NEGATIVE_INFINITY,minPanY:Number.NEGATIVE_INFINITY,height:ot?620:420,mode:"line",pointMarkers:"none"}):c.jsx("div",{className:"empty-state",style:{minHeight:220},children:"Brak krzywych LOESS do wyswietlenia."})})]})]}),_e.map(q=>{const oe={...G0(q),...T[q.id]??{}},pe=yF(Pt.map(Qe=>({sample:Qe.sample,value:q.getter(Qe),spread:dF(Qe,q.id),replicates:o.filter(rt=>rt.sample===Qe.sample).reduce((rt,je)=>{const Be=q.getter(je);return Be==null||!Number.isFinite(Number(Be))||rt.push({value:Number(Be),well:je.well,replicate:je.replicate}),rt},[])})),oe.sort),He=`param-${q.id}`,st=`${He}-chart`,_t=F===st,Lt=Qe=>{D(rt=>({...rt,[q.id]:Qe}))},xr=()=>c.jsx(kF,{param:q,settings:oe,onChange:Lt,onReset:()=>Lt(G0(q)),onExport:()=>Ee(st,oe.title||q.label),onCopy:()=>C(st,oe.title||q.label),legendVisible:!!oe.legendVisible,onToggleLegend:()=>Lt({...oe,legendVisible:!oe.legendVisible}),samples:pe.map(Qe=>Qe.sample),sampleColors:B,disabled:!i.length});return c.jsxs("div",{className:"parameter-section",id:He,children:[!_t&&xr(),_t&&re&&c.jsx("div",{className:"plot-controls-float",children:xr()}),c.jsx(_F,{param:q,data:pe,settings:oe,sampleColors:B,chartId:st,chartRef:ge(st),fullscreen:_t,onToggleFullscreen:()=>le(Qe=>{const rt=Qe===st?null:st;return rt&&j(!0),rt}),showControls:re,onToggleControls:()=>j(Qe=>!Qe)})]},q.id)})]})]}),c.jsx("button",{type:"button",className:"parameters-nav-toggle",onClick:()=>X(!0),"aria-label":"Otworz panel nawigacji",children:c.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M4 6h16M4 12h16M4 18h16",strokeLinecap:"round"})})}),Q&&c.jsx("div",{className:"parameters-nav-overlay",role:"dialog","aria-label":"Nawigacja kart Parameters",children:c.jsxs("div",{className:"panel parameters-nav parameters-nav--floating",children:[c.jsxs("div",{className:"parameters-nav__header",children:[c.jsx("h4",{style:{margin:0},children:"Nawigacja"}),c.jsx("button",{className:"btn",type:"button",onClick:()=>X(!1),"aria-label":"Zamknij nawigacje",children:""})]}),c.jsx("p",{className:"small",style:{marginTop:6},children:"Przeskakuj bezposrednio do tabeli lub konkretnego wykresu."}),c.jsx("div",{className:"parameters-nav__list",children:vt.map(q=>c.jsx("button",{className:"btn parameters-nav__btn",type:"button",onClick:()=>kt(q.id),children:q.label},q.id))})]})})]})]})}const EF=[{id:"home",labels:{en:"Home",pl:"Start"}},{id:"samplesMapping",labels:{en:"Setup",pl:"Konfiguracja"}},{id:"plots",labels:{en:"Data Control",pl:"Kontrola Danych"}},{id:"interactive",labels:{en:"Blank",pl:"Blank"}},{id:"compiler",labels:{en:"Curves Smoothing",pl:"Wygadzanie Krzywych"}},{id:"parameters",labels:{en:"Parameters",pl:"Parametry"}}];function bF(){return c.jsxs("svg",{className:"logo-mark",viewBox:"0 0 256 256","aria-hidden":"true",focusable:"false",children:[c.jsxs("defs",{children:[c.jsxs("linearGradient",{id:"bgGrad",x1:"0",y1:"0",x2:"1",y2:"1",children:[c.jsx("stop",{offset:"0%",stopColor:"#0f172a"}),c.jsx("stop",{offset:"100%",stopColor:"#1e293b"})]}),c.jsxs("linearGradient",{id:"curveGrad",x1:"0",y1:"1",x2:"1",y2:"0",children:[c.jsx("stop",{offset:"0%",stopColor:"#22c55e"}),c.jsx("stop",{offset:"50%",stopColor:"#a855f7"}),c.jsx("stop",{offset:"100%",stopColor:"#38bdf8"})]})]}),c.jsx("rect",{x:"8",y:"8",width:"240",height:"240",rx:"56",fill:"url(#bgGrad)"}),c.jsxs("g",{stroke:"#64748b",strokeWidth:"4",strokeLinecap:"round",children:[c.jsx("line",{x1:"52",y1:"204",x2:"212",y2:"204"}),c.jsx("line",{x1:"52",y1:"72",x2:"52",y2:"204"})]}),c.jsxs("g",{stroke:"#1f2937",strokeWidth:"2",opacity:"0.6",children:[c.jsx("line",{x1:"52",y1:"172",x2:"212",y2:"172"}),c.jsx("line",{x1:"52",y1:"140",x2:"212",y2:"140"}),c.jsx("line",{x1:"52",y1:"108",x2:"212",y2:"108"})]}),c.jsx("path",{d:"M 56 198 C 80 196, 96 190, 110 178 C 128 162, 140 140, 152 124 C 170 100, 188 92, 212 92",fill:"none",stroke:"url(#curveGrad)",strokeWidth:"6",strokeLinecap:"round"}),c.jsxs("g",{fill:"#e5e7eb",stroke:"#0f172a",strokeWidth:"2",children:[c.jsx("circle",{cx:"72",cy:"190",r:"5"}),c.jsx("circle",{cx:"96",cy:"182",r:"5"}),c.jsx("circle",{cx:"120",cy:"164",r:"5"}),c.jsx("circle",{cx:"144",cy:"138",r:"5"}),c.jsx("circle",{cx:"172",cy:"112",r:"5"}),c.jsx("circle",{cx:"200",cy:"100",r:"5"})]}),c.jsx("text",{x:"204",y:"48",textAnchor:"end",fontFamily:"system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif",fontSize:"26",fontWeight:"600",fill:"#cbd5f5",children:"GCA"}),c.jsxs("g",{transform:"rotate(-18 64 40)",children:[c.jsx("rect",{x:"26",y:"24",rx:"10",ry:"10",width:"90",height:"32",fill:"#b91c1c",opacity:"0.95"}),c.jsx("text",{x:"71",y:"46",textAnchor:"middle",fontFamily:"system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif",fontSize:"18",fontWeight:"700",fill:"#ffffff",children:"DEMO"})]})]})}function CF(){const e=Ze(l=>l.activeTab==="logPhase"?"parameters":l.activeTab),t=Ze(l=>l.setActiveTab),r=Ze(l=>l.language),n=Ze(l=>l.setLanguage),a=Ze(l=>l.theme),s=Ze(l=>l.toggleTheme),i=a==="light"?r==="pl"?"Wlacz tryb nocny":"Enable night mode":r==="pl"?"Wlacz tryb dzienny":"Enable day mode";return c.jsxs("header",{className:"topbar",children:[c.jsxs("div",{className:"logo-area",children:[c.jsx("div",{className:"logo-mark-wrap",children:c.jsx(bF,{})}),c.jsx("div",{children:c.jsx("div",{className:"logo",children:"Growth Curves Analyser Demo"})})]}),c.jsx("div",{className:"nav",role:"tablist","aria-label":"Modules",children:EF.map(l=>c.jsx("button",{className:e===l.id?"active":"",onClick:()=>t(l.id),"aria-pressed":e===l.id,children:l.labels[r]},l.id))}),c.jsxs("div",{className:"nav-utilities",children:[c.jsxs("div",{className:"language-toggle",role:"group","aria-label":"Language switch",children:[c.jsx("button",{className:r==="en"?"active":"",onClick:()=>n("en"),"aria-pressed":r==="en",children:"EN"}),c.jsx("button",{className:r==="pl"?"active":"",onClick:()=>n("pl"),"aria-pressed":r==="pl",children:"PL"})]}),c.jsx("button",{className:"mode-toggle",onClick:s,"aria-label":i,children:a==="light"?"":""})]})]})}const TF={en:{headline:"End-to-end growth curve workflow.",contact:"Email: growthcurves.analyser@gmail.com",version:"Demo v0.1.0",builtBy:"App created by Iwo Szempruch",linkedin:"LinkedIn",portfolio:"GitHub Portfolio"},pl:{headline:"Kompletny workflow do krzywych wzrostu.",contact:"Email: growthcurves.analyser@gmail.com",version:"Demo v0.1.0",builtBy:"Aplikacja stworzona przez Iwo Szempruch",linkedin:"LinkedIn",portfolio:"Portfolio GitHub"}},_x={linkedin:"https://www.linkedin.com/in/iwoszempruch",portfolio:"https://iwoszempruch.github.io/Portfolio/"};function NF(){const e=Ze(n=>n.language),t=k.useMemo(()=>new Date().getFullYear(),[]),r=TF[e];return c.jsxs("footer",{className:"footer",children:[c.jsxs("div",{className:"footer-brand",children:[c.jsx("div",{className:"logo",children:"Bacterial Growth Curves"}),c.jsx("p",{children:r.headline})]}),c.jsxs("div",{className:"footer-meta",children:[c.jsx("span",{children:r.version}),c.jsx("span",{children:r.contact}),c.jsxs("span",{children:[" ",t]})]}),c.jsxs("div",{className:"footer-links",children:[c.jsx("span",{children:r.builtBy}),c.jsx("a",{href:_x.linkedin,target:"_blank",rel:"noreferrer noopener",children:r.linkedin}),c.jsx("a",{href:_x.portfolio,target:"_blank",rel:"noreferrer noopener",children:r.portfolio})]})]})}function AF(){const t=Ze(o=>o.language)==="pl",[r,n]=k.useState(!1),[a,s]=k.useState(null),i="growthcurves.analyser@gmail.com",l=k.useCallback((o,u)=>{var f;try{if((f=navigator==null?void 0:navigator.clipboard)!=null&&f.writeText)navigator.clipboard.writeText(o);else{const d=document.createElement("textarea");d.value=o,document.body.appendChild(d),d.select(),document.execCommand("copy"),document.body.removeChild(d)}s(t?`${u} skopiowano`:`${u} copied`)}catch{s(t?"Nie udao si skopiowa":"Copy failed")}finally{setTimeout(()=>s(null),2e3)}},[t]);return c.jsxs("div",{className:`feedback-bubble ${r?"open":""}`,children:[c.jsx("button",{type:"button",className:"feedback-bubble__btn","aria-label":t?"Zgo uwagi":"Send feedback",onClick:()=>n(o=>!o),children:c.jsxs("span",{className:"typing-dots","aria-hidden":"true",children:[c.jsx("span",{}),c.jsx("span",{}),c.jsx("span",{})]})}),r&&c.jsxs("div",{className:"feedback-bubble__popover",children:[c.jsxs("p",{className:"small",style:{margin:0},children:[t?"W przypadku bdw, zastrzee lub sugestii wylij prosz maila na":"If you spot an error or have suggestions, please email"," ",c.jsx("button",{type:"button",className:"link-btn",onClick:()=>l(i,"Email"),children:i}),"."]}),a&&c.jsx("div",{className:"small",style:{marginTop:4},children:a})]})]})}function jF(){const e=Ze(n=>n.activeTab==="logPhase"?"parameters":n.activeTab),t=Ze(n=>n.theme),r=Ze(n=>n.setActiveTab);return k.useEffect(()=>{document.documentElement.setAttribute("data-theme",t)},[t]),k.useEffect(()=>{if(typeof window>"u")return;const a=new URLSearchParams(window.location.search).get("tab");a&&new Set(["home","samplesMapping","plots","interactive","compiler","parameters","logPhase"]).has(a)&&r(a==="logPhase"?"parameters":a)},[r]),c.jsxs("div",{className:"app",children:[c.jsx(CF,{}),c.jsx("main",{className:"main",children:e==="home"?c.jsx(A_,{}):c.jsxs("div",{className:"container",children:[e==="samplesMapping"&&c.jsx(p3,{}),c.jsx("div",{style:{display:e==="plots"?"block":"none"},"aria-hidden":e==="plots"?void 0:!0,children:c.jsx(T3,{})}),c.jsx("div",{style:{display:e==="interactive"?"block":"none"},"aria-hidden":e==="interactive"?void 0:!0,children:c.jsx(A3,{})}),c.jsx("div",{style:{display:e==="compiler"?"block":"none"},"aria-hidden":e==="compiler"?void 0:!0,children:c.jsx(Q3,{})}),e==="parameters"&&c.jsx(SF,{}),c.jsx(AF,{})]})}),c.jsx(NF,{})]})}O1(document.getElementById("root")).render(c.jsx(Rx.StrictMode,{children:c.jsx(jF,{})}));
